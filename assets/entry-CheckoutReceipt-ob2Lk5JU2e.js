import{K as T}from"./entry-KvIcon-BUhAos7YaB.js";import{c as n,q as e,L as i,m as d,J as p,I as f,M as r,D as g,z as v,C as u,a as m,r as _,K as x,o as s}from"./entry-vue.esm-bundler-C0PPCo9W96.js";import"./entry-KvWwwHeader-C1bm1YMh4q.js";import{g as K}from"./entry-KvButton-BA7nBLyz1b.js";import{N as j}from"./entry-KvTooltip-CaRc32kHXv.js";import"./entry-numeral-xVHG5DEP0A.js";import{_ as O}from"./entry-_plugin-vue_export-helper-DlAUqK2UKH.js";import{f as I}from"./entry-index-CGacd2nhU3.js";const D=(l=Date.now())=>{const t=new Date(l);return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds())},h={name:"CheckoutReceipt",components:{KvButton:K,KvIcon:T,KvTooltip:j},props:{lender:{type:Object,required:!0},receipt:{type:Object,required:!0},disableRedirects:{type:Boolean,default:!1},enableKivaCardTracking:{type:Boolean,default:!1}},computed:{formattedTransactionTime(){return`${I(D(this.receipt.transactionTime),"MMMM dd, yyyy h:mm a")} GMT`},loans(){return this.receiptValues.length?this.receipt.items.values.filter(l=>l.basketItemType==="loan_reservation"):[]},kivaCards(){return this.receiptValues.length?this.receipt.items.values.filter(l=>l.basketItemType==="kiva_card"):[]},printableKivaCards(){return this.kivaCards.length?this.kivaCards.filter(l=>l.kivaCardObject.deliveryType==="print"):[]},donations(){return this.receipt.items.values.filter(l=>l.basketItemType==="donation")},receiptValues(){var l,t;return((t=(l=this.receipt)==null?void 0:l.items)==null?void 0:t.values)??[]}},methods:{printReceipt(){typeof window<"u"&&(this.enableKivaCardTracking&&this.$kvTrackEvent("post-checkout","click","print-receipt-order-confirmation drawer"),window.print())},printDonationInformation(){this.enableKivaCardTracking&&this.$kvTrackEvent("post-checkout","click","print-donation-information drawer")},printKivaCard(){this.enableKivaCardTracking&&this.$kvTrackEvent("post-checkout","click","kiva-card-view-pdf-order-confirmation drawer")}}},F={class:"checkout-receipt"},N={class:"checkout-receipt__wrapper tw-bg-primary tw-p-4 tw-rounded-xs tw-border tw-border-tertiary"},R={"data-testid":"lender-info",class:"section section--lender-info"},A={class:"data-hj-suppress"},U={class:"data-hj-suppress"},V={key:0,"data-testid":"print-kcard-msg",class:"section tw-text-center print:!tw-hidden"},M={class:"checkout-receipt__item-list"},q={"data-testid":"loan",class:"loan"},B={class:"loan__name data-hj-suppress","data-testid":"loan-name"},P={class:"tw-text-small"},E={class:"tw-text-secondary","data-testid":"loan-country"},L={key:0,"data-testid":"loan-use"},z={class:"loan__amount tw-text-h3","data-testid":"loan-amount"},G={"data-testid":"kcard",class:"loan kcard"},S={class:"loan__details data-hj-suppress","data-testid":"kcard-details"},Y={key:0,"data-testid":"kcard-details",class:"loan__details data-hj-suppress"},H={class:"loan__details data-hj-suppress","data-testid":"kcard-details"},J={class:"loan__amount tw-text-h3","data-testid":"kcard-amount"},W={key:0,"data-testid":"kcard-portfolio",class:"section tw-text-center print:!tw-hidden"},Q={class:"checkout-receipt__item-list"},X={class:"section"},Z={class:"loan","data-testid":"donation"},$={class:"loan__amount tw-text-h3","data-testid":"donation-amount"},tt={"data-testid":"receipt-total",class:"section total"},et={class:"total__amount tw-text-h3","data-testid":"total-amount"},at={class:"section payments"},it={class:"payments__list"},st={key:0,"data-testid":"payment-type-kcard",class:"total"},nt={class:"total__amount tw-text-h3","data-testid":"kcard-payment-amount"},ot={key:1,"data-testid":"payment-type-free-trial",class:"total"},rt={key:2,"data-testid":"payment-type-free-credit",class:"total"},dt={class:"total__amount tw-text-h3","data-testid":"free-credit-payment-amount"},lt={key:3,"data-testid":"payment-type-kiva-credit-added",class:"total"},ct={class:"total__amount tw-text-h3","data-testid":"kiva-credit-added-payment-amount"},pt={key:4,"data-testid":"payment-kiva-credit-used",class:"total"},ut={class:"total__amount tw-text-h3","data-testid":"kiva-credit-use-payment-amount"},mt={key:5,"data-testid":"payment-type-amount-charged",class:"total"},_t={class:"total__amount tw-text-h3","data-testid":"amount-charged-payment-amount"},kt={class:"section section--print print:!tw-hidden"};function vt(l,t,o,yt,ft,c){const k=_("router-link"),y=_("kv-icon"),C=_("kv-tooltip"),b=_("kv-button"),w=x("kv-track-event");return s(),n("div",F,[t[25]||(t[25]=e("h2",{class:"checkout-receipt__headline"}," Order Confirmation ",-1)),e("div",N,[e("section",R,[e("div",null,i(c.formattedTransactionTime),1),e("div",A,i(o.lender.firstName)+" "+i(o.lender.lastName),1),e("div",U,i(o.lender.email),1)]),e("section",null,[c.printableKivaCards.length>0?(s(),n("div",V,[e("h2",null,"Print your Kiva "+i(c.printableKivaCards.length>1?"Cards":"Card"),1),e("p",null," The print-it-yourself Kiva "+i(c.printableKivaCards.length>1?"Cards":"Card")+" you ordered can be printed right now by clicking on the print "+i(c.printableKivaCards.length>1?"buttons":"button")+" in the receipt below. Or, you can print a copy anytime directly from your email receipt. ",1)])):d("",!0),e("ul",M,[(s(!0),n(p,null,f(c.loans,a=>(s(),n("li",{"data-testid":"receipt-item-loan",class:"section",key:a.id},[e("div",q,[e("h3",B,[o.disableRedirects?(s(),n(p,{key:0},[r(i(a.loan.name),1)],64)):(s(),v(k,{key:1,to:`/lend/${a.id}`},{default:u(()=>[r(i(a.loan.name),1)],void 0),_:2},1032,["to"]))]),e("div",P,[e("p",E,[a.loan.geocode&&a.loan.geocode.city?(s(),n(p,{key:0},[r(i(a.loan.geocode.city)+", ",1)],64)):d("",!0),a.loan.geocode&&a.loan.geocode.country?(s(),n(p,{key:1},[r(i(a.loan.geocode.country.name),1)],64)):d("",!0)]),a.loan.use?(s(),n("p",L," A loan helps "+i(a.loan.use),1)):d("",!0)]),e("div",z," $"+i(a.price),1)])]))),128)),(s(!0),n(p,null,f(c.kivaCards,a=>(s(),n("li",{"data-testid":"receipt-item-kcard",class:"section",key:a.id},[e("div",G,[a.kivaCardObject.deliveryType==="print"?(s(),n(p,{key:0},[e("div",null,[t[2]||(t[2]=e("h3",{class:"loan__name loan__name--inline","data-testid":"kcard-type-print"}," Print-it-yourself Kiva Card ",-1)),m(y,{"data-testid":"kcard-tool-tip-control",name:"question",id:`print-card-${a.id}`,class:"loan__question-icon tw-fill-current tw-text-tertiary"},null,8,["id"]),m(C,{"data-testid":"kcard-tool-tip-text",controller:`print-card-${a.id}`,theme:"ecoGreenLight"},{default:u(()=>t[1]||(t[1]=[r(" You can print this card now. We'll also send it to you in an email so you can print it later. ")]),void 0),_:2,__:[1]},1032,["controller"])]),m(b,{"data-testid":"kcard-print-button",class:"tw-mb-2 print:!tw-hidden",target:"_blank",onClick:c.printKivaCard,href:`/gifts/kiva-cards/print?giftCode=${a.kivaCardObject.redemptionCode}`},{default:u(()=>t[3]||(t[3]=[r(" Print Kiva Card ")]),void 0),_:2,__:[3]},1032,["onClick","href"])],64)):a.kivaCardObject.deliveryType==="postal"?(s(),n(p,{key:1},[t[7]||(t[7]=e("h3",{class:"loan__name","data-testid":"kcard-type-postal"}," Postal delivery Kiva Card ",-1)),e("div",S,[r(" For: "+i(a.kivaCardObject.mailingInfo.firstName)+" "+i(a.kivaCardObject.mailingInfo.lastName),1),t[5]||(t[5]=e("br",null,null,-1)),r(" "+i(a.kivaCardObject.mailingInfo.address),1),t[6]||(t[6]=e("br",null,null,-1)),a.kivaCardObject.mailingInfo.address2?(s(),n(p,{key:0},[r(i(a.kivaCardObject.mailingInfo.address2),1),t[4]||(t[4]=e("br",null,null,-1))],64)):d("",!0),r(" "+i(a.kivaCardObject.mailingInfo.city)+", "+i(a.kivaCardObject.mailingInfo.state)+" "+i(a.kivaCardObject.mailingInfo.zip),1)])],64)):a.kivaCardObject.deliveryType==="lender"?(s(),n(p,{key:2},[t[8]||(t[8]=e("h3",{class:"loan__name","data-testid":"kcard-type-lender"}," Kiva Card ",-1)),a.kivaCardObject.recipient.name?(s(),n("div",Y," For: "+i(a.kivaCardObject.recipient.name),1)):d("",!0)],64)):a.kivaCardObject.deliveryType==="email"?(s(),n(p,{key:3},[t[10]||(t[10]=e("h3",{class:"loan__name","data-testid":"kcard-type-email"}," Email delivery Kiva Card ",-1)),e("div",H,[t[9]||(t[9]=r(" For: ")),a.kivaCardObject.recipient.name?(s(),n(p,{key:0},[r(i(a.kivaCardObject.recipient.name)+" â€“ ",1)],64)):d("",!0),r(" "+i(a.kivaCardObject.recipient.email),1)])],64)):d("",!0),e("div",J," $"+i(a.price),1)])]))),128)),c.kivaCards.length>0?(s(),n("li",W,[t[12]||(t[12]=r(" For more details about all your Kiva Card purchases, please visit your ")),g((s(),v(k,{to:"/portfolio/kiva-cards"},{default:u(()=>t[11]||(t[11]=[r(" Kiva portfolio ")]),void 0),_:1,__:[11]})),[[w,["Thanks","click","kiva-card-portfolio"]]]),t[13]||(t[13]=r(". "))])):d("",!0)])]),e("section",null,[e("ul",Q,[e("li",X,[e("div",Z,[t[15]||(t[15]=e("h3",{class:"loan__name"}," Donation to Kiva ",-1)),o.receipt.totals.donationTotal>0?(s(),v(k,{key:0,"data-testid":"print-donation-information",class:"smallest print:tw-hidden",to:"/portfolio/donations",onClick:c.printDonationInformation},{default:u(()=>t[14]||(t[14]=[r(" Print Donation Information ")]),void 0),_:1,__:[14]},8,["onClick"])):d("",!0),e("div",$," $"+i(o.receipt.totals.donationTotal),1)])]),e("li",tt,[t[16]||(t[16]=e("h3",{class:"total__header tw-text-h3"}," Total: ",-1)),e("span",et,"$"+i(o.receipt.totals.itemTotal),1)])])]),e("section",at,[t[23]||(t[23]=e("h3",{class:"tw-text-secondary"}," Payments ",-1)),e("ul",it,[o.receipt.totals.redemptionCodeAppliedTotal>0?(s(),n("li",st,[t[17]||(t[17]=e("span",{class:"total__header tw-text-h3"},"Kiva Card:",-1)),e("span",nt," $"+i(o.receipt.totals.redemptionCodeAppliedTotal),1)])):d("",!0),o.receipt.totals.freeTrialAppliedTotal>0?(s(),n("li",ot,t[18]||(t[18]=[e("span",{class:"total__header tw-text-h3"},"Free Trial:",-1),e("span",{class:"total__amount tw-text-h3","data-testid":"free-trial-payment-amount"},"Free!",-1)]))):d("",!0),o.receipt.totals.bonusAppliedTotal>0?(s(),n("li",rt,[t[19]||(t[19]=e("span",{class:"total__header tw-text-h3"},"Free credit:",-1)),e("span",dt,i(o.receipt.totals.bonusAppliedTotal),1)])):d("",!0),o.receipt.totals.depositTotals.kivaCreditAdded>0?(s(),n("li",lt,[t[20]||(t[20]=e("span",{class:"total__header tw-text-h3"},"Kiva credit added:",-1)),e("span",ct," $"+i(o.receipt.totals.depositTotals.kivaCreditAdded),1)])):d("",!0),o.receipt.totals.depositTotals.kivaCreditUsed>0?(s(),n("li",pt,[t[21]||(t[21]=e("span",{class:"total__header tw-text-h3"},"Kiva credit:",-1)),e("span",ut," $"+i(o.receipt.totals.depositTotals.kivaCreditUsed),1)])):d("",!0),parseFloat(o.receipt.totals.depositTotals.depositTotal)>0?(s(),n("li",mt,[t[22]||(t[22]=e("span",{class:"total__header tw-text-h3"},"Amount charged:",-1)),e("span",_t," $"+i(o.receipt.totals.depositTotals.depositTotal),1)])):d("",!0)])]),e("section",kt,[e("button",{"data-testid":"print-receipt",class:"print tw-text-link tw-flex tw-items-center tw-gap-1",onClick:t[0]||(t[0]=(...a)=>c.printReceipt&&c.printReceipt(...a))},[m(y,{name:"print",class:"print__icon tw-fill-current"}),t[24]||(t[24]=e("span",null,"Print this receipt",-1))])])])])}const jt=O(h,[["render",vt],["__scopeId","data-v-1131ac7b"]]);h.__docgenInfo={displayName:"CheckoutReceipt",exportName:"default",description:"",tags:{},props:[{name:"lender",type:{name:"object"},required:!0},{name:"receipt",type:{name:"object"},required:!0},{name:"disableRedirects",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"enableKivaCardTracking",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/Checkout/CheckoutReceipt.vue"]};export{jt as C};
