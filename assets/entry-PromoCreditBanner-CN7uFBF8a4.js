import{n as y}from"./entry-numeral-xVHG5DEP0A.js";import{g as k}from"./entry-index-CWclSTHHJk.js";import{b as B,i as x,u as F,a as P}from"./entry-promoCredit-w2GeqDaA1T.js";import{c as l,N as I,o as i,m as w,D as p,M as h,L as u,q as m,z as f,C as g,J as N,A as _,r as L,K as D}from"./entry-vue.esm-bundler-C0PPCo9W96.js";import{c as A}from"./entry-confetti.module-BCnSlh9tqh.js";import{_ as M}from"./entry-_plugin-vue_export-helper-DlAUqK2UKH.js";function C(){return(t,e)=>t<e?-1:1}function S(t,e){if(!Array.isArray(t))throw new TypeError("list must be an array");return(n,r)=>{const o=e?n[e]:n,a=e?r[e]:r;return t.indexOf(o)<t.indexOf(a)?-1:1}}function le(t,e){const n=t.toLowerCase();return(r,o)=>{const a=r[e].toLowerCase(),s=(e?o[e]:o).toLowerCase(),d=a.indexOf(n),c=s.indexOf(n);return d===0?c===0?C()(a,s):-1:c===0?1:C()(a,s)}}const V={width:"34",height:"36",viewBox:"0 0 34 36",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function E(t,e){return i(),l("svg",V,e[0]||(e[0]=[I('<path d="M16.8445 21.239L28.7624 17.9217V31.7843L16.8445 35.362V21.239Z" fill="#DC9E26"></path><path d="M28.5146 18.252V31.5964L17.0924 35.0264V21.4317L28.5146 18.252ZM29.0102 17.5935L28.3832 17.7688L16.961 20.9484L16.5967 21.0486V35.6974L17.2336 35.5071L28.6559 32.0771L29.0102 31.9694V17.5935Z" fill="#EDF4F1"></path><path d="M16.7058 21.2162L28.8615 17.8338L32.906 21.6268L20.9386 26.7217L16.7058 21.2162Z" fill="#F4B539"></path><path d="M28.7626 18.2525L32.2322 21.5072L21.0578 26.2641L17.3404 21.4321L28.7626 18.2525ZM28.9634 17.4163L28.5643 17.5264L17.1421 20.706L16.0715 21.004L16.753 21.8903L20.4704 26.7223L20.8199 27.1779L21.3452 26.9551L32.5196 22.1982L33.5803 21.7475L32.7377 20.9564L29.2682 17.7017L28.9634 17.4163Z" fill="#EDF4F1"></path><path d="M8.5 32.8135L4.72363 31.7293V17.9217L16.639 21.239V35.3019L8.5 32.8135Z" fill="#F8CD69"></path><path d="M4.9715 18.252L16.3937 21.4317V35.0264L9 32.8135L4.9715 31.5964V18.252ZM4.47583 17.5935V31.8643L4.69639 32.012L9 33.3135L16.6307 35.5797H16.8918V21.0486L16.5275 20.9484L5.10529 17.7688L4.47831 17.5935H4.47583Z" fill="#EDF4F1"></path><path d="M0.614502 22.5111L4.31452 17.8242L16.5099 21.2167L12.2845 26.7071L0.614502 22.5111Z" fill="#F8CD69"></path><path d="M4.4534 18.252L15.8756 21.4316L12.1583 26.2636L1.23169 22.3329L4.4534 18.252ZM4.17583 17.3958L3.87101 17.7838L0.6493 21.8648L0 22.6884L0.981382 23.0415L11.9079 26.9722L12.4135 27.1549L12.7431 26.7268L16.4605 21.8948L17.142 21.0085L16.0714 20.7106L4.64918 17.531L4.17583 17.3983V17.3958Z" fill="#EDF4F1"></path><path d="M3.95776 17.6259L16.7901 13.9856L29.6199 17.6259L16.7901 21.2662L3.95776 17.6259Z" fill="#F4B539"></path><path d="M16.7898 14.2456L28.7027 17.6255L16.7898 21.0055L4.87687 17.6255L16.7898 14.2456ZM16.7898 13.7249L16.6559 13.7624L4.74304 17.1424L3.04297 17.6255L4.74304 18.1087L16.6559 21.4887L16.7898 21.5262L16.9236 21.4887L28.8365 18.1087L30.5366 17.6255L28.8365 17.1424L16.9236 13.7624L16.7898 13.7249Z" fill="#EDF4F1"></path><path d="M17.2711 9.54645C17.2711 9.54645 20.026 4.92216 23.5352 7.65042C27.0445 10.3756 16.8698 19.8223 16.8698 19.8223C16.8698 19.8223 7.7905 11.0889 10.9859 7.69612C14.1813 4.30336 17.2711 9.54343 17.2711 9.54343V9.54645Z" fill="#276A43"></path><path d="M25.9065 6.90332L28.3717 4.41284" stroke="#ffffff" stroke-width="1.01165" stroke-linejoin="round"></path><path d="M22.2136 4.33654L23.3029 0.989502" stroke="#ffffff" stroke-width="1.01165" stroke-linejoin="round"></path><path d="M8.15253 7.82881L5.17041 5.98462" stroke="#ffffff" stroke-width="1.01165" stroke-linejoin="round"></path><path d="M11.4947 4.38376L9.65161 1.38428" stroke="#ffffff" stroke-width="1.01165" stroke-linejoin="round"></path><path d="M16.9463 3.5226L16.9333 0" stroke="#ffffff" stroke-width="1.01165" stroke-linejoin="round"></path>',16)]))}const Z={render:E},O=()=>{A({origin:{y:.2},particleCount:150,spread:200,colors:["#6AC395","#223829","#95D4B3"],disableForReducedMotion:!0})},v="showPromoCreditPill",U="kiva_lending_credit",R=t=>{t.set(v,"true",{path:"/"})},q=t=>t.get(v),T=t=>{const e=t.get(U);if(!e)return 0;try{const n=decodeURIComponent(e),r=JSON.parse(n);if(r&&typeof r=="object"&&"amount"in r){const a=parseFloat(r.amount);return!Number.isNaN(a)&&a>0?a:0}const o=parseFloat(r);return!Number.isNaN(o)&&o>0?o:0}catch{const r=parseFloat(e);return!Number.isNaN(r)&&r>0?r:0}},j=k`
	query userPromoCredits($basketId: String) {
		my {
			id
			...UserPromoBalance
		}
		shop (basketId: $basketId) {
			id
			lendingRewardOffered
			basket {
				id
				credits {
					values {
						id
						available
						promoFund {
							id
							displayName
						}
					}
				}
			}
			...BasketPromoAvailable
		}
	}
	${F}
	${P}
`,K=k`
	query promoCampaign($basketId: String, $promoFundId: String) {
		shop (basketId: $basketId) {
			id
			promoCampaign (promoFundId: $promoFundId) {
				promoFund {
					id
					displayName
				}
				managedAccount {
					campaignInfo {
						campaignPromoFundId
						upc
					}
					id
					managementType
					pageId
					strategicPartner {
						id
						partnerName
						partnerContentfulPage
					}
				}
			}
		}
	}
`,b={name:"PromoCreditBanner",inject:{apollo:{default:null},cookieStore:{default:null}},data(){return{bonusBalance:0,lendingRewardOffered:!1,promoCampaignData:null,priorityBasketCredit:null,isUserDataLoading:!1,isScrolled:!1,kivaLendingCreditFromCookie:0,myId:null}},components:{HeartBox:Z},apollo:[{query:j,preFetch:!0,shouldPreFetch(t,{renderConfig:e}){return!e.useCDNCaching},result({data:t}){var e;this.isUserDataLoading=!1,this.myId=((e=t==null?void 0:t.my)==null?void 0:e.id)??null,this.setPromoState(t),this.setPriorityBasketCredit(t)}},{query:K,preFetch:!1,variables(){return{promoFundId:this.promoFundId?String(this.promoFundId):null}},result({data:t}){var e;this.promoCampaignData=((e=t==null?void 0:t.shop)==null?void 0:e.promoCampaign)??null}}],created(){const{useCDNCaching:t}=this.$renderConfig;this.isUserDataLoading=t,this.kivaLendingCreditFromCookie=T(this.cookieStore)},computed:{isLoggedIn(){return this.myId!==null&&this.myId!==void 0},effectiveBonusBalance(){return this.isLoggedIn?this.bonusBalance:this.kivaLendingCreditFromCookie},bonusBalanceFormatted(){return y(this.effectiveBonusBalance).format("$0[.]00")},impactDashboardLink(){var e;const t={...this.$route.query};return delete t.fromContext,`${(e=this.$route.query)==null?void 0:e.fromContext}?${new URLSearchParams(t).toString()}`},isUpcCampaign(){var t,e,n;return((n=(e=(t=this.promoCampaignData)==null?void 0:t.managedAccount)==null?void 0:e.campaignInfo)==null?void 0:n.upc)??!1},isFromImpactDashboard(){return x(this.$route)},creditAvailable(){var t;return((t=this.priorityBasketCredit)==null?void 0:t.available)??null},partnerName(){var t,e,n;return((n=(e=(t=this.promoCampaignData)==null?void 0:t.managedAccount)==null?void 0:e.strategicPartner)==null?void 0:n.partnerName)??null},promoFundId(){var e,n,r,o;const t=((n=(e=this.promoCampaignData)==null?void 0:e.promoFund)==null?void 0:n.id)??null;return((o=(r=this.priorityBasketCredit)==null?void 0:r.promoFund)==null?void 0:o.id)??t},promoFundDisplayName(){var e,n,r,o;const t=((n=(e=this.promoCampaignData)==null?void 0:e.promoFund)==null?void 0:n.displayName)??null;return((o=(r=this.priorityBasketCredit)==null?void 0:r.promoFund)==null?void 0:o.displayName)??t},managedAccountPageId(){var t,e;return((e=(t=this.promoCampaignData)==null?void 0:t.managedAccount)==null?void 0:e.pageId)??null},upcCampaignLink(){var n,r,o,a,s,d;const t=((o=(r=(n=this.promoCampaignData)==null?void 0:n.managedAccount)==null?void 0:r.strategicPartner)==null?void 0:o.partnerContentfulPage)??null,e=((d=(s=(a=this.promoCampaignData)==null?void 0:a.managedAccount)==null?void 0:s.campaignInfo)==null?void 0:d.upc)??null;return!t||!e?null:`/impact-dashboard/${t}/upc/${e}`},showUpcCampaignBanner(){return this.isUpcCampaign&&!!this.partnerName&&!!this.upcCampaignLink},setPromoCreditPillCookie(){return!this.showUpcCampaignBanner&&!this.lendingRewardOffered&&this.effectiveBonusBalance>0&&!this.managedAccountPageId}},methods:{setPromoState(t){var e;this.bonusBalance=B(t),this.lendingRewardOffered=(e=t.shop)==null?void 0:e.lendingRewardOffered},setPriorityBasketCredit(t){var o,a,s;const e=((s=(a=(o=t==null?void 0:t.shop)==null?void 0:o.basket)==null?void 0:a.credits)==null?void 0:s.values)??[],n=["universal_code","redemption_code","bonus_credit","kiva_credit"],r=e.map(d=>d).filter(d=>(d==null?void 0:d.available)>0);r.sort(S(n,"creditType")),this.priorityBasketCredit=r[0]??null},onScroll(){this.isScrolled=window.scrollY>0}},mounted(){!q(this.cookieStore)&&this.setPromoCreditPillCookie&&(R(this.cookieStore),O()),window.addEventListener("scroll",this.onScroll)},beforeUnmount(){window.removeEventListener("scroll",this.onScroll)}},$={key:0,class:"tw-bg-brand tw-text-white tw-text-center tw-py-1 md:tw-py-1.5 tw-px-2","data-testid":"banner-placeholder",style:{display:"var(--ui-data-promo-credit-banner-display, block)"}},H={key:1,class:"tw-bg-brand tw-text-white tw-text-center tw-py-1 md:tw-py-1.5 tw-px-2","data-testid":"upc-campaign-banner"},Y=["href"],W={key:2,class:"tw-bg-brand tw-text-white tw-text-center tw-py-1 md:tw-py-1.5 tw-px-2","data-testid":"lending-reward-banner-impact-dashboard"},z=["href"],J={key:3,class:"tw-bg-brand tw-text-white tw-text-center tw-py-1 md:tw-py-1.5 tw-px-2","data-testid":"lending-reward-banner"},G={class:"tw-underline"},Q={key:1,href:"/lend/filter",class:"tw-text-white tw-no-underline hover:tw-no-underline hover:tw-text-white active:tw-text-white visited:tw-text-white focus:tw-text-white","data-testid":"free-credit-banner"},X={key:0},ee={key:1,class:"tw-underline tw-text-h5"},te={class:"tw-underline"};function ae(t,e,n,r,o,a){const s=L("router-link"),d=L("HeartBox"),c=D("kv-track-event");return o.isUserDataLoading?(i(),l("div",$," Â  ")):a.showUpcCampaignBanner?(i(),l("div",H,[p((i(),l("a",{href:a.upcCampaignLink,class:"tw-text-white hover:tw-text-white active:tw-text-white visited:tw-text-white focus:tw-text-white","data-testid":"impact-dashboard-promo-banner"},[h(" You have Kiva credit from "+u(a.partnerName)+" to lend ",1)],8,Y)),[[c,["TopNav","click-Promo","UPC Campaign Banner"]]])])):a.isFromImpactDashboard?(i(),l("div",W,[p((i(),l("a",{href:a.impactDashboardLink,class:"tw-text-white tw-no-underline hover:tw-no-underline hover:tw-text-white active:tw-text-white visited:tw-text-white focus:tw-text-white","data-testid":"impact-dashboard-promo-banner"},[e[0]||(e[0]=h(" Please go back to your first Kiva tab or ")),e[1]||(e[1]=m("span",{class:"tw-underline"}," click here",-1)),h(" to use your "+u(a.bonusBalanceFormatted)+" promo credit. ",1)],8,z)),[[c,["TopNav","click-Promo","Lending Reward Banner"]]])])):o.lendingRewardOffered?(i(),l("div",J,[a.promoFundDisplayName&&a.managedAccountPageId?p((i(),f(s,{key:0,to:`/cc/${a.managedAccountPageId}`,class:"tw-text-white tw-no-underline hover:tw-no-underline hover:tw-text-white active:tw-text-white visited:tw-text-white focus:tw-text-white","data-testid":"cc-promo-banner"},{default:g(()=>[m("span",G," Complete a loan to receive your lending reward from "+u(a.promoFundDisplayName)+"! ",1)],void 0),_:1},8,["to"])),[[c,["TopNav","click-Promo","Lending Reward Banner"]]]):(i(),l(N,{key:1},[e[2]||(e[2]=h(" Make a Kiva loan ")),e[3]||(e[3]=m("br",{class:"sm:tw-inline md:tw-hidden"},null,-1)),e[4]||(e[4]=h("and receive a $25 free credit to lend again. "))],64))])):a.effectiveBonusBalance>0?(i(),l("div",{key:4,class:_(["bonus-banner-holder tw-text-center tw-py-1 md:tw-py-1.5 tw-px-2 tw-flex tw-gap-2 tw-justify-center tw-items-center",{"tw-items-center":o.isScrolled,"tw-bg-brand-500":!a.managedAccountPageId,"tw-bg-brand":a.managedAccountPageId}]),"data-testid":"bonus-banner"},[a.managedAccountPageId?w("",!0):(i(),f(d,{key:0,class:"tw-w-4.5 tw-h-4.5"})),a.managedAccountPageId?w("",!0):p((i(),l("a",Q,[o.isScrolled?(i(),l("span",ee," Use your "+u(t.$filters.numeral(a.effectiveBonusBalance,"$0"))+" gift today while funds last! ",1)):(i(),l("div",X,[m("h3",null,"You've got "+u(t.$filters.numeral(a.effectiveBonusBalance,"$0"))+" to lend!",1),e[5]||(e[5]=m("h4",null,"While funds last",-1))]))])),[[c,["TopNav","click-Promo","Bonus Banner"]]]),a.managedAccountPageId?p((i(),f(s,{key:2,to:`/cc/${a.managedAccountPageId}`,class:"tw-text-white tw-no-underline hover:tw-no-underline hover:tw-text-white active:tw-text-white visited:tw-text-white focus:tw-text-white","data-testid":"cc-promo-banner"},{default:g(()=>[m("span",te," You have "+u(t.$filters.numeral(a.creditAvailable,"$0.00"))+" from "+u(a.promoFundDisplayName)+" to lend! ",1)],void 0),_:1},8,["to"])),[[c,["TopNav","click-Promo","MVP Bonus Banner"]]]):w("",!0)],2)):w("",!0)}const ce=M(b,[["render",ae]]);b.__docgenInfo={displayName:"PromoCreditBanner",exportName:"default",description:"",tags:{},sourceFiles:["/home/runner/work/ui/ui/src/components/WwwFrame/PromotionalBanner/Banners/PromoCreditBanner.vue"]};export{ce as P,S as i,le as s};
