function fr(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?fr=function(e){return typeof e}:fr=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fr(t)}function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function di(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _e(t,e,r){return e&&di(t.prototype,e),r&&di(t,r),t}function d(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yi(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Hr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yi(Object(r),!0).forEach(function(n){d(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yi(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Li(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&en(t,e)}function _t(t){return _t=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},_t(t)}function en(t,e){return en=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},en(t,e)}function No(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function V(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Oo(t,e){return e&&(typeof e=="object"||typeof e=="function")?e:V(t)}function Gi(t){var e=No();return function(){var n=_t(t),i;if(e){var a=_t(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Oo(this,i)}}function Bo(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=_t(t),t!==null););return t}function lr(t,e,r){return typeof Reflect<"u"&&Reflect.get?lr=Reflect.get:lr=function(i,a,o){var u=Bo(i,a);if(u){var c=Object.getOwnPropertyDescriptor(u,a);return c.get?c.get.call(o):c.value}},lr(t,e,r||t)}function _i(t,e){return Lo(t)||zo(t,e)||zi(t,e)||ko()}function de(t){return Uo(t)||Go(t)||zi(t)||Vo()}function Uo(t){if(Array.isArray(t))return tn(t)}function Lo(t){if(Array.isArray(t))return t}function Go(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function zo(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var r=[],n=!0,i=!1,a=void 0;try{for(var o=t[Symbol.iterator](),u;!(n=(u=o.next()).done)&&(r.push(u.value),!(e&&r.length===e));n=!0);}catch(c){i=!0,a=c}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return r}}function zi(t,e){if(t){if(typeof t=="string")return tn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tn(t,e)}}function tn(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Vo(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ko(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}/* @license twgl.js 4.15.2 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */var xt=Float32Array;function De(t,e,r){var n=new xt(3);return n}function jo(t,e,r){return r=r||new xt(3),r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r}function Xo(t,e,r){return r=r||new xt(3),r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r}function gi(t,e,r){r=r||new xt(3);var n=t[2]*e[0]-t[0]*e[2],i=t[0]*e[1]-t[1]*e[0];return r[0]=t[1]*e[2]-t[2]*e[1],r[1]=n,r[2]=i,r}function Yr(t,e){e=e||new xt(3);var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=Math.sqrt(r);return n>1e-5?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=0,e[1]=0,e[2]=0),e}function Ho(t,e,r){return r=r||new xt(3),r[0]=t[0]*e[0],r[1]=t[1]*e[1],r[2]=t[2]*e[2],r}var Y=Float32Array;function Yo(t){var e=Y;return Y=t,e}function Wo(t,e){return e=e||new Y(16),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=-t[7],e[8]=-t[8],e[9]=-t[9],e[10]=-t[10],e[11]=-t[11],e[12]=-t[12],e[13]=-t[13],e[14]=-t[14],e[15]=-t[15],e}function Vi(t,e){return e=e||new Y(16),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function gn(t){return t=t||new Y(16),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function $o(t,e){if(e=e||new Y(16),e===t){var r;return r=t[1],t[1]=t[4],t[4]=r,r=t[2],t[2]=t[8],t[8]=r,r=t[3],t[3]=t[12],t[12]=r,r=t[6],t[6]=t[9],t[9]=r,r=t[7],t[7]=t[13],t[13]=r,r=t[11],t[11]=t[14],t[14]=r,e}var n=t[0*4+0],i=t[0*4+1],a=t[0*4+2],o=t[0*4+3],u=t[1*4+0],c=t[1*4+1],f=t[1*4+2],h=t[1*4+3],l=t[2*4+0],m=t[2*4+1],g=t[2*4+2],y=t[2*4+3],_=t[3*4+0],T=t[3*4+1],x=t[3*4+2],M=t[3*4+3];return e[0]=n,e[1]=u,e[2]=l,e[3]=_,e[4]=i,e[5]=c,e[6]=m,e[7]=T,e[8]=a,e[9]=f,e[10]=g,e[11]=x,e[12]=o,e[13]=h,e[14]=y,e[15]=M,e}function bn(t,e){e=e||new Y(16);var r=t[0*4+0],n=t[0*4+1],i=t[0*4+2],a=t[0*4+3],o=t[1*4+0],u=t[1*4+1],c=t[1*4+2],f=t[1*4+3],h=t[2*4+0],l=t[2*4+1],m=t[2*4+2],g=t[2*4+3],y=t[3*4+0],_=t[3*4+1],T=t[3*4+2],x=t[3*4+3],M=m*x,E=T*g,w=c*x,A=T*f,I=c*g,F=m*f,R=i*x,S=T*a,U=i*g,L=m*a,D=i*f,N=c*a,B=h*_,j=y*l,W=o*_,q=y*u,Z=o*l,Te=h*u,Oe=r*_,Be=y*n,Ie=r*l,Ue=h*n,Ze=r*u,lt=o*n,Ke=M*u+A*l+I*_-(E*u+w*l+F*_),Xt=E*n+R*l+L*_-(M*n+S*l+U*_),ht=w*n+S*u+D*_-(A*n+R*u+N*_),Ht=F*n+U*u+N*l-(I*n+L*u+D*l),ee=1/(r*Ke+o*Xt+h*ht+y*Ht);return e[0]=ee*Ke,e[1]=ee*Xt,e[2]=ee*ht,e[3]=ee*Ht,e[4]=ee*(E*o+w*h+F*y-(M*o+A*h+I*y)),e[5]=ee*(M*r+S*h+U*y-(E*r+R*h+L*y)),e[6]=ee*(A*r+R*o+N*y-(w*r+S*o+D*y)),e[7]=ee*(I*r+L*o+D*h-(F*r+U*o+N*h)),e[8]=ee*(B*f+q*g+Z*x-(j*f+W*g+Te*x)),e[9]=ee*(j*a+Oe*g+Ue*x-(B*a+Be*g+Ie*x)),e[10]=ee*(W*a+Be*f+Ze*x-(q*a+Oe*f+lt*x)),e[11]=ee*(Te*a+Ie*f+lt*g-(Z*a+Ue*f+Ze*g)),e[12]=ee*(W*m+Te*T+j*c-(Z*T+B*c+q*m)),e[13]=ee*(Ie*T+B*i+Be*m-(Oe*m+Ue*T+j*i)),e[14]=ee*(Oe*c+lt*T+q*i-(Ze*T+W*i+Be*c)),e[15]=ee*(Ze*m+Z*i+Ue*c-(Ie*c+lt*m+Te*i)),e}function qo(t,e,r){r=r||new Y(16);var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],c=t[5],f=t[6],h=t[7],l=t[8],m=t[9],g=t[10],y=t[11],_=t[12],T=t[13],x=t[14],M=t[15],E=e[0],w=e[1],A=e[2],I=e[3],F=e[4],R=e[5],S=e[6],U=e[7],L=e[8],D=e[9],N=e[10],B=e[11],j=e[12],W=e[13],q=e[14],Z=e[15];return r[0]=n*E+u*w+l*A+_*I,r[1]=i*E+c*w+m*A+T*I,r[2]=a*E+f*w+g*A+x*I,r[3]=o*E+h*w+y*A+M*I,r[4]=n*F+u*R+l*S+_*U,r[5]=i*F+c*R+m*S+T*U,r[6]=a*F+f*R+g*S+x*U,r[7]=o*F+h*R+y*S+M*U,r[8]=n*L+u*D+l*N+_*B,r[9]=i*L+c*D+m*N+T*B,r[10]=a*L+f*D+g*N+x*B,r[11]=o*L+h*D+y*N+M*B,r[12]=n*j+u*W+l*q+_*Z,r[13]=i*j+c*W+m*q+T*Z,r[14]=a*j+f*W+g*q+x*Z,r[15]=o*j+h*W+y*q+M*Z,r}function Zo(t,e,r){return r=r||gn(),t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11]),r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function Ko(t,e){return e=e||De(),e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Qo(t,e,r){r=r||De();var n=e*4;return r[0]=t[n+0],r[1]=t[n+1],r[2]=t[n+2],r}function Jo(t,e,r,n){n!==t&&(n=Vi(t,n));var i=r*4;return n[i+0]=e[0],n[i+1]=e[1],n[i+2]=e[2],n}function eu(t,e,r,n,i){i=i||new Y(16);var a=Math.tan(Math.PI*.5-.5*t),o=1/(r-n);return i[0]=a/e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=(r+n)*o,i[11]=-1,i[12]=0,i[13]=0,i[14]=r*n*o*2,i[15]=0,i}function tu(t,e,r,n,i,a,o){return o=o||new Y(16),o[0]=2/(e-t),o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/(n-r),o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2/(i-a),o[11]=0,o[12]=(e+t)/(t-e),o[13]=(n+r)/(r-n),o[14]=(a+i)/(i-a),o[15]=1,o}function ru(t,e,r,n,i,a,o){o=o||new Y(16);var u=e-t,c=n-r,f=i-a;return o[0]=2*i/u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*i/c,o[6]=0,o[7]=0,o[8]=(t+e)/u,o[9]=(n+r)/c,o[10]=a/f,o[11]=-1,o[12]=0,o[13]=0,o[14]=i*a/f,o[15]=0,o}var ze,rt,Pe;function nu(t,e,r,n){return n=n||new Y(16),ze=ze||De(),rt=rt||De(),Pe=Pe||De(),Yr(Xo(t,e,Pe),Pe),Yr(gi(r,Pe,ze),ze),Yr(gi(Pe,ze,rt),rt),n[0]=ze[0],n[1]=ze[1],n[2]=ze[2],n[3]=0,n[4]=rt[0],n[5]=rt[1],n[6]=rt[2],n[7]=0,n[8]=Pe[0],n[9]=Pe[1],n[10]=Pe[2],n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}function iu(t,e){return e=e||new Y(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function au(t,e,r){r=r||new Y(16);var n=e[0],i=e[1],a=e[2],o=t[0],u=t[1],c=t[2],f=t[3],h=t[1*4+0],l=t[1*4+1],m=t[1*4+2],g=t[1*4+3],y=t[2*4+0],_=t[2*4+1],T=t[2*4+2],x=t[2*4+3],M=t[3*4+0],E=t[3*4+1],w=t[3*4+2],A=t[3*4+3];return t!==r&&(r[0]=o,r[1]=u,r[2]=c,r[3]=f,r[4]=h,r[5]=l,r[6]=m,r[7]=g,r[8]=y,r[9]=_,r[10]=T,r[11]=x),r[12]=o*n+h*i+y*a+M,r[13]=u*n+l*i+_*a+E,r[14]=c*n+m*i+T*a+w,r[15]=f*n+g*i+x*a+A,r}function ou(t,e){e=e||new Y(16);var r=Math.cos(t),n=Math.sin(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function uu(t,e,r){r=r||new Y(16);var n=t[4],i=t[5],a=t[6],o=t[7],u=t[8],c=t[9],f=t[10],h=t[11],l=Math.cos(e),m=Math.sin(e);return r[4]=l*n+m*u,r[5]=l*i+m*c,r[6]=l*a+m*f,r[7]=l*o+m*h,r[8]=l*u-m*n,r[9]=l*c-m*i,r[10]=l*f-m*a,r[11]=l*h-m*o,t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r}function su(t,e){e=e||new Y(16);var r=Math.cos(t),n=Math.sin(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function cu(t,e,r){r=r||new Y(16);var n=t[0*4+0],i=t[0*4+1],a=t[0*4+2],o=t[0*4+3],u=t[2*4+0],c=t[2*4+1],f=t[2*4+2],h=t[2*4+3],l=Math.cos(e),m=Math.sin(e);return r[0]=l*n-m*u,r[1]=l*i-m*c,r[2]=l*a-m*f,r[3]=l*o-m*h,r[8]=l*u+m*n,r[9]=l*c+m*i,r[10]=l*f+m*a,r[11]=l*h+m*o,t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r}function fu(t,e){e=e||new Y(16);var r=Math.cos(t),n=Math.sin(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function lu(t,e,r){r=r||new Y(16);var n=t[0*4+0],i=t[0*4+1],a=t[0*4+2],o=t[0*4+3],u=t[1*4+0],c=t[1*4+1],f=t[1*4+2],h=t[1*4+3],l=Math.cos(e),m=Math.sin(e);return r[0]=l*n+m*u,r[1]=l*i+m*c,r[2]=l*a+m*f,r[3]=l*o+m*h,r[4]=l*u-m*n,r[5]=l*c-m*i,r[6]=l*f-m*a,r[7]=l*h-m*o,t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r}function hu(t,e,r){r=r||new Y(16);var n=t[0],i=t[1],a=t[2],o=Math.sqrt(n*n+i*i+a*a);n/=o,i/=o,a/=o;var u=n*n,c=i*i,f=a*a,h=Math.cos(e),l=Math.sin(e),m=1-h;return r[0]=u+(1-u)*h,r[1]=n*i*m+a*l,r[2]=n*a*m-i*l,r[3]=0,r[4]=n*i*m-a*l,r[5]=c+(1-c)*h,r[6]=i*a*m+n*l,r[7]=0,r[8]=n*a*m+i*l,r[9]=i*a*m-n*l,r[10]=f+(1-f)*h,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function vu(t,e,r,n){n=n||new Y(16);var i=e[0],a=e[1],o=e[2],u=Math.sqrt(i*i+a*a+o*o);i/=u,a/=u,o/=u;var c=i*i,f=a*a,h=o*o,l=Math.cos(r),m=Math.sin(r),g=1-l,y=c+(1-c)*l,_=i*a*g+o*m,T=i*o*g-a*m,x=i*a*g-o*m,M=f+(1-f)*l,E=a*o*g+i*m,w=i*o*g+a*m,A=a*o*g-i*m,I=h+(1-h)*l,F=t[0],R=t[1],S=t[2],U=t[3],L=t[4],D=t[5],N=t[6],B=t[7],j=t[8],W=t[9],q=t[10],Z=t[11];return n[0]=y*F+_*L+T*j,n[1]=y*R+_*D+T*W,n[2]=y*S+_*N+T*q,n[3]=y*U+_*B+T*Z,n[4]=x*F+M*L+E*j,n[5]=x*R+M*D+E*W,n[6]=x*S+M*N+E*q,n[7]=x*U+M*B+E*Z,n[8]=w*F+A*L+I*j,n[9]=w*R+A*D+I*W,n[10]=w*S+A*N+I*q,n[11]=w*U+A*B+I*Z,t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n}function mu(t,e){return e=e||new Y(16),e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pu(t,e,r){r=r||new Y(16);var n=e[0],i=e[1],a=e[2];return r[0]=n*t[0*4+0],r[1]=n*t[0*4+1],r[2]=n*t[0*4+2],r[3]=n*t[0*4+3],r[4]=i*t[1*4+0],r[5]=i*t[1*4+1],r[6]=i*t[1*4+2],r[7]=i*t[1*4+3],r[8]=a*t[2*4+0],r[9]=a*t[2*4+1],r[10]=a*t[2*4+2],r[11]=a*t[2*4+3],t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r}function ki(t,e,r){r=r||De();var n=e[0],i=e[1],a=e[2],o=n*t[0*4+3]+i*t[1*4+3]+a*t[2*4+3]+t[3*4+3];return r[0]=(n*t[0*4+0]+i*t[1*4+0]+a*t[2*4+0]+t[3*4+0])/o,r[1]=(n*t[0*4+1]+i*t[1*4+1]+a*t[2*4+1]+t[3*4+1])/o,r[2]=(n*t[0*4+2]+i*t[1*4+2]+a*t[2*4+2]+t[3*4+2])/o,r}function ji(t,e,r){r=r||De();var n=e[0],i=e[1],a=e[2];return r[0]=n*t[0*4+0]+i*t[1*4+0]+a*t[2*4+0],r[1]=n*t[0*4+1]+i*t[1*4+1]+a*t[2*4+1],r[2]=n*t[0*4+2]+i*t[1*4+2]+a*t[2*4+2],r}function du(t,e,r){r=r||De();var n=bn(t),i=e[0],a=e[1],o=e[2];return r[0]=i*n[0*4+0]+a*n[0*4+1]+o*n[0*4+2],r[1]=i*n[1*4+0]+a*n[1*4+1]+o*n[1*4+2],r[2]=i*n[2*4+0]+a*n[2*4+1]+o*n[2*4+2],r}var nt=Object.freeze({__proto__:null,axisRotate:vu,axisRotation:hu,copy:Vi,frustum:ru,getAxis:Qo,getTranslation:Ko,identity:gn,inverse:bn,lookAt:nu,multiply:qo,negate:Wo,ortho:tu,perspective:eu,rotateX:uu,rotateY:cu,rotateZ:lu,rotationX:ou,rotationY:su,rotationZ:fu,scale:pu,scaling:mu,setAxis:Jo,setDefaultType:Yo,setTranslation:Zo,transformDirection:ji,transformNormal:du,transformPoint:ki,translate:au,translation:iu,transpose:$o}),Tn=5120,Ut=5121,En=5122,xn=5123,An=5124,wn=5125,In=5126,yu=32819,_u=32820,gu=33635,bu=5131,Tu=33640,Eu=35899,xu=35902,Au=36269,wu=34042,Xi={};{var ie=Xi;ie[Tn]=Int8Array,ie[Ut]=Uint8Array,ie[En]=Int16Array,ie[xn]=Uint16Array,ie[An]=Int32Array,ie[wn]=Uint32Array,ie[In]=Float32Array,ie[yu]=Uint16Array,ie[_u]=Uint16Array,ie[gu]=Uint16Array,ie[bu]=Uint16Array,ie[Tu]=Uint32Array,ie[Eu]=Uint32Array,ie[xu]=Uint32Array,ie[Au]=Uint32Array,ie[wu]=Uint32Array}function xr(t){if(t instanceof Int8Array)return Tn;if(t instanceof Uint8Array||t instanceof Uint8ClampedArray)return Ut;if(t instanceof Int16Array)return En;if(t instanceof Uint16Array)return xn;if(t instanceof Int32Array)return An;if(t instanceof Uint32Array)return wn;if(t instanceof Float32Array)return In;throw new Error("unsupported typed array type")}function Iu(t){if(t===Int8Array)return Tn;if(t===Uint8Array||t===Uint8ClampedArray)return Ut;if(t===Int16Array)return En;if(t===Uint16Array)return xn;if(t===Int32Array)return An;if(t===Uint32Array)return wn;if(t===Float32Array)return In;throw new Error("unsupported typed array type")}function Cu(t){var e=Xi[t];if(!e)throw new Error("unknown gl type");return e}var Lt=typeof SharedArrayBuffer<"u"?function(e){return e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof SharedArrayBuffer)}:function(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer};function Mu(t,e,r){t.forEach(function(n){var i=e[n];i!==void 0&&(r[n]=i)})}function Hi(){var t;(t=console).error.apply(t,arguments)}function Ru(){var t;(t=console).warn.apply(t,arguments)}function Pu(t,e){return typeof WebGLBuffer<"u"&&e instanceof WebGLBuffer}function Su(t,e){return typeof WebGLShader<"u"&&e instanceof WebGLShader}function Yi(t,e){return typeof WebGLTexture<"u"&&e instanceof WebGLTexture}function Fu(t,e){return typeof WebGLSampler<"u"&&e instanceof WebGLSampler}var Wi=35044,Ne=34962,$i=34963,Du=34660,Nu=5120,Ou=5121,Bu=5122,Uu=5123,Lu=5124,Gu=5125,zu=5126,qi={attribPrefix:""};function Zi(t,e,r,n,i){t.bindBuffer(e,r),t.bufferData(e,n,i||Wi)}function Cn(t,e,r,n){if(Pu(t,e))return e;r=r||Ne;var i=t.createBuffer();return Zi(t,r,i,e,n),i}function Ki(t){return t==="indices"}function Vu(t){return t instanceof Int8Array||t instanceof Uint8Array}function ku(t){return t===Int8Array||t===Uint8Array}function Mn(t){return t.length?t:t.data}var ju=/coord|texture/i,Xu=/color|colour/i;function Qi(t,e){var r;if(ju.test(t)?r=2:Xu.test(t)?r=4:r=3,e%r>0)throw new Error("Can not guess numComponents for attribute '".concat(t,"'. Tried ").concat(r," but ").concat(e," values is not evenly divisible by ").concat(r,". You should specify it."));return r}function Rn(t,e){return t.numComponents||t.size||Qi(e,Mn(t).length)}function Vt(t,e){if(Lt(t))return t;if(Lt(t.data))return t.data;Array.isArray(t)&&(t={data:t});var r=t.type;return r||(Ki(e)?r=Uint16Array:r=Float32Array),new r(t.data)}function Hu(t,e){var r={};return Object.keys(e).forEach(function(n){if(!Ki(n)){var i=e[n],a=i.attrib||i.name||i.attribName||qi.attribPrefix+n;if(i.value){if(!Array.isArray(i.value)&&!Lt(i.value))throw new Error("array.value is not array or typedarray");r[a]={value:i.value}}else{var o,u,c,f;if(i.buffer&&i.buffer instanceof WebGLBuffer)o=i.buffer,f=i.numComponents||i.size,u=i.type,c=i.normalize;else if(typeof i=="number"||typeof i.data=="number"){var h=i.data||i,l=i.type||Float32Array,m=h*l.BYTES_PER_ELEMENT;u=Iu(l),c=i.normalize!==void 0?i.normalize:ku(l),f=i.numComponents||i.size||Qi(n,h),o=t.createBuffer(),t.bindBuffer(Ne,o),t.bufferData(Ne,m,i.drawType||Wi)}else{var g=Vt(i,n);o=Cn(t,g,void 0,i.drawType),u=xr(g),c=i.normalize!==void 0?i.normalize:Vu(g),f=Rn(i,n)}r[a]={buffer:o,numComponents:f,type:u,normalize:c,stride:i.stride||0,offset:i.offset||0,divisor:i.divisor===void 0?void 0:i.divisor,drawType:i.drawType}}}}),t.bindBuffer(Ne,null),r}function Yu(t,e,r,n){r=Vt(r),Zi(t,Ne,e.buffer,r,e.drawType)}function Wu(t,e){return e===Nu||e===Ou?1:e===Bu||e===Uu?2:e===Lu||e===Gu||e===zu?4:0}var yt=["position","positions","a_position"];function $u(t){var e,r;for(r=0;r<yt.length&&(e=yt[r],!(e in t));++r);r===yt.length&&(e=Object.keys(t)[0]);var n=t[e],i=Mn(n).length,a=Rn(n,e),o=i/a;if(i%a>0)throw new Error("numComponents ".concat(a," not correct for length ").concat(i));return o}function qu(t,e){var r,n;for(n=0;n<yt.length&&(r=yt[n],!(r in e||(r=qi.attribPrefix+r,r in e)));++n);n===yt.length&&(r=Object.keys(e)[0]);var i=e[r];t.bindBuffer(Ne,i.buffer);var a=t.getBufferParameter(Ne,Du);t.bindBuffer(Ne,null);var o=Wu(t,i.type),u=a/o,c=i.numComponents||i.size,f=u/c;if(f%1!==0)throw new Error("numComponents ".concat(c," not correct for length ").concat(length));return f}function rn(t,e,r){var n=Hu(t,e),i=Object.assign({},{});i.attribs=Object.assign({},{},n);var a=e.indices;if(a){var o=Vt(a,"indices");i.indices=Cn(t,o,$i),i.numElements=o.length,i.elementType=xr(o)}else i.numElements||(i.numElements=qu(t,i.attribs));return i}function Zu(t,e,r){var n=r==="indices"?$i:Ne,i=Vt(e,r);return Cn(t,i,n)}function Ku(t,e){var r={};return Object.keys(e).forEach(function(n){r[n]=Zu(t,e[n],n)}),e.indices?(r.numElements=e.indices.length,r.elementType=xr(Vt(e.indices))):r.numElements=$u(e),r}var ut=Mn,Qu=Rn;function Ji(t,e){var r=0;return t.push=function(){for(var n=0;n<arguments.length;++n){var i=arguments[n];if(i instanceof Array||Lt(i))for(var a=0;a<i.length;++a)t[r++]=i[a];else t[r++]=i}},t.reset=function(n){r=n||0},t.numComponents=e,Object.defineProperty(t,"numElements",{get:function(){return this.length/this.numComponents|0}}),t}function z(t,e,r){var n=r||Float32Array;return Ji(new n(t*e),t)}function Ju(t){return t!=="indices"}function es(t){var e=t.indices,r={},n=e.length;function i(a){for(var o=t[a],u=o.numComponents,c=z(u,n,o.constructor),f=0;f<n;++f)for(var h=e[f],l=h*u,m=0;m<u;++m)c.push(o[l+m]);r[a]=c}return Object.keys(t).filter(Ju).forEach(i),r}function ts(t){if(t.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");for(var e=t.normal,r=e.length,n=0;n<r;n+=9){var i=e[n+0],a=e[n+1],o=e[n+2],u=e[n+3],c=e[n+4],f=e[n+5],h=e[n+6],l=e[n+7],m=e[n+8],g=i+u+h,y=a+c+l,_=o+f+m,T=Math.sqrt(g*g+y*y+_*_);g/=T,y/=T,_/=T,e[n+0]=g,e[n+1]=y,e[n+2]=_,e[n+3]=g,e[n+4]=y,e[n+5]=_,e[n+6]=g,e[n+7]=y,e[n+8]=_}return t}function Pn(t,e,r){for(var n=t.length,i=new Float32Array(3),a=0;a<n;a+=3)r(e,[t[a],t[a+1],t[a+2]],i),t[a]=i[0],t[a+1]=i[1],t[a+2]=i[2]}function rs(t,e,r){r=r||De();var n=e[0],i=e[1],a=e[2];return r[0]=n*t[0*4+0]+i*t[0*4+1]+a*t[0*4+2],r[1]=n*t[1*4+0]+i*t[1*4+1]+a*t[1*4+2],r[2]=n*t[2*4+0]+i*t[2*4+1]+a*t[2*4+2],r}function ea(t,e){return Pn(t,e,ji),t}function ta(t,e){return Pn(t,bn(e),rs),t}function ra(t,e){return Pn(t,e,ki),t}function na(t,e){return Object.keys(t).forEach(function(r){var n=t[r];r.indexOf("pos")>=0?ra(n,e):r.indexOf("tan")>=0||r.indexOf("binorm")>=0?ea(n,e):r.indexOf("norm")>=0&&ta(n,e)}),t}function Sn(t,e,r){return t=t||2,e=e||0,r=r||0,t*=.5,{position:{numComponents:2,data:[e+-1*t,r+-1*t,e+1*t,r+-1*t,e+-1*t,r+1*t,e+1*t,r+1*t]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function Fn(t,e,r,n,i){t=t||1,e=e||1,r=r||1,n=n||1,i=i||gn();for(var a=(r+1)*(n+1),o=z(3,a),u=z(3,a),c=z(2,a),f=0;f<=n;f++)for(var h=0;h<=r;h++){var l=h/r,m=f/n;o.push(t*l-t*.5,0,e*m-e*.5),u.push(0,1,0),c.push(l,m)}for(var g=r+1,y=z(3,r*n*2,Uint16Array),_=0;_<n;_++)for(var T=0;T<r;T++)y.push((_+0)*g+T,(_+1)*g+T,(_+0)*g+T+1),y.push((_+1)*g+T,(_+1)*g+T+1,(_+0)*g+T+1);var x=na({position:o,normal:u,texcoord:c,indices:y},i);return x}function Dn(t,e,r,n,i,a,o){if(e<=0||r<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");n=n||0,i=i||Math.PI,a=a||0,o=o||Math.PI*2;for(var u=i-n,c=o-a,f=(e+1)*(r+1),h=z(3,f),l=z(3,f),m=z(2,f),g=0;g<=r;g++)for(var y=0;y<=e;y++){var _=y/e,T=g/r,x=c*_+a,M=u*T+n,E=Math.sin(x),w=Math.cos(x),A=Math.sin(M),I=Math.cos(M),F=w*A,R=I,S=E*A;h.push(t*F,t*R,t*S),l.push(F,R,S),m.push(1-_,T)}for(var U=e+1,L=z(3,e*r*2,Uint16Array),D=0;D<e;D++)for(var N=0;N<r;N++)L.push((N+0)*U+D,(N+0)*U+D+1,(N+1)*U+D),L.push((N+1)*U+D,(N+0)*U+D+1,(N+1)*U+D+1);return{position:h,normal:l,texcoord:m,indices:L}}var ns=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function Nn(t){t=t||1;for(var e=t/2,r=[[-e,-e,-e],[+e,-e,-e],[-e,+e,-e],[+e,+e,-e],[-e,-e,+e],[+e,-e,+e],[-e,+e,+e],[+e,+e,+e]],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],i=[[1,0],[0,0],[0,1],[1,1]],a=6*4,o=z(3,a),u=z(3,a),c=z(2,a),f=z(3,6*2,Uint16Array),h=0;h<6;++h){for(var l=ns[h],m=0;m<4;++m){var g=r[l[m]],y=n[h],_=i[m];o.push(g),u.push(y),c.push(_)}var T=4*h;f.push(T+0,T+1,T+2),f.push(T+0,T+2,T+3)}return{position:o,normal:u,texcoord:c,indices:f}}function Ar(t,e,r,n,i,a,o){if(n<3)throw new Error("radialSubdivisions must be 3 or greater");if(i<1)throw new Error("verticalSubdivisions must be 1 or greater");for(var u=a===void 0?!0:a,c=o===void 0?!0:o,f=(u?2:0)+(c?2:0),h=(n+1)*(i+1+f),l=z(3,h),m=z(3,h),g=z(2,h),y=z(3,n*(i+f/2)*2,Uint16Array),_=n+1,T=Math.atan2(t-e,r),x=Math.cos(T),M=Math.sin(T),E=u?-2:0,w=i+(c?2:0),A=E;A<=w;++A){var I=A/i,F=r*I,R=void 0;A<0?(F=0,I=1,R=t):A>i?(F=r,I=1,R=e):R=t+(e-t)*(A/i),(A===-2||A===i+2)&&(R=0,I=0),F-=r/2;for(var S=0;S<_;++S){var U=Math.sin(S*Math.PI*2/n),L=Math.cos(S*Math.PI*2/n);l.push(U*R,F,L*R),A<0?m.push(0,-1,0):A>i?m.push(0,1,0):R===0?m.push(0,0,0):m.push(U*x,M,L*x),g.push(S/n,1-I)}}for(var D=0;D<i+f;++D)if(!(D===1&&u||D===i+f-2&&c))for(var N=0;N<n;++N)y.push(_*(D+0)+0+N,_*(D+0)+1+N,_*(D+1)+1+N),y.push(_*(D+0)+0+N,_*(D+1)+1+N,_*(D+1)+0+N);return{position:l,normal:m,texcoord:g,indices:y}}function bi(t,e){e=e||[];for(var r=[],n=0;n<t.length;n+=4){var i=t[n],a=t.slice(n+1,n+4);a.push.apply(a,e);for(var o=0;o<i;++o)r.push.apply(r,a)}return r}function On(){var t=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],e=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],r=bi([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),n=bi([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),i=t.length/3,a={position:z(3,i),texcoord:z(2,i),normal:z(3,i),color:z(4,i,Uint8Array),indices:z(3,i/3,Uint16Array)};a.position.push(t),a.texcoord.push(e),a.normal.push(r),a.color.push(n);for(var o=0;o<i;++o)a.indices.push(o);return a}function wr(t,e,r,n,i,a,o){if(i<=0)throw new Error("subdivisionDown must be > 0");a=a||0,o=o||1;var u=2,c=o-a,f=(i+1)*2*(2+u),h=z(3,f),l=z(3,f),m=z(2,f);function g(w,A,I){return w+(A-w)*I}function y(w,A,I,F,R,S){for(var U=0;U<=i;U++){var L=A/(u-1),D=U/i,N=(L-.5)*2,B=(a+D*c)*Math.PI,j=Math.sin(B),W=Math.cos(B),q=g(t,w,j),Z=N*n,Te=W*t,Oe=j*q;h.push(Z,Te,Oe);var Be=jo(Ho([0,j,W],I),F);l.push(Be),m.push(L*R+S,D)}}for(var _=0;_<u;_++){var T=(_/(u-1)-.5)*2;y(e,_,[1,1,1],[0,0,0],1,0),y(e,_,[0,0,0],[T,0,0],0,0),y(r,_,[1,1,1],[0,0,0],1,0),y(r,_,[0,0,0],[T,0,0],0,1)}var x=z(3,i*2*(2+u),Uint16Array);function M(w,A){for(var I=0;I<i;++I)x.push(w+I+0,w+I+1,A+I+0),x.push(w+I+1,A+I+1,A+I+0)}var E=i+1;return M(E*0,E*4),M(E*5,E*7),M(E*6,E*2),M(E*3,E*1),{position:h,normal:l,texcoord:m,indices:x}}function Bn(t,e,r,n,i,a){return Ar(t,t,e,r,n,i,a)}function Un(t,e,r,n,i,a){if(r<3)throw new Error("radialSubdivisions must be 3 or greater");if(n<3)throw new Error("verticalSubdivisions must be 3 or greater");i=i||0,a=a||Math.PI*2;for(var o=a-i,u=r+1,c=n+1,f=u*c,h=z(3,f),l=z(3,f),m=z(2,f),g=z(3,r*n*2,Uint16Array),y=0;y<c;++y)for(var _=y/n,T=_*Math.PI*2,x=Math.sin(T),M=t+x*e,E=Math.cos(T),w=E*e,A=0;A<u;++A){var I=A/r,F=i+I*o,R=Math.sin(F),S=Math.cos(F),U=R*M,L=S*M,D=R*x,N=S*x;h.push(U,w,L),l.push(D,E,N),m.push(I,1-_)}for(var B=0;B<n;++B)for(var j=0;j<r;++j){var W=1+j,q=1+B;g.push(u*B+j,u*q+j,u*B+W),g.push(u*q+j,u*q+W,u*B+W)}return{position:h,normal:l,texcoord:m,indices:g}}function Ln(t,e,r,n,i){if(e<3)throw new Error("divisions must be at least 3");r=r||1,i=i||1,n=n||0;for(var a=(e+1)*(r+1),o=z(3,a),u=z(3,a),c=z(2,a),f=z(3,r*e*2,Uint16Array),h=0,l=t-n,m=e+1,g=0;g<=r;++g){for(var y=n+l*Math.pow(g/r,i),_=0;_<=e;++_){var T=2*Math.PI*_/e,x=y*Math.cos(T),M=y*Math.sin(T);if(o.push(x,0,M),u.push(0,1,0),c.push(1-_/e,g/r),g>0&&_!==e){var E=h+(_+1),w=h+_,A=h+_-m,I=h+(_+1)-m;f.push(E,w,A),f.push(E,A,I)}}h+=e+1}return{position:o,normal:u,texcoord:c,indices:f}}function is(t){return Math.random()*t|0}function as(t,e){e=e||{};var r=t.position.numElements,n=z(4,r,Uint8Array),i=e.rand||function(l,m){return m<3?is(256):255};if(t.color=n,t.indices)for(var a=0;a<r;++a)n.push(i(a,0),i(a,1),i(a,2),i(a,3));else for(var o=e.vertsPerColor||3,u=r/o,c=0;c<u;++c)for(var f=[i(c,0),i(c,1),i(c,2),i(c,3)],h=0;h<o;++h)n.push(f);return t}function Ae(t){return function(e){var r=t.apply(this,Array.prototype.slice.call(arguments,1));return Ku(e,r)}}function we(t){return function(e){var r=t.apply(null,Array.prototype.slice.call(arguments,1));return rn(e,r)}}var os=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function nn(t,e,r,n){n=n||0;for(var i=t.length,a=0;a<i;++a)e[r+a]=t[a]+n}function ia(t,e){var r=ut(t),n=new r.constructor(e),i=n;return r.numComponents&&r.numElements&&Ji(n,r.numComponents),t.data&&(i={data:n},Mu(os,t,i)),i}function us(t){for(var e={},r,n=function(h){var l=t[h];Object.keys(l).forEach(function(m){e[m]||(e[m]=[]),!r&&m!=="indices"&&(r=m);var g=l[m],y=Qu(g,m),_=ut(g),T=_.length/y;e[m].push(T)})},i=0;i<t.length;++i)n(i);function a(f){for(var h=0,l,m=0;m<t.length;++m){var g=t[m],y=g[f],_=ut(y);h+=_.length,(!l||y.data)&&(l=y)}return{length:h,spec:l}}function o(f,h,l){for(var m=0,g=0,y=0;y<t.length;++y){var _=t[y],T=_[f],x=ut(T);f==="indices"?(nn(x,l,g,m),m+=h[y]):nn(x,l,g),g+=x.length}}var u=e[r],c={};return Object.keys(e).forEach(function(f){var h=a(f),l=ia(h.spec,h.length);o(f,u,ut(l)),c[f]=l}),c}function ss(t){var e={};return Object.keys(t).forEach(function(r){var n=t[r],i=ut(n),a=ia(n,i.length);nn(i,ut(a),0),e[r]=a}),e}var cs=we(On),fs=Ae(On),ls=we(Nn),hs=Ae(Nn),vs=we(Fn),ms=Ae(Fn),ps=we(Dn),ds=Ae(Dn),ys=we(Ar),_s=Ae(Ar),gs=we(Sn),bs=Ae(Sn),aa=we(wr),oa=Ae(wr),Ts=we(Bn),Es=Ae(Bn),xs=we(Un),As=Ae(Un),ws=we(Ln),Is=Ae(Ln),Cs=aa,Ms=oa,Rs=wr,Ps=Object.freeze({__proto__:null,create3DFBufferInfo:cs,create3DFBuffers:fs,create3DFVertices:On,createAugmentedTypedArray:z,createCubeBufferInfo:ls,createCubeBuffers:hs,createCubeVertices:Nn,createPlaneBufferInfo:vs,createPlaneBuffers:ms,createPlaneVertices:Fn,createSphereBufferInfo:ps,createSphereBuffers:ds,createSphereVertices:Dn,createTruncatedConeBufferInfo:ys,createTruncatedConeBuffers:_s,createTruncatedConeVertices:Ar,createXYQuadBufferInfo:gs,createXYQuadBuffers:bs,createXYQuadVertices:Sn,createCresentBufferInfo:Cs,createCresentBuffers:Ms,createCresentVertices:Rs,createCrescentBufferInfo:aa,createCrescentBuffers:oa,createCrescentVertices:wr,createCylinderBufferInfo:Ts,createCylinderBuffers:Es,createCylinderVertices:Bn,createTorusBufferInfo:xs,createTorusBuffers:As,createTorusVertices:Un,createDiscBufferInfo:ws,createDiscBuffers:Is,createDiscVertices:Ln,deindexVertices:es,flattenNormals:ts,makeRandomVertexColors:as,reorientDirections:ea,reorientNormals:ta,reorientPositions:ra,reorientVertices:na,concatVertices:us,duplicateVertices:ss});function Ye(t){return!!t.texStorage2D}function ua(t){return!t.texStorage2D}var an=function(){var t={},e={};function r(n){var i=n.constructor.name;if(!t[i]){for(var a in n)if(typeof n[a]=="number"){var o=e[n[a]];e[n[a]]=o?"".concat(o," | ").concat(a):a}t[i]=!0}}return function(i,a){return r(i),e[a]||"0x"+a.toString(16)}}(),We={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},Gt=Lt,Wr;function sa(){return Wr=Wr||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),Wr}var on=6406,ye=6407,X=6408,un=6409,sn=6410,hr=6402,cn=34041,dr=33071,Ss=9728,Fs=9729,$e=3553,He=34067,st=32879,ct=35866,Gn=34069,Ds=34070,Ns=34071,Os=34072,Bs=34073,Us=34074,fn=10241,ln=10240,yr=10242,_r=10243,Ti=32882,Ls=33082,Gs=33083,zs=33084,Vs=33085,Ir=3317,zn=3314,Vn=32878,kn=3316,jn=3315,Xn=32877,hn=37443,vn=37441,mn=37440,ks=33321,js=36756,Xs=33325,Hs=33326,Ys=33330,Ws=33329,$s=33338,qs=33337,Zs=33340,Ks=33339,Qs=33323,Js=36757,ec=33327,tc=33328,rc=33336,nc=33335,ic=33332,ac=33331,oc=33334,uc=33333,sc=32849,cc=35905,fc=36194,lc=36758,hc=35898,vc=35901,mc=34843,pc=34837,dc=36221,yc=36239,_c=36215,gc=36233,bc=36209,Tc=36227,Ec=32856,xc=35907,Ac=36759,wc=32855,Ic=32854,Cc=32857,Mc=34842,Rc=34836,Pc=36220,Sc=36238,Fc=36975,Dc=36214,Nc=36232,Oc=36226,Bc=36208,Uc=33189,Lc=33190,Gc=36012,zc=36013,Vc=35056,Ve=5120,H=5121,Jt=5122,Ft=5123,er=5124,pt=5125,ae=5126,Ei=32819,xi=32820,Ai=33635,be=5131,Dt=36193,$r=33640,kc=35899,jc=35902,Xc=36269,Hc=34042,Nt=33319,it=33320,Ot=6403,at=36244,ot=36248,ke=36249,Yc={};{var ue=Yc;ue[on]={numColorComponents:1},ue[un]={numColorComponents:1},ue[sn]={numColorComponents:2},ue[ye]={numColorComponents:3},ue[X]={numColorComponents:4},ue[Ot]={numColorComponents:1},ue[at]={numColorComponents:1},ue[Nt]={numColorComponents:2},ue[it]={numColorComponents:2},ue[ye]={numColorComponents:3},ue[ot]={numColorComponents:3},ue[X]={numColorComponents:4},ue[ke]={numColorComponents:4},ue[hr]={numColorComponents:1},ue[cn]={numColorComponents:2}}var qr;function Cr(t){if(!qr){var e={};e[on]={textureFormat:on,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[H,be,Dt,ae]},e[un]={textureFormat:un,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[H,be,Dt,ae]},e[sn]={textureFormat:sn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[H,be,Dt,ae]},e[ye]={textureFormat:ye,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[H,be,Dt,ae,Ai]},e[X]={textureFormat:X,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[H,be,Dt,ae,Ei,xi]},e[ks]={textureFormat:Ot,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[H]},e[js]={textureFormat:Ot,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[Ve]},e[Xs]={textureFormat:Ot,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[ae,be]},e[Hs]={textureFormat:Ot,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[ae]},e[Ys]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[H]},e[Ws]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[Ve]},e[ic]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Ft]},e[ac]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Jt]},e[oc]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[pt]},e[uc]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[er]},e[Qs]={textureFormat:Nt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[H]},e[Js]={textureFormat:Nt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[Ve]},e[ec]={textureFormat:Nt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[ae,be]},e[tc]={textureFormat:Nt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[ae]},e[rc]={textureFormat:it,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[H]},e[nc]={textureFormat:it,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Ve]},e[$s]={textureFormat:it,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Ft]},e[qs]={textureFormat:it,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Jt]},e[Zs]={textureFormat:it,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[pt]},e[Ks]={textureFormat:it,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[er]},e[sc]={textureFormat:ye,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[H]},e[cc]={textureFormat:ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[H]},e[fc]={textureFormat:ye,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[H,Ai]},e[lc]={textureFormat:ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[Ve]},e[hc]={textureFormat:ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[ae,be,kc]},e[vc]={textureFormat:ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[ae,be,jc]},e[mc]={textureFormat:ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[ae,be]},e[pc]={textureFormat:ye,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[ae]},e[dc]={textureFormat:ot,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[H]},e[yc]={textureFormat:ot,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[Ve]},e[_c]={textureFormat:ot,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Ft]},e[gc]={textureFormat:ot,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Jt]},e[bc]={textureFormat:ot,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[pt]},e[Tc]={textureFormat:ot,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[er]},e[Ec]={textureFormat:X,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[H]},e[xc]={textureFormat:X,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[H]},e[Ac]={textureFormat:X,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[Ve]},e[wc]={textureFormat:X,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[H,xi,$r]},e[Ic]={textureFormat:X,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[H,Ei]},e[Cc]={textureFormat:X,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[$r]},e[Mc]={textureFormat:X,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[ae,be]},e[Rc]={textureFormat:X,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[ae]},e[Pc]={textureFormat:ke,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[H]},e[Sc]={textureFormat:ke,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Ve]},e[Fc]={textureFormat:ke,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[$r]},e[Dc]={textureFormat:ke,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Ft]},e[Nc]={textureFormat:ke,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Jt]},e[Oc]={textureFormat:ke,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[er]},e[Bc]={textureFormat:ke,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[pt]},e[Uc]={textureFormat:hr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[Ft,pt]},e[Lc]={textureFormat:hr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[pt]},e[Gc]={textureFormat:hr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ae]},e[Vc]={textureFormat:cn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Hc]},e[zc]={textureFormat:cn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Xc]},Object.keys(e).forEach(function(r){var n=e[r];n.bytesPerElementMap={},n.bytesPerElement.forEach(function(i,a){var o=n.type[a];n.bytesPerElementMap[o]=i})}),qr=e}return qr[t]}function Wc(t,e){var r=Cr(t);if(!r)throw"unknown internal format";var n=r.bytesPerElementMap[e];if(n===void 0)throw"unknown internal format";return n}function kt(t){var e=Cr(t);if(!e)throw"unknown internal format";return{format:e.textureFormat,type:e.type[0]}}function wi(t){return(t&t-1)===0}function $c(t,e,r,n){if(!Ye(t))return wi(e)&&wi(r);var i=Cr(n);if(!i)throw"unknown internal format";return i.colorRenderable&&i.textureFilterable}function qc(t){var e=Cr(t);if(!e)throw"unknown internal format";return e.textureFilterable}function Zc(t,e,r){return Gt(e)?xr(e):r||H}function tr(t,e,r,n,i){if(i%1!==0)throw"can't guess dimensions";if(!r&&!n){var a=Math.sqrt(i/(e===He?6:1));a%1===0?(r=a,n=a):(r=i,n=1)}else if(n){if(!r&&(r=i/n,r%1))throw"can't guess dimensions"}else if(n=i/r,n%1)throw"can't guess dimensions";return{width:r,height:n}}var re={};function gt(t,e){e.colorspaceConversion!==void 0&&(re.colorspaceConversion=t.getParameter(hn),t.pixelStorei(hn,e.colorspaceConversion)),e.premultiplyAlpha!==void 0&&(re.premultiplyAlpha=t.getParameter(vn),t.pixelStorei(vn,e.premultiplyAlpha)),e.flipY!==void 0&&(re.flipY=t.getParameter(mn),t.pixelStorei(mn,e.flipY))}function bt(t,e){e.colorspaceConversion!==void 0&&t.pixelStorei(hn,re.colorspaceConversion),e.premultiplyAlpha!==void 0&&t.pixelStorei(vn,re.premultiplyAlpha),e.flipY!==void 0&&t.pixelStorei(mn,re.flipY)}function ca(t){re.unpackAlignment=t.getParameter(Ir),Ye(t)&&(re.unpackRowLength=t.getParameter(zn),re.unpackImageHeight=t.getParameter(Vn),re.unpackSkipPixels=t.getParameter(kn),re.unpackSkipRows=t.getParameter(jn),re.unpackSkipImages=t.getParameter(Xn))}function fa(t){t.pixelStorei(Ir,re.unpackAlignment),Ye(t)&&(t.pixelStorei(zn,re.unpackRowLength),t.pixelStorei(Vn,re.unpackImageHeight),t.pixelStorei(kn,re.unpackSkipPixels),t.pixelStorei(jn,re.unpackSkipRows),t.pixelStorei(Xn,re.unpackSkipImages))}function Kc(t,e,r,n){n.minMag&&(r.call(t,e,fn,n.minMag),r.call(t,e,ln,n.minMag)),n.min&&r.call(t,e,fn,n.min),n.mag&&r.call(t,e,ln,n.mag),n.wrap&&(r.call(t,e,yr,n.wrap),r.call(t,e,_r,n.wrap),(e===st||Fu(t,e))&&r.call(t,e,Ti,n.wrap)),n.wrapR&&r.call(t,e,Ti,n.wrapR),n.wrapS&&r.call(t,e,yr,n.wrapS),n.wrapT&&r.call(t,e,_r,n.wrapT),n.minLod&&r.call(t,e,Ls,n.minLod),n.maxLod&&r.call(t,e,Gs,n.maxLod),n.baseLevel&&r.call(t,e,zs,n.baseLevel),n.maxLevel&&r.call(t,e,Vs,n.maxLevel)}function la(t,e,r){var n=r.target||$e;t.bindTexture(n,e),Kc(t,n,t.texParameteri,r)}function Qc(t){return t=t||We.textureColor,Gt(t)?t:new Uint8Array([t[0]*255,t[1]*255,t[2]*255,t[3]*255])}function pn(t,e,r,n,i,a){r=r||We.textureOptions,a=a||X;var o=r.target||$e;if(n=n||r.width,i=i||r.height,t.bindTexture(o,e),$c(t,n,i,a))t.generateMipmap(o);else{var u=qc(a)?Fs:Ss;t.texParameteri(o,fn,u),t.texParameteri(o,ln,u),t.texParameteri(o,yr,dr),t.texParameteri(o,_r,dr)}}function zt(t){return t.auto===!0||t.auto===void 0&&t.level===void 0}function dn(t,e){return e=e||{},e.cubeFaceOrder||[Gn,Ds,Ns,Os,Bs,Us]}function yn(t,e){var r=dn(t,e),n=r.map(function(i,a){return{face:i,ndx:a}});return n.sort(function(i,a){return i.face-a.face}),n}function ha(t,e,r,n){n=n||We.textureOptions;var i=n.target||$e,a=n.level||0,o=r.width,u=r.height,c=n.internalFormat||n.format||X,f=kt(c),h=n.format||f.format,l=n.type||f.type;if(gt(t,n),t.bindTexture(i,e),i===He){var m=r.width,g=r.height,y,_;if(m/6===g)y=g,_=[0,0,1,0,2,0,3,0,4,0,5,0];else if(g/6===m)y=m,_=[0,0,0,1,0,2,0,3,0,4,0,5];else if(m/3===g/2)y=m/3,_=[0,0,1,0,2,0,0,1,1,1,2,1];else if(m/2===g/3)y=m/2,_=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(r.src?r.src:r.nodeName);var T=sa();T?(T.canvas.width=y,T.canvas.height=y,o=y,u=y,yn(t,n).forEach(function(S){var U=_[S.ndx*2+0]*y,L=_[S.ndx*2+1]*y;T.drawImage(r,U,L,y,y,0,0,y,y),t.texImage2D(S.face,a,c,h,l,T.canvas)}),T.canvas.width=1,T.canvas.height=1):typeof createImageBitmap<"u"&&(o=y,u=y,yn(t,n).forEach(function(S){var U=_[S.ndx*2+0]*y,L=_[S.ndx*2+1]*y;t.texImage2D(S.face,a,c,y,y,0,h,l,null),createImageBitmap(r,U,L,y,y,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(D){gt(t,n),t.bindTexture(i,e),t.texImage2D(S.face,a,c,h,l,D),bt(t,n),zt(n)&&pn(t,e,n,o,u,c)})}))}else if(i===st||i===ct){var x=Math.min(r.width,r.height),M=Math.max(r.width,r.height),E=M/x;if(E%1!==0)throw"can not compute 3D dimensions of element";var w=r.width===M?1:0,A=r.height===M?1:0;ca(t),t.pixelStorei(Ir,1),t.pixelStorei(zn,r.width),t.pixelStorei(Vn,0),t.pixelStorei(Xn,0),t.texImage3D(i,a,c,x,x,x,0,h,l,null);for(var I=0;I<E;++I){var F=I*x*w,R=I*x*A;t.pixelStorei(kn,F),t.pixelStorei(jn,R),t.texSubImage3D(i,a,0,0,I,x,x,1,h,l,r)}fa(t)}else t.texImage2D(i,a,c,h,l,r);bt(t,n),zt(n)&&pn(t,e,n,o,u,c),la(t,e,n)}function jt(){}function Jc(t){if(typeof document<"u"){var e=document.createElement("a");return e.href=t,e.hostname===location.hostname&&e.port===location.port&&e.protocol===location.protocol}else{var r=new URL(location.href).origin,n=new URL(t,location.href).origin;return n===r}}function ef(t,e){return e===void 0&&!Jc(t)?"anonymous":e}function tf(t,e,r){r=r||jt;var n;if(e=e!==void 0?e:We.crossOrigin,e=ef(t,e),typeof Image<"u"){n=new Image,e!==void 0&&(n.crossOrigin=e);var i=function(){n.removeEventListener("error",a),n.removeEventListener("load",o),n=null},a=function(){var m="couldn't load image: "+t;Hi(m),r(m,n),i()},o=function(){r(null,n),i()};return n.addEventListener("error",a),n.addEventListener("load",o),n.src=t,n}else if(typeof ImageBitmap<"u"){var u,c,f=function(){r(u,c)},h={};e&&(h.mode="cors"),fetch(t,h).then(function(l){if(!l.ok)throw l;return l.blob()}).then(function(l){return createImageBitmap(l,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(l){c=l,setTimeout(f)}).catch(function(l){u=l,setTimeout(f)}),n=null}return n}function va(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof ImageData<"u"&&t instanceof ImageData||typeof HTMLElement<"u"&&t instanceof HTMLElement}function Hn(t,e,r){return va(t)?(setTimeout(function(){r(null,t)}),t):tf(t,e,r)}function Yn(t,e,r){r=r||We.textureOptions;var n=r.target||$e;if(t.bindTexture(n,e),r.color!==!1){var i=Qc(r.color);if(n===He)for(var a=0;a<6;++a)t.texImage2D(Gn+a,0,X,1,1,0,X,H,i);else n===st||n===ct?t.texImage3D(n,0,X,1,1,1,0,X,H,i):t.texImage2D(n,0,X,1,1,0,X,H,i)}}function rf(t,e,r,n){n=n||jt,r=r||We.textureOptions,Yn(t,e,r),r=Object.assign({},r);var i=Hn(r.src,r.crossOrigin,function(a,o){a?n(a,e,o):(ha(t,e,o,r),n(null,e,o))});return i}function nf(t,e,r,n){n=n||jt;var i=r.src;if(i.length!==6)throw"there must be 6 urls for a cubemap";var a=r.level||0,o=r.internalFormat||r.format||X,u=kt(o),c=r.format||u.format,f=r.type||H,h=r.target||$e;if(h!==He)throw"target must be TEXTURE_CUBE_MAP";Yn(t,e,r),r=Object.assign({},r);var l=6,m=[],g=dn(t,r),y;function _(T){return function(x,M){--l,x?m.push(x):M.width!==M.height?m.push("cubemap face img is not a square: "+M.src):(gt(t,r),t.bindTexture(h,e),l===5?dn().forEach(function(E){t.texImage2D(E,a,o,c,f,M)}):t.texImage2D(T,a,o,c,f,M),bt(t,r),zt(r)&&t.generateMipmap(h)),l===0&&n(m.length?m:void 0,e,y)}}y=i.map(function(T,x){return Hn(T,r.crossOrigin,_(g[x]))})}function af(t,e,r,n){n=n||jt;var i=r.src,a=r.internalFormat||r.format||X,o=kt(a),u=r.format||o.format,c=r.type||H,f=r.target||ct;if(f!==st&&f!==ct)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";Yn(t,e,r),r=Object.assign({},r);var h=i.length,l=[],m,g=r.level||0,y=r.width,_=r.height,T=i.length,x=!0;function M(E){return function(w,A){if(--h,w)l.push(w);else{if(gt(t,r),t.bindTexture(f,e),x){x=!1,y=r.width||A.width,_=r.height||A.height,t.texImage3D(f,g,a,y,_,T,0,u,c,null);for(var I=0;I<T;++I)t.texSubImage3D(f,g,0,0,I,y,_,1,u,c,A)}else{var F=A,R;(A.width!==y||A.height!==_)&&(R=sa(),F=R.canvas,R.canvas.width=y,R.canvas.height=_,R.drawImage(A,0,0,y,_)),t.texSubImage3D(f,g,0,0,E,y,_,1,u,c,F),R&&F===R.canvas&&(R.canvas.width=0,R.canvas.height=0)}bt(t,r),zt(r)&&t.generateMipmap(f)}h===0&&n(l.length?l:void 0,e,m)}}m=i.map(function(E,w){return Hn(E,r.crossOrigin,M(w))})}function of(t,e,r,n){n=n||We.textureOptions;var i=n.target||$e;t.bindTexture(i,e);var a=n.width,o=n.height,u=n.depth,c=n.level||0,f=n.internalFormat||n.format||X,h=kt(f),l=n.format||h.format,m=n.type||Zc(t,r,h.type);if(Gt(r))r instanceof Uint8ClampedArray&&(r=new Uint8Array(r.buffer));else{var g=Cu(m);r=new g(r)}var y=Wc(f,m),_=r.byteLength/y;if(_%1)throw"length wrong size for format: "+an(t,l);var T;if(i===st||i===ct)if(!a&&!o&&!u){var x=Math.cbrt(_);if(x%1!==0)throw"can't guess cube size of array of numElements: "+_;a=x,o=x,u=x}else a&&(!o||!u)?(T=tr(t,i,o,u,_/a),o=T.width,u=T.height):o&&(!a||!u)?(T=tr(t,i,a,u,_/o),a=T.width,u=T.height):(T=tr(t,i,a,o,_/u),a=T.width,o=T.height);else T=tr(t,i,a,o,_),a=T.width,o=T.height;if(ca(t),t.pixelStorei(Ir,n.unpackAlignment||1),gt(t,n),i===He){var M=y/r.BYTES_PER_ELEMENT,E=_/6*M;yn(t,n).forEach(function(w){var A=E*w.ndx,I=r.subarray(A,A+E);t.texImage2D(w.face,c,f,a,o,0,l,m,I)})}else i===st||i===ct?t.texImage3D(i,c,f,a,o,u,0,l,m,r):t.texImage2D(i,c,f,a,o,0,l,m,r);return bt(t,n),fa(t),{width:a,height:o,depth:u,type:m}}function uf(t,e,r){var n=r.target||$e;t.bindTexture(n,e);var i=r.level||0,a=r.internalFormat||r.format||X,o=kt(a),u=r.format||o.format,c=r.type||o.type;if(gt(t,r),n===He)for(var f=0;f<6;++f)t.texImage2D(Gn+f,i,a,r.width,r.height,0,u,c,null);else n===st||n===ct?t.texImage3D(n,i,a,r.width,r.height,r.depth,0,u,c,null):t.texImage2D(n,i,a,r.width,r.height,0,u,c,null);bt(t,r)}function sf(t,e,r){r=r||jt,e=e||We.textureOptions;var n=t.createTexture(),i=e.target||$e,a=e.width||1,o=e.height||1,u=e.internalFormat||X;t.bindTexture(i,n),i===He&&(t.texParameteri(i,yr,dr),t.texParameteri(i,_r,dr));var c=e.src;if(c)if(typeof c=="function"&&(c=c(t,e)),typeof c=="string")rf(t,n,e,r);else if(Gt(c)||Array.isArray(c)&&(typeof c[0]=="number"||Array.isArray(c[0])||Gt(c[0]))){var f=of(t,n,c,e);a=f.width,o=f.height}else Array.isArray(c)&&(typeof c[0]=="string"||va(c[0]))?i===He?nf(t,n,e,r):af(t,n,e,r):(ha(t,n,c,e),a=c.width,o=c.height);else uf(t,n,e);return zt(e)&&pn(t,n,e,a,o,u),la(t,n,e),n}var ma=Hi;function pa(t){return typeof document<"u"&&document.getElementById?document.getElementById(t):null}var gr=33984,Mr=34962,cf=34963,ff=35713,lf=35714,hf=35632,vf=35633,mf=35981,da=35718,pf=35721,df=35971,yf=35382,_f=35396,gf=35398,bf=35392,Tf=35395,Rr=5126,ya=35664,_a=35665,ga=35666,Wn=5124,ba=35667,Ta=35668,Ea=35669,xa=35670,Aa=35671,wa=35672,Ia=35673,Ca=35674,Ma=35675,Ra=35676,Ef=35678,xf=35680,Af=35679,wf=35682,If=35685,Cf=35686,Mf=35687,Rf=35688,Pf=35689,Sf=35690,Ff=36289,Df=36292,Nf=36293,$n=5125,Pa=36294,Sa=36295,Fa=36296,Of=36298,Bf=36299,Uf=36300,Lf=36303,Gf=36306,zf=36307,Vf=36308,kf=36311,Pr=3553,Sr=34067,qn=32879,Fr=35866,G={};function Da(t,e){return G[e].bindPoint}function jf(t,e){return function(r){t.uniform1f(e,r)}}function Xf(t,e){return function(r){t.uniform1fv(e,r)}}function Hf(t,e){return function(r){t.uniform2fv(e,r)}}function Yf(t,e){return function(r){t.uniform3fv(e,r)}}function Wf(t,e){return function(r){t.uniform4fv(e,r)}}function Na(t,e){return function(r){t.uniform1i(e,r)}}function Oa(t,e){return function(r){t.uniform1iv(e,r)}}function Ba(t,e){return function(r){t.uniform2iv(e,r)}}function Ua(t,e){return function(r){t.uniform3iv(e,r)}}function La(t,e){return function(r){t.uniform4iv(e,r)}}function $f(t,e){return function(r){t.uniform1ui(e,r)}}function qf(t,e){return function(r){t.uniform1uiv(e,r)}}function Zf(t,e){return function(r){t.uniform2uiv(e,r)}}function Kf(t,e){return function(r){t.uniform3uiv(e,r)}}function Qf(t,e){return function(r){t.uniform4uiv(e,r)}}function Jf(t,e){return function(r){t.uniformMatrix2fv(e,!1,r)}}function el(t,e){return function(r){t.uniformMatrix3fv(e,!1,r)}}function tl(t,e){return function(r){t.uniformMatrix4fv(e,!1,r)}}function rl(t,e){return function(r){t.uniformMatrix2x3fv(e,!1,r)}}function nl(t,e){return function(r){t.uniformMatrix3x2fv(e,!1,r)}}function il(t,e){return function(r){t.uniformMatrix2x4fv(e,!1,r)}}function al(t,e){return function(r){t.uniformMatrix4x2fv(e,!1,r)}}function ol(t,e){return function(r){t.uniformMatrix3x4fv(e,!1,r)}}function ul(t,e){return function(r){t.uniformMatrix4x3fv(e,!1,r)}}function se(t,e,r,n){var i=Da(t,e);return Ye(t)?function(a){var o,u;Yi(t,a)?(o=a,u=null):(o=a.texture,u=a.sampler),t.uniform1i(n,r),t.activeTexture(gr+r),t.bindTexture(i,o),t.bindSampler(r,u)}:function(a){t.uniform1i(n,r),t.activeTexture(gr+r),t.bindTexture(i,a)}}function ce(t,e,r,n,i){for(var a=Da(t,e),o=new Int32Array(i),u=0;u<i;++u)o[u]=r+u;return Ye(t)?function(c){t.uniform1iv(n,o),c.forEach(function(f,h){t.activeTexture(gr+o[h]);var l,m;Yi(t,f)?(l=f,m=null):(l=f.texture,m=f.sampler),t.bindSampler(r,m),t.bindTexture(a,l)})}:function(c){t.uniform1iv(n,o),c.forEach(function(f,h){t.activeTexture(gr+o[h]),t.bindTexture(a,f)})}}G[Rr]={Type:Float32Array,size:4,setter:jf,arraySetter:Xf};G[ya]={Type:Float32Array,size:8,setter:Hf};G[_a]={Type:Float32Array,size:12,setter:Yf};G[ga]={Type:Float32Array,size:16,setter:Wf};G[Wn]={Type:Int32Array,size:4,setter:Na,arraySetter:Oa};G[ba]={Type:Int32Array,size:8,setter:Ba};G[Ta]={Type:Int32Array,size:12,setter:Ua};G[Ea]={Type:Int32Array,size:16,setter:La};G[$n]={Type:Uint32Array,size:4,setter:$f,arraySetter:qf};G[Pa]={Type:Uint32Array,size:8,setter:Zf};G[Sa]={Type:Uint32Array,size:12,setter:Kf};G[Fa]={Type:Uint32Array,size:16,setter:Qf};G[xa]={Type:Uint32Array,size:4,setter:Na,arraySetter:Oa};G[Aa]={Type:Uint32Array,size:8,setter:Ba};G[wa]={Type:Uint32Array,size:12,setter:Ua};G[Ia]={Type:Uint32Array,size:16,setter:La};G[Ca]={Type:Float32Array,size:16,setter:Jf};G[Ma]={Type:Float32Array,size:36,setter:el};G[Ra]={Type:Float32Array,size:64,setter:tl};G[If]={Type:Float32Array,size:24,setter:rl};G[Cf]={Type:Float32Array,size:32,setter:il};G[Mf]={Type:Float32Array,size:24,setter:nl};G[Rf]={Type:Float32Array,size:48,setter:ol};G[Pf]={Type:Float32Array,size:32,setter:al};G[Sf]={Type:Float32Array,size:48,setter:ul};G[Ef]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:Pr};G[xf]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:Sr};G[Af]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:qn};G[wf]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:Pr};G[Ff]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:Fr};G[Df]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:Fr};G[Nf]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:Sr};G[Of]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:Pr};G[Bf]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:qn};G[Uf]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:Sr};G[Lf]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:Fr};G[Gf]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:Pr};G[zf]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:qn};G[Vf]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:Sr};G[kf]={Type:null,size:0,setter:se,arraySetter:ce,bindPoint:Fr};function Dr(t,e){return function(r){if(r.value)switch(t.disableVertexAttribArray(e),r.value.length){case 4:t.vertexAttrib4fv(e,r.value);break;case 3:t.vertexAttrib3fv(e,r.value);break;case 2:t.vertexAttrib2fv(e,r.value);break;case 1:t.vertexAttrib1fv(e,r.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else t.bindBuffer(Mr,r.buffer),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,r.numComponents||r.size,r.type||Rr,r.normalize||!1,r.stride||0,r.offset||0),r.divisor!==void 0&&t.vertexAttribDivisor(e,r.divisor)}}function qe(t,e){return function(r){if(r.value)if(t.disableVertexAttribArray(e),r.value.length===4)t.vertexAttrib4iv(e,r.value);else throw new Error("The length of an integer constant value must be 4!");else t.bindBuffer(Mr,r.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,r.numComponents||r.size,r.type||Wn,r.stride||0,r.offset||0),r.divisor!==void 0&&t.vertexAttribDivisor(e,r.divisor)}}function Nr(t,e){return function(r){if(r.value)if(t.disableVertexAttribArray(e),r.value.length===4)t.vertexAttrib4uiv(e,r.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else t.bindBuffer(Mr,r.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,r.numComponents||r.size,r.type||$n,r.stride||0,r.offset||0),r.divisor!==void 0&&t.vertexAttribDivisor(e,r.divisor)}}function Zn(t,e,r){var n=r.size,i=r.count;return function(a){t.bindBuffer(Mr,a.buffer);for(var o=a.size||a.numComponents||n,u=o/i,c=a.type||Rr,f=G[c],h=f.size*o,l=a.normalize||!1,m=a.offset||0,g=h/i,y=0;y<i;++y)t.enableVertexAttribArray(e+y),t.vertexAttribPointer(e+y,u,c,l,h,m+g*y),a.divisor!==void 0&&t.vertexAttribDivisor(e+y,a.divisor)}}var J={};J[Rr]={size:4,setter:Dr};J[ya]={size:8,setter:Dr};J[_a]={size:12,setter:Dr};J[ga]={size:16,setter:Dr};J[Wn]={size:4,setter:qe};J[ba]={size:8,setter:qe};J[Ta]={size:12,setter:qe};J[Ea]={size:16,setter:qe};J[$n]={size:4,setter:Nr};J[Pa]={size:8,setter:Nr};J[Sa]={size:12,setter:Nr};J[Fa]={size:16,setter:Nr};J[xa]={size:4,setter:qe};J[Aa]={size:8,setter:qe};J[wa]={size:12,setter:qe};J[Ia]={size:16,setter:qe};J[Ca]={size:4,setter:Zn,count:2};J[Ma]={size:9,setter:Zn,count:3};J[Ra]={size:16,setter:Zn,count:4};function sl(t,e){return e=e||0,++e,t.split(`
`).map(function(r,n){return n+e+": "+r}).join(`
`)}var Ii=/^[ \t]*\n/;function Ga(t,e,r,n){var i=n||ma,a=t.createShader(r),o=0;Ii.test(e)&&(o=1,e=e.replace(Ii,"")),t.shaderSource(a,e),t.compileShader(a);var u=t.getShaderParameter(a,ff);if(!u){var c=t.getShaderInfoLog(a);return i(sl(e,o)+`
*** Error compiling shader: `+c),t.deleteShader(a),null}return a}function Kn(t,e,r){var n,i;if(typeof t=="function")r=t,t=void 0;else if(t&&!Array.isArray(t)){if(t.errorCallback)return t;var a=t;r=a.errorCallback,t=a.attribLocations,n=a.transformFeedbackVaryings,i=a.transformFeedbackMode}var o={errorCallback:r||ma,transformFeedbackVaryings:n,transformFeedbackMode:i};if(t){var u={};Array.isArray(t)?t.forEach(function(c,f){u[c]=f}):u=t,o.attribLocations=u}return o}var za=["VERTEX_SHADER","FRAGMENT_SHADER"];function cl(t,e){if(e.indexOf("frag")>=0)return hf;if(e.indexOf("vert")>=0)return vf}function Ci(t,e){e.forEach(function(r){t.deleteShader(r)})}function fl(t,e,r,n,i){for(var a=Kn(r,n,i),o=[],u=[],c=0;c<e.length;++c){var f=e[c];if(typeof f=="string"){var h=pa(f),l=h?h.text:f,m=t[za[c]];h&&h.type&&(m=cl(t,h.type)||m),f=Ga(t,l,m,a.errorCallback),u.push(f)}Su(t,f)&&o.push(f)}if(o.length!==e.length)return a.errorCallback("not enough shaders for program"),Ci(t,u),null;var g=t.createProgram();o.forEach(function(x){t.attachShader(g,x)}),a.attribLocations&&Object.keys(a.attribLocations).forEach(function(x){t.bindAttribLocation(g,a.attribLocations[x],x)});var y=a.transformFeedbackVaryings;y&&(y.attribs&&(y=y.attribs),Array.isArray(y)||(y=Object.keys(y)),t.transformFeedbackVaryings(g,y,a.transformFeedbackMode||mf)),t.linkProgram(g);var _=t.getProgramParameter(g,lf);if(!_){var T=t.getProgramInfoLog(g);return a.errorCallback("Error in program linking:"+T),t.deleteProgram(g),Ci(t,u),null}return g}function ll(t,e,r,n,i){for(var a=Kn(r,n,i),o=[],u=0;u<e.length;++u){var c=Ga(t,e[u],t[za[u]],a.errorCallback);if(!c)return null;o.push(c)}return fl(t,o,a)}function Qn(t){var e=t.name;return e.startsWith("gl_")||e.startsWith("webgl_")}function hl(t,e){var r=0;function n(h,l,m){var g=l.size>1&&l.name.substr(-3)==="[0]",y=l.type,_=G[y];if(!_)throw new Error("unknown type: 0x".concat(y.toString(16)));var T;if(_.bindPoint){var x=r;r+=l.size,g?T=_.arraySetter(t,y,x,m,l.size):T=_.setter(t,y,x,m,l.size)}else _.arraySetter&&g?T=_.arraySetter(t,m):T=_.setter(t,m);return T.location=m,T}for(var i={},a=t.getProgramParameter(e,da),o=0;o<a;++o){var u=t.getActiveUniform(e,o);if(!Qn(u)){var c=u.name;c.substr(-3)==="[0]"&&(c=c.substr(0,c.length-3));var f=t.getUniformLocation(e,u.name);f&&(i[c]=n(e,u,f))}}return i}function vl(t,e){for(var r={},n=t.getProgramParameter(e,df),i=0;i<n;++i){var a=t.getTransformFeedbackVarying(e,i);r[a.name]={index:i,type:a.type,size:a.size}}return r}function ml(t,e){for(var r=t.getProgramParameter(e,da),n=[],i=[],a=0;a<r;++a){i.push(a),n.push({});var o=t.getActiveUniform(e,a);if(Qn(o))break;n[a].name=o.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(m){var g=m[0],y=m[1];t.getActiveUniforms(e,i,t[g]).forEach(function(_,T){n[T][y]=_})});for(var u={},c=t.getProgramParameter(e,yf),f=0;f<c;++f){var h=t.getActiveUniformBlockName(e,f),l={index:t.getUniformBlockIndex(e,h),usedByVertexShader:t.getActiveUniformBlockParameter(e,f,_f),usedByFragmentShader:t.getActiveUniformBlockParameter(e,f,gf),size:t.getActiveUniformBlockParameter(e,f,bf),uniformIndices:t.getActiveUniformBlockParameter(e,f,Tf)};l.used=l.usedByVertexShader||l.usedByFragmentShader,u[h]=l}return{blockSpecs:u,uniformData:n}}function Va(t,e){for(var r=t.uniformSetters||t,n=arguments.length,i=1;i<n;++i){var a=arguments[i];if(Array.isArray(a))for(var o=a.length,u=0;u<o;++u)Va(r,a[u]);else for(var c in a){var f=r[c];f&&f(a[c])}}}function pl(t,e){for(var r={},n=t.getProgramParameter(e,pf),i=0;i<n;++i){var a=t.getActiveAttrib(e,i);if(!Qn(a)){var o=t.getAttribLocation(e,a.name),u=J[a.type],c=u.setter(t,o,u);c.location=o,r[a.name]=c}}return r}function dl(t,e){for(var r in e){var n=t[r];n&&n(e[r])}}function yl(t,e,r){r.vertexArrayObject?t.bindVertexArray(r.vertexArrayObject):(dl(e.attribSetters||e,r.attribs),r.indices&&t.bindBuffer(cf,r.indices))}function _l(t,e){var r=hl(t,e),n=pl(t,e),i={program:e,uniformSetters:r,attribSetters:n};return Ye(t)&&(i.uniformBlockSpec=ml(t,e),i.transformFeedbackInfo=vl(t,e)),i}function gl(t,e,r,n,i){var a=Kn(r,n,i),o=!0;if(e=e.map(function(c){if(c.indexOf(`
`)<0){var f=pa(c);f?c=f.text:(a.errorCallback("no element with id: "+c),o=!1)}return c}),!o)return null;var u=ll(t,e,a);return u?_l(t,u):null}var bl=/^(.*?)_/;function Tl(t,e){an(t,0);var r=t.getExtension(e);if(r){var n={},i=bl.exec(e)[1],a="_"+i;for(var o in r){var u=r[o],c=typeof u=="function",f=c?i:a,h=o;o.endsWith(f)&&(h=o.substring(0,o.length-f.length)),t[h]!==void 0?!c&&t[h]!==u&&Ru(h,t[h],u,o):c?t[h]=function(l){return function(){return l.apply(r,arguments)}}(u):(t[h]=u,n[h]=u)}n.constructor={name:r.constructor.name},an(n,0)}return r}var Mi=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function ka(t){for(var e=0;e<Mi.length;++e)Tl(t,Mi[e])}function El(t,e){for(var r=["webgl","experimental-webgl"],n=null,i=0;i<r.length;++i)if(n=t.getContext(r[i],e),n){ka(n);break}return n}function xl(t,e){var r=El(t,e);return r}function ja(t,e){e=e||1,e=Math.max(0,e);var r=t.clientWidth*e|0,n=t.clientHeight*e|0;return t.width!==r||t.height!==n?(t.width=r,t.height=n,!0):!1}var Al=function(){function t(e,r){var n=this;Q(this,t),d(this,"gl",null),d(this,"isWebGL2",null),d(this,"instancedEnabled",!1),d(this,"init",function(){var i=n.gl;i.viewport(0,0,i.canvas.width,i.canvas.height),i.clearColor(0,0,0,1),i.enable(i.DEPTH_TEST),i.enable(i.CULL_FACE),i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA)}),d(this,"resize",function(i,a){n.gl.viewport(0,0,i,a)}),d(this,"prepareRenderFrame",function(){n.gl.clear(n.gl.COLOR_BUFFER_BIT|n.gl.DEPTH_BUFFER_BIT)}),this.gl=xl(e,r),this.isWebGL2=Ye(this.gl)&&ua(this.gl),ka(this.gl),this.gl.drawElementsInstanced&&(this.instancedEnabled=!0),ja(e)}return _e(t,[{key:"clearColor",set:function(r){this.gl.clearColor(r[0],r[1],r[2],r[3])}}]),t}(),vr=1e-6,le=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function wl(){var t=new le(9);return le!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Se(){var t=new le(16);return le!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Xa(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Il(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],a=e[6],o=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function rr(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],u=e[5],c=e[6],f=e[7],h=e[8],l=e[9],m=e[10],g=e[11],y=e[12],_=e[13],T=e[14],x=e[15],M=r*u-n*o,E=r*c-i*o,w=r*f-a*o,A=n*c-i*u,I=n*f-a*u,F=i*f-a*c,R=h*_-l*y,S=h*T-m*y,U=h*x-g*y,L=l*T-m*_,D=l*x-g*_,N=m*x-g*T,B=M*N-E*D+w*L+A*U-I*S+F*R;return B?(B=1/B,t[0]=(u*N-c*D+f*L)*B,t[1]=(i*D-n*N-a*L)*B,t[2]=(_*F-T*I+x*A)*B,t[3]=(m*I-l*F-g*A)*B,t[4]=(c*U-o*N-f*S)*B,t[5]=(r*N-i*U+a*S)*B,t[6]=(T*w-y*F-x*E)*B,t[7]=(h*F-m*w+g*E)*B,t[8]=(o*D-u*U+f*R)*B,t[9]=(n*U-r*D-a*R)*B,t[10]=(y*I-_*w+x*M)*B,t[11]=(l*w-h*I-g*M)*B,t[12]=(u*S-o*L-c*R)*B,t[13]=(r*L-n*S+i*R)*B,t[14]=(_*E-y*A-T*M)*B,t[15]=(h*A-l*E+m*M)*B,t):null}function Zr(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=e[4],c=e[5],f=e[6],h=e[7],l=e[8],m=e[9],g=e[10],y=e[11],_=e[12],T=e[13],x=e[14],M=e[15],E=r[0],w=r[1],A=r[2],I=r[3];return t[0]=E*n+w*u+A*l+I*_,t[1]=E*i+w*c+A*m+I*T,t[2]=E*a+w*f+A*g+I*x,t[3]=E*o+w*h+A*y+I*M,E=r[4],w=r[5],A=r[6],I=r[7],t[4]=E*n+w*u+A*l+I*_,t[5]=E*i+w*c+A*m+I*T,t[6]=E*a+w*f+A*g+I*x,t[7]=E*o+w*h+A*y+I*M,E=r[8],w=r[9],A=r[10],I=r[11],t[8]=E*n+w*u+A*l+I*_,t[9]=E*i+w*c+A*m+I*T,t[10]=E*a+w*f+A*g+I*x,t[11]=E*o+w*h+A*y+I*M,E=r[12],w=r[13],A=r[14],I=r[15],t[12]=E*n+w*u+A*l+I*_,t[13]=E*i+w*c+A*m+I*T,t[14]=E*a+w*f+A*g+I*x,t[15]=E*o+w*h+A*y+I*M,t}function Ri(t,e,r,n,i){var a=1/Math.tan(e/2),o;return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(n-i),t[10]=(i+n)*o,t[14]=2*i*n*o):(t[10]=-1,t[14]=-2*n),t}function Pi(t,e,r,n){var i,a,o,u,c,f,h,l,m,g,y=e[0],_=e[1],T=e[2],x=n[0],M=n[1],E=n[2],w=r[0],A=r[1],I=r[2];return Math.abs(y-w)<vr&&Math.abs(_-A)<vr&&Math.abs(T-I)<vr?Xa(t):(h=y-w,l=_-A,m=T-I,g=1/Math.hypot(h,l,m),h*=g,l*=g,m*=g,i=M*m-E*l,a=E*h-x*m,o=x*l-M*h,g=Math.hypot(i,a,o),g?(g=1/g,i*=g,a*=g,o*=g):(i=0,a=0,o=0),u=l*o-m*a,c=m*i-h*o,f=h*a-l*i,g=Math.hypot(u,c,f),g?(g=1/g,u*=g,c*=g,f*=g):(u=0,c=0,f=0),t[0]=i,t[1]=u,t[2]=h,t[3]=0,t[4]=a,t[5]=c,t[6]=l,t[7]=0,t[8]=o,t[9]=f,t[10]=m,t[11]=0,t[12]=-(i*y+a*_+o*T),t[13]=-(u*y+c*_+f*T),t[14]=-(h*y+l*_+m*T),t[15]=1,t)}function ft(){var t=new le(3);return le!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Cl(t){var e=new le(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ml(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function br(t,e,r){var n=new le(3);return n[0]=t,n[1]=e,n[2]=r,n}function Rl(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function Pl(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function Sl(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function Fl(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.hypot(r,n,i)}function Tt(t,e){var r=e[0],n=e[1],i=e[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function Ha(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Kr(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],u=r[1],c=r[2];return t[0]=i*c-a*u,t[1]=a*o-n*c,t[2]=n*u-i*o,t}function Si(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,t[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,t[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,t}var Dl=Ml;(function(){var t=ft();return function(e,r,n,i,a,o){var u,c;for(r||(r=3),n||(n=0),i?c=Math.min(i*r+n,e.length):c=e.length,u=n;u<c;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],a(t,t,o),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}})();function Nl(){var t=new le(4);return le!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Ol(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=r*o,t[1]=n*o,t[2]=i*o,t[3]=a*o,t}(function(){var t=Nl();return function(e,r,n,i,a,o){var u,c;for(r||(r=4),n||(n=0),i?c=Math.min(i*r+n,e.length):c=e.length,u=n;u<c;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],a(t,t,o),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}})();function Fi(){var t=new le(4);return le!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Bl(t,e,r){r=r*.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function Qr(t,e,r,n){var i=e[0],a=e[1],o=e[2],u=e[3],c=r[0],f=r[1],h=r[2],l=r[3],m,g,y,_,T;return g=i*c+a*f+o*h+u*l,g<0&&(g=-g,c=-c,f=-f,h=-h,l=-l),1-g>vr?(m=Math.acos(g),y=Math.sin(m),_=Math.sin((1-n)*m)/y,T=Math.sin(n*m)/y):(_=1-n,T=n),t[0]=_*i+T*c,t[1]=_*a+T*f,t[2]=_*o+T*h,t[3]=_*u+T*l,t}function Ul(t,e){var r=e[0]+e[4]+e[8],n;if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(e[i*3+i]-e[a*3+a]-e[o*3+o]+1),t[i]=.5*n,n=.5/n,t[3]=(e[a*3+o]-e[o*3+a])*n,t[a]=(e[a*3+i]+e[i*3+a])*n,t[o]=(e[o*3+i]+e[i*3+o])*n}return t}var Ya=Ol;(function(){var t=ft(),e=br(1,0,0),r=br(0,1,0);return function(n,i,a){var o=Ha(i,a);return o<-.999999?(Kr(t,e,i),Dl(t)<1e-6&&Kr(t,r,i),Tt(t,t),Bl(n,t,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Kr(t,i,a),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+o,Ya(n,n))}})();(function(){var t=Fi(),e=Fi();return function(r,n,i,a,o,u){return Qr(t,n,o,u),Qr(e,i,a,u),Qr(r,t,e,2*u*(1-u)),r}})();(function(){var t=wl();return function(e,r,n,i){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],Ya(e,Ul(e,t))}})();function Ll(){var t=new le(2);return le!=Float32Array&&(t[0]=0,t[1]=0),t}(function(){var t=Ll();return function(e,r,n,i,a,o){var u,c;for(r||(r=2),n||(n=0),i?c=Math.min(i*r+n,e.length):c=e.length,u=n;u<c;u+=r)t[0]=e[u],t[1]=e[u+1],a(t,t,o),e[u]=t[0],e[u+1]=t[1];return e}})();var Gl=function t(e,r){var n=this;Q(this,t),d(this,"fov",void 0),d(this,"width",void 0),d(this,"height",void 0),d(this,"aspect",void 0),d(this,"zNear",void 0),d(this,"zFar",void 0),d(this,"projection",void 0),d(this,"eye",void 0),d(this,"target",void 0),d(this,"up",void 0),d(this,"view",void 0),d(this,"viewProjection",void 0),d(this,"world",void 0),d(this,"resize",function(i,a){n.width=i,n.height=a,n.aspect=i/a,n.projection=Se(),Ri(n.projection,n.fov,n.aspect,n.zNear,n.zFar)}),d(this,"update",function(i){Pi(n.view,n.eye,n.target,n.up),rr(n.camera,n.view),Zr(n.viewProjection,n.projection,n.view)}),d(this,"setPosition",function(i){n.eye=i}),d(this,"getUniforms",function(i){var a={};return a.u_viewInverse=n.camera,a.u_world=n.world,a.u_worldInverseTranspose=Se(),a.u_view=n.view,a.u_resolution=[n.width,n.height],rr(a.u_worldInverseTranspose,n.world),Il(a.u_worldInverseTranspose,a.u_worldInverseTranspose),a.u_worldViewProjection=Se(),Zr(a.u_worldViewProjection,n.viewProjection,n.world),a.u_cameraPos=n.eye,a}),d(this,"getRayFromScreen",function(i,a){var o=i*2-1,u=a*2-1,c=n.unproject([o,u,-1]),f=n.unproject([o,u,1]),h=ft();return Pl(h,f,c),Tt(h,h),{origin:c,direction:h}}),d(this,"unproject",function(i){var a=Se();rr(a,n.viewProjection);var o=br(i[0],i[1],i[2]);return Si(o,o,a),o}),d(this,"project",function(i){var a=Cl(i);Si(a,a,n.viewProjection);var o=(a[0]+1)/2,u=(a[1]+1)/2;return[o,u]}),this.fov=30*(Math.PI/180),this.width=e,this.height=r,this.aspect=e/r,this.zNear=.01,this.zFar=100,this.projection=Se(),Ri(this.projection,this.fov,this.aspect,this.zNear,this.zFar),this.eye=[0,0,6],this.target=[0,0,0],this.up=[0,1,0],this.view=Se(),Pi(this.view,this.eye,this.target,this.up),this.camera=Se(),rr(this.camera,this.view),this.viewProjection=Se(),Zr(this.viewProjection,this.projection,this.view),this.world=Se(),Xa(this.world)},zl=function t(e,r){var n=this;Q(this,t),d(this,"resize",function(i,a){n.camera.resize(i,a)}),d(this,"update",function(i){n.camera.update(i)}),d(this,"getUniforms",function(i){var a=n.camera.getUniforms(i);return a.time=i,a}),this.camera=new Gl(e,r)},Vl=function(){function t(e){var r=this;Q(this,t),d(this,"programInfo",null),d(this,"textures",{}),d(this,"uniforms",null),d(this,"shaderStrings",null),d(this,"isInit",!1),d(this,"texturesLoaded",!1),d(this,"init",function(n){r.programInfo=gl(n,Object.values(r.shaderStrings)),r.isInit=!0}),d(this,"loadTextures",function(n,i,a){if(i){var o=Object.keys(i).length,u=0;Object.entries(i).forEach(function(c){var f=_i(c,2),h=f[0],l=f[1];r.textures[h]=sf(n,l,function(){u+=1,u===o&&(r.texturesLoaded=!0,a&&a())})})}}),d(this,"updateUniforms",function(n){Object.entries(n).forEach(function(i){var a=_i(i,2),o=a[0],u=a[1];r.uniforms[o]=u})}),this.shaderStrings=e}return _e(t,[{key:"isReady",get:function(){return this.isInit&&this.texturesLoaded}}]),t}();let k;const Fe=new Array(32).fill(void 0);Fe.push(void 0,null,!0,!1);function je(t){return Fe[t]}let ve=0,nr=null;function mr(){return(nr===null||nr.buffer!==k.memory.buffer)&&(nr=new Uint8Array(k.memory.buffer)),nr}let pr=new TextEncoder("utf-8");const kl=typeof pr.encodeInto=="function"?function(t,e){return pr.encodeInto(t,e)}:function(t,e){const r=pr.encode(t);return e.set(r),{read:t.length,written:r.length}};function Di(t,e,r){if(r===void 0){const u=pr.encode(t),c=e(u.length);return mr().subarray(c,c+u.length).set(u),ve=u.length,c}let n=t.length,i=e(n);const a=mr();let o=0;for(;o<n;o++){const u=t.charCodeAt(o);if(u>127)break;a[i+o]=u}if(o!==n){o!==0&&(t=t.slice(o)),i=r(i,n,n=o+t.length*3);const u=mr().subarray(i+o,i+n),c=kl(t,u);o+=c.written}return ve=o,i}let ir=null;function ar(){return(ir===null||ir.buffer!==k.memory.buffer)&&(ir=new Int32Array(k.memory.buffer)),ir}let Bt=Fe.length;function jl(t){t<36||(Fe[t]=Bt,Bt=t)}function Wa(t){const e=je(t);return jl(t),e}let $a=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});$a.decode();function or(t,e){return $a.decode(mr().subarray(t,t+e))}function Jr(t){Bt===Fe.length&&Fe.push(Fe.length+1);const e=Bt;return Bt=Fe[e],Fe[e]=t,e}function Xl(){k.init_gkweb()}let ur=null;function Hl(){return(ur===null||ur.buffer!==k.memory.buffer)&&(ur=new Float32Array(k.memory.buffer)),ur}function dt(t,e){const r=e(t.length*4);return Hl().set(t,r/4),ve=t.length,r}let sr=null;function Yl(){return(sr===null||sr.buffer!==k.memory.buffer)&&(sr=new Uint32Array(k.memory.buffer)),sr}function Wl(t,e){const r=e(t.length*4);return Yl().set(t,r/4),ve=t.length,r}class $l{free(){const e=this.ptr;this.ptr=0,k.__wbg_gkcollider_free(e)}static create_collision_geometry(e,r,n){var i=dt(e,k.__wbindgen_malloc),a=ve,o=dt(r,k.__wbindgen_malloc),u=ve,c=Wl(n,k.__wbindgen_malloc),f=ve,h=k.gkcollider_create_collision_geometry(i,a,o,u,c,f);return Jn.__wrap(h)}}class ql{free(){const e=this.ptr;this.ptr=0,k.__wbg_gkcollision_free(e)}}class Jn{static __wrap(e){const r=Object.create(Jn.prototype);return r.ptr=e,r}free(){const e=this.ptr;this.ptr=0,k.__wbg_gkcollisiongeo_free(e)}raycast(e,r){var n=dt(e,k.__wbindgen_malloc),i=ve,a=dt(r,k.__wbindgen_malloc),o=ve,u=k.gkcollisiongeo_raycast(this.ptr,n,i,a,o);return Wa(u)}hitTest(e,r){var n=dt(e,k.__wbindgen_malloc),i=ve,a=dt(r,k.__wbindgen_malloc),o=ve,u=k.gkcollisiongeo_hitTest(this.ptr,n,i,a,o);return u!==0}}async function Zl(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(n){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n);else throw n}const r=await t.arrayBuffer();return await WebAssembly.instantiate(r,e)}else{const r=await WebAssembly.instantiate(t,e);return r instanceof WebAssembly.Instance?{instance:r,module:t}:r}}async function qa(t){typeof t>"u"&&console.log("You must specify wasm location");const e={};e.wbg={},e.wbg.__wbindgen_json_serialize=function(i,a){const o=je(a);var u=JSON.stringify(o===void 0?null:o),c=Di(u,k.__wbindgen_malloc,k.__wbindgen_realloc),f=ve;ar()[i/4+1]=f,ar()[i/4+0]=c},e.wbg.__wbindgen_object_drop_ref=function(i){Wa(i)},e.wbg.__wbindgen_json_parse=function(i,a){var o=JSON.parse(or(i,a));return Jr(o)},e.wbg.__wbindgen_string_new=function(i,a){var o=or(i,a);return Jr(o)},e.wbg.__wbg_new_59cb74e423758ede=function(){var i=new Error;return Jr(i)},e.wbg.__wbg_stack_558ba5917b466edd=function(i,a){var o=je(a).stack,u=Di(o,k.__wbindgen_malloc,k.__wbindgen_realloc),c=ve;ar()[i/4+1]=c,ar()[i/4+0]=u},e.wbg.__wbg_error_4bb6c2a97407129a=function(i,a){try{console.error(or(i,a))}finally{k.__wbindgen_free(i,a)}},e.wbg.__wbg_debug_7020dcb48edf105b=function(i){console.debug(je(i))},e.wbg.__wbg_error_b23efba5bfb5cec5=function(i){console.error(je(i))},e.wbg.__wbg_info_8ce99578d0b91a35=function(i){console.info(je(i))},e.wbg.__wbg_log_c180b836187d3c94=function(i){console.log(je(i))},e.wbg.__wbg_warn_942f927afebcc748=function(i){console.warn(je(i))},e.wbg.__wbindgen_throw=function(i,a){throw new Error(or(i,a))},(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:r,module:n}=await Zl(await t,e);return k=r.exports,qa.__wbindgen_wasm_module=n,k}var Za=function(){function t(){var e=this;Q(this,t),d(this,"id",null),d(this,"geometry",null),d(this,"collisionGeometry",null),d(this,"material",null),d(this,"_translation",[0,0,0]),d(this,"_rotation",[0,0,0]),d(this,"_scale",[1,1,1]),d(this,"_modelMatrix",null),d(this,"_modelIsDirty",!0),d(this,"rayCast",!0),d(this,"isInteractive",!1),d(this,"isSelectable",!1),d(this,"isHoverable",!1),d(this,"shouldDraw",!0),d(this,"setInteractive",function(r,n,i){e.isInteractive=typeof r=="boolean"?r:!1,e.isSelectable=typeof n=="boolean"?n:!1,e.isHoverable=typeof i=="boolean"?i:!1}),this.id="_"+Math.random().toString(36).substr(2,9)}return _e(t,[{key:"update",value:function(r){var n=this;r&&Object.entries(r).forEach(function(i){n.material.uniforms[i[0]]=i[1]})}},{key:"isReady",get:function(){return this.geometry&&this.material?this.geometry.isReady&&this.material.isReady:!1}},{key:"translation",get:function(){return this._translation},set:function(r){this._translation=r,this._modelIsDirty=!0}},{key:"rotation",get:function(){return this._rotation},set:function(r){this._rotation=r,this._modelIsDirty=!0}},{key:"scale",get:function(){return this._scale},set:function(r){this._scale=r,this._modelIsDirty=!0}},{key:"modelMatrix",get:function(){if(this._modelIsDirty){var r=nt.identity(),n=nt.translation(this._translation,r),i=nt.scaling(this._scale);this._modelMatrix=n,nt.rotateX(n,this._rotation[0],this._modelMatrix),nt.rotateY(n,this._rotation[1],this._modelMatrix),nt.rotateZ(n,this._rotation[2],this._modelMatrix),nt.multiply(this._modelMatrix,i,this._modelMatrix),this._modelIsDirty=!1}return this._modelMatrix}}]),t}(),Ka=function(t){Li(r,t);var e=Gi(r);function r(){return Q(this,r),e.apply(this,arguments)}return r}(Za),Ni=128,Kl=function(){function t(e){var r=this;Q(this,t),d(this,"isInit",!1),d(this,"isDirty",!1),d(this,"needsResize",!1),d(this,"newGeometry",[]),d(this,"bufferInfo",void 0),d(this,"vertices",void 0),d(this,"init",function(n){Object.keys(r.vertices).length===0&&r.vertices.constructor===Object||(r.bufferInfo=rn(n,r.vertices),r.isInit=!0,r.isDirty=!1)}),d(this,"resizeVertices",function(n){}),d(this,"updateGeometry",function(n,i,a){(i===void 0||typeof i!="number")&&(i=0),console.log("Update geo",n),Object.keys(n).forEach(function(o){var u;(u=r.vertices[o].data).splice.apply(u,[i,n[o].data.length].concat(de(n[o].data)))}),r.isDirty=!0}),d(this,"updateBuffers",function(n){Object.keys(r.bufferInfo.attribs).forEach(function(i){Yu(n,r.bufferInfo.attribs[i],r.vertices[i])}),r.isDirty=!1}),d(this,"reloadBuffers",function(n){r.deleteBuffers(n),r.bufferInfo=rn(n,r.vertices),r.isDirty=!1,r.needsResize=!1}),d(this,"deleteBuffers",function(n){Object.keys(r.bufferInfo.attribs).forEach(function(i){n.deleteBuffer(i.buffer)}),n.deleteBuffer(r.bufferInfo.indices),r.bufferInfo={}}),e==="sphere"?this.vertices=Ps.createSphereVertices(1,Ni,Ni):this.vertices={}}return _e(t,[{key:"isReady",get:function(){return this.isInit}}]),t}(),Xe=function(){function t(){Q(this,t)}return _e(t,null,[{key:"radiansForPosition",value:function(r,n){return n>0?r>=0?Math.atan(r/n):2*Math.PI+Math.atan(r/n):n<0?Math.PI+Math.atan(r/n):r>0?Math.PI/2:3*Math.PI/2}},{key:"latLonFromWorld",value:function(r){var n=ft();Tt(n,r);for(var i=Math.asin(n[1]),a=this.radiansForPosition(n[0],n[2]),o=i*180/Math.PI,u=a*180/Math.PI;u>180;)u-=360;return{lat:o,lon:u}}},{key:"distanceBetweenPoints",value:function(r,n){var i=function(y){return y*(Math.PI/180)},a=6371,o=i(r.lat),u=i(n.lat),c=i(n.lat-r.lat),f=i(n.lon-r.lon),h=Math.sin(c/2)*Math.sin(c/2)+Math.cos(o)*Math.cos(u)*Math.sin(f/2)*Math.sin(f/2),l=2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),m=a*l;return m}},{key:"worldFromLatLon",value:function(r,n,i){var a=i||0,o=r*Math.PI/180,u=n*Math.PI/180,c=Math.cos(o),f=Math.sin(o),h=Math.sin(u)*c,l=Math.cos(u)*c,m=br(h,f,l),g=ft();Tt(g,m);var y=Sl(g,g,a);return Rl(m,m,y),m}},{key:"hexToRGB",value:function(r,n){var i=0,a=0,o=0,u=n!==!1;return r.length===4?(i="0x".concat(r[1]).concat(r[1]),a="0x".concat(r[2]).concat(r[2]),o="0x".concat(r[3]).concat(r[3])):r.length===7&&(i="0x".concat(r[1]).concat(r[2]),a="0x".concat(r[3]).concat(r[4]),o="0x".concat(r[5]).concat(r[6])),u?(i/=255,a/=255,o/=255):(i=parseInt(i,16),a=parseInt(a,16),o=parseInt(o,16)),[i,a,o]}},{key:"hexToRGBA",value:function(r,n,i){var a=this.hexToRGB(r,i),o=i!==!1?n:n*255;return[a[0],a[1],a[2],o]}},{key:"isSubSet",value:function(r,n){return r.every(function(i){return n.find(function(a){return a===i})!==void 0})}},{key:"lerpColor",value:function(r,n,i){var a=parseInt(r.replace(/#/g,""),16),o=a>>16,u=a>>8&255,c=a&255,f=parseInt(n.replace(/#/g,""),16),h=f>>16,l=f>>8&255,m=f&255,g=o+i*(h-o),y=u+i*(l-u),_=c+i*(m-c);return"#".concat(((1<<24)+(g<<16)+(y<<8)+_|0).toString(16).slice(1))}}]),t}(),Ql=function t(e,r){var n=this;Q(this,t),d(this,"isLoaded",!1),d(this,"ctx",void 0),d(this,"canvas",void 0),d(this,"image",void 0),d(this,"getIdFromLatLon",function(i,a){if(n.isLoaded){var o=(a/180+1)/2,u=1-(i/90+1)/2,c=o*n.canvas.width,f=u*n.canvas.height;return n.ctx.getImageData(c,f,1,1).data[0]}}),this.image=new Image,this.image.src=e,this.image.addEventListener("load",function(){n.canvas=document.createElement("canvas"),n.canvas.width=n.image.width,n.canvas.height=n.image.height,n.ctx=n.canvas.getContext("2d"),n.ctx.drawImage(n.image,0,0),n.isLoaded=!0,r()})},Jl=function t(e,r){var n=this;Q(this,t),d(this,"isInit",!1),d(this,"useImageLookup",!1),d(this,"imageLookup",null),d(this,"getIdFromLatLon",function(i,a){return n.imageLookup.getIdFromLatLon(i,a)}),d(this,"getFromId",function(i){return n.data.find(function(a){return a.id===i})}),d(this,"getFromCode",function(i){return n.data.find(function(a){return a.code===i})}),d(this,"getFromName",function(i){return n.data.find(function(a){return a.name===i})}),e instanceof Array&&(this.data=e,r&&(this.useImageLookup=!0,this.imageLookup=new Ql(r,function(){n.isInit=!0})))},ne=function(){function t(e,r,n,i){var a=this;Q(this,t),d(this,"time",void 0),d(this,"delay",0),d(this,"ease",function(o){return o}),d(this,"onComplete",function(o){}),d(this,"onUpdate",function(o){}),d(this,"endAt",void 0),d(this,"isNumeric",!1),d(this,"toObj",null),d(this,"fromObj",null),d(this,"currentObj",null),d(this,"mechanism",function(){if(a.isRunning){if(a.stopped)return!1;var o=a.endAt-new Date().getTime();o<=0?(clearTimeout(a.playTimeout),a.stopped=!0,a.advanceFrame(1,1),a.isNumeric?a.onUpdate(a.currentObj.value):a.onUpdate(a.currentObj),a.onComplete(!0),a.cleanup()):(a.advanceFrame(a.time-o,a.time),a.isNumeric?a.onUpdate(a.currentObj.value):a.onUpdate(a.currentObj))}}),i=i||{},this.time=n,this.endAt=new Date().getTime()+this.time,this.isNumeric=!isNaN(e),this.isNumeric?(this.toObj={value:r},this.fromObj={value:e}):(this.toObj=Hr({},r),this.fromObj=Hr({},e)),this.currentObj=Hr({},this.fromObj),this.id=t.getId(),t.tweens[this.id]=this,i.onComplete&&(this.onComplete=i.onComplete,delete i.onComplete),i.onUpdate&&(this.onUpdate=i.onUpdate,delete i.onUpdate),i.ease&&(this.ease=i.ease,delete i.ease),i.delay&&(this.endAt+=i.delay,this.delay=i.delay,delete i.delay),this.playTimeout=setTimeout(function(){a.play()},this.delay)}return _e(t,[{key:"play",value:function(){this.endAt=new Date().getTime()+this.time,this.isRunning=!0,t.isRunning||(t.isRunning=!0,requestAnimationFrame(t.mechanism))}},{key:"stop",value:function(){clearTimeout(this.playTimeout),this.stopped=!0,this.onComplete(!1),this.cleanup()}},{key:"currentValue",value:function(){return this.isNumeric?this.currentObj.value:this.currentObj}},{key:"cleanup",value:function(){this.isRunning=!1,delete t.tweens[this.id],Object.keys(t.tweens).length===0&&(t.isRunning=!1)}},{key:"advanceFrame",value:function(r,n){var i=n!==0?r/n:1;i=this.ease(i);for(var a in this.toObj){var o=this.fromObj[a],u=this.toObj[a],c=u-o;this.currentObj[a]=o+c*i}}}]),t}();ne.id=0;ne.tweens={};ne.killTweensOf=function(t){for(var e in ne.tweens){var r=ne.tweens[e];r.obj===t&&r.stop()}};ne.getId=function(){return++ne.id};ne.isRunning=!1;ne.mechanism=function(){for(var t in ne.tweens)ne.tweens[t].mechanism();ne.isRunning&&requestAnimationFrame(ne.mechanism)};var e0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qa(t,e){return e={exports:{}},t(e,e.exports),e.exports}Qa(function(t){/*! Hammer.JS - v2.0.8 - 2016-04-23
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(e,r,n,i){function a(p,s,v){return setTimeout(h(p,v),s)}function o(p,s,v){return Array.isArray(p)?(u(p,v[s],v),!0):!1}function u(p,s,v){var b;if(p)if(p.forEach)p.forEach(s,v);else if(p.length!==i)for(b=0;b<p.length;)s.call(v,p[b],b,p),b++;else for(b in p)p.hasOwnProperty(b)&&s.call(v,p[b],b,p)}function c(p,s,v){var b="DEPRECATED METHOD: "+s+`
`+v+` AT 
`;return function(){var C=new Error("get-stack-trace"),P=C&&C.stack?C.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",O=e.console&&(e.console.warn||e.console.log);return O&&O.call(e.console,b,P),p.apply(this,arguments)}}function f(p,s,v){var b,C=s.prototype;b=p.prototype=Object.create(C),b.constructor=p,b._super=C,v&&Me(b,v)}function h(p,s){return function(){return p.apply(s,arguments)}}function l(p,s){return fr(p)==lo?p.apply(s&&s[0]||i,s):p}function m(p,s){return p===i?s:p}function g(p,s,v){u(x(s),function(b){p.addEventListener(b,v,!1)})}function y(p,s,v){u(x(s),function(b){p.removeEventListener(b,v,!1)})}function _(p,s){for(;p;){if(p==s)return!0;p=p.parentNode}return!1}function T(p,s){return p.indexOf(s)>-1}function x(p){return p.trim().split(/\s+/g)}function M(p,s,v){if(p.indexOf&&!v)return p.indexOf(s);for(var b=0;b<p.length;){if(v&&p[b][v]==s||!v&&p[b]===s)return b;b++}return-1}function E(p){return Array.prototype.slice.call(p,0)}function w(p,s,v){for(var b=[],C=[],P=0;P<p.length;){var O=p[P][s];M(C,O)<0&&b.push(p[P]),C[P]=O,P++}return b=b.sort(function($,te){return $[s]>te[s]}),b}function A(p,s){for(var v,b,C=s[0].toUpperCase()+s.slice(1),P=0;P<ni.length;){if(v=ni[P],b=v?v+C:s,b in p)return b;P++}return i}function I(){return vo++}function F(p){var s=p.ownerDocument||p;return s.defaultView||s.parentWindow||e}function R(p,s){var v=this;this.manager=p,this.callback=s,this.element=p.element,this.target=p.options.inputTarget,this.domHandler=function(b){l(p.options.enable,[p])&&v.handler(b)},this.init()}function S(p){var s=p.options.inputClass;return new(s||(po?Ue:yo?Ke:ai?ht:Ie))(p,U)}function U(p,s,v){var b=v.pointers.length,C=v.changedPointers.length,P=s&oe&&b-C===0,O=s&(K|fe)&&b-C===0;v.isFirst=!!P,v.isFinal=!!O,P&&(p.session={}),v.eventType=s,L(p,v),p.emit("hammer.input",v),p.recognize(v),p.session.prevInput=v}function L(p,s){var v=p.session,b=s.pointers,C=b.length;v.firstInput||(v.firstInput=B(s)),C>1&&!v.firstMultiple?v.firstMultiple=B(s):C===1&&(v.firstMultiple=!1);var P=v.firstInput,O=v.firstMultiple,$=O?O.center:P.center,te=s.center=j(b);s.timeStamp=kr(),s.deltaTime=s.timeStamp-P.timeStamp,s.angle=Te($,te),s.distance=Z($,te),D(v,s),s.offsetDirection=q(s.deltaX,s.deltaY);var he=W(s.deltaTime,s.deltaX,s.deltaY);s.overallVelocityX=he.x,s.overallVelocityY=he.y,s.overallVelocity=Qe(he.x)>Qe(he.y)?he.x:he.y,s.scale=O?Be(O.pointers,b):1,s.rotation=O?Oe(O.pointers,b):0,s.maxPointers=v.prevInput?s.pointers.length>v.prevInput.maxPointers?s.pointers.length:v.prevInput.maxPointers:s.pointers.length,N(v,s);var pe=p.element;_(s.srcEvent.target,pe)&&(pe=s.srcEvent.target),s.target=pe}function D(p,s){var v=s.center,b=p.offsetDelta||{},C=p.prevDelta||{},P=p.prevInput||{};s.eventType!==oe&&P.eventType!==K||(C=p.prevDelta={x:P.deltaX||0,y:P.deltaY||0},b=p.offsetDelta={x:v.x,y:v.y}),s.deltaX=C.x+(v.x-b.x),s.deltaY=C.y+(v.y-b.y)}function N(p,s){var v,b,C,P,O=p.lastInterval||s,$=s.timeStamp-O.timeStamp;if(s.eventType!=fe&&($>bo||O.velocity===i)){var te=s.deltaX-O.deltaX,he=s.deltaY-O.deltaY,pe=W($,te,he);b=pe.x,C=pe.y,v=Qe(pe.x)>Qe(pe.y)?pe.x:pe.y,P=q(te,he),p.lastInterval=s}else v=O.velocity,b=O.velocityX,C=O.velocityY,P=O.direction;s.velocity=v,s.velocityX=b,s.velocityY=C,s.direction=P}function B(p){for(var s=[],v=0;v<p.pointers.length;)s[v]={clientX:vt(p.pointers[v].clientX),clientY:vt(p.pointers[v].clientY)},v++;return{timeStamp:kr(),pointers:s,center:j(s),deltaX:p.deltaX,deltaY:p.deltaY}}function j(p){var s=p.length;if(s===1)return{x:vt(p[0].clientX),y:vt(p[0].clientY)};for(var v=0,b=0,C=0;s>C;)v+=p[C].clientX,b+=p[C].clientY,C++;return{x:vt(v/s),y:vt(b/s)}}function W(p,s,v){return{x:s/p||0,y:v/p||0}}function q(p,s){return p===s?qt:Qe(p)>=Qe(s)?0>p?wt:It:0>s?Ct:Mt}function Z(p,s,v){v||(v=ui);var b=s[v[0]]-p[v[0]],C=s[v[1]]-p[v[1]];return Math.sqrt(b*b+C*C)}function Te(p,s,v){v||(v=ui);var b=s[v[0]]-p[v[0]],C=s[v[1]]-p[v[1]];return 180*Math.atan2(C,b)/Math.PI}function Oe(p,s){return Te(s[1],s[0],Zt)+Te(p[1],p[0],Zt)}function Be(p,s){return Z(s[0],s[1],Zt)/Z(p[0],p[1],Zt)}function Ie(){this.evEl=Eo,this.evWin=xo,this.pressed=!1,R.apply(this,arguments)}function Ue(){this.evEl=si,this.evWin=ci,R.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function Ze(){this.evTarget=Co,this.evWin=Mo,this.started=!1,R.apply(this,arguments)}function lt(p,s){var v=E(p.touches),b=E(p.changedTouches);return s&(K|fe)&&(v=w(v.concat(b),"identifier")),[v,b]}function Ke(){this.evTarget=Po,this.targetIds={},R.apply(this,arguments)}function Xt(p,s){var v=E(p.touches),b=this.targetIds;if(s&(oe|Je)&&v.length===1)return b[v[0].identifier]=!0,[v,v];var C,P,O=E(p.changedTouches),$=[],te=this.target;if(P=v.filter(function(he){return _(he.target,te)}),s===oe)for(C=0;C<P.length;)b[P[C].identifier]=!0,C++;for(C=0;C<O.length;)b[O[C].identifier]&&$.push(O[C]),s&(K|fe)&&delete b[O[C].identifier],C++;return $.length?[w(P.concat($),"identifier"),$]:void 0}function ht(){R.apply(this,arguments);var p=h(this.handler,this);this.touch=new Ke(this.manager,p),this.mouse=new Ie(this.manager,p),this.primaryTouch=null,this.lastTouches=[]}function Ht(p,s){p&oe?(this.primaryTouch=s.changedPointers[0].identifier,ee.call(this,s)):p&(K|fe)&&ee.call(this,s)}function ee(p){var s=p.changedPointers[0];if(s.identifier===this.primaryTouch){var v={x:s.clientX,y:s.clientY};this.lastTouches.push(v);var b=this.lastTouches,C=function(){var O=b.indexOf(v);O>-1&&b.splice(O,1)};setTimeout(C,So)}}function oo(p){for(var s=p.srcEvent.clientX,v=p.srcEvent.clientY,b=0;b<this.lastTouches.length;b++){var C=this.lastTouches[b],P=Math.abs(s-C.x),O=Math.abs(v-C.y);if(fi>=P&&fi>=O)return!0}return!1}function Br(p,s){this.manager=p,this.set(s)}function uo(p){if(T(p,tt))return tt;var s=T(p,Rt),v=T(p,Pt);return s&&v?tt:s||v?s?Rt:Pt:T(p,Xr)?Xr:mi}function so(){if(!hi)return!1;var p={},s=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(v){p[v]=s?e.CSS.supports("touch-action",v):!0}),p}function Ce(p){this.options=Me({},this.defaults,p||{}),this.id=I(),this.manager=null,this.options.enable=m(this.options.enable,!0),this.state=Qt,this.simultaneous={},this.requireFail=[]}function ei(p){return p&St?"cancel":p&Ge?"end":p&mt?"move":p&me?"start":""}function ti(p){return p==Mt?"down":p==Ct?"up":p==wt?"left":p==It?"right":""}function Yt(p,s){var v=s.manager;return v?v.get(p):p}function ge(){Ce.apply(this,arguments)}function Wt(){ge.apply(this,arguments),this.pX=null,this.pY=null}function Ur(){ge.apply(this,arguments)}function Lr(){Ce.apply(this,arguments),this._timer=null,this._input=null}function Gr(){ge.apply(this,arguments)}function zr(){ge.apply(this,arguments)}function $t(){Ce.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Le(p,s){return s=s||{},s.recognizers=m(s.recognizers,Le.defaults.preset),new Vr(p,s)}function Vr(p,s){this.options=Me({},Le.defaults,s||{}),this.options.inputTarget=this.options.inputTarget||p,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=p,this.input=S(this),this.touchAction=new Br(this,this.options.touchAction),ri(this,!0),u(this.options.recognizers,function(v){var b=this.add(new v[0](v[1]));v[2]&&b.recognizeWith(v[2]),v[3]&&b.requireFailure(v[3])},this)}function ri(p,s){var v=p.element;if(v.style){var b;u(p.options.cssProps,function(C,P){b=A(v.style,P),s?(p.oldCssProps[b]=v.style[b],v.style[b]=C):v.style[b]=p.oldCssProps[b]||""}),s||(p.oldCssProps={})}}function co(p,s){var v=r.createEvent("Event");v.initEvent(p,!0,!0),v.gesture=s,s.target.dispatchEvent(v)}var Me,ni=["","webkit","Moz","MS","ms","o"],fo=r.createElement("div"),lo="function",vt=Math.round,Qe=Math.abs,kr=Date.now;Me=typeof Object.assign!="function"?function(p){if(p===i||p===null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(p),v=1;v<arguments.length;v++){var b=arguments[v];if(b!==i&&b!==null)for(var C in b)b.hasOwnProperty(C)&&(s[C]=b[C])}return s}:Object.assign;var ii=c(function(p,s,v){for(var b=Object.keys(s),C=0;C<b.length;)(!v||v&&p[b[C]]===i)&&(p[b[C]]=s[b[C]]),C++;return p},"extend","Use `assign`."),ho=c(function(p,s){return ii(p,s,!0)},"merge","Use `assign`."),vo=1,mo=/mobile|tablet|ip(ad|hone|od)|android/i,ai="ontouchstart"in e,po=A(e,"PointerEvent")!==i,yo=ai&&mo.test(navigator.userAgent),At="touch",_o="pen",jr="mouse",go="kinect",bo=25,oe=1,Je=2,K=4,fe=8,qt=1,wt=2,It=4,Ct=8,Mt=16,Ee=wt|It,et=Ct|Mt,oi=Ee|et,ui=["x","y"],Zt=["clientX","clientY"];R.prototype={handler:function(){},init:function(){this.evEl&&g(this.element,this.evEl,this.domHandler),this.evTarget&&g(this.target,this.evTarget,this.domHandler),this.evWin&&g(F(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&y(this.element,this.evEl,this.domHandler),this.evTarget&&y(this.target,this.evTarget,this.domHandler),this.evWin&&y(F(this.element),this.evWin,this.domHandler)}};var To={mousedown:oe,mousemove:Je,mouseup:K},Eo="mousedown",xo="mousemove mouseup";f(Ie,R,{handler:function(s){var v=To[s.type];v&oe&&s.button===0&&(this.pressed=!0),v&Je&&s.which!==1&&(v=K),this.pressed&&(v&K&&(this.pressed=!1),this.callback(this.manager,v,{pointers:[s],changedPointers:[s],pointerType:jr,srcEvent:s}))}});var Ao={pointerdown:oe,pointermove:Je,pointerup:K,pointercancel:fe,pointerout:fe},wo={2:At,3:_o,4:jr,5:go},si="pointerdown",ci="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(si="MSPointerDown",ci="MSPointerMove MSPointerUp MSPointerCancel"),f(Ue,R,{handler:function(s){var v=this.store,b=!1,C=s.type.toLowerCase().replace("ms",""),P=Ao[C],O=wo[s.pointerType]||s.pointerType,$=O==At,te=M(v,s.pointerId,"pointerId");P&oe&&(s.button===0||$)?0>te&&(v.push(s),te=v.length-1):P&(K|fe)&&(b=!0),0>te||(v[te]=s,this.callback(this.manager,P,{pointers:v,changedPointers:[s],pointerType:O,srcEvent:s}),b&&v.splice(te,1))}});var Io={touchstart:oe,touchmove:Je,touchend:K,touchcancel:fe},Co="touchstart",Mo="touchstart touchmove touchend touchcancel";f(Ze,R,{handler:function(s){var v=Io[s.type];if(v===oe&&(this.started=!0),this.started){var b=lt.call(this,s,v);v&(K|fe)&&b[0].length-b[1].length===0&&(this.started=!1),this.callback(this.manager,v,{pointers:b[0],changedPointers:b[1],pointerType:At,srcEvent:s})}}});var Ro={touchstart:oe,touchmove:Je,touchend:K,touchcancel:fe},Po="touchstart touchmove touchend touchcancel";f(Ke,R,{handler:function(s){var v=Ro[s.type],b=Xt.call(this,s,v);b&&this.callback(this.manager,v,{pointers:b[0],changedPointers:b[1],pointerType:At,srcEvent:s})}});var So=2500,fi=25;f(ht,R,{handler:function(s,v,b){var C=b.pointerType==At,P=b.pointerType==jr;if(!(P&&b.sourceCapabilities&&b.sourceCapabilities.firesTouchEvents)){if(C)Ht.call(this,v,b);else if(P&&oo.call(this,b))return;this.callback(s,v,b)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var li=A(fo.style,"touchAction"),hi=li!==i,vi="compute",mi="auto",Xr="manipulation",tt="none",Rt="pan-x",Pt="pan-y",Kt=so();Br.prototype={set:function(s){s==vi&&(s=this.compute()),hi&&this.manager.element.style&&Kt[s]&&(this.manager.element.style[li]=s),this.actions=s.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var s=[];return u(this.manager.recognizers,function(v){l(v.options.enable,[v])&&(s=s.concat(v.getTouchAction()))}),uo(s.join(" "))},preventDefaults:function(s){var v=s.srcEvent,b=s.offsetDirection;if(this.manager.session.prevented)return void v.preventDefault();var C=this.actions,P=T(C,tt)&&!Kt[tt],O=T(C,Pt)&&!Kt[Pt],$=T(C,Rt)&&!Kt[Rt];if(P){var te=s.pointers.length===1,he=s.distance<2,pe=s.deltaTime<250;if(te&&he&&pe)return}return $&&O?void 0:P||O&&b&Ee||$&&b&et?this.preventSrc(v):void 0},preventSrc:function(s){this.manager.session.prevented=!0,s.preventDefault()}};var Qt=1,me=2,mt=4,Ge=8,Re=Ge,St=16,xe=32;Ce.prototype={defaults:{},set:function(s){return Me(this.options,s),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(s){if(o(s,"recognizeWith",this))return this;var v=this.simultaneous;return s=Yt(s,this),v[s.id]||(v[s.id]=s,s.recognizeWith(this)),this},dropRecognizeWith:function(s){return o(s,"dropRecognizeWith",this)?this:(s=Yt(s,this),delete this.simultaneous[s.id],this)},requireFailure:function(s){if(o(s,"requireFailure",this))return this;var v=this.requireFail;return s=Yt(s,this),M(v,s)===-1&&(v.push(s),s.requireFailure(this)),this},dropRequireFailure:function(s){if(o(s,"dropRequireFailure",this))return this;s=Yt(s,this);var v=M(this.requireFail,s);return v>-1&&this.requireFail.splice(v,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(s){return!!this.simultaneous[s.id]},emit:function(s){function v(P){b.manager.emit(P,s)}var b=this,C=this.state;Ge>C&&v(b.options.event+ei(C)),v(b.options.event),s.additionalEvent&&v(s.additionalEvent),C>=Ge&&v(b.options.event+ei(C))},tryEmit:function(s){return this.canEmit()?this.emit(s):void(this.state=xe)},canEmit:function(){for(var s=0;s<this.requireFail.length;){if(!(this.requireFail[s].state&(xe|Qt)))return!1;s++}return!0},recognize:function(s){var v=Me({},s);return l(this.options.enable,[this,v])?(this.state&(Re|St|xe)&&(this.state=Qt),this.state=this.process(v),void(this.state&(me|mt|Ge|St)&&this.tryEmit(v))):(this.reset(),void(this.state=xe))},process:function(s){},getTouchAction:function(){},reset:function(){}},f(ge,Ce,{defaults:{pointers:1},attrTest:function(s){var v=this.options.pointers;return v===0||s.pointers.length===v},process:function(s){var v=this.state,b=s.eventType,C=v&(me|mt),P=this.attrTest(s);return C&&(b&fe||!P)?v|St:C||P?b&K?v|Ge:v&me?v|mt:me:xe}}),f(Wt,ge,{defaults:{event:"pan",threshold:10,pointers:1,direction:oi},getTouchAction:function(){var s=this.options.direction,v=[];return s&Ee&&v.push(Pt),s&et&&v.push(Rt),v},directionTest:function(s){var v=this.options,b=!0,C=s.distance,P=s.direction,O=s.deltaX,$=s.deltaY;return P&v.direction||(v.direction&Ee?(P=O===0?qt:0>O?wt:It,b=O!=this.pX,C=Math.abs(s.deltaX)):(P=$===0?qt:0>$?Ct:Mt,b=$!=this.pY,C=Math.abs(s.deltaY))),s.direction=P,b&&C>v.threshold&&P&v.direction},attrTest:function(s){return ge.prototype.attrTest.call(this,s)&&(this.state&me||!(this.state&me)&&this.directionTest(s))},emit:function(s){this.pX=s.deltaX,this.pY=s.deltaY;var v=ti(s.direction);v&&(s.additionalEvent=this.options.event+v),this._super.emit.call(this,s)}}),f(Ur,ge,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[tt]},attrTest:function(s){return this._super.attrTest.call(this,s)&&(Math.abs(s.scale-1)>this.options.threshold||this.state&me)},emit:function(s){if(s.scale!==1){var v=s.scale<1?"in":"out";s.additionalEvent=this.options.event+v}this._super.emit.call(this,s)}}),f(Lr,Ce,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[mi]},process:function(s){var v=this.options,b=s.pointers.length===v.pointers,C=s.distance<v.threshold,P=s.deltaTime>v.time;if(this._input=s,!C||!b||s.eventType&(K|fe)&&!P)this.reset();else if(s.eventType&oe)this.reset(),this._timer=a(function(){this.state=Re,this.tryEmit()},v.time,this);else if(s.eventType&K)return Re;return xe},reset:function(){clearTimeout(this._timer)},emit:function(s){this.state===Re&&(s&&s.eventType&K?this.manager.emit(this.options.event+"up",s):(this._input.timeStamp=kr(),this.manager.emit(this.options.event,this._input)))}}),f(Gr,ge,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[tt]},attrTest:function(s){return this._super.attrTest.call(this,s)&&(Math.abs(s.rotation)>this.options.threshold||this.state&me)}}),f(zr,ge,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ee|et,pointers:1},getTouchAction:function(){return Wt.prototype.getTouchAction.call(this)},attrTest:function(s){var v,b=this.options.direction;return b&(Ee|et)?v=s.overallVelocity:b&Ee?v=s.overallVelocityX:b&et&&(v=s.overallVelocityY),this._super.attrTest.call(this,s)&&b&s.offsetDirection&&s.distance>this.options.threshold&&s.maxPointers==this.options.pointers&&Qe(v)>this.options.velocity&&s.eventType&K},emit:function(s){var v=ti(s.offsetDirection);v&&this.manager.emit(this.options.event+v,s),this.manager.emit(this.options.event,s)}}),f($t,Ce,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Xr]},process:function(s){var v=this.options,b=s.pointers.length===v.pointers,C=s.distance<v.threshold,P=s.deltaTime<v.time;if(this.reset(),s.eventType&oe&&this.count===0)return this.failTimeout();if(C&&P&&b){if(s.eventType!=K)return this.failTimeout();var O=this.pTime?s.timeStamp-this.pTime<v.interval:!0,$=!this.pCenter||Z(this.pCenter,s.center)<v.posThreshold;this.pTime=s.timeStamp,this.pCenter=s.center,$&&O?this.count+=1:this.count=1,this._input=s;var te=this.count%v.taps;if(te===0)return this.hasRequireFailures()?(this._timer=a(function(){this.state=Re,this.tryEmit()},v.interval,this),me):Re}return xe},failTimeout:function(){return this._timer=a(function(){this.state=xe},this.options.interval,this),xe},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Re&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Le.VERSION="2.0.8",Le.defaults={domEvents:!1,touchAction:vi,enable:!0,inputTarget:null,inputClass:null,preset:[[Gr,{enable:!1}],[Ur,{enable:!1},["rotate"]],[zr,{direction:Ee}],[Wt,{direction:Ee},["swipe"]],[$t],[$t,{event:"doubletap",taps:2},["tap"]],[Lr]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Fo=1,pi=2;Vr.prototype={set:function(s){return Me(this.options,s),s.touchAction&&this.touchAction.update(),s.inputTarget&&(this.input.destroy(),this.input.target=s.inputTarget,this.input.init()),this},stop:function(s){this.session.stopped=s?pi:Fo},recognize:function(s){var v=this.session;if(!v.stopped){this.touchAction.preventDefaults(s);var b,C=this.recognizers,P=v.curRecognizer;(!P||P&&P.state&Re)&&(P=v.curRecognizer=null);for(var O=0;O<C.length;)b=C[O],v.stopped===pi||P&&b!=P&&!b.canRecognizeWith(P)?b.reset():b.recognize(s),!P&&b.state&(me|mt|Ge)&&(P=v.curRecognizer=b),O++}},get:function(s){if(s instanceof Ce)return s;for(var v=this.recognizers,b=0;b<v.length;b++)if(v[b].options.event==s)return v[b];return null},add:function(s){if(o(s,"add",this))return this;var v=this.get(s.options.event);return v&&this.remove(v),this.recognizers.push(s),s.manager=this,this.touchAction.update(),s},remove:function(s){if(o(s,"remove",this))return this;if(s=this.get(s)){var v=this.recognizers,b=M(v,s);b!==-1&&(v.splice(b,1),this.touchAction.update())}return this},on:function(s,v){if(s!==i&&v!==i){var b=this.handlers;return u(x(s),function(C){b[C]=b[C]||[],b[C].push(v)}),this}},off:function(s,v){if(s!==i){var b=this.handlers;return u(x(s),function(C){v?b[C]&&b[C].splice(M(b[C],v),1):delete b[C]}),this}},emit:function(s,v){this.options.domEvents&&co(s,v);var b=this.handlers[s]&&this.handlers[s].slice();if(b&&b.length){v.type=s,v.preventDefault=function(){v.srcEvent.preventDefault()};for(var C=0;C<b.length;)b[C](v),C++}},destroy:function(){this.element&&ri(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},Me(Le,{INPUT_START:oe,INPUT_MOVE:Je,INPUT_END:K,INPUT_CANCEL:fe,STATE_POSSIBLE:Qt,STATE_BEGAN:me,STATE_CHANGED:mt,STATE_ENDED:Ge,STATE_RECOGNIZED:Re,STATE_CANCELLED:St,STATE_FAILED:xe,DIRECTION_NONE:qt,DIRECTION_LEFT:wt,DIRECTION_RIGHT:It,DIRECTION_UP:Ct,DIRECTION_DOWN:Mt,DIRECTION_HORIZONTAL:Ee,DIRECTION_VERTICAL:et,DIRECTION_ALL:oi,Manager:Vr,Input:R,TouchAction:Br,TouchInput:Ke,MouseInput:Ie,PointerEventInput:Ue,TouchMouseInput:ht,SingleTouchInput:Ze,Recognizer:Ce,AttrRecognizer:ge,Tap:$t,Pan:Wt,Swipe:zr,Pinch:Ur,Rotate:Gr,Press:Lr,on:g,off:y,each:u,merge:ho,extend:ii,assign:Me,inherit:f,bindFn:h,prefixed:A});var Do=typeof e<"u"?e:typeof self<"u"?self:{};Do.Hammer=Le,t.exports?t.exports=Le:e[n]=Le})(window,document,"Hammer")});var t0=function(){function t(){var e=this;Q(this,t),d(this,"isInteractive",!0),d(this,"hasAmbient",!1),d(this,"init",function(r,n,i,a){e.zStart=e._zBounded(e.settings.CAM_Z_INI),e.zCurrent=e.zStart,e.zTarget=e.zStart,e.rotStart=[0,0],e.rotCurrent=e.rotStart,e.rotTarget=e.rotStart,e.rotVelocity=[0,0],e.interacting=!1,e.lastGestureChange=0,e.pointsPerRadian=Math.PI/(r/window.devicePixelRatio),e.zFullWidth=e.settings.CAM_Z_MAX,e.camFov=a,e.camAspect=i,e.zFullWidth=e._frustumDist(2*(1/e.camAspect),e.camFov)}),d(this,"resize",function(r,n,i,a){e.pointsPerRadian=Math.PI/(r/window.devicePixelRatio),e.camFov=a,e.camAspect=i,e.zFullWidth=e._frustumDist(2*(1/e.camAspect),e.camFov)}),d(this,"activate",function(){e.hammertime.on("panstart",e._onPanStart.bind(e)),e.hammertime.on("pan",e._onPanContinue.bind(e)),e.hammertime.on("panend",e._onPanEnd.bind(e)),e.hammertime.on("tap",e._onTap.bind(e))}),d(this,"deactivate",function(){e.hammertime.off("panstart",e._onPanStart.bind(e)),e.hammertime.off("pan",e._onPanContinue.bind(e)),e.hammertime.off("panend",e._onPanEnd.bind(e)),e.hammertime.off("tap",e._onTap.bind(e))}),d(this,"_zForScale",function(r){return r<1?e.zStart*(1/r):e.zStart+(e.settings.CAM_Z_MIN-e.zStart)*(1-1/r)}),d(this,"_onWheel",function(r){if(e.isInteractive){r.preventDefault();var n=Math.pow((r.deltaY+10)/100,3)/250,i=r.deltaY>0?n:1/n;i=Math.max(.9,i),i=Math.min(1.2,i),e.zStart=e.zCurrent,e.rotVelocity=[0,0],e.zTarget=e._zBounded(e._zForScale(i)),e.lastGestureChange=r.timeStamp}}),d(this,"_onPanContinue",function(r){if(e.isInteractive&&e.interacting===!0){var n=6,i=[r.deltaY/devicePixelRatio*n,r.deltaX/devicePixelRatio*n],a=e._rotForDelta([e.panStart[0]-i[0],e.panStart[1]-i[1]]);e.rotTarget=e._rotBounded([e.rotStart[0]+a[0],e.rotStart[1]+a[1]]),e.lastGestureChange=r.timeStamp}}),d(this,"_onPanEnd",function(r){if(e.isInteractive){e.interacting=!1;var n=r.timeStamp,i=n-e.lastGestureChange;if(i>.1){e.rotVelocity=[0,0];return}var a=e._rotForDelta([r.overallVelocityX,r.overallVelocityY]);e.rotVelocity=[a[0]*.016,a[1]*.016],e.rotDir=a[0]>0?1:-1;var o=e.rotTarget[0]/(Math.PI/2)/.5;Math.abs(o)<1?e.ambientPitchX=Math.asin(o):e.ambientPitchX=Math.PI/2*(o/Math.abs(o)),e.ambientPitchDir=a[1]>0?-1:1}}),d(this,"_updateRot",function(){if(e.interacting)e.ambientYaw=0,e.ambientPitch=0,e.ambientTween&&(e.ambientTween.stop(),e.ambientTween=null);else{var r=0;r=Math.sin(e.ambientPitchX)*(Math.PI/2)*.5,e.ambientPitchX+=.001*e.ambientPitchDir*e.ambientPitch,e.rotTarget=[e.rotTarget[0]*(1-e.ambientPitch)+r*e.ambientPitch,e.rotTarget[1]];var n=[Math.max(Math.min(e.rotTarget[0],e.settings.CAM_PITCH_SPRING_MAX),e.settings.CAM_PITCH_SPRING_MIN),e.rotTarget[1]],i=[e.rotTarget[0]-n[0]+e.rotVelocity[0],e.rotTarget[1]-n[1]+e.rotVelocity[1]];e.rotTarget=[e.rotTarget[0]-i[0]*e.settings.SPRING_STR*3,e.rotTarget[1]-i[1]*e.settings.SPRING_STR*3],e.rotVelocity=[e.rotVelocity[0]*e.settings.FRICTION,e.rotVelocity[1]*e.settings.FRICTION];var a=e.zCurrent/e.settings.CAM_Z_MAX;e.hasAmbient&&e.ambientYaw===0&&!e.ambientTween&&e.setAmbientAnimated(!0,2500);var o=e.ambientYaw*(a*a);Math.abs(e.rotVelocity[1])<o&&(e.rotVelocity[1]=o*e.rotDir)}var u=[e.rotTarget[0]-e.rotCurrent[0],e.rotTarget[1]-e.rotCurrent[1]];e.rotCurrent=[e.rotCurrent[0]+u[0]*e.settings.SPRING_STR,e.rotCurrent[1]+u[1]*e.settings.SPRING_STR]}),d(this,"_updateZ",function(){if(!e.interacting){e.zBounded=Math.max(Math.min(e.zTarget,e.settings.CAM_Z_SPRING_MAX),e.settings.CAM_Z_SPRING_MIN);var r=e.zTarget-e.zBounded;e.zTarget-=r*e.settings.SPRING_STR*3}var n=e.zTarget-e.zCurrent;e.zCurrent+=n*e.settings.SPRING_STR}),d(this,"update",function(r){e.fov=r,e._updateZ(),e._updateRot()}),d(this,"setAltitude",function(r){e.zTarget=1+r/e.settings.EARTH_RADIUS}),d(this,"getAltitude",function(){return(e.zCurrent-1)*e.settings.EARTH_RADIUS}),d(this,"setAmbient",function(r){e.ambientTween&&(e.ambientTween.stop(),e.ambientTween=null),e.hasAmbient=r,r?(e.ambientYaw=1*e.settings.YAW_MIN_VELOCITY,e.ambientPitch=1):(e.ambientYaw=0,e.ambientPitch=0);var n=e.rotTarget[0]/(Math.PI/2)/.5;Math.abs(n)<1?e.ambientPitchX=Math.asin(n):e.ambientPitchX=Math.PI/2*(n/Math.abs(n))}),d(this,"setAmbientAnimated",function(r,n){e.hasAmbient=r;var i=r?0:1,a=r?1:0;e.ambientTween&&(i=e.ambientTween.currentValue(),e.ambientTween.stop());var o=(n||250)*Math.abs(a-i);if(o===0){e.setAmbient(r);return}var u=e.rotTarget[0]/(Math.PI/2)/.5;Math.abs(u)<1?e.ambientPitchX=Math.asin(u):e.ambientPitchX=Math.PI/2*(u/Math.abs(u)),e.ambientTween=new ne(i,a,o,{onUpdate:function(f){e.ambientYaw=f*e.settings.YAW_MIN_VELOCITY,e.ambientPitch=f},onComplete:function(f){f&&(e.ambientTween=null)}})}),d(this,"reset",function(){e.zStart=e._zBounded(e.settings.CAM_Z_INI),e.zCurrent=e.zStart,e.zTarget=e.zStart,e.rotStart=[0,0],e.rotCurrent=e.rotStart,e.rotTarget=e.rotStart,e.rotVelocity=[0,0],e.interacting=!1,e.lastGestureChange=0}),d(this,"_zBounded",function(r){if(r>e.settings.CAM_Z_SPRING_MAX){var n=r-e.settings.CAM_Z_SPRING_MAX,i=e.settings.CAM_Z_MAX-e.settings.CAM_Z_SPRING_MAX,a=e.easeOutSin(Math.min(n/i,1));return e.settings.CAM_Z_SPRING_MAX+i*a}if(r<e.settings.CAM_Z_SPRING_MIN){var o=r-e.settings.CAM_Z_SPRING_MIN,u=e.settings.CAM_Z_MIN-e.settings.CAM_Z_SPRING_MIN,c=e.easeOutSin(Math.min(o/u,1));return e.settings.CAM_Z_SPRING_MIN+u*c}return r}),d(this,"_rotBounded",function(r){if(r[0]>e.settings.CAM_PITCH_SPRING_MAX){var n=r[0]-e.settings.CAM_PITCH_SPRING_MAX,i=e.settings.CAM_PITCH_MAX-e.settings.CAM_PITCH_SPRING_MAX,a=e.easeOutSin(Math.min(n/i,1));return[e.settings.CAM_PITCH_SPRING_MAX+i*a,r[1]]}if(r[0]<e.settings.CAM_PITCH_SPRING_MIN){var o=r[0]-e.settings.CAM_PITCH_SPRING_MIN,u=e.settings.CAM_PITCH_MIN-e.settings.CAM_PITCH_SPRING_MIN,c=e.easeOutSin(Math.min(o/u,1));return[e.settings.CAM_PITCH_SPRING_MIN+u*c,r[1]]}return r}),d(this,"_frustumDist",function(r,n){return r*.5/Math.tan(n*.5*(Math.PI/180))}),d(this,"_rotForDelta",function(r){var n=r[0]*(e.pointsPerRadian*(e.zCurrent/e.zFullWidth)),i=r[1]*(e.pointsPerRadian*(e.zCurrent/e.zFullWidth));return[n,i]}),d(this,"easeOutSin",function(r){return Math.sin(r*Math.PI/2)}),this.settings={},this.settings.EARTH_RADIUS=6378137,this.settings.CAM_Z_MIN=1,this.settings.CAM_Z_MAX=45,this.settings.CAM_Z_INI=(this.settings.CAM_Z_MIN+this.settings.CAM_Z_MAX)*.5,this.settings.CAM_Z_SPRING_BND=.8,this.settings.CAM_Z_SPRING_MAX=this.settings.CAM_Z_MAX*this.settings.CAM_Z_SPRING_BND,this.settings.CAM_Z_SPRING_MIN=this.settings.CAM_Z_MIN*(1/this.settings.CAM_Z_SPRING_BND),this.settings.CAM_PITCH_MAX=Math.PI*.5,this.settings.CAM_PITCH_MIN=-Math.PI*.5,this.settings.CAM_PITCH_INI=0,this.settings.CAM_PITCH_SPRING_BND=.8,this.settings.CAM_PITCH_SPRING_MAX=this.settings.CAM_PITCH_MAX*this.settings.CAM_PITCH_SPRING_BND,this.settings.CAM_PITCH_SPRING_MIN=this.settings.CAM_PITCH_MIN*this.settings.CAM_PITCH_SPRING_BND,this.settings.FRICTION=.1,this.settings.SPRING_STR=.16,this.settings.YAW_MIN_VELOCITY=.01,this.zStart=0,this.zCurrent=0,this.zTarget=0,this.panStart=[0,0],this.rotStart=[0,0],this.rotCurrent=[0,0],this.rotTarget=[0,0],this.rotVelocity=[0,0],this.rotDir=1,this.ambientYaw=0,this.ambientPitch=0,this.ambientPitchX=0,this.ambientPitchDir=-1,this.ambientTween=null,this.interacting=!1,this.getInteractionState=function(){return e.interacting},this.lastGestureChange=0,this.pointsPerRadian=0,this.zFullWidth=0,this.onTap=function(r){},this.onPanCB=function(r){}}return _e(t,[{key:"_onTap",value:function(r){this.isInteractive&&this.onTap(r)}},{key:"_onPinch",value:function(r){this.isInteractive&&(r.isFirst?(this.zStart=this.zCurrent,this.rotVelocity=[0,0]):r.isFinal||(this.zTarget=this._zBounded(this._zForScale(r.scale)),this.lastGestureChange=r.timeStamp))}},{key:"_onPanStart",value:function(r){this.interacting=!0,this.rotStart=this.rotCurrent,this.panStart=[r.deltaX/devicePixelRatio,r.deltaY/devicePixelRatio],this.rotVelocity=[0,0]}},{key:"camPos",get:function(){return[0,0,this.zCurrent]}},{key:"camYaw",get:function(){return this.rotCurrent[1]}},{key:"camPitch",get:function(){return this.rotCurrent[0]}}]),t}(),r0=function(){function t(e,r,n){var i=this;Q(this,t),d(this,"isInteractive",!1),d(this,"targetElement",null),d(this,"targetDrawable",null),d(this,"camera",null),d(this,"movementModel",null),d(this,"boundingRect",null),d(this,"onTapCB",null),d(this,"options",{tap:!0,pan:!0,pinch:!0}),d(this,"release",function(){i.hammer.destroy()}),d(this,"resize",function(){i.boundingRect=i.targetElement.getBoundingClientRect(),i.movementModel.resize(i.boundingRect.width,i.boundingRect.height,i.camera.aspect,i.camera.fov)}),d(this,"update",function(){i.movementModel.update(i.camera.fov)}),d(this,"isOverTarget",function(a,o){var u=a-i.boundingRect.x,c=o-i.boundingRect.y,f=u/i.boundingRect.width,h=(i.boundingRect.height-c)/i.boundingRect.height,l=i.camera.getRayFromScreen(f,h);return i.targetDrawable.hitTest(l)}),d(this,"onPanStart",function(a){i.isOverTarget(a.center.x,a.center.y)&&(i.movementModel._onPanStart(a),i.onPan&&i.onPan(a))}),d(this,"onPanContinue",function(a){a.center.x!==0&&a.center.y!==0&&(i.movementModel._onPanContinue(a),i.onPan&&i.onPan(a))}),d(this,"onPanEnd",function(a){i.movementModel._onPanEnd(a)}),d(this,"onTap",function(a){var o=a.center.x-i.boundingRect.x,u=a.center.y-i.boundingRect.y;i.onTapCB&&i.onTapCB(o,u)}),e?(this.targetElement=e,this.boundingRect=this.targetElement.getBoundingClientRect()):e=window,this.camera=r,n&&(n.tap&&(this.options.tap=n.tap),n.pan&&(this.options.pan=n.pan),n.pinch&&(this.options.pinch=n.pinch)),this.movementModel=new t0,this.movementModel.init(this.boundingRect.width,this.boundingRect.height,this.camera.aspect,this.camera.fov),this.movementModel.isInteractive=!0,this.movementModel.hasAmbient=!1,this.hammer=window.Hammer(this.targetElement,null),this.options.tap&&this.hammer.on("tap",this.onTap),this.options.pan&&this.hammer.on("panstart",this.onPanStart),this.options.pan&&this.hammer.on("pan",this.onPanContinue),this.options.pan&&this.hammer.on("panend",this.onPanEnd),this.options.pinch&&this.hammer.on("tap",this.onPinch),this.isInteractive=!0}return _e(t,[{key:"target",set:function(r){this.targetDrawable=r}}]),t}(),Ja=function t(){Q(this,t)};Ja.create=function(t,e,r,n){var i=3*t,a=3*(r-t)-i,o=1-i-a,u=3*e,c=3*(n-e)-u,f=1-u-c,h=function(_){return((o*_+a)*_+i)*_},l=function(_){return((f*_+c)*_+u)*_},m=function(_){return(3*o*_+2*a)*_+i},g=function(_,T){var x,M,E,w,A;E=_;for(var I=0;I<8;I++){if(w=h(E)-_,Math.abs(w)<T)return E;if(A=m(E),Math.abs(A)<1e-6)break;E=E-w/A}if(x=0,M=1,E=_,E<x)return x;if(E>M)return M;for(;x<M;){if(w=h(E),Math.abs(w-_)<T)return E;_>w?x=E:M=E,E=(M-x)*.5+x}return E};return function(y){return l(g(y,1e-9))}};const n0=Math.asin,Oi=Math.cos,i0=Math.sin,a0=Math.sqrt,o0=Math.PI,u0=6378137;function s0(t){return t*t}function cr(t){return t*o0/180}function Bi(t){return s0(i0(t/2))}function c0(t,e){const r=cr(Array.isArray(t)?t[1]:t.latitude||t.lat),n=cr(Array.isArray(e)?e[1]:e.latitude||e.lat),i=cr(Array.isArray(t)?t[0]:t.longitude||t.lng||t.lon),a=cr(Array.isArray(e)?e[0]:e.longitude||e.lng||e.lon),o=Bi(n-r)+Oi(r)*Oi(n)*Bi(a-i);return 2*u0*n0(a0(o))}var f0=c0,eo=function(){if(typeof Map<"u")return Map;function t(e,r){var n=-1;return e.some(function(i,a){return i[0]===r?(n=a,!0):!1}),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(r){var n=t(this.__entries__,r),i=this.__entries__[n];return i&&i[1]},e.prototype.set=function(r,n){var i=t(this.__entries__,r);~i?this.__entries__[i][1]=n:this.__entries__.push([r,n])},e.prototype.delete=function(r){var n=this.__entries__,i=t(n,r);~i&&n.splice(i,1)},e.prototype.has=function(r){return!!~t(this.__entries__,r)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(r,n){n===void 0&&(n=null);for(var i=0,a=this.__entries__;i<a.length;i++){var o=a[i];r.call(n,o[1],o[0])}},e}()}(),_n=typeof window<"u"&&typeof document<"u"&&window.document===document,Tr=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),l0=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Tr):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)}}(),h0=2;function v0(t,e){var r=!1,n=!1,i=0;function a(){r&&(r=!1,t()),n&&u()}function o(){l0(a)}function u(){var c=Date.now();if(r){if(c-i<h0)return;n=!0}else r=!0,n=!1,setTimeout(o,e);i=c}return u}var m0=20,p0=["top","right","bottom","left","width","height","size","weight"],d0=typeof MutationObserver<"u",y0=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=v0(this.refresh.bind(this),m0)}return t.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},t.prototype.removeObserver=function(e){var r=this.observers_,n=r.indexOf(e);~n&&r.splice(n,1),!r.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},t.prototype.updateObservers_=function(){var e=this.observers_.filter(function(r){return r.gatherActive(),r.hasActive()});return e.forEach(function(r){return r.broadcastActive()}),e.length>0},t.prototype.connect_=function(){!_n||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),d0?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){!_n||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(e){var r=e.propertyName,n=r===void 0?"":r,i=p0.some(function(a){return!!~n.indexOf(a)});i&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),to=function(t,e){for(var r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];Object.defineProperty(t,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return t},Et=function(t){var e=t&&t.ownerDocument&&t.ownerDocument.defaultView;return e||Tr},ro=Or(0,0,0,0);function Er(t){return parseFloat(t)||0}function Ui(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.reduce(function(n,i){var a=t["border-"+i+"-width"];return n+Er(a)},0)}function _0(t){for(var e=["top","right","bottom","left"],r={},n=0,i=e;n<i.length;n++){var a=i[n],o=t["padding-"+a];r[a]=Er(o)}return r}function g0(t){var e=t.getBBox();return Or(0,0,e.width,e.height)}function b0(t){var e=t.clientWidth,r=t.clientHeight;if(!e&&!r)return ro;var n=Et(t).getComputedStyle(t),i=_0(n),a=i.left+i.right,o=i.top+i.bottom,u=Er(n.width),c=Er(n.height);if(n.boxSizing==="border-box"&&(Math.round(u+a)!==e&&(u-=Ui(n,"left","right")+a),Math.round(c+o)!==r&&(c-=Ui(n,"top","bottom")+o)),!E0(t)){var f=Math.round(u+a)-e,h=Math.round(c+o)-r;Math.abs(f)!==1&&(u-=f),Math.abs(h)!==1&&(c-=h)}return Or(i.left,i.top,u,c)}var T0=function(){return typeof SVGGraphicsElement<"u"?function(t){return t instanceof Et(t).SVGGraphicsElement}:function(t){return t instanceof Et(t).SVGElement&&typeof t.getBBox=="function"}}();function E0(t){return t===Et(t).document.documentElement}function x0(t){return _n?T0(t)?g0(t):b0(t):ro}function A0(t){var e=t.x,r=t.y,n=t.width,i=t.height,a=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,o=Object.create(a.prototype);return to(o,{x:e,y:r,width:n,height:i,top:r,right:e+n,bottom:i+r,left:e}),o}function Or(t,e,r,n){return{x:t,y:e,width:r,height:n}}var w0=function(){function t(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Or(0,0,0,0),this.target=e}return t.prototype.isActive=function(){var e=x0(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},t}(),I0=function(){function t(e,r){var n=A0(r);to(this,{target:e,contentRect:n})}return t}(),C0=function(){function t(e,r,n){if(this.activeObservations_=[],this.observations_=new eo,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=r,this.callbackCtx_=n}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Et(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(e)||(r.set(e,new w0(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Et(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(e)&&(r.delete(e),r.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(r){r.isActive()&&e.activeObservations_.push(r)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,r=this.activeObservations_.map(function(n){return new I0(n.target,n.broadcastRect())});this.callback_.call(e,r,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),no=typeof WeakMap<"u"?new WeakMap:new eo,io=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=y0.getInstance(),n=new C0(e,r,this);no.set(this,n)}return t}();["observe","unobserve","disconnect"].forEach(function(t){io.prototype[t]=function(){var e;return(e=no.get(this))[t].apply(e,arguments)}});var ao=function(){return typeof Tr.ResizeObserver<"u"?Tr.ResizeObserver:io}(),M0=function(){function t(e){var r=this;Q(this,t),d(this,"_container",null),d(this,"_callouts",{}),d(this,"_calloutDefinitions",[]),d(this,"_currentlyRemoving",[]),d(this,"onAutoRemove",null),d(this,"autoRemoveCallouts",!0),d(this,"autoRemoveThreshholdSimilarity",.5),d(this,"shouldAutoRemoveCallout",null),d(this,"autoRemoveThreshholdMargins",{top:0,right:0,left:0,bottom:0}),e&&e.tagName==="DIV"?(this._container=e,this._container.style.pointerEvents="none",this.resizeObserver=new ao(function(n){n.length&&(r.bounds=n[0].contentRect)}),this.resizeObserver.observe(this._container)):console.warn("CalloutManager expects a DIV element as a container."),this._removeCalloutComplete=this._removeCalloutComplete.bind(this)}return _e(t,[{key:"release",value:function(){this.resizeObserver.disconnect()}},{key:"addCallout",value:function(r){this.replaceCallouts([].concat(de(this._calloutDefinitions),[r]))}},{key:"removeCallout",value:function(r){var n=this._calloutDefinitions.findIndex(function(i){return i.id===r.id});n!==-1&&this.replaceCallouts([].concat(de(this._calloutDefinitions.slice(0,n)),de(this._calloutDefinitions.slice(n+1))))}},{key:"replaceCallouts",value:function(r){var n=this,i=r.filter(function(c){return!n._calloutDefinitions.includes(c)}),a=this._calloutDefinitions.filter(function(c){return!r.includes(c)}),o=a.filter(function(c){return!n._currentlyRemoving.includes(c)});this._currentlyRemoving=[].concat(de(this._currentlyRemoving),de(o)),this._calloutDefinitions=[].concat(de(this._calloutDefinitions),de(i));var u=i.map(function(c){var f=c.calloutClass;if(f)return new f(c)}).filter(function(c){return c});u.forEach(function(c){n._callouts[c.definition.id]=c,n._container.appendChild(c.element),c.animateIn()}),o.map(function(c){return n._callouts[c.id]}).forEach(function(c){c.animateOut(n._removeCalloutComplete)})}},{key:"removeAllCallouts",value:function(){this.replaceCallouts([])}},{key:"update",value:function(r){var n=this;if(this.positionProvider){var i=[],a=this.positionProvider(this._calloutDefinitions);this._calloutDefinitions.forEach(function(o,u){var c=n._callouts[o.id],f=a[u];if(c&&(c.setPosition(f),c.update(r)),n.autoRemoveCallouts){var h=n.autoRemoveThreshholdSimilarity,l=n.autoRemoveThreshholdMargins;(f.world.similarityToCameraVector<h||f.screen.x<l.left||f.screen.x>n.bounds.width-l.right||f.screen.y<l.top||f.screen.y>n.bounds.height-l.bottom)&&i.push(o)}}),i.forEach(function(o){(!n.shouldAutoRemoveCallout||n.shouldAutoRemoveCallout(o))&&(n.removeCallout(o),n.onAutoRemove&&n.onAutoRemove(o))})}}},{key:"_removeCalloutComplete",value:function(r){var n=r.definition.id,i=this._calloutDefinitions.findIndex(function(a){return a.id===n});i!==-1&&(this._calloutDefinitions=[].concat(de(this._calloutDefinitions.slice(0,i)),de(this._calloutDefinitions.slice(i+1))),i=this._currentlyRemoving.findIndex(function(a){return a.id===n}),this._currentlyRemoving=[].concat(de(this._currentlyRemoving.slice(0,i)),de(this._currentlyRemoving.slice(i+1))),this._container.removeChild(this._callouts[n].element),this._callouts[n].release(),delete this._callouts[n])}},{key:"drawables",get:function(){var r=this;return this._calloutDefinitions.map(function(n){return r._callouts[n.id].drawables})}}]),t}(),N0=function(){function t(e,r,n){var i=this;Q(this,t),d(this,"_wasmLoaded",!1),d(this,"isInit",!1),d(this,"shouldDraw",!1),d(this,"isInteractive",!1),d(this,"renderer",null),d(this,"scene",null),d(this,"_alt",4),d(this,"tartgetDrawable",null),d(this,"calloutManager",null),d(this,"interactionController",null),d(this,"boundingRect",null),d(this,"_onWasmLoad",[]),d(this,"drawqueue",[]),d(this,"loadWasm",function(a){var o=a===void 0?"./gkweb_bg.wasm":a;qa(o).then(function(){i._wasmLoaded=!0,Xl(),i._onWasmLoad.forEach(function(u){u()}),i._onInitCB()})}),d(this,"init",function(a){i.renderer=new Al(a,i.gkOptions.attributes),i.renderer.init(),i.gkOptions.clearColor&&(i.renderer.clearColor=i.gkOptions.clearColor),i.scene=new zl(a.width,a.height),i.interactionController=new r0(a,i.scene.camera),i.interactionController.onTapCB=i.onTapCB,window.onresize=i.onResizeCB,window.onscroll=i.onResizeCB,i.isInit=!0}),d(this,"release",function(){i.stopDrawing(),i.calloutManager&&i.calloutManager.release(),i.interactionController&&i.interactionController.release()}),d(this,"_onInitCB",function(){i.onInitCB(i),i.renderloop(0)}),d(this,"onResizeCB",function(){i.boundingRect=i.renderer.gl.canvas.getBoundingClientRect(),ja(i.renderer.gl.canvas),i.scene.resize(i.boundingRect.width,i.boundingRect.height),i.renderer.resize(i.boundingRect.width,i.boundingRect.height),i.interactionController.resize()}),d(this,"setCameratargetDrawable",function(a){i.interactionController.hitTarget=a.hitTest}),d(this,"setAbsMovementModelTo",function(a,o,u){i.interactionController.movementModel.rotCurrent[0]=a*(-Math.PI/180),i.interactionController.movementModel.rotCurrent[1]=o*(Math.PI/180),i.interactionController.movementModel.rotTarget[0]=a*(-Math.PI/180),i.interactionController.movementModel.rotTarget[1]=o*(Math.PI/180),u!==void 0&&(i._alt=u)}),d(this,"animateToLatLon",function(a,o,u){i.interactionController.movementModel.interacting=!0,i.interactionController.movementModel.setAmbientAnimated(!1,100),i.currentTween&&i.currentTween.stop();for(var c=i.interactionController.movementModel.rotTarget[0]/(-Math.PI/180),f=i.interactionController.movementModel.rotTarget[1]/(Math.PI/180);f<-180;)f+=360;for(;f>180;)f-=360;var h=f0({lat:c,lon:f},{lat:a,lon:o}),l=Math.max(Math.round(h/1e4),350),m=a,g=o,y=m-c,_=g-f,T=g+360-f,x=g-360-f;Math.abs(T)<Math.abs(_)&&(g=o+360,_=T),Math.abs(x)<Math.abs(_)&&(g=o-360,_=x);var M=u||l,E=450,w=350,A=.85,I=.55,F=Math.min(Math.max(M-w,0),1)/(E-w),R=I+(A-I)*F,S=Ja.create(.315,.015,1-R,1);i.currentTween=new ne(0,1,M,{onUpdate:function(L){for(var D=S(L),N=f+_*D,B=c+y*D;N<-180;)N+=360;for(;N>180;)N-=360;i.setAbsMovementModelTo(B,N)},onComplete:function(L){L&&(i.currentTween=null)}})}),d(this,"setMovementModelTo",function(a,o,u){i.interactionController.movementModel.rotTarget[0]=a*(-Math.PI/180),i.interactionController.movementModel.rotTarget[1]=o*(Math.PI/180),u!==void 0&&(i._alt=u)}),d(this,"moveCameraTo",function(a,o,u){var c=Xe.worldFromLatLon(a,o,u);i.scene.camera.setPosition(c)}),d(this,"addDrawable",function(a,o){return a instanceof Za?(a instanceof Ka&&i.tartgetDrawable===null&&(i.tartgetDrawable=a,i.interactionController.target=a),a.init(i.renderer.gl,o),i.drawqueue.push(a),i._wasmLoaded?a.createCollisionGeo():i._onWasmLoad.push(a.createCollisionGeo),!0):!1}),d(this,"startDrawing",function(){i.shouldDraw=!0,i.renderloop(0)}),d(this,"stopDrawing",function(){i.shouldDraw=!1}),d(this,"renderloop",function(a){var o=a/1e4;if(i.shouldDraw){i.interactionController.update();var u=-i.interactionController.movementModel.camPitch*(180/Math.PI),c=i.interactionController.movementModel.camYaw*(180/Math.PI);i.updateCameraFunction(o),i.moveCameraTo(u,c,i._alt),i.renderer.prepareRenderFrame(),i.scene.update(o);var f=i.scene.getUniforms(o);i.drawqueue.forEach(function(h){h.update(i.renderer.gl,f,o)}),i.calloutManager&&i.calloutManager.update(o),i.onUpdate&&i.onUpdate(),i.drawqueue.forEach(function(h){h.draw(i.renderer.gl)}),requestAnimationFrame(i.renderloop)}}),d(this,"onTapCB",function(a,o){var u=a/i.boundingRect.width,c=(i.boundingRect.height-o)/i.boundingRect.height,f=i.scene.camera.getRayFromScreen(u,c),h=i.targetLatLon(f);i.onTap&&i.onTap({x:a,y:o},h);var l={};l.drawables=[],h&&(l.lat=h.lat,l.lon=h.lon),i.drawqueue.forEach(function(m){if(m.isInteractive&&m.isSelectable){var g={};g.obj=m;var y=m.rayCastFrom(f);y&&m.isSelectable&&(g.selection=m.onSelection(h.lat,h.lon,y)),l.drawables.push(g)}}),i.userDefinedSelection(l)}),d(this,"targetLatLon",function(a){var o,u=i.tartgetDrawable.rayCastFrom(a);return u!==!1&&(o=Xe.latLonFromWorld(u.point)),o}),d(this,"onMouseMoveCB",function(a,o){var u=a/i.boundingRect.width,c=(i.boundingRect.height-o)/i.boundingRect.height,f=i.scene.camera.getRayFromScreen(u,c);i.drawqueue.forEach(function(h){if(h.isInteractive&&h.isHoverable){var l=h.rayCastFrom(f);l&&h.isHoverable&&h.onHover(l)}})}),d(this,"updateCameraFunction",function(a){}),d(this,"moveCameraToLatLon",function(a,o,u){}),d(this,"getPosition",function(a,o,u){u||(u=0);var c=Xe.worldFromLatLon(a,o,u),f=i.scene.camera.project(c);f[0]*=i.boundingRect.width,f[1]*=i.boundingRect.height,f[1]=i.boundingRect.height-f[1];var h=i.scene.camera.project(i.scene.camera.target);h[0]*=i.boundingRect.width,h[1]*=i.boundingRect.height,h[1]=i.boundingRect.height-h[1];var l=[];l.push(f[0]-h[0]),l.push(f[1]-h[1]);var m=ft();Tt(m,c);var g=i.scene.camera.eye,y=ft();Tt(y,g);var _=Ha(m,y);return{screen:{x:f[0],y:f[1]},world:{x:l[0],y:l[1],similarityToCameraVector:_}}}),d(this,"registerCalloutManager",function(a){if(!a||!a instanceof M0){console.warn("registerCalloutManager must be passed an instance of CalloutManager");return}a.positionProvider=function(o){return o.map(function(u){return i.getPosition(u.latitude,u.longitude,u.altitude)})},i.calloutManager=a}),d(this,"computeGlobeSize",function(){var a=i.scene.camera.fov,o=Fl(i.scene.camera.eye,i.tartgetDrawable.translation),u=1,c=2*Math.asin(u/o),f=c/a*i.boundingRect.height;console.log(o,f,i.boundingRect.height)}),d(this,"setGlobeSize",function(a){var o=i.scene.camera.fov,u=1,c=Math.sin(a/i.boundingRect.height*o/2)*u;console.log(c)}),d(this,"setAmbient",function(a){i.interactionController.movementModel.hasAmbient=a}),this.gkOptions=r===void 0?{}:r,n&&(this.onInitCB=n),this.boundingRect=e.getBoundingClientRect(),this.init(e),this.loadWasm(this.gkOptions.wasmPath)}return _e(t,[{key:"isWebGL1",get:function(){return this.gl?ua(this.gl):!1}},{key:"isWebGL2",get:function(){return this.gl?Ye(this.gl):!1}}]),t}(),R0=Qa(function(t,e){/**
 * k-d Tree JavaScript - V 1.01
 *
 * https://github.com/ubilabs/kd-tree-javascript
 *
 * @author Mircea Pricop <pricop@ubilabs.net>, 2012
 * @author Martin Kleppe <kleppe@ubilabs.net>, 2012
 * @author Ubilabs http://ubilabs.net, 2012
 * @license MIT License <http://www.opensource.org/licenses/mit-license.php>
 */(function(r,n){n(e)})(e0,function(r){function n(a,o,u){this.obj=a,this.left=null,this.right=null,this.parent=u,this.dimension=o}function i(a){this.content=[],this.scoreFunction=a}i.prototype={push:function(a){this.content.push(a),this.bubbleUp(this.content.length-1)},pop:function(){var a=this.content[0],o=this.content.pop();return this.content.length>0&&(this.content[0]=o,this.sinkDown(0)),a},peek:function(){return this.content[0]},remove:function(a){for(var o=this.content.length,u=0;u<o;u++)if(this.content[u]==a){var c=this.content.pop();return void(u!=o-1&&(this.content[u]=c,this.scoreFunction(c)<this.scoreFunction(a)?this.bubbleUp(u):this.sinkDown(u)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(a){for(var o=this.content[a];a>0;){var u=Math.floor((a+1)/2)-1,c=this.content[u];if(!(this.scoreFunction(o)<this.scoreFunction(c)))break;this.content[u]=o,this.content[a]=c,a=u}},sinkDown:function(a){for(var o=this.content.length,u=this.content[a],c=this.scoreFunction(u);;){var f=2*(a+1),h=f-1,l=null;if(h<o){var m=this.content[h],g=this.scoreFunction(m);g<c&&(l=h)}if(f<o){var y=this.content[f];this.scoreFunction(y)<(l==null?c:g)&&(l=f)}if(l==null)break;this.content[a]=this.content[l],this.content[l]=u,a=l}}},r.kdTree=function(a,o,u){function c(h,l,m){var g,y,_=l%u.length;return h.length===0?null:h.length===1?new n(h[0],_,m):(h.sort(function(T,x){return T[u[_]]-x[u[_]]}),g=Math.floor(h.length/2),y=new n(h[g],_,m),y.left=c(h.slice(0,g),l+1,y),y.right=c(h.slice(g+1),l+1,y),y)}var f=this;Array.isArray(a)?this.root=c(a,0,null):function(h){function l(m){m.left&&(m.left.parent=m,l(m.left)),m.right&&(m.right.parent=m,l(m.right))}f.root=h,l(f.root)}(a),this.toJSON=function(h){h||(h=this.root);var l=new n(h.obj,h.dimension,null);return h.left&&(l.left=f.toJSON(h.left)),h.right&&(l.right=f.toJSON(h.right)),l},this.insert=function(h){function l(_,T){if(_===null)return T;var x=u[_.dimension];return h[x]<_.obj[x]?l(_.left,_):l(_.right,_)}var m,g,y=l(this.root,null);y!==null?(m=new n(h,(y.dimension+1)%u.length,y),g=u[y.dimension],h[g]<y.obj[g]?y.left=m:y.right=m):this.root=new n(h,0,null)},this.remove=function(h){function l(y){if(y===null)return null;if(y.obj===h)return y;var _=u[y.dimension];return h[_]<y.obj[_]?l(y.left):l(y.right)}function m(y){function _(E,w){var A,I,F,R,S;return E===null?null:(A=u[w],E.dimension===w?E.left!==null?_(E.left,w):E:(I=E.obj[A],F=_(E.left,w),R=_(E.right,w),S=E,F!==null&&F.obj[A]<I&&(S=F),R!==null&&R.obj[A]<S.obj[A]&&(S=R),S))}var T,x,M;if(y.left===null&&y.right===null)return y.parent===null?void(f.root=null):(M=u[y.parent.dimension],void(y.obj[M]<y.parent.obj[M]?y.parent.left=null:y.parent.right=null));y.right!==null?(x=(T=_(y.right,y.dimension)).obj,m(T),y.obj=x):(x=(T=_(y.left,y.dimension)).obj,m(T),y.right=y.left,y.left=null,y.obj=x)}var g;(g=l(f.root))!==null&&m(g)},this.nearest=function(h,l,m){function g(x){function M(U,L){T.push([U,L]),T.size()>l&&T.pop()}var E,w,A,I,F=u[x.dimension],R=o(h,x.obj),S={};for(I=0;I<u.length;I+=1)I===x.dimension?S[u[I]]=h[u[I]]:S[u[I]]=x.obj[u[I]];w=o(S,x.obj),x.right!==null||x.left!==null?(g(E=x.right===null?x.left:x.left===null?x.right:h[F]<x.obj[F]?x.left:x.right),(T.size()<l||R<T.peek()[1])&&M(x,R),(T.size()<l||Math.abs(w)<T.peek()[1])&&(A=E===x.left?x.right:x.left)!==null&&g(A)):(T.size()<l||R<T.peek()[1])&&M(x,R)}var y,_,T;if(T=new i(function(x){return-x[1]}),m)for(y=0;y<l;y+=1)T.push([null,m]);for(f.root&&g(f.root),_=[],y=0;y<Math.min(l,T.content.length);y+=1)T.content[y][0]&&_.push([T.content[y][0].obj,T.content[y][1]]);return _},this.balanceFactor=function(){function h(m){return m===null?0:Math.max(h(m.left),h(m.right))+1}function l(m){return m===null?0:l(m.left)+l(m.right)+1}return h(f.root)/(Math.log(l(f.root))/Math.log(2))}},r.BinaryHeap=i})}),O0=function(){function t(){var e=this;Q(this,t),d(this,"data",[]),d(this,"types",[]),d(this,"lastElementId",void 0),d(this,"kdtree",null),d(this,"addGeojson",function(r){r.type==="FeatureCollection"&&r.features instanceof Array&&(r.features.forEach(function(n,i){var a={id:"_".concat(Math.random().toString(36).substr(2,9)),lat:n.geometry.coordinates[1],lon:n.geometry.coordinates[0],properties:n.properties};e.data.push(a),e.lastElementId=i}),e.kdtree=new R0.kdTree(e.data,Xe.distanceBetweenPoints,["lat","lon"]))}),d(this,"addGeojsonPoint",function(r){var n=r.geometry.coordinates[1],i=r.geometry.coordinates[0],a=r.properties;return e.addPoint(n,i,a)}),d(this,"addPoint",function(r,n,i){var a={id:"_".concat(Math.random().toString(36).substr(2,9)),lat:r,lon:n,properties:i};return e.data.push(a),e.lastElementId=a.id,a}),d(this,"updateDataset",function(r){r.features.forEach(function(n){var i=e.data.find(function(a){var o=a.lat===n.geometry.coordinates[1],u=a.lon===n.geometry.coordinates[0];return o&&u});i===void 0?e.addGeojsonPoint(n):i.properties=n.properties})}),d(this,"deleteDataset",function(){e.data=[]}),d(this,"getNearest",function(r,n,i,a){var o=e.kdtree.nearest({lat:r,lon:n},a,i).sort(function(u,c){return u[1]-c[1]});if(o[0]!==void 0)return o}),d(this,"getElementFromId",function(r){return e.data.find(function(n){return n.id===r})}),d(this,"getElementFromKey",function(r,n){return e.data.find(function(i){return i.properties[r]===n})}),d(this,"getTypeList",function(){var r=[];return r.push([e.data[0]]),e.data.forEach(function(n){var i=Object.keys(n.properties),a=!1;r.forEach(function(o){var u=Object.keys(o[0].properties),c=Xe.isSubSet(i,u),f=Xe.isSubSet(u,i);c&&f&&(o.push(n),a=!0)}),a===!1&&r.push([n])}),r}),d(this,"getMaxForKey",function(r){var n=-1/0,i;if(typeof e.data[0].properties[r]!="number"){console.warn("Cannot compare non-numbers");return}return e.data.forEach(function(a){var o=a.properties[r];o>=n&&(n=o,i=a.id)}),{max:n,id:i}}),d(this,"getMinForKey",function(r){var n=1/0,i;if(typeof e.data[0].properties[r]!="number"){console.warn("Cannot compare non-numbers");return}return e.data.forEach(function(a){var o=a.properties[r];o<=n&&(n=o,i=a.id)}),{min:n,id:i}}),d(this,"getRangeForKey",function(r){var n=e.getMinForKey(r),i=e.getMaxForKey(r);return{min:n,max:i}}),d(this,"mapKeyToRange",function(r,n,i){var a=e.getRangeForKey(r);return e.data.map(function(o){var u=o.properties[r],c=(u-a.min.min)/(a.max.max-a.min.min)*(i-n)+n;return{id:o.properties.region_id,value:c}})})}return _e(t,[{key:"isHomogeneous",get:function(){return this.getTypeList().length===1}}]),t}(),P0=`#define GLSLIFY 1
attribute vec4 position;attribute vec3 normal;attribute vec2 texcoord;uniform mat4 u_worldViewProjection;uniform mat4 u_viewInverse;uniform mat4 u_model;uniform vec3 u_cameraPos;varying vec2 vTexture;varying float vAlpha;void main(){vec4 pos=u_worldViewProjection*u_model*position;gl_PointSize=10.0;vec3 transformedNormal=(u_worldViewProjection*u_model*vec4(normal,1.0)).xyz;vec4 transformedCamera=vec4(0.0,0.0,-1.0,1.0)*u_worldViewProjection;vAlpha=pow((1.0+(dot(normal,normalize(transformedCamera.xyz))))/2.0,0.35);vTexture=texcoord.xy;gl_Position=pos+0.00000000000000001*normal.x*texcoord.x;}`,S0=`precision mediump float;
#define GLSLIFY 1
uniform sampler2D u_surface;varying vec2 vTexture;varying float vAlpha;void main(){vec4 surfaceColor=texture2D(u_surface,vec2(vTexture.x,1.0-vTexture.y));vec3 color=surfaceColor.rgb*vAlpha;gl_FragColor=vec4(color,1.0);}`,F0={vertex:P0,fragment:S0},D0={u_lightWorldPos:[1,3,-8],u_lightColor:[1,.8,.8,1],u_ambient:[1,1,1,1],u_specular:[1,1,1,1],u_shininess:100,u_specularFactor:.1},B0=function(t){Li(r,t);var e=Gi(r);function r(n,i){var a,o;Q(this,r),o=e.call(this),d(V(o),"material",null),d(V(o),"lookup",null),d(V(o),"currentSelection",-1),d(V(o),"previousSelection",-1),d(V(o),"inAnimation",null),d(V(o),"outAnimation",null),d(V(o),"selection0",236),d(V(o),"selection1",144),d(V(o),"current",236),d(V(o),"dataTexture",void 0),d(V(o),"dataTextureSize",16),d(V(o),"updateCMDs",[]),d(V(o),"highlightAnimationProps",{start:0,stop:1,duration:1e3,onUpdate:function(w){o.material.uniforms.u_animateIn=w}}),d(V(o),"init",function(E,w){o.geometry.init(E);var A={surface:{src:o.textureSrc.surface,minMag:E.LINEAR}};console.log(o.textureSrc),o.material.init(E),o.material.uniforms.uModelMatrix=o.modelMatrix,o.material.loadTextures(E,A,function(){o.material.uniforms.u_surface=o.material.textures.surface,w&&w()})}),d(V(o),"getValueForId",function(E){return o.lookup.getFromId(E)}),d(V(o),"getValueForCode",function(E){return o.lookup.getFromCode(E)}),d(V(o),"getValueForName",function(E){return o.lookup.getFromName(E)}),d(V(o),"setIdColor",function(E,w,A){var I=A===void 0?1:A,F=Xe.hexToRGBA(w,I,!1);o.updateCMDs.push(function(R){o.dataTexture.updatePixelId(R,F,E)})}),d(V(o),"createCollisionGeo",function(){o.collisionGeometry&&o.collisionGeometry instanceof ql||(o.collisionGeometry=$l.create_collision_geometry(o.geometry.vertices.position.data,o.geometry.vertices.texcoord.data,o.geometry.vertices.indices.data))}),d(V(o),"rayCastFrom",function(E){return o.collisionGeometry.raycast(E.origin,E.direction)}),d(V(o),"hitTest",function(E){return o.collisionGeometry.hitTest(E.origin,E.direction)}),d(V(o),"onSelectionCB",function(E){}),d(V(o),"onSelection",function(E,w,A){Xe.latLonFromWorld(A.point)}),d(V(o),"onHover",function(E){console.log("IcosphereLookup.onHover",E)}),d(V(o),"update",function(E,w,A){lr((a=V(o),_t(r.prototype)),"update",a).call(a,w,A),o.material.uniforms.u_model=o.modelMatrix,o.updateCMDs.forEach(function(I){I(E)}),o.updateCMDs=[]}),d(V(o),"draw",function(E){!o.isReady||!o.shouldDraw||(E.useProgram(o.material.programInfo.program),yl(E,o.material.programInfo,o.geometry.bufferInfo),Va(o.material.programInfo,o.material.uniforms),E.drawArrays(E.TRIANGLES,0,o.geometry.bufferInfo.numElements))}),d(V(o),"setCountryHover",function(E){}),d(V(o),"setHighlightId",function(E){o.previousSelection=o.currentSelection,o.currentSelection=E;var w=o.inAnimation?o.inAnimation.currentValue():1,A=w*(300/1);o.animateIn(o.currentSelection,500),o.animateOut(o.previousSelection,A,w)}),d(V(o),"animateIn",function(E,w,A){o.material.uniforms.u_idAnimateIn=E,o.inAnimation&&o.inAnimation.stop(),o.material.uniforms.u_animateIn=0,o.inAnimation=new ne(o.highlightAnimationProps.start,o.highlightAnimationProps.stop,o.highlightAnimationProps.duration,{onUpdate:o.highlightAnimationProps.onUpdate})}),d(V(o),"animateOut",function(E,w,A,I){o.material.uniforms.u_idAnimateOut=E,o.outAnimation&&o.outAnimation.stop(),o.material.uniforms.u_animateOut=A,o.outAnimation=new ne(A,0,w,{onUpdate:function(R){o.material.uniforms.u_animateOut=R}})}),d(V(o),"addDataset",function(E){o.lookup=new Jl(E,o.textureSrc.id)}),d(V(o),"updateIdState",function(E,w){}),o.textureSrc={surface:n.surface},o.material=new Vl(F0),o.material.uniforms=D0,o.geometry=new Kl;var u=11664,c=11664,f=u*3,h=u*3,l=u*3,m=0,g=new Float32Array(i),y=new Int32Array(i),_=g.subarray(m,m+f);m+=f;var T=g.subarray(m,m+h);m+=h;var x=g.subarray(m,m+l);m+=l;var M=y.subarray(m,m+c);return o.geometry.vertices.position={numComponents:3,data:_},o.geometry.vertices.normal={numComponents:3,data:T},o.geometry.vertices.texcoord={numComponents:3,data:x},o.geometry.vertices.indices={numComponents:3,data:M},o}return r}(Ka),U0=function t(e,r,n,i){Q(this,t),d(this,"id",Math.random().toFixed(16).substr(2)),d(this,"latitude",0),d(this,"longitude",0),d(this,"altitude",0),d(this,"calloutClass",void 0),d(this,"data",void 0),this.latitude=e,this.longitude=r,this.calloutClass=n,this.data=i},L0=function(){function t(e){var r=this;Q(this,t),d(this,"drawables",[]),d(this,"element",void 0),d(this,"definition",void 0),d(this,"size",{width:0,height:0}),this.definition=e,this.element=this.createElement(),this.resizeObserver=new ao(function(n){n.length&&(r.size=n[0].contentRect)}),this.resizeObserver.observe(this.element)}return _e(t,[{key:"release",value:function(){this.resizeObserver.disconnect()}},{key:"createElement",value:function(){return document.createElement("div")}},{key:"animateIn",value:function(){}},{key:"animateOut",value:function(r){r(this)}},{key:"update",value:function(r){this.drawables.forEach(function(n){return n.update(r)})}},{key:"setPosition",value:function(r){this.element.style.transform="translate(".concat(r.screen.x,"px, ").concat(r.screen.y,"px)")}}]),t}();export{L0 as Callout,U0 as CalloutDefinition,M0 as CalloutManager,Gl as Camera,O0 as DataStore,Za as Drawable,Xe as GKUtils,Kl as Geometry,N0 as GlobeKitView,Jl as Lookup,B0 as Lowpoly,Al as Renderer,zl as Scene,Vl as ShaderMaterial};
