import{c as A}from"./entry-confetti.module-BCnSlh9tqh.js";import{K as w}from"./entry-KvAccordionItem-BUdedcIFQ1.js";import{K as B}from"./entry-KvLoadingSpinner-D6PAL1PtJd.js";import{C as L}from"./entry-CheckoutReceipt-BWw2aPpW_l.js";import{S as E}from"./entry-SocialShareV2-BCa_qBnGLD.js";import{j}from"./entry-joinArray-BjvW27pIp5.js";import{u as q,b as K,s as R}from"./entry-syncDate-BmkM6LdPy7.js";import{_ as H}from"./entry-KvButton-CZu-utW0a_.js";import{K as P}from"./entry-KvContentfulImg-DUC7wnP7UI.js";import{a as G}from"./entry-richTextRenderer-CZAKD6FB9X.js";import{r as O}from"./entry-rich-text-html-renderer.es5-kBaKhcHuza.js";import{c,o,f as S,d as v,r as l,K as f,b as g,J as I,e as r,H as M,a as p}from"./entry-vue.esm-bundler-Bf_Yeyugwo.js";import{_ as x}from"./entry-_plugin-vue_export-helper-DlAUqK2UKH.js";import"./entry-KvExpandable-DeDyumYo7d.js";import"./entry-mdi-BJHOrBfjV3.js";import"./entry-KvMaterialIcon-DcajXwg-0j.js";import"./entry-KvWwwHeader-CVdIzOPj6Q.js";import"./entry-_commonjsHelpers-Cpj98o6Yn6.js";import"./entry-numeral-DJCTM12wUX.js";import"./entry-KvIcon-DpMQFaEAGT.js";import"./iframe-CWeBLAo0.js";import"./entry-KvTooltip-Dc9Ho_TJhC.js";import"./entry-touchEvents-DzV-rvy7P4.js";import"./entry-KvThemeProvider-CJZWo36001.js";import"./entry-KvButton-DF0Vhz1EWA.js";import"./entry-KvLoadingSpinner-D0IZcQeh_0.js";import"./entry-index-CGacd2nhU3.js";import"./entry-index-COmIkRYU2t.js";import"./entry-index-CbPSoDvqj7.js";import"./entry-index-tAHLmhMYuW.js";import"./entry-index-D4S0JsTkt8.js";import"./entry-orderBy-CUrcrXTfYx.js";import"./entry-get-D3xDH2SX94.js";import"./entry-isSymbol-5pnFTpIKM9.js";import"./entry-keys-B9dmm4b_qU.js";import"./entry-social-sharing-mixin-mcFPgMmQne.js";import"./entry-urlUtils-D59-4GikCB.js";import"./entry-kiva-logo-fyRkKmi0FM.js";import"./entry-CampaignLogoGroup-D5aVYDQ4uA.js";import"./entry-KvContentfulImg-ClwkYYkTk_.js";import"./entry-throttle-DL1zg7kAk0.js";import"./entry-toNumber-MeiYJWOH0A.js";import"./entry-imageUtils-_95xo2d0ng.js";import"./entry-KvLoadingPlaceholder-DUZzoT9CoU.js";import"./entry-settingsUtils-CXPrtFAPl-.js";import"./entry-get-BUjo_hX5jl.js";import"./entry-myKivaUtils-USlSQzpKdw.js";import"./entry-logReadQueryError-Codcl0QZ_g.js";import"./entry-logFormatter-DhjghUk5Me.js";import"./entry-myKivaForAllUsers-DI6rZrUMxZ.js";import"./entry-KvPageContainer-B9-1kg27t_.js";import"./entry-KvUserAvatar-CcUKtQr-4i.js";import"./entry-throttle-DR-Bh3IiJx.js";import"./entry-toInteger-XI_MWEAzOD.js";import"./entry-PromoCreditBanner-CCrPa6t4Rf.js";import"./entry-promoCredit-A8tDfJh8uJ.js";import"./entry-lock-scroll-Bww220JhDP.js";import"./entry-getCacheKey-BX3EO2qX-W.js";import"./entry-KvTextInput-DOWiWB5Pob.js";import"./entry-attrs-C2OODjD6EW.js";import"./entry-contentfulUtils-CqD1k4MYgu.js";import"./entry-index-Dew-HucFLB.js";const U=`query thanksPage {
	hasEverLoggedIn @client
	my {
		id
		autoDeposit {
			id
			isSubscriber
		}
		teams {
			values {
				id
				team {
					id
					teamPublicId
					name
				}
			}
		}
		lender {
			id
			name
			image {
				id
				url
			}
			publicId
		}
		userAccount {
			id
			firstName
			lastName
			email
			inviterName
			public
		}
		loans {
			totalCount
		}
		communicationSettings {
			lenderNews
			loanUpdates
		}
	}
	general {
		shareAskCopy: uiExperimentSetting(key: "share_ask_copy") {
			key
			value
		}
		ftd_message_enable: uiConfigSetting(key: "ftd_message_enable") {
			key
			value
		}
		ftd_message_amount: uiConfigSetting(key: "ftd_message_amount") {
			key
			value
		}
		single_version_enable: uiConfigSetting(key: "thanks_page_single_version_enable") {
			key
			value
		}
		my_kiva_all_users: uiConfigSetting(key: "my_kiva_all_users_enable") {
			key
			value
		}
	}
	mySubscriptions(includeDisabled: false) {
		values {
			id
			enabled
		}
	}
	contentful {
		entries(contentType: "page", contentKey: "thanks")
	}
}
`,J={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"thanksPage"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasEverLoggedIn"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[]}]},{kind:"Field",name:{kind:"Name",value:"my"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"autoDeposit"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isSubscriber"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"teams"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"values"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"team"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"teamPublicId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"lender"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"publicId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"userAccount"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"firstName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lastName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"inviterName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"public"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"loans"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"communicationSettings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lenderNews"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"loanUpdates"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"general"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"shareAskCopy"},name:{kind:"Name",value:"uiExperimentSetting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"key"},value:{kind:"StringValue",value:"share_ask_copy",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"ftd_message_enable"},name:{kind:"Name",value:"uiConfigSetting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"key"},value:{kind:"StringValue",value:"ftd_message_enable",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"ftd_message_amount"},name:{kind:"Name",value:"uiConfigSetting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"key"},value:{kind:"StringValue",value:"ftd_message_amount",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"single_version_enable"},name:{kind:"Name",value:"uiConfigSetting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"key"},value:{kind:"StringValue",value:"thanks_page_single_version_enable",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"my_kiva_all_users"},name:{kind:"Name",value:"uiConfigSetting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"key"},value:{kind:"StringValue",value:"my_kiva_all_users_enable",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"mySubscriptions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includeDisabled"},value:{kind:"BooleanValue",value:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"values"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"contentful"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entries"},arguments:[{kind:"Argument",name:{kind:"Name",value:"contentType"},value:{kind:"StringValue",value:"page",block:!1}},{kind:"Argument",name:{kind:"Name",value:"contentKey"},value:{kind:"StringValue",value:"thanks",block:!1}}],directives:[]}]}}]}}],loc:{start:0,end:1089,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:U}}},D={name:"CampaignPartnerThanks",components:{KvButton:H,KvContentfulImg:P},props:{partnerContent:{type:Object,default:()=>{}},pageSettingData:{type:Object,default:()=>{}}},computed:{partnerImage(){var e,t,s;const n=(t=(e=this.partnerContent)==null?void 0:e.media)==null?void 0:t[0];return{title:(n==null?void 0:n.title)||"",url:((s=n==null?void 0:n.file)==null?void 0:s.url)||""}},headline(){var n,e,t;return((t=(e=(n=this.partnerContent)==null?void 0:n.contents)==null?void 0:e[0])==null?void 0:t.headline)||""},bodyCopy(){var e,t,s;const n=(s=(t=(e=this.partnerContent)==null?void 0:e.contents)==null?void 0:t[0])==null?void 0:s.bodyCopy;return n?O.documentToHtmlString(n):""},ctaText(){var n,e,t;return((t=(e=(n=this.partnerContent)==null?void 0:n.contents)==null?void 0:e[0])==null?void 0:t.primaryCtaText)||""},ctaLink(){var n,e,t;return((t=(e=(n=this.partnerContent)==null?void 0:n.contents)==null?void 0:e[0])==null?void 0:t.primaryCtaLink)||""}},async mounted(){await this.$nextTick(),G(this.$refs.partnerBodyCopy,this.pageSettingData)}},W={class:"campaign-partner-thanks"},$={key:1,class:"campaign-partner-thanks__header"},z=["innerHTML"];function Q(n,e,t,s,a,i){const d=l("kv-contentful-img"),m=l("kv-button");return o(),c("div",W,[i.partnerImage.url?(o(),S(d,{key:0,class:"campaign-partner-thanks__img","contentful-src":i.partnerImage.url,width:500,alt:i.partnerImage.title,"fallback-format":"jpg"},null,8,["contentful-src","alt"])):v("",!0),i.headline?(o(),c("h2",$,f(i.headline),1)):v("",!0),i.bodyCopy?(o(),c("div",{key:2,class:"campaign-partner-thanks__body",innerHTML:i.bodyCopy,ref:"partnerBodyCopy"},null,8,z)):v("",!0),i.ctaLink&&i.ctaText?(o(),S(m,{key:3,class:"campaign-partner-thanks__body",href:i.ctaLink},{default:g(()=>[I(f(i.ctaText),1)],void 0),_:1},8,["href"])):v("",!0)])}const X=x(D,[["render",Q],["__scopeId","data-v-75e65578"]]);D.__docgenInfo={displayName:"CampaignPartnerThanks",exportName:"default",description:"",tags:{},props:[{name:"partnerContent",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}},{name:"pageSettingData",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/CorporateCampaign/CampaignPartnerThanks.vue"]};const Y="kvu_lb",Z="kvu_db",V={name:"CampaignThanks",components:{CampaignPartnerThanks:X,CheckoutReceipt:L,KvAccordionItem:w,KvLoadingSpinner:B,SocialShareV2:E},inject:["apollo","cookieStore"],head(){return{title:"Thank you!"}},props:{transactionId:{type:Number,default:null},partnerContent:{type:Object,default(){return{}}},pageSettingData:{type:Object,default:()=>{}},promoGuestCheckoutEnabled:{type:Boolean,default:!1}},data(){return{lender:{},loans:[],receipt:{},showReceipt:!1}},computed:{borrowerSupport(){const n=this.loans.map(e=>e.name);return n.length>3?`these ${n.length} borrowers`:j(n,"and")}},mounted(){this.transactionId&&this.fetchReceipt()},methods:{fetchReceipt(){const n={query:J,variables:{checkoutId:this.transactionId}};this.promoGuestCheckoutEnabled&&(n.variables.visitorId=this.cookieStore.get("uiv")||null),this.apollo.query(n).then(async({data:e})=>{var d,m,u,_,h,y,N,b,F,C,T;this.lender={...(d=e==null?void 0:e.my)==null?void 0:d.userAccount,teams:(u=(m=e==null?void 0:e.my)==null?void 0:m.teams)==null?void 0:u.values.map(k=>k.team)},this.receipt=(_=e==null?void 0:e.shop)==null?void 0:_.receipt;const t=((y=(h=this.receipt)==null?void 0:h.items)==null?void 0:y.values)??[];this.loans=t.filter(k=>k.basketItemType==="loan_reservation").map(k=>k.loan),(N=e==null?void 0:e.my)!=null&&N.userAccount||console.error(`Failed to get lender for transaction id: ${this.$route.query.kiva_transaction_id}`),this.receipt||console.error(`Failed to get receipt for transaction id: ${this.$route.query.kiva_transaction_id}`);const s=(C=(F=(b=this.receipt)==null?void 0:b.totals)==null?void 0:F.depositTotals)==null?void 0:C.depositTotal,a=this.loans.length>0,i=parseFloat(s)>0;this.cookieStore.set(Y,a,{path:"/"}),this.cookieStore.set(Z,i,{path:"/"}),q(a),K(i),R({userId:(T=this.lender)==null?void 0:T.id,hasEverLoggedIn:!0,hasLentBefore:a,hasDepositBefore:i}),this.showReceipt=!0,await this.$nextTick(),this.celebrate()})},celebrate(){const n=this.$refs.confettiCanvas;n.confetti=n.confetti||A.create(n,{resize:!0,useWorker:!0}),n.confetti({origin:{y:.2},particleCount:150,spread:200,disableForReducedMotion:!0,colors:["#d74937","#6859c0","#fee259","#118aec","#DDFFF4","#4faf4e","#aee15c"]})}}},ee={class:"campaign-thanks"},ne={class:"campaign-thanks__container"},te={class:"campaign-thanks__header hide-for-print"},ie={class:"tw-mb-4"},ae={class:"tw-text-subhead"},se={class:"data-hj-suppress"},re={class:"campaign-thanks__partner-block"},oe={key:1,class:"campaign-thanks__spinner"},le={class:"campaign-thanks__confetti-canvas",ref:"confettiCanvas"};function de(n,e,t,s,a,i){const d=l("campaign-partner-thanks"),m=l("social-share-v2"),u=l("kv-accordion-item"),_=l("checkout-receipt"),h=l("kv-loading-spinner");return o(),c("div",ee,[r("div",ne,[a.loans.length>0?(o(),c(M,{key:0},[r("header",te,[r("h2",ie," Thanks for supporting "+f(i.borrowerSupport)+"! ",1),r("p",ae,[e[0]||(e[0]=I(" We've emailed your order confirmation to ")),r("span",se,f(a.lender.email),1)])]),r("section",re,[p(d,{"partner-content":t.partnerContent,"page-setting-data":t.pageSettingData},null,8,["partner-content","page-setting-data"])]),p(u,{id:"thanks-share"},{header:g(()=>e[1]||(e[1]=[r("h2",null,"Share the Good",-1)])),default:g(()=>[p(m,{class:"campaign-thanks__social-share",lender:a.lender,loans:a.loans},null,8,["lender","loans"])],void 0),_:1}),p(u,{id:"thanks-receipt"},{header:g(()=>e[2]||(e[2]=[r("h2",null,"Receipt",-1)])),default:g(()=>[a.showReceipt?(o(),S(_,{key:0,class:"campaign-thanks__receipt","disable-redirects":!0,lender:a.lender,receipt:a.receipt},null,8,["lender","receipt"])):v("",!0)],void 0),_:1})],64)):(o(),c("div",oe,[p(h)]))]),r("canvas",le,null,512)])}const fn=x(V,[["render",de],["__scopeId","data-v-09d1a962"]]);V.__docgenInfo={displayName:"CampaignThanks",exportName:"default",description:"",tags:{},props:[{name:"transactionId",type:{name:"number"},defaultValue:{func:!1,value:"null"}},{name:"partnerContent",type:{name:"object"},defaultValue:{func:!1,value:"{}"}},{name:"pageSettingData",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}},{name:"promoGuestCheckoutEnabled",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/CorporateCampaign/CampaignThanks.vue"]};export{fn as default};
