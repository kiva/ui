import{c as L}from"./entry-confetti.module-BCnSlh9tqh.js";import{K as B}from"./entry-KvAccordionItem-C1aTJ3Gq8C.js";import{K as V}from"./entry-KvLoadingSpinner-KUfNgrvm0_.js";import{C as j}from"./entry-CheckoutReceipt-ob2Lk5JU2e.js";import{S as q}from"./entry-SocialShareV2-zimM20f-m9.js";import{j as E}from"./entry-joinArray-BjvW27pIp5.js";import{u as R,b as A,s as P}from"./entry-syncDate-B5_baTpRcj.js";import{_ as H}from"./entry-KvButton-C9WvITgRyG.js";import{K}from"./entry-KvContentfulImg-eZvzi1SzQc.js";import{a as G}from"./entry-richTextRenderer-CPfVcw13m2.js";import{r as M}from"./entry-rich-text-html-renderer.es5-kBaKhcHuza.js";import{c as d,o,z as y,m as g,r as l,L as f,C as v,M as I,q as s,J as O,a as k}from"./entry-vue.esm-bundler-C0PPCo9W96.js";import{_ as x}from"./entry-_plugin-vue_export-helper-DlAUqK2UKH.js";import"./entry-KvExpandable-Bd-oWmSPhz.js";import"./entry-mdi-B1ONwcTkQ2.js";import"./entry-KvMaterialIcon-C3KLX5OV-L.js";import"./entry-KvWwwHeader-C1bm1YMh4q.js";import"./entry-_commonjsHelpers-Cpj98o6Yn6.js";import"./entry-index-CWclSTHHJk.js";import"./entry-numeral-xVHG5DEP0A.js";import"./entry-KvIcon-BUhAos7YaB.js";import"./iframe-Cc_r_Bkf.js";import"./entry-KvButton-BA7nBLyz1b.js";import"./entry-KvLoadingSpinner-CpYE5b1xV2.js";import"./entry-KvTooltip-CaRc32kHXv.js";import"./entry-KvThemeProvider-BF4_ArwXOx.js";import"./entry-index-CGacd2nhU3.js";import"./entry-index-COmIkRYU2t.js";import"./entry-index-CbPSoDvqj7.js";import"./entry-index-tAHLmhMYuW.js";import"./entry-index-D4S0JsTkt8.js";import"./entry-orderBy-CUrcrXTfYx.js";import"./entry-get-D3xDH2SX94.js";import"./entry-isSymbol-5pnFTpIKM9.js";import"./entry-keys-B9dmm4b_qU.js";import"./entry-social-sharing-mixin-mcFPgMmQne.js";import"./entry-urlUtils-D59-4GikCB.js";import"./entry-kiva-logo-CXWq-YcmJ4.js";import"./entry-CampaignLogoGroup-R50IhBJ4kn.js";import"./entry-KvContentfulImg-B0t9ZCrx8O.js";import"./entry-throttle-DL1zg7kAk0.js";import"./entry-toNumber-MeiYJWOH0A.js";import"./entry-imageUtils-XCIqTGZvrk.js";import"./entry-KvLoadingPlaceholder-B_9_tltQhY.js";import"./entry-settingsUtils-CXPrtFAPl-.js";import"./entry-get-BUjo_hX5jl.js";import"./entry-myKivaUtils-DUwPoPrS-N.js";import"./entry-logReadQueryError-Codcl0QZ_g.js";import"./entry-logFormatter-DhjghUk5Me.js";import"./entry-myKivaForAllUsers-DI6rZrUMxZ.js";import"./entry-KvPageContainer-Dh8GJwjiow.js";import"./entry-KvUserAvatar-DmX-R6-wYd.js";import"./entry-throttle-4FNEI5INvC.js";import"./entry-toInteger-XI_MWEAzOD.js";import"./entry-PromoCreditBanner-CN7uFBF8a4.js";import"./entry-promoCredit-w2GeqDaA1T.js";import"./entry-lock-scroll-Bww220JhDP.js";import"./entry-getCacheKey-CFbvtT9xx4.js";import"./entry-KvTextInput-CnVgGp-sYq.js";import"./entry-attrs-C2OODjD6EW.js";import"./entry-contentfulUtils-lP2pdZcy67.js";import"./entry-index-Dew-HucFLB.js";const U=`query thanksPage {
	hasEverLoggedIn @client
	my {
		id
		teams {
			values {
				id
				team {
					id
					teamPublicId
					name
				}
			}
		}
		lender {
			id
			name
			image {
				id
				url
			}
			publicId
		}
		userAccount {
			id
			firstName
			lastName
			email
			inviterName
			public
		}
		loans {
			totalCount
		}
		communicationSettings {
			lenderNews
			loanUpdates
		}
	}
	general {
		thankyou_page_goals_enable: uiConfigSetting(key: "thankyou_page_goals_enable") {
			key
			value
		}
		post_lending_next_steps_enable: uiConfigSetting(key: "mykiva_post_lending_next_steps_enable") {
			key
			value
		}
	}
}
`,z={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"thanksPage"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasEverLoggedIn"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[]}]},{kind:"Field",name:{kind:"Name",value:"my"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"teams"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"values"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"team"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"teamPublicId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"lender"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"publicId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"userAccount"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"firstName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lastName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"inviterName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"public"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"loans"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"communicationSettings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lenderNews"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"loanUpdates"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"general"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"thankyou_page_goals_enable"},name:{kind:"Name",value:"uiConfigSetting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"key"},value:{kind:"StringValue",value:"thankyou_page_goals_enable",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"post_lending_next_steps_enable"},name:{kind:"Name",value:"uiConfigSetting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"key"},value:{kind:"StringValue",value:"mykiva_post_lending_next_steps_enable",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:668,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:U}}},w={name:"CampaignPartnerThanks",components:{KvButton:H,KvContentfulImg:K},props:{partnerContent:{type:Object,default:()=>{}},pageSettingData:{type:Object,default:()=>{}}},computed:{partnerImage(){var e,n,r;const t=(n=(e=this.partnerContent)==null?void 0:e.media)==null?void 0:n[0];return{title:(t==null?void 0:t.title)||"",url:((r=t==null?void 0:t.file)==null?void 0:r.url)||""}},headline(){var t,e,n;return((n=(e=(t=this.partnerContent)==null?void 0:t.contents)==null?void 0:e[0])==null?void 0:n.headline)||""},bodyCopy(){var e,n,r;const t=(r=(n=(e=this.partnerContent)==null?void 0:e.contents)==null?void 0:n[0])==null?void 0:r.bodyCopy;return t?M.documentToHtmlString(t):""},ctaText(){var t,e,n;return((n=(e=(t=this.partnerContent)==null?void 0:t.contents)==null?void 0:e[0])==null?void 0:n.primaryCtaText)||""},ctaLink(){var t,e,n;return((n=(e=(t=this.partnerContent)==null?void 0:t.contents)==null?void 0:e[0])==null?void 0:n.primaryCtaLink)||""}},async mounted(){await this.$nextTick(),G(this.$refs.partnerBodyCopy,this.pageSettingData)}},J={class:"campaign-partner-thanks"},W={key:1,class:"campaign-partner-thanks__header"},$=["innerHTML"];function Q(t,e,n,r,a,i){const m=l("kv-contentful-img"),c=l("kv-button");return o(),d("div",J,[i.partnerImage.url?(o(),y(m,{key:0,class:"campaign-partner-thanks__img","contentful-src":i.partnerImage.url,width:500,alt:i.partnerImage.title,"fallback-format":"jpg"},null,8,["contentful-src","alt"])):g("",!0),i.headline?(o(),d("h2",W,f(i.headline),1)):g("",!0),i.bodyCopy?(o(),d("div",{key:2,class:"campaign-partner-thanks__body",innerHTML:i.bodyCopy,ref:"partnerBodyCopy"},null,8,$)):g("",!0),i.ctaLink&&i.ctaText?(o(),y(c,{key:3,class:"campaign-partner-thanks__body",href:i.ctaLink},{default:v(()=>[I(f(i.ctaText),1)],void 0),_:1},8,["href"])):g("",!0)])}const X=x(w,[["render",Q],["__scopeId","data-v-75e65578"]]);w.__docgenInfo={displayName:"CampaignPartnerThanks",exportName:"default",description:"",tags:{},props:[{name:"partnerContent",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}},{name:"pageSettingData",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/CorporateCampaign/CampaignPartnerThanks.vue"]};const Y="kvu_lb",Z="kvu_db",D={name:"CampaignThanks",components:{CampaignPartnerThanks:X,CheckoutReceipt:j,KvAccordionItem:B,KvLoadingSpinner:V,SocialShareV2:q},inject:["apollo","cookieStore"],head(){return{title:"Thank you!"}},props:{transactionId:{type:Number,default:null},partnerContent:{type:Object,default(){return{}}},pageSettingData:{type:Object,default:()=>{}},promoGuestCheckoutEnabled:{type:Boolean,default:!1}},data(){return{lender:{},loans:[],receipt:{},showReceipt:!1}},computed:{borrowerSupport(){const t=this.loans.map(e=>e.name);return t.length>3?`these ${t.length} borrowers`:E(t,"and")}},mounted(){this.transactionId&&this.fetchReceipt()},methods:{fetchReceipt(){const t={query:z,variables:{checkoutId:this.transactionId}};this.promoGuestCheckoutEnabled&&(t.variables.visitorId=this.cookieStore.get("uiv")||null),this.apollo.query(t).then(async({data:e})=>{var m,c,u,_,h,S,N,b,C,F,T;this.lender={...(m=e==null?void 0:e.my)==null?void 0:m.userAccount,teams:(u=(c=e==null?void 0:e.my)==null?void 0:c.teams)==null?void 0:u.values.map(p=>p.team)},this.receipt=(_=e==null?void 0:e.shop)==null?void 0:_.receipt;const n=((S=(h=this.receipt)==null?void 0:h.items)==null?void 0:S.values)??[];this.loans=n.filter(p=>p.basketItemType==="loan_reservation").map(p=>p.loan),(N=e==null?void 0:e.my)!=null&&N.userAccount||console.error(`Failed to get lender for transaction id: ${this.$route.query.kiva_transaction_id}`),this.receipt||console.error(`Failed to get receipt for transaction id: ${this.$route.query.kiva_transaction_id}`);const r=(F=(C=(b=this.receipt)==null?void 0:b.totals)==null?void 0:C.depositTotals)==null?void 0:F.depositTotal,a=this.loans.length>0,i=parseFloat(r)>0;this.cookieStore.set(Y,a,{path:"/"}),this.cookieStore.set(Z,i,{path:"/"}),R(a),A(i),P({userId:(T=this.lender)==null?void 0:T.id,hasEverLoggedIn:!0,hasLentBefore:a,hasDepositBefore:i}),this.showReceipt=!0,await this.$nextTick(),this.celebrate()})},celebrate(){const t=this.$refs.confettiCanvas;t.confetti=t.confetti||L.create(t,{resize:!0,useWorker:!0}),t.confetti({origin:{y:.2},particleCount:150,spread:200,disableForReducedMotion:!0,colors:["#d74937","#6859c0","#fee259","#118aec","#DDFFF4","#4faf4e","#aee15c"]})}}},ee={class:"campaign-thanks"},te={class:"campaign-thanks__container"},ne={class:"campaign-thanks__header hide-for-print"},ie={class:"tw-mb-4"},ae={class:"tw-text-subhead"},re={class:"data-hj-suppress"},se={class:"campaign-thanks__partner-block"},oe={key:1,class:"campaign-thanks__spinner"},le={class:"campaign-thanks__confetti-canvas",ref:"confettiCanvas"};function me(t,e,n,r,a,i){const m=l("campaign-partner-thanks"),c=l("social-share-v2"),u=l("kv-accordion-item"),_=l("checkout-receipt"),h=l("kv-loading-spinner");return o(),d("div",ee,[s("div",te,[a.loans.length>0?(o(),d(O,{key:0},[s("header",ne,[s("h2",ie," Thanks for supporting "+f(i.borrowerSupport)+"! ",1),s("p",ae,[e[0]||(e[0]=I(" We've emailed your order confirmation to ")),s("span",re,f(a.lender.email),1)])]),s("section",se,[k(m,{"partner-content":n.partnerContent,"page-setting-data":n.pageSettingData},null,8,["partner-content","page-setting-data"])]),k(u,{id:"thanks-share"},{header:v(()=>e[1]||(e[1]=[s("h2",null,"Share the Good",-1)])),default:v(()=>[k(c,{class:"campaign-thanks__social-share",lender:a.lender,loans:a.loans},null,8,["lender","loans"])],void 0),_:1}),k(u,{id:"thanks-receipt"},{header:v(()=>e[2]||(e[2]=[s("h2",null,"Receipt",-1)])),default:v(()=>[a.showReceipt?(o(),y(_,{key:0,class:"campaign-thanks__receipt","disable-redirects":!0,lender:a.lender,receipt:a.receipt},null,8,["lender","receipt"])):g("",!0)],void 0),_:1})],64)):(o(),d("div",oe,[k(h)]))]),s("canvas",le,null,512)])}const ht=x(D,[["render",me],["__scopeId","data-v-09d1a962"]]);D.__docgenInfo={displayName:"CampaignThanks",exportName:"default",description:"",tags:{},props:[{name:"transactionId",type:{name:"number"},defaultValue:{func:!1,value:"null"}},{name:"partnerContent",type:{name:"object"},defaultValue:{func:!1,value:"{}"}},{name:"pageSettingData",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}},{name:"promoGuestCheckoutEnabled",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/CorporateCampaign/CampaignThanks.vue"]};export{ht as default};
