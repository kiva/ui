import{n as r}from"./entry-numeral-DJCTM12wUX.js";import{_ as i}from"./entry-get-BUjo_hX5jl.js";import{_}from"./entry-teamInfoFromId-IKosKqIg9v.js";import{_ as y}from"./entry-includes-CAVAVivXb3.js";import{L as v}from"./entry-LoanCardImage-B-jPvvwaD0.js";import{F as k}from"./entry-FundraisingStatusMeter-CIqAUUW8XG.js";import{_ as b}from"./entry-updateLoanReservation-BaDuxVurTB.js";import{r as c,c as s,o as l,a as p,e as n,K as d,E as I}from"./entry-vue.esm-bundler-Bf_Yeyugwo.js";import{_ as L}from"./entry-_plugin-vue_export-helper-DlAUqK2UKH.js";import"./entry-_commonjsHelpers-Cpj98o6Yn6.js";import"./entry-get-D3xDH2SX94.js";import"./entry-isSymbol-5pnFTpIKM9.js";import"./entry-KvWwwHeader-CVdIzOPj6Q.js";import"./iframe-CWeBLAo0.js";import"./entry-orderBy-CUrcrXTfYx.js";import"./entry-keys-B9dmm4b_qU.js";import"./entry-loanUtils-5D9a5yj3H7.js";import"./entry-index-CNzTSTNafD.js";import"./entry-index-COmIkRYU2t.js";import"./entry-index-D4S0JsTkt8.js";import"./entry-index-CbPSoDvqj7.js";import"./entry-index-DwHITppAlA.js";import"./entry-_baseIndexOf-qfoVQuLp0t.js";import"./entry-_baseFindIndex-Ca62E79BN9.js";import"./entry-toInteger-XI_MWEAzOD.js";import"./entry-toNumber-MeiYJWOH0A.js";import"./entry-mdi-BJHOrBfjV3.js";import"./entry-KvMaterialIcon-DcajXwg-0j.js";const f={name:"AdaptiveMicroLoanCard",components:{LoanCardImage:v,FundraisingStatusMeter:k},inject:["apollo"],emits:["add-to-basket","processing-add-to-basket"],props:{itemsInBasket:{type:Array,default:()=>[]},loan:{type:Object,default:()=>({userProperties:{},loanFundraisingInfo:{},geocode:{country:{}},image:{}})},cardNumber:{type:Number,default:0},isVisitor:{type:Boolean,default:!0},country:{type:String,default:""},sector:{type:String,default:""},partner:{type:String,default:""},gender:{type:String,default:""}},computed:{itemInBasket(){return y(this.itemsInBasket,this.loan.id)},amountLeft(){const{fundedAmount:a,reservedAmount:t}=this.loan.loanFundraisingInfo;return r(this.loan.loanAmount).subtract(a).subtract(t).value()},isFunded(){return this.loan.status==="funded"||this.amountLeft<=0},percentRaised(){return r(r(this.loan.loanAmount).subtract(this.amountLeft)).divide(this.loan.loanAmount).value()},loanType(){const a=i(this.loan,"geocode.country.name"),t=i(this.loan,"sector.name"),e=i(this.loan,"partner.name"),m=i(this.loan,"gender.name"),u=i(this.loan,"activity.name");return`location=${a},sector=${t},partner=${e},gender=${m},activity=${u}`}},methods:{addToBasket(){this.$emit("processing-add-to-basket"),this.apollo.mutate({mutation:b,variables:{loanId:this.loan.id,price:r(25).format("0.00")}}).then(({errors:a})=>{this.$emit("add-to-basket",{loanId:this.loanId,success:!a}),a&&_(a,({message:t})=>{this.$showTipMsg(t,"error")}),this.$kvTrackEvent("Lending","lend-button-loan-upsell",this.loanType,this.cardNumber,this.cardNumber)}).catch(()=>{this.$showTipMsg("Failed to add loan. Please try again.","error")})},trackProfileClick(){this.$kvTrackEvent("Lending","lend-button-loan-profile",this.loanType,this.cardNumber,this.cardNumber)}}},C={class:"minimal-loan-card"},V={class:"minimal-loan-card-data-wrap"},A={class:"tw-text-small name"},B={class:"minimal-fundraising-meter"},N={class:"tw-text-small loan-data"},w={class:"minimal-loan-card-action-wrap"},T=["loan-id"],F={key:1,class:"card-action"};function M(a,t,e,m,u,o){const g=c("loan-card-image"),h=c("fundraising-status-meter");return l(),s("div",C,[p(g,{"loan-id":e.loan.id,name:e.loan.name,"retina-image-url":e.loan.image.retina,"standard-image-url":e.loan.image.default,"is-visitor":!0,onClick:o.trackProfileClick,"open-in-new-tab":!0,"use-default-styles":!1},null,8,["loan-id","name","retina-image-url","standard-image-url","onClick"]),n("div",V,[n("p",A,d(e.loan.name),1),n("div",B,[p(h,{"amount-left":o.amountLeft,"percent-raised":o.percentRaised,"is-funded":e.loan.status==="funded","short-meter":!0},null,8,["amount-left","percent-raised","is-funded"])]),n("p",N,[n("span",null,d(e.loan.geocode.country.name),1),n("span",null,d(e.loan.activity.name),1)]),n("div",w,[o.itemInBasket?(l(),s("p",F," In your basket ")):(l(),s("a",{key:0,"loan-id":e.loan.id,onClick:t[0]||(t[0]=I(x=>o.addToBasket(),["prevent"])),class:"card-action"},"Add to basket ",8,T))])])])}const le=L(f,[["render",M],["__scopeId","data-v-3de88f4f"]]);f.__docgenInfo={displayName:"AdaptiveMicroLoanCard",exportName:"default",description:"",tags:{},props:[{name:"itemsInBasket",type:{name:"array"},defaultValue:{func:!1,value:"[]"}},{name:"loan",type:{name:"object"},defaultValue:{func:!1,value:`{
    userProperties: {},
    loanFundraisingInfo: {},
    geocode: {
        country: {}
    },
    image: {}
}`}},{name:"cardNumber",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"isVisitor",type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"country",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"sector",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"partner",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"gender",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],events:[{name:"add-to-basket",type:{names:["undefined"]}},{name:"processing-add-to-basket"}],sourceFiles:["/home/runner/work/ui/ui/src/components/LoanCards/AdaptiveMicroLoanCard.vue"]};export{le as default};
