const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./entry-dropin-CUQr8-qLY8.js","./entry-_commonjsHelpers-Cpj98o6Yn6.js","./entry-syncDate-B5_baTpRcj.js","./iframe-Cc_r_Bkf.js","./entry-vue.esm-bundler-C0PPCo9W96.js","./entry-index-CWclSTHHJk.js","./entry-numeral-xVHG5DEP0A.js","./entry-kiva-logo-CXWq-YcmJ4.js","./entry-_plugin-vue_export-helper-DlAUqK2UKH.js","./entry-mdi-B1ONwcTkQ2.js","./entry-CampaignLogoGroup-R50IhBJ4kn.js","./entry-KvWwwHeader-C1bm1YMh4q.js","./KvWwwHeader-DtWMcmZI.css","./entry-KvContentfulImg-B0t9ZCrx8O.js","./entry-throttle-DL1zg7kAk0.js","./entry-isSymbol-5pnFTpIKM9.js","./entry-toNumber-MeiYJWOH0A.js","./entry-KvMaterialIcon-C3KLX5OV-L.js","./entry-imageUtils-XCIqTGZvrk.js","./entry-KvLoadingPlaceholder-B_9_tltQhY.js","./entry-settingsUtils-CXPrtFAPl-.js","./entry-get-BUjo_hX5jl.js","./entry-get-D3xDH2SX94.js","./entry-index-COmIkRYU2t.js","./entry-myKivaUtils-DUwPoPrS-N.js","./entry-logReadQueryError-Codcl0QZ_g.js","./entry-logFormatter-DhjghUk5Me.js","./entry-myKivaForAllUsers-DI6rZrUMxZ.js","./entry-KvButton-BA7nBLyz1b.js","./entry-KvLoadingSpinner-CpYE5b1xV2.js","./entry-KvPageContainer-Dh8GJwjiow.js","./entry-KvUserAvatar-DmX-R6-wYd.js","./entry-throttle-4FNEI5INvC.js","./entry-KvThemeProvider-BF4_ArwXOx.js","./entry-orderBy-CUrcrXTfYx.js","./entry-keys-B9dmm4b_qU.js","./entry-toInteger-XI_MWEAzOD.js","./entry-PromoCreditBanner-CN7uFBF8a4.js","./entry-promoCredit-w2GeqDaA1T.js","./entry-confetti.module-BCnSlh9tqh.js","./entry-lock-scroll-Bww220JhDP.js","./entry-getCacheKey-CFbvtT9xx4.js","./entry-KvTextInput-CnVgGp-sYq.js","./entry-attrs-C2OODjD6EW.js","./syncDate-bPyyfmqv.css"])))=>i.map(i=>d[i]);
import{_ as y}from"./iframe-Cc_r_Bkf.js";import{_ as l}from"./entry-get-BUjo_hX5jl.js";import{n as f}from"./entry-numeral-xVHG5DEP0A.js";import{K as g}from"./entry-KvLoadingSpinner-KUfNgrvm0_.js";import{c as k,o as u,q as v,z as I,m as b,r as P}from"./entry-vue.esm-bundler-C0PPCo9W96.js";import{_}from"./entry-_plugin-vue_export-helper-DlAUqK2UKH.js";import{w as c,a as m}from"./entry-exports-CudK1O5XNw.js";import"./entry-_commonjsHelpers-Cpj98o6Yn6.js";import"./entry-get-D3xDH2SX94.js";import"./entry-isSymbol-5pnFTpIKM9.js";const D=`query getClientToken($useCustomerId: Boolean = false) {
	shop {
		id
		getClientToken(useCustomerId: $useCustomerId)
	}
}
`,T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getClientToken"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"useCustomerId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shop"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"getClientToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"useCustomerId"},value:{kind:"Variable",name:{kind:"Name",value:"useCustomerId"}}}],directives:[]}]}}]}}],loc:{start:0,end:160,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:D}}},h={name:"BraintreeDropInInterface",components:{KvLoadingSpinner:g},inject:["apollo"],emits:["transactions-enabled"],props:{amount:{type:String,default:""},flow:{type:String,default:"checkout",validator(e){return["checkout","vault"].indexOf(e)!==-1}},preselectVaultedPaymentMethod:{type:Boolean,default:!0},paymentTypes:{type:Array,default:()=>["paypal","card"],validator(e){const n=["card","paypal","paypalCredit","venmo","applePay","googlePay"];return e.every(t=>n.includes(t))}},auth:{type:String,default:"client-token",validator(e){return["token-key","client-token"].indexOf(e)!==-1}}},data(){return{btDropinInstance:()=>{},clientToken:null,updatingPaymentWrapper:!1}},computed:{formattedAmount(){return f(this.amount).format("0.00")},applePaymentRequest(){return{total:{label:"Kiva",amount:this.formattedAmount},requiredBillingContactFields:["postalAddress"]}},googleTransactionInfo(){return{totalPriceStatus:"FINAL",totalPrice:this.formattedAmount,currencyCode:"USD"}}},watch:{amount:{handler(e,n){var t,a,o,s,r,p,i,d;e!==n&&((a=(t=this.btDropinInstance)==null?void 0:t.updateConfiguration)==null||a.call(t,"paypal","amount",this.formattedAmount),(s=(o=this.btDropinInstance)==null?void 0:o.updateConfiguration)==null||s.call(o,"paypalCredit","amount",this.formattedAmount),(p=(r=this.btDropinInstance)==null?void 0:r.updateConfiguration)==null||p.call(r,"googlePay","transactionInfo",this.googleTransactionInfo),(d=(i=this.btDropinInstance)==null?void 0:i.updateConfiguration)==null||d.call(i,"applePay","paymentRequest",this.applePaymentRequest))},immediate:!0}},methods:{setUpdatingPaymentWrapper(e){this.updatingPaymentWrapper=e},getDropInAuthToken(){this.auth==="client-token"&&(this.setUpdatingPaymentWrapper(!0),this.apollo.query({query:T,variables:{amount:this.formattedAmount,useCustomerId:!0}}).then(e=>{if(e.errors){this.setUpdatingPaymentWrapper(!1),console.error(e.errors);const n=l(e,"errors[0].code"),t=l(e,"errors[0].message");c(a=>{a.setTag("bt_stage_dropin","btGetClientTokenError"),a.setTag("bt_get_client_token_error",t),m(n)}),this.$showTipMsg("An Error has occured. Please refresh the page and try again.","error")}else this.clientToken=l(e,"data.shop.getClientToken"),this.initializeDropIn(this.clientToken)}).catch(e=>{console.error(e),this.$showTipMsg("An Error has occured. Please refresh the page and try again.","error")})),this.auth==="token-key"&&this.initializeDropIn(this.$appConfig.btTokenKey)},async initializeDropIn(e){const{default:n}=await y(async()=>{const{default:t}=await import("./entry-dropin-CUQr8-qLY8.js").then(a=>a.d);return{default:t}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44]),import.meta.url);setTimeout(()=>this.setUpdatingPaymentWrapper(!1),500),n.create({authorization:e,container:"#dropin-container",dataCollector:{kount:!0},paymentOptionPriority:this.paymentTypes,preselectVaultedPaymentMethod:this.preselectVaultedPaymentMethod,card:{vault:{allowVaultCardOverride:!0}},paypal:{flow:this.flow,amount:this.formattedAmount,currency:"USD",buttonStyle:{color:"gold",shape:"rect",size:"responsive"}},googlePay:{googlePayVersion:2,merchantId:this.$appConfig.googlePay.merchantId,transactionInfo:this.googleTransactionInfo,allowedPaymentMethods:[{type:"CARD",parameters:{billingAddressRequired:!0,billingAddressParameters:{format:"FULL"}}}]},applePay:{displayName:"Kiva",paymentRequest:this.applePaymentRequest}}).then(t=>{this.btDropinInstance=t,this.initializeDropInActions()}).catch(t=>{console.error(t),c(a=>{a.setTag("bt_stage_dropin","btCreateError"),a.setTag("bt_client_create_error",t.message),m(t.code)}),this.$showTipMsg("An Error has occured. Please refresh the page and try again.","error")})},initializeDropInActions(){this.btDropinInstance.isPaymentMethodRequestable()&&this.$emit("transactions-enabled",!0),this.btDropinInstance.on("paymentMethodRequestable",e=>{this.$emit("transactions-enabled",!0)}),this.btDropinInstance.on("noPaymentMethodRequestable",()=>{this.$emit("transactions-enabled",!1)})}},mounted(){var n;((n=document==null?void 0:document.getElementById("dropin-container"))==null?void 0:n.innerHTML)===""&&this.getDropInAuthToken()}},C={class:"drop-in-wrapper"};function A(e,n,t,a,o,s){const r=P("kv-loading-spinner");return u(),k("div",C,[n[0]||(n[0]=v("div",{id:"dropin-container",class:"data-hj-suppress"},null,-1)),o.updatingPaymentWrapper?(u(),I(r,{key:0})):b("",!0)])}const z=_(h,[["render",A],["__scopeId","data-v-5162c6c5"]]);h.__docgenInfo={displayName:"BraintreeDropInInterface",description:`Displays the Braintree Drop In Interface
For reference see:
https://braintree.github.io/braintree-web-drop-in/docs/current/module-braintree-web-drop-in.html`,tags:{},exportName:"default",props:[{name:"amount",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"flow",description:`Paypal flow options.
Must be 'checkout' or 'vault'`,type:{name:"string"},defaultValue:{func:!1,value:"'checkout'"},values:["checkout","vault"]},{name:"preselectVaultedPaymentMethod",description:`Preselect Vaulted Payment Method
Braintree option to preselect payment method`,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"paymentTypes",description:`Payment type options to be displayed.
Also controls the order to display them in.
All options in default order:
['card', 'paypal', 'paypalCredit', 'venmo', 'applePay', 'googlePay']`,type:{name:"array"},defaultValue:{func:!1,value:"['paypal', 'card']"}},{name:"auth",description:`Drop-In auth options
Must be 'token-key' or 'client-token'`,type:{name:"string"},defaultValue:{func:!1,value:"'client-token'"},values:["token-key","client-token"]}],events:[{name:"transactions-enabled",type:{names:["undefined"]}}],sourceFiles:["/home/runner/work/ui/ui/src/components/Payment/BraintreeDropInInterface.vue"]};export{z as default};
