import{T,d as w}from"./entry-syncDate-B5_baTpRcj.js";import{l as P}from"./entry-logReadQueryError-Codcl0QZ_g.js";import{T as F,C as E}from"./entry-TheBasketBar-Cgdj9ciXsz.js";import{b as N,s as q,a as I,T as O}from"./entry-TheFooter-95dkQre_cW.js";import{p as x,h as H}from"./entry-promoCredit-w2GeqDaA1T.js";import{n as g}from"./entry-numeral-xVHG5DEP0A.js";import{_ as j}from"./entry-updateDonation-CfhElOgRHH.js";import{A as L}from"./entry-AppealBannerCircular-CqQXAmYjz8.js";import{r as m}from"./entry-rich-text-html-renderer.es5-kBaKhcHuza.js";import{z as p,r as s,o as c,c as v,m as h,D as b,E as B,a as u,G as R,v as _,q as G,A as U}from"./entry-vue.esm-bundler-C0PPCo9W96.js";import{_ as f}from"./entry-_plugin-vue_export-helper-DlAUqK2UKH.js";import{G as W}from"./entry-GenericPromoBanner-CbAKwaWum3.js";import{D as K}from"./entry-DonationBanner-7RI-GJmEu8.js";const V=`query hasEverLoggedIn {
	hasEverLoggedIn @client
}
`,Q={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"hasEverLoggedIn"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasEverLoggedIn"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[]}]}]}}],loc:{start:0,end:89,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:V}}},$=`query appealBanner {
	general {
		kivaStats {
			latestDonationCampaign {
				amount_raised
				target_amount
			}
		}
	}
}
`,M={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appealBanner"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"general"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"kivaStats"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latestDonationCampaign"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"amount_raised"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"target_amount"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:162,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:$}}},y={name:"AppealBannerCircularContainer",components:{AppealBannerCircular:L},inject:["apollo","cookieStore"],apollo:{query:M,preFetch:!0,result({data:e}){var n,a,r,t,o,i;this.amountRaised=(r=(a=(n=e==null?void 0:e.general)==null?void 0:n.kivaStats)==null?void 0:a.latestDonationCampaign)==null?void 0:r.amount_raised,this.targetAmount=(i=(o=(t=e==null?void 0:e.general)==null?void 0:t.kivaStats)==null?void 0:o.latestDonationCampaign)==null?void 0:i.target_amount}},props:{appealBannerContent:{type:Object,default:()=>{}}},data(){return{targetAmount:null,amountRaised:null,isOpen:!0}},computed:{headline(){var a;const e=((a=this.appealBannerContent)==null?void 0:a.richText)||"",n={renderNode:{paragraph:(r,t)=>`${t(r.content)}`}};return m.documentToHtmlString(e,n)},body(){var n,a,r,t;const e=((t=(r=(a=(n=this.appealBannerContent)==null?void 0:n.additionalContent)==null?void 0:a[0])==null?void 0:r.fields)==null?void 0:t.richText)||"";return m.documentToHtmlString(e)},buttonAmounts(){var n,a;return((a=(n=this.appealBannerContent)==null?void 0:n.dataObject)==null?void 0:a.donationAmounts)||""},imageUrl(){var e,n,a,r,t,o,i;return((i=(o=(t=(r=(a=(n=(e=this.appealBannerContent)==null?void 0:e.additionalContent)==null?void 0:n.find(l=>{var d;return((d=l==null?void 0:l.fields)==null?void 0:d.name)==="Progress Meter Image"}).fields)==null?void 0:a.images)==null?void 0:r[0])==null?void 0:t.fields)==null?void 0:o.file)==null?void 0:i.url)||""},hasDisclaimer(){var n,a,r;return(((r=(a=(n=this.appealBannerContent)==null?void 0:n.disclaimers)==null?void 0:a.content)==null?void 0:r[0])??"")!==""}},created(){const e=this.cookieStore.get("appeal_banner_is_open");typeof e>"u"?this.isOpen=!0:this.isOpen=e==="true"},methods:{onToggleBanner(e){this.isOpen=e,this.cookieStore.set("appeal_banner_is_open",e,{path:"/"})},onAmountSelected(e){this.apollo.mutate({mutation:j,variables:{price:g(e).format("0.00"),isTip:!0}}).then(n=>{n.errors?n.errors.forEach(({message:a})=>{this.$showTipMsg(a,"error")}):(this.$kvTrackEvent("/support-kiva","Donate from Macro","Donation from Macro",g(e).value()*100,g(e).value()*100),this.$router.push({path:"/checkout"}))}).catch(n=>{console.error(n)})}}};function z(e,n,a,r,t,o){const i=s("appeal-banner-circular");return c(),p(i,{"target-amount":t.targetAmount,"amount-raised":t.amountRaised,"button-amounts":o.buttonAmounts,headline:o.headline,body:o.body,"image-url":o.imageUrl,"is-open":t.isOpen,disclaimer:o.hasDisclaimer,onToggleBanner:o.onToggleBanner,onAmountSelected:o.onAmountSelected},null,8,["target-amount","amount-raised","button-amounts","headline","body","image-url","is-open","disclaimer","onToggleBanner","onAmountSelected"])}const J=f(y,[["render",z]]);y.__docgenInfo={displayName:"AppealBannerCircularContainer",exportName:"default",description:"",tags:{},props:[{name:"appealBannerContent",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/WwwFrame/PromotionalBanner/Banners/AppealBanner/AppealBannerCircularContainer.vue"]};const k={name:"DonationBannerContainer",components:{DonationBanner:K},props:{donationBannerContent:{type:Object,default:()=>{}}},data(){return{isOpen:!0}},computed:{headline(){var a;const e=((a=this.donationBannerContent)==null?void 0:a.richText)||"",n={renderNode:{paragraph:(r,t)=>`${t(r.content)}`}};return m.documentToHtmlString(e,n)},body(){var n,a,r,t;const e=((t=(r=(a=(n=this.donationBannerContent)==null?void 0:n.additionalContent)==null?void 0:a[0])==null?void 0:r.fields)==null?void 0:t.richText)||"";return m.documentToHtmlString(e)},buttonAmounts(){var e,n;return((n=(e=this.donationBannerContent)==null?void 0:e.dataObject)==null?void 0:n.donationAmounts)||[]},frequency(){var e,n;return((n=(e=this.donationBannerContent)==null?void 0:e.dataObject)==null?void 0:n.frequency)||"once"},bannerImageUrl(){var e,n,a,r;return((r=(a=(n=(e=this.donationBannerContent)==null?void 0:e.bannerImage)==null?void 0:n.fields)==null?void 0:a.file)==null?void 0:r.url)||""},hasDisclaimer(){var n,a,r;return(((r=(a=(n=this.donationBannerContent)==null?void 0:n.disclaimers)==null?void 0:a.content)==null?void 0:r[0])||"")!==""}},methods:{onCloseBanner(){this.isOpen=!1}}};function X(e,n,a,r,t,o){const i=s("donation-banner");return c(),v("div",null,[t.isOpen?(c(),p(i,{key:0,"button-amounts":o.buttonAmounts,headline:o.headline,body:o.body,disclaimer:o.hasDisclaimer,"banner-image-url":o.bannerImageUrl,frequency:o.frequency,onCloseBanner:o.onCloseBanner},null,8,["button-amounts","headline","body","disclaimer","banner-image-url","frequency","onCloseBanner"])):h("",!0)])}const Y=f(k,[["render",X]]);k.__docgenInfo={displayName:"DonationBannerContainer",exportName:"default",description:"",tags:{},props:[{name:"donationBannerContent",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/WwwFrame/PromotionalBanner/Banners/Donation/DonationBannerContainer.vue"]};const C={name:"GlobalPromotionalBannerContentful",components:{AppealBannerCircularContainer:J,GenericPromoBanner:W,DonationBannerContainer:Y},data(){return{activeBanner:{},hasPromoSession:!1,isUserDataLoading:!1}},inject:{apollo:{default:null},cookieStore:{default:null}},apollo:[{query:x,preFetch:!0,shouldPreFetch(e,{renderConfig:n}){return!n.useCDNCaching},result({data:e}){this.isUserDataLoading=!1,this.hasPromoSession=H(e)}},{query:N,preFetch:!0,result({data:e}){this.activeBanner=I(e,this.$route.path)??{}}}],created(){const{useCDNCaching:e}=this.$renderConfig;this.isUserDataLoading=e},computed:{hiddenForPromoCredit(){return this.hasPromoSession&&!q(this.activeBanner)},promoBannerContent(){var e,n,a;return(e=this.activeBanner)!=null&&e.fields?{disclaimer:((a=(n=this.activeBanner.fields.disclaimers)==null?void 0:n.content)==null?void 0:a[0])??null,kvTrackEvent:this.activeBanner.fields.kvTrackEvent,link:this.activeBanner.fields.link,richText:m.documentToHtmlString(this.activeBanner.fields.richText),iconKey:this.activeBanner.fields.iconKey??""}:{}},appealEnabled(){var e,n;return((n=(e=this.activeBanner)==null?void 0:e.fields)==null?void 0:n.bannerType)==="Appeal Banner"&&!this.hiddenForPromoCredit},customAppealEnabled(){var e,n;return((n=(e=this.activeBanner)==null?void 0:e.fields)==null?void 0:n.bannerType)==="Custom Appeal"&&!this.hiddenForPromoCredit},donationEnabled(){var e,n;return((n=(e=this.activeBanner)==null?void 0:e.fields)==null?void 0:n.bannerType)==="Donation Banner"&&!this.hiddenForPromoCredit},isPromoEnabled(){var e;return((e=this.activeBanner)==null?void 0:e.fields)&&!this.appealEnabled&&!this.customAppealEnabled&&!this.donationEnabled&&!this.hiddenForPromoCredit}}};function Z(e,n,a,r,t,o){const i=s("generic-promo-banner"),l=s("appeal-banner-circular-container"),d=s("donation-banner-container");return c(),v("div",{class:"print:tw-hidden",style:R(t.isUserDataLoading?{display:"var(--ui-data-global-promo-banner-display, block)"}:{})},[b(u(i,{"icon-key":o.promoBannerContent.iconKey,"promo-banner-content":o.promoBannerContent},null,8,["icon-key","promo-banner-content"]),[[B,o.isPromoEnabled]]),o.appealEnabled?(c(),p(l,{key:0,"appeal-banner-content":t.activeBanner.fields},null,8,["appeal-banner-content"])):h("",!0),o.donationEnabled?(c(),p(d,{key:1,"donation-banner-content":t.activeBanner.fields},null,8,["donation-banner-content"])):h("",!0)],4)}const ee=f(C,[["render",Z]]);C.__docgenInfo={displayName:"GlobalPromotionalBannerContentful",exportName:"default",description:"",tags:{},sourceFiles:["/home/runner/work/ui/ui/src/components/WwwFrame/PromotionalBanner/GlobalPromotionalBannerContentful.vue"]};const S={name:"WwwPage",inject:["apollo","cookieStore"],components:{CookieBanner:E,GlobalPromoContentful:ee,TheBasketBar:F,TheFooter:O,TheHeader:T},props:{grayBackground:{type:Boolean,default:!1},hideSearchInHeader:{type:Boolean,default:!1},mainClass:{type:[Object,String],default:""}},data(){return{isKivaAppReferral:!1}},created(){var e,n;this.isKivaAppReferral=((n=(e=this.$route)==null?void 0:e.query)==null?void 0:n.kivaAppReferral)==="true"},mounted(){try{const e=this.apollo.readQuery({query:Q});w(e==null?void 0:e.hasEverLoggedIn)}catch(e){P(e,"User has ever logged in")}},computed:{mainClasses(){return[this.mainClass,{"tw-bg-secondary":this.grayBackground}]}}},ne={class:"www-page"};function ae(e,n,a,r,t,o){const i=s("global-promo-contentful"),l=s("the-header"),d=s("the-footer"),A=s("the-basket-bar"),D=s("cookie-banner");return c(),v("div",ne,[b(u(i,null,null,512),[[B,!t.isKivaAppReferral]]),b(u(l,{"hide-search-in-header":a.hideSearchInHeader},null,8,["hide-search-in-header"]),[[B,!t.isKivaAppReferral]]),t.isKivaAppReferral?h("",!0):_(e.$slots,"secondary",{key:0}),G("main",{class:U(o.mainClasses)},[_(e.$slots,"tertiary"),_(e.$slots,"default")],2),u(d),u(A),u(D)])}const ge=f(S,[["render",ae]]);S.__docgenInfo={displayName:"WwwPage",exportName:"default",description:"",tags:{},props:[{name:"grayBackground",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"hideSearchInHeader",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"mainClass",type:{name:"object|string"},defaultValue:{func:!1,value:"''"}}],slots:[{name:"secondary"},{name:"tertiary"},{name:"default"}],sourceFiles:["/home/runner/work/ui/ui/src/components/WwwFrame/WwwPage.vue"]};export{ge as W};
