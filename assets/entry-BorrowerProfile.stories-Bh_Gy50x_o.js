const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./entry-twitter-logo-CKBJE5jZoB.js","./entry-vue.esm-bundler-Bf_Yeyugwo.js","./entry-yelp-logo-B3xvN1uhUN.js","./entry-etsy-logo-XXt8qaIMUO.js","./entry-facebook-logo-CxXOeoqLhG.js","./entry-instagram-logo-CTb2FALcXo.js","./entry-linkedin-logo-9_C1iJf6OB.js"])))=>i.map(i=>d[i]);
import{A as na,c as _t,d as ii,g as oi,b as ri,e as si,t as rt,f as li}from"./entry-loanUtils-5D9a5yj3H7.js";import{n as pe,g as K}from"./entry-numeral-DJCTM12wUX.js";import{t as en,k as Wt,l as di,m as ui}from"./entry-syncDate-BmkM6LdPy7.js";import{u as mi,g as ci}from"./entry-useGoalData-Ca1kvn8G_3.js";import{W as pi}from"./entry-WwwPage-D-sW1TnUWL.js";import{r as g,f as x,o as s,b as _,F,e as o,E as Be,g as Ve,d as v,c as u,a as p,J as D,K as b,G as De,T as Zt,z as tn,h as G,j as J,w as nn,A as an,S as hi,v as fi,n as Q,x as le,B as gi,H,P as de,k as zt,u as Cn,I as Y,D as wi,R as We,y as vi,O as bi}from"./entry-vue.esm-bundler-Bf_Yeyugwo.js";import{s as aa}from"./entry-KvWwwHeader-CVdIzOPj6Q.js";import{g as dt}from"./entry-KvGrid-A3hpmYTsti.js";import{x as Dt}from"./entry-KvPageContainer-B9-1kg27t_.js";import{_ as B}from"./entry-_plugin-vue_export-helper-DlAUqK2UKH.js";import{H as ia}from"./entry-HeroBackground-Cf59T6vSbl.js";import{c as yi,m as oa,B as _i,C as ki,r as Li,M as Ci,N as Si,O as ra,d as xi,P as Ii,Q as Ti,I as Ni,p as sa,R as Ai,S as Di,w as la,T as Pi,U as Mi}from"./entry-mdi-BJHOrBfjV3.js";import{H as Ri}from"./entry-heart-comment-BO5gGNt_k4.js";import{w as _e}from"./entry-KvMaterialIcon-DcajXwg-0j.js";import{_ as ge}from"./entry-KvLoadingPlaceholder-DUZzoT9CoU.js";import{B as ut}from"./entry-BorrowerImage-WXGsRE2huI.js";import{S as Ei,B as da}from"./entry-SummaryTag-BL5nRGkmuD.js";import{q as Fi}from"./entry-KvProgressBar-CQtXD0YVwH.js";import{x as Oi,a as Bi,s as Vi,L as $i,l as qi,b as Sn}from"./entry-teamInfoFromId-IKosKqIg9v.js";import{s as zi,I as Ui}from"./entry-injectionCheck-B-GzsW2qm5.js";import{c as Me}from"./entry-observerUtils-DveHpw6JZJ.js";import{s as ji}from"./entry-smooth-scroll-mixin-Coaqv0J44m.js";import{L as Hi}from"./entry-ActionButton-DBlbdMcglY.js";import{K as Ki}from"./entry-KvIcon-DpMQFaEAGT.js";import{U as Ze}from"./entry-KvButton-DF0Vhz1EWA.js";import{L as Gi}from"./entry-KvSelect-DG6WmDJ0xC.js";import{u as Wi}from"./entry-vue-router-DdFAIqQzgT.js";import{l as ot}from"./entry-logFormatter-DhjghUk5Me.js";import{g as Zi,M as Qi,_ as Yi}from"./entry-myKivaUtils-USlSQzpKdw.js";import{c as Xi}from"./entry-throttle-DR-Bh3IiJx.js";import{a as Ji,C as eo,t as to,o as no,n as ao,b as io,u as mt}from"./entry-KvLightbox-Ccr5YlTKqp.js";import{u as oo,C as ro}from"./entry-useBadgeData-BVPFKdTbm4.js";import{_ as so}from"./entry-basketItems-B-09YWrzPC.js";import{r as lo}from"./entry-settingsUtils-CXPrtFAPl-.js";import{d as xn}from"./entry-achievementUtils-Cf0LlmQMSn.js";import{K as uo}from"./entry-KvExpandable-DeDyumYo7d.js";import{K as ct}from"./entry-KvTextLink-CFK6VYUYhK.js";import{l as Qt}from"./entry-logReadQueryError-Codcl0QZ_g.js";import{K as mo}from"./entry-KvLoadingSpinner-D6PAL1PtJd.js";import{K as co}from"./entry-KivaClassicLoanCarousel-k0btLiNi28.js";import{_ as po}from"./entry-KivaClassicBasicLoanCard-mqx9jt4fGB.js";import{a as ho}from"./entry-flssUtils-DWsTzfBCU6.js";import{d as fo}from"./entry-contentfulUtils-CqD1k4MYgu.js";import{H as go,_ as wo}from"./entry-KvTabs-Dt0rMR23wJ.js";import{I as vo}from"./entry-KvTabPanel-Dqe0lxZDeq.js";import{r as bo}from"./entry-rich-text-html-renderer.es5-kBaKhcHuza.js";import{f as st}from"./entry-index-CGacd2nhU3.js";import{p as Pe,b as yo}from"./entry-index-CNzTSTNafD.js";import{r as _o,t as In}from"./entry-index-COmIkRYU2t.js";import{K as ko}from"./entry-KvMap-CASSCa2mwP.js";import{_ as lt}from"./entry-throttle-DL1zg7kAk0.js";import{K as Lo}from"./entry-KvTooltip-Dc9Ho_TJhC.js";import{_ as Qe}from"./iframe-CWeBLAo0.js";import{w as Co,c as So}from"./entry-exports-CudK1O5XNw.js";import{c as xo}from"./entry-click-outside-DsIhxHJU82.js";import{w as Io,d as To}from"./entry-imageUtils-_95xo2d0ng.js";import{l as No}from"./entry-KvCarousel--umaisw_ND.js";import{O as Ao}from"./entry-KvRadio-Ckc1q-vBRD.js";import{S as Do}from"./entry-ShareButton-B3Ylkxw3-A.js";import{K as Po}from"./entry-KvSocialShareButton-7rHfWlFtkv.js";import{m as Mo}from"./entry-importHelpers-zIMYNa8D_v.js";import{J as Ro}from"./entry-KvUserAvatar-CcUKtQr-4i.js";import{X as Eo}from"./entry-KvToast-DVJJx3ySa7.js";import{a as on}from"./entry-apollo-story-mixin-CB9BNmK9U5.js";import{c as rn}from"./entry-cookie-store-story-mixin-Bv_t57ys9l.js";import{k as sn}from"./entry-kv-auth0-story-mixin-DxLGBTBTDx.js";import{m as Fo}from"./entry-utils-LVhxYihmNs.js";import"./entry-get-BUjo_hX5jl.js";import"./entry-_commonjsHelpers-Cpj98o6Yn6.js";import"./entry-get-D3xDH2SX94.js";import"./entry-isSymbol-5pnFTpIKM9.js";import"./entry-kiva-logo-fyRkKmi0FM.js";import"./entry-touchEvents-DzV-rvy7P4.js";import"./entry-CampaignLogoGroup-D5aVYDQ4uA.js";import"./entry-KvContentfulImg-ClwkYYkTk_.js";import"./entry-myKivaForAllUsers-DI6rZrUMxZ.js";import"./entry-KvThemeProvider-CJZWo36001.js";import"./entry-orderBy-CUrcrXTfYx.js";import"./entry-keys-B9dmm4b_qU.js";import"./entry-toInteger-XI_MWEAzOD.js";import"./entry-toNumber-MeiYJWOH0A.js";import"./entry-PromoCreditBanner-CCrPa6t4Rf.js";import"./entry-promoCredit-A8tDfJh8uJ.js";import"./entry-lock-scroll-Bww220JhDP.js";import"./entry-getCacheKey-BX3EO2qX-W.js";import"./entry-KvTextInput-DOWiWB5Pob.js";import"./entry-attrs-C2OODjD6EW.js";import"./entry-loanAddComment-DvQEPf3nxH.js";import"./entry-TheBasketBar-CAfv021hcH.js";import"./entry-KvButton-CZu-utW0a_.js";import"./entry-basketCount-CZ-kE9ye_Z.js";import"./entry-TheFooter-B50H37oieJ.js";import"./entry-KvAccordionItem-BUdedcIFQ1.js";import"./entry-urlUtils-D59-4GikCB.js";import"./entry-updateDonation-CfhElOgRHH.js";import"./entry-AppealBannerCircular-D3bqh_0eaU.js";import"./entry-KvProgressCircle-Dl0vzA6hWT.js";import"./entry-GenericPromoBanner-xsZONbxoWL.js";import"./entry-DonationBanner-BukgKHfxUA.js";import"./entry-index-DwHITppAlA.js";import"./entry-updateLoanReservation-BaDuxVurTB.js";import"./entry-includes-CAVAVivXb3.js";import"./entry-_baseIndexOf-qfoVQuLp0t.js";import"./entry-_baseFindIndex-Ca62E79BN9.js";import"./entry-KvLoadingSpinner-D0IZcQeh_0.js";import"./entry-time-left-mixin-BgOgttSZrl.js";import"./entry-KvLoadingParagraph-B1vku9KEXS.js";import"./entry-LoanTag-ByD8VlFF-R.js";import"./entry-filterConfig-CYtqWPfM7q.js";import"./entry-numberUtils-CJK53TfNzV.js";import"./entry-filterUtils-D0mz1tA9_E.js";import"./entry-sortOptions-DCsqn1mIXB.js";import"./entry-regions-iDsXyep4ay.js";import"./entry-index-Dew-HucFLB.js";import"./entry-index-CbPSoDvqj7.js";import"./entry-index-tAHLmhMYuW.js";import"./entry-index-D4S0JsTkt8.js";import"./entry-index.browser-vcSNLBTfP4.js";import"./entry-social-sharing-mixin-mcFPgMmQne.js";import"./entry-loan-data-mock-B1RgYuoN0n.js";function Tn(t,e){_o(2,arguments);var a=In(t),r=In(e);return a.getTime()<r.getTime()}const Oo={components:{KvMaterialIcon:_e,KvButton:Ze},props:{visible:{type:Boolean,default:!1},preventClose:{type:Boolean,default:!1},basketCount:{type:Number,default:0},categoryName:{type:String,default:""}},emits:["cart-modal-closed"],setup(t,{emit:e}){const{visible:a,preventClose:r}=tn(t),n=G(null),i=G(null),l=G(null),m=G(),c=J(()=>[n.value]),h=J(()=>!!t.categoryName),f=J(()=>h.value?`Support another ${t.categoryName}`:`View basket (${t.basketCount})`),{activate:k,deactivate:w}=Ji(c,{allowOutsideClick:!0});let C=null,I=null;const T=(q="")=>{n.value&&i.value&&(w(),i.value.scrollTop=0,ao(i.value)),io(),C&&(C(),C=null),document.removeEventListener("keyup",I),e("cart-modal-closed",{type:q})};I=q=>{q&&q.key==="Escape"&&!r.value&&T()};const P=()=>{r.value||T("background")},L=()=>{a.value&&(document.addEventListener("keyup",I),fi(()=>{n.value&&i.value&&(k(),C=eo(n.value),to(i.value)),no()}))},O=q=>{T(q)},E=()=>{r.value||(m.value=setTimeout(()=>{e("cart-modal-closed",{type:"time"})},1e4))},V=()=>{r.value||clearTimeout(m.value)};return nn(a,()=>{a.value?(L(),E()):T()}),an(()=>{a.value&&(L(),E())}),hi(()=>T()),{mdiClose:oa,mdiCheckCircle:yi,onKeyUp:I,onScreenClick:P,hide:T,show:L,controlsRef:l,handleClick:O,clearAutomaticClose:V,setAutomaticClose:E,ctaText:f,showCategoryOption:h}}},Bo={class:"container"},Vo={class:"tw-flex tw-pt-2 tw-px-2.5"},$o={class:"tw-flex tw-flex-grow tw-gap-1 tw-items-center tw-pb-2"},qo={id:"kvCartModalBody",ref:"kvCartModalBody",class:"tw-flex tw-gap-2"},zo={ref:"controlsRef",class:"tw-flex-shrink-0 tw-flex tw-justify-end tw-gap-x-2.5 tw-px-2.5 tw-pb-2 tw-flex-col tw-gap-1"};function Uo(t,e,a,r,n,i){const l=g("kv-material-icon"),m=g("kv-button");return s(),x(Zt,{"enter-active-class":"tw-transition-opacity tw-duration-300","leave-active-class":"tw-transition-opacity tw-duration-300","enter-class":"tw-opacity-0","enter-to-class":"tw-opacity-full","leave-class":"tw-opacity-full","leave-to-class":"tw-opacity-0"},{default:_(()=>[F(o("div",{class:"screen",onClick:e[6]||(e[6]=Be((...c)=>r.onScreenClick&&r.onScreenClick(...c),["stop","prevent"]))},[o("div",null,[o("div",Bo,[o("div",{ref:"kvCartModal",tabindex:"-1","data-test":"kv-cart-modal",class:"modal","aria-modal":"true","aria-label":"Added to basket",onClick:e[3]||(e[3]=Be(()=>{},["stop"])),onMouseenter:e[4]||(e[4]=c=>r.clearAutomaticClose()),onMouseleave:e[5]||(e[5]=c=>r.setAutomaticClose())},[o("div",Vo,[o("div",$o,[Ve(t.$slots,"header",{},()=>[p(l,{class:"tw-w-3.5 tw-h-3.5 tw-text-brand",icon:r.mdiCheckCircle},null,8,["icon"]),e[7]||(e[7]=o("p",{class:"tw-flex-1 tw-font-medium tw-text-center"}," Added to basket ",-1))],!0),a.preventClose?v("",!0):(s(),u("button",{key:0,class:"tw-grid tw-content-center tw-justify-center tw-ml-auto tw-w-6 tw-h-6 tw--m-2 hover:tw-text-action-highlight",onClick:e[0]||(e[0]=Be(c=>r.hide("x-button"),["stop"]))},[p(l,{class:"tw-w-3.5 tw-h-3.5",icon:r.mdiClose},null,8,["icon"]),e[8]||(e[8]=o("span",{class:"tw-sr-only"},"Close",-1))]))])]),o("div",qo,[Ve(t.$slots,"content",{},void 0,!0)],512),o("div",zo,[p(m,{class:"tw-w-full",onClick:e[1]||(e[1]=c=>r.handleClick(r.showCategoryOption?"support-another":"view-basket"))},{default:_(()=>[D(b(r.ctaText),1)]),_:1}),r.showCategoryOption?(s(),u("button",{key:0,class:"tw-text-action tw-pt-1.5 tw-font-medium",onClick:e[2]||(e[2]=c=>r.handleClick("view-basket"))}," No thanks, go to basket ("+b(a.basketCount)+") ",1)):v("",!0)],512)],544)])])],512),[[De,a.visible]])]),_:3})}const jo=aa(Oo,[["render",Uo],["__scopeId","data-v-4af12153"]]),Ho={components:{KvCartModal:jo,KvCartPill:Oi},props:{modalVisible:{type:Boolean,default:!1},addedLoan:{type:Object,default:()=>({})},userData:{type:Object,default:()=>({})},photoPath:{type:String,default:""},milestonesNumber:{type:Number,default:0},showModalContent:{type:Boolean,default:!1},hasEverLoggedIn:{type:Boolean,default:!1},myKivaExperimentEnabled:{type:Boolean,default:!1},oneLoanAwayCategory:{type:String,default:""},oneLoanAwayFilteredUrl:{type:String,default:""},oneAwayText:{type:String,default:""},milestonesProgress:{type:Object,default:()=>({})},isLoanGoal:{type:Boolean,default:!1},isCompletingGoal:{type:Boolean,default:!1}},emits:["reset-modal","close-redirect"],setup(t,{emit:e}){const{modalVisible:a,addedLoan:r,userData:n,hasEverLoggedIn:i,myKivaExperimentEnabled:l,oneLoanAwayCategory:m,oneLoanAwayFilteredUrl:c,milestonesProgress:h}=tn(t),f=G(0),k=G(0),w=J(()=>{var M;return((M=r.value)==null?void 0:M.basketSize)??0}),C=J(()=>{const M=window.innerWidth-k.value-200,z=`${M>0?M:0}`,ae=`${f.value}`;return{right:z,top:ae}}),I=J(()=>{var M;return(M=r.value)==null?void 0:M.name}),T=J(()=>{var M;return!((M=n.value)!=null&&M.my)}),P=J(()=>{var M,z,ae;return l.value&&(T.value&&!i.value||!T.value&&!((ae=(z=(M=n.value)==null?void 0:M.my)==null?void 0:z.loans)!=null&&ae.totalCount))&&w.value===1}),L=J(()=>m.value&&c.value&&!P.value),O=J(()=>Object.values(h.value).reduce((M,z)=>M+(z>0?z:0),0)),E=J(()=>{var M,z,ae;if(t.isCompletingGoal)return`Supporting ${I.value} meets your annual goal!`;if(t.isLoanGoal)return"You’re closer to reaching your annual goal!";if(P.value){const me=`Supporting ${I.value} helps`;return((M=r.value)==null?void 0:M.borrowerCount)>1||(z=r.value)!=null&&z.themes.includes("Social Enterprise")?`${me} them invest in themselves.`:((ae=r.value)==null?void 0:ae.gender)==="male"?`${me} him invest in himself.`:`${me} her invest in herself.`}if(L.value)return"You’re close to your next achievement!";const we=O.value>1?`${O.value} achievements`:"your next achievement";return I.value?`Supporting ${I.value} will reach ${we}!`:"Supporting this loan reaches an achievement!"}),V=M=>{M==="view-basket"?e("close-redirect",{type:M,path:"/basket"}):M==="support-another"&&c.value&&e("close-redirect",{type:M,path:c.value})},q=M=>{const{type:z}=M;z&&V(z),e("reset-modal")},oe=()=>{const M=document.getElementsByTagName("header")[0],z=(M==null?void 0:M.getBoundingClientRect())??null;let ae=[...document.querySelectorAll('[data-testid="header-basket"]')],we=ae.find(ee=>ee==null?void 0:ee.clientHeight);we||(ae=[...document.querySelectorAll('[data-testid="header-about"]')],we=ae.find(ee=>ee==null?void 0:ee.clientHeight));const me=(we==null?void 0:we.getBoundingClientRect())??null;me&&(me==null?void 0:me.right)!==k.value&&(k.value=me==null?void 0:me.right),z&&(z==null?void 0:z.bottom)!==f.value&&(f.value=z==null?void 0:z.bottom)},ue=Xi(oe,50);return nn(a,()=>{a.value&&oe()},{immediate:!0}),an(()=>{oe(),window.addEventListener("scroll",ue),window.addEventListener("resize",ue)}),gi(()=>{window.removeEventListener("scroll",ue),window.removeEventListener("resize",ue)}),{modalPosition:C,basketCount:w,isFirstLoan:P,borrowerName:I,showOneAway:L,pillMsg:E,closeCartModal:q}}},Ko={key:0,class:"tw-w-full tw-mx-2.5 tw-border-t tw-border-tertiary tw-py-2"},Go={key:0,class:"tw-min-w-3",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Wo={key:1,class:"tw-min-w-3",width:"18",height:"21",viewBox:"0 0 18 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Zo={key:2,class:"tw-text-h5"};function Qo(t,e,a,r,n,i){const l=g("KvCartPill"),m=g("KvCartModal");return a.modalVisible?(s(),x(m,{key:0,style:le({"--modal-right":`${r.modalPosition.right}px`,"--modal-top":`${r.modalPosition.top}px`}),class:"cart-modal !tw-top-0",visible:a.modalVisible,"photo-path":a.photoPath,"basket-count":r.basketCount,"category-name":a.oneLoanAwayCategory,onCartModalClosed:r.closeCartModal},{content:_(()=>[a.showModalContent||r.isFirstLoan?(s(),u("div",Ko,[p(l,{class:"!tw-w-full tw-justify-center","borrower-name":r.borrowerName,"milestones-number":a.milestonesNumber,"is-close-next-milestone":r.showOneAway,"custom-message":r.pillMsg},{icon:_(()=>[o("div",{class:Q({"tw-flex tw-items-center tw-justify-center tw-bg-gray-100 tw-p-0.5 tw-rounded tw-whitespace-nowrap":r.showOneAway})},[r.isFirstLoan?(s(),u("svg",Go,e[0]||(e[0]=[o("path",{d:"M36.2676 17.5025C34.6519 30.5945 24.9878 35.8229 20.1847 38.0889C20.1496 38.1055 20.1099 38.1043 20.075 38.0873C8.60201 32.516 4.24979 22.9018 3.62911 17.5025C3.34064 14.6558 3.18678 8.5719 3.14406 5.7867C3.14315 5.72754 3.1847 5.67723 3.24194 5.66227C11.6312 3.46948 14.2758 3.52186 20.0937 1.86776C20.1175 1.86099 20.1437 1.86113 20.1673 1.86833C26.6496 3.83905 31.8224 4.23356 36.8613 5.66108C36.9176 5.67702 36.9559 5.72959 36.9546 5.78805C36.8227 11.47 36.4423 15.9605 36.2676 17.5025Z",fill:"#2AA967",stroke:"#223829","stroke-width":"1.8"},null,-1),o("path",{d:"M20.4351 14.843L21.9756 18.0745L24.854 15.6822L24.7902 19.1942L28.5088 18.0548L26.8519 21.24L30.7676 21.5504L27.8039 23.8581L31.2399 25.5648L27.4819 26.5959L29.8438 29.4037L25.9414 28.9799L26.821 32.4033L23.4488 30.598L22.6939 34.0451L20.4351 31.1704L18.1763 34.0451L17.4214 30.598L14.0492 32.4033L14.9288 28.9799L11.0263 29.4037L13.3883 26.5959L9.63032 25.5648L13.0662 23.8581L10.1025 21.5504L14.0183 21.24L12.3613 18.0548L16.0799 19.1942L16.0162 15.6822L18.8946 18.0745L20.4351 14.843Z",fill:"#EDF4F1"},null,-1),o("g",{"clip-path":"url(#clip0_5027_1388)"},[o("g",{"clip-path":"url(#clip1_5027_1388)"},[o("path",{d:"M19.2444 20.6905L19.8597 21.0523C21.075 19.9275 20.1316 26.1623 19.8116 27.8909C19.5792 29.5078 14.7217 33.608 13.6854 34.193C12.7214 33.8716 11.8214 32.5859 10.9214 31.943L12.5429 30.7145L14.4237 28.7341C14.7695 28.5282 14.9239 27.9729 14.4345 27.1922L14.2273 26.2352C14.3719 25.417 14.3935 23.7737 14.7459 23.7067C15.0983 23.6397 15.4988 23.962 15.5714 24.1195L15.6854 24.8573L15.9712 23.9288C16.1145 23.2631 16.2966 21.1451 16.508 20.4695C16.7193 19.794 17.0456 19.5155 17.3426 19.7641C17.4599 19.4449 18.217 19.5299 18.7862 19.9414L18.7126 20.4533L19.2444 20.6905Z",fill:"#D8A15A"}),o("path",{d:"M10.1846 31.5C10.1846 31.5 14.2722 29.2857 14.2722 27.8458C13.9934 27.0662 14.0253 27.4322 13.9649 26.5651C13.9045 25.6981 14.5046 24.9692 14.5263 24.1642C14.548 23.3591 15.549 23.1576 15.5722 24.1642",stroke:"#22382A","stroke-width":"0.683036","stroke-linecap":"square","stroke-linejoin":"round"}),o("path",{d:"M17.2757 21.0599C17.3407 20.4353 16.9021 20.1772 16.58 20.1575C16.2253 20.1363 16.1913 20.7398 16.1913 20.7398L15.9326 23.2395C15.9326 23.2395 15.6948 23.9864 15.4656 24.838C15.3559 25.4 15.2535 25.6135 15.2535 25.6135C15.2535 25.6135 15.1848 25.7612 15.1467 26.1471",stroke:"#22382A","stroke-width":"0.683036","stroke-linecap":"square","stroke-linejoin":"round"}),o("path",{d:"M16.4608 24.5279L16.434 24.8684L17.1149 24.922L17.1417 24.5815L16.4608 24.5279ZM16.8957 23.792L17.2328 23.8471L16.8957 23.792ZM17.0506 22.8022L17.3888 22.8504L17.3897 22.8432L17.0506 22.8022ZM17.3052 20.6933L17.6443 20.7342L17.6449 20.7282L17.3052 20.6933ZM17.7496 19.8093L17.7693 19.4684L17.7688 19.4683L17.7496 19.8093ZM18.0616 21.0641C18.0616 21.2527 18.2145 21.4056 18.4032 21.4056C18.5918 21.4056 18.7447 21.2527 18.7447 21.0641H18.0616ZM16.8013 24.5547C17.1417 24.5815 17.1417 24.5815 17.1417 24.5816C17.1417 24.5816 17.1417 24.5816 17.1417 24.5816C17.1417 24.5816 17.1417 24.5816 17.1417 24.5816C17.1417 24.5816 17.1417 24.5816 17.1417 24.5815C17.1417 24.5814 17.1418 24.5813 17.1418 24.581C17.1418 24.5805 17.1419 24.5796 17.142 24.5785C17.1422 24.5761 17.1425 24.5724 17.1429 24.5675C17.1437 24.5577 17.145 24.543 17.1468 24.5239C17.1503 24.4857 17.1557 24.4303 17.1631 24.3624C17.178 24.2264 17.2009 24.042 17.2328 23.8471L16.5587 23.7368C16.5243 23.9471 16.4999 24.1441 16.4841 24.2881C16.4762 24.3603 16.4705 24.4196 16.4666 24.4612C16.4647 24.4819 16.4633 24.4983 16.4623 24.5096C16.4618 24.5153 16.4615 24.5197 16.4612 24.5228C16.4611 24.5243 16.461 24.5255 16.4609 24.5264C16.4609 24.5268 16.4609 24.5272 16.4608 24.5274C16.4608 24.5275 16.4608 24.5277 16.4608 24.5277C16.4608 24.5278 16.4608 24.5278 16.4608 24.5279C16.4608 24.5279 16.4608 24.5279 16.4608 24.5279C16.4608 24.5279 16.4608 24.5279 16.8013 24.5547ZM17.2328 23.8471C17.2864 23.5196 17.3253 23.2709 17.3508 23.1039C17.3636 23.0204 17.373 22.9573 17.3793 22.915C17.3824 22.8938 17.3848 22.8778 17.3863 22.867C17.3871 22.8616 17.3877 22.8575 17.3881 22.8548C17.3883 22.8534 17.3884 22.8523 17.3885 22.8516C17.3886 22.8512 17.3886 22.851 17.3887 22.8508C17.3887 22.8507 17.3887 22.8506 17.3887 22.8505C17.3887 22.8505 17.3887 22.8505 17.3887 22.8504C17.3887 22.8504 17.3887 22.8504 17.3887 22.8504C17.3887 22.8504 17.3887 22.8504 17.0506 22.8022C16.7125 22.7541 16.7125 22.7541 16.7125 22.7541C16.7125 22.7541 16.7125 22.754 16.7125 22.754C16.7125 22.7541 16.7125 22.7541 16.7125 22.7541C16.7125 22.7541 16.7125 22.7541 16.7125 22.7542C16.7125 22.7543 16.7124 22.7545 16.7124 22.7548C16.7123 22.7554 16.7122 22.7563 16.712 22.7576C16.7116 22.7601 16.7111 22.7639 16.7104 22.769C16.7089 22.7792 16.7066 22.7946 16.7036 22.8152C16.6975 22.8564 16.6882 22.9184 16.6757 23.0007C16.6505 23.1654 16.6119 23.4116 16.5587 23.7368L17.2328 23.8471ZM17.3897 22.8432L17.6442 20.7342L16.9661 20.6524L16.7115 22.7613L17.3897 22.8432ZM17.3052 20.6933C17.6449 20.7282 17.6449 20.7283 17.6449 20.7284C17.6449 20.7284 17.6449 20.7284 17.6449 20.7285C17.6449 20.7285 17.6448 20.7286 17.6448 20.7286C17.6448 20.7287 17.6448 20.7287 17.6448 20.7286C17.6449 20.7285 17.6449 20.7283 17.6449 20.7278C17.645 20.7268 17.6452 20.725 17.6455 20.7225C17.6461 20.7174 17.6471 20.7094 17.6485 20.6988C17.6512 20.6776 17.6556 20.6466 17.662 20.6091C17.6748 20.5329 17.6946 20.4356 17.7226 20.3422C17.7522 20.2438 17.7839 20.174 17.8104 20.1367C17.8383 20.0974 17.8128 20.1549 17.7305 20.1503L17.7688 19.4683C17.5107 19.4538 17.3417 19.6169 17.2533 19.7415C17.1635 19.8681 17.1061 20.0206 17.0685 20.1456C17.0294 20.2757 17.004 20.4031 16.9884 20.4957C16.9805 20.5427 16.9749 20.5821 16.9712 20.6102C16.9694 20.6243 16.968 20.6357 16.967 20.6439C16.9666 20.6479 16.9662 20.6512 16.9659 20.6537C16.9658 20.6549 16.9657 20.6559 16.9656 20.6567C16.9656 20.6571 16.9655 20.6574 16.9655 20.6577C16.9655 20.6578 16.9655 20.658 16.9655 20.6581C16.9655 20.6581 16.9654 20.6582 16.9654 20.6582C16.9654 20.6583 16.9654 20.6584 17.3052 20.6933ZM17.7299 20.1503C17.8501 20.1572 17.9059 20.1844 17.9317 20.2029C17.9553 20.2197 17.9801 20.2476 18.0027 20.3099C18.0584 20.4633 18.0616 20.6955 18.0616 21.0641H18.7447C18.7447 20.7461 18.7511 20.3699 18.6448 20.0771C18.5865 19.9163 18.4892 19.7616 18.3284 19.6469C18.1699 19.5337 17.979 19.4805 17.7693 19.4684L17.7299 20.1503Z",fill:"#22382A"}),o("path",{d:"M17.9624 24.475C17.9624 24.475 18.0121 24.2433 18.0905 23.792C18.2035 23.1406 18.2013 22.8927 18.2013 22.8927L18.4274 21.0373C18.4274 21.0373 18.559 20.3958 18.9106 20.3803C19.5083 20.3549 19.6418 20.7713 19.6913 21.2732",stroke:"#22382A","stroke-width":"0.683036","stroke-linecap":"square","stroke-linejoin":"round"}),o("path",{d:"M19.0729 25.0086C19.1796 24.4323 19.2936 23.6414 19.2936 23.6414L19.4856 21.8945C19.4856 21.8945 19.5182 21.4574 19.862 21.3841C20.4474 21.2586 20.627 22.1539 20.6193 22.8405C20.6193 22.8405 20.3918 24.5173 20.3345 25.211C20.2772 25.9047 19.9443 28.2178 18.3708 29.9069C16.5115 31.5829 13.6851 34.1929 13.6851 34.1929",stroke:"#22382A","stroke-width":"0.683036","stroke-linecap":"square","stroke-linejoin":"round"}),o("path",{d:"M22.0093 20.5003H21.6667C21.2984 21.8094 20.6852 25.9186 20.7567 27.6357C20.7567 29.2325 25.1554 32.9683 26.1075 33.6785C27.3928 34.2687 29.0639 32.1003 28.9211 31.3643L26.2503 29.0382C25.9341 28.7909 26.0233 27.8916 26.1075 27.4729L26.9644 24.9827C27.0596 24.7455 26.9935 24.2427 26.6508 24.1289C26.308 24.0151 25.8612 24.2712 25.7659 24.4135L25.3375 24.9827L25.2226 23.7732C25.175 23.1091 25.1107 21.724 24.9965 21.041C24.8822 20.358 24.4842 20.1445 24.1515 20.3437C24.0801 20.0186 23.7802 19.6046 23.1518 19.9236V20.4291L22.7233 20.1445L22.0093 20.5003Z",fill:"#AF741C"}),o("path",{d:"M20.1411 26.6948C20.1411 26.6948 20.1314 28.8758 20.9911 29.7662C21.926 30.7345 25.1575 33.9449 25.5785 34.1285",stroke:"#22382A","stroke-width":"0.683036","stroke-linecap":"square","stroke-linejoin":"round"}),o("path",{d:"M23.8426 27.2245C23.8426 27.2245 22.587 27.3427 22.4766 28.5906",stroke:"#22382A","stroke-width":"0.683036","stroke-linecap":"square","stroke-linejoin":"round"}),o("path",{d:"M28.9848 31.2356C28.9848 31.2356 25.0255 29.2418 25.4509 27.6307C25.8764 26.0195 26.5607 24.5046 26.3715 24.2799C26.1217 23.9825 25.4237 24.2087 25.1012 24.8607C24.7787 25.5127 24.3547 26.3308 24.3547 26.3308",stroke:"#22382A","stroke-width":"0.683036","stroke-linecap":"square","stroke-linejoin":"round"}),o("path",{d:"M23.1941 24.891L23.1597 23.5747C23.1597 23.5747 23.2154 22.3143 23.3156 21.8207C23.3156 20.8601 24.2833 20.4704 24.4148 21.337C24.5165 22.0088 24.4915 23.657 24.4915 23.657C24.4915 23.657 24.4023 24.6497 24.6965 25.3463",stroke:"#22382A","stroke-width":"0.683036","stroke-linecap":"square","stroke-linejoin":"round"}),o("path",{d:"M23.2942 21.3084C23.2942 20.9716 23.529 20.1131 22.8247 19.985C22.2219 20.1033 22.2902 20.5378 22.1693 21.0799C22.0485 21.622 21.9888 23.2313 21.9888 23.2313L21.9644 24.6633",stroke:"#22382A","stroke-width":"0.683036","stroke-linecap":"square","stroke-linejoin":"round"}),o("path",{d:"M22.1849 20.6467C21.9501 19.8996 21.1267 19.9819 21.0213 21.1164C20.9709 21.6576 20.7175 22.6608 20.7175 22.6608L20.4827 24.1976",stroke:"#22382A","stroke-width":"0.683036","stroke-linecap":"round","stroke-linejoin":"round"})])],-1),o("path",{d:"M36.2676 17.5025C34.6519 30.5945 24.9878 35.8229 20.1847 38.0889C20.1496 38.1055 20.1099 38.1043 20.075 38.0873C8.60201 32.516 4.24979 22.9018 3.62911 17.5025C3.34064 14.6558 3.18678 8.5719 3.14406 5.7867C3.14315 5.72754 3.1847 5.67723 3.24194 5.66227C11.6312 3.46948 14.2758 3.52186 20.0937 1.86776C20.1175 1.86099 20.1437 1.86113 20.1673 1.86833C26.6496 3.83905 31.8224 4.23356 36.8613 5.66108C36.9176 5.67702 36.9559 5.72959 36.9546 5.78805C36.8227 11.47 36.4423 15.9605 36.2676 17.5025Z",stroke:"#223829","stroke-width":"1.8"},null,-1),o("path",{d:"M6.79042 16.0619L5.19586 10.1835L8.41478 9.04901L8.80357 10.3866L6.69262 11.0002L7.01277 12.1016L8.67078 11.4821L9.12761 13.0537L7.40388 13.4471L7.66595 14.3487L9.7769 13.7351L10.1393 15.0884L6.79042 16.0619Z",fill:"#223829"},null,-1),o("path",{d:"M33.1027 9.8062L32.0862 9.4574L31.8117 12.9574L30.8766 15.6826L32.0234 16.076L32.9335 13.4235L34.9377 10.4359L33.9476 10.0961L32.9832 11.4446L33.1027 9.8062Z",fill:"#223829"},null,-1),o("path",{d:"M31.5926 9.28625L29.0298 8.66132L28.7615 9.76164L29.5303 9.94911L28.3106 14.9507L29.3876 15.2134L30.6054 10.2193L31.3224 10.3942L31.5926 9.28625Z",fill:"#223829"},null,-1),o("path",{d:"M25.0681 14.2538L25.2222 13.5225L25.2812 13.2428L25.7358 13.3386L26.5961 9.25753L26.1529 9.10768L26.3635 8.10815L28.3301 8.52271L28.1081 9.57626L27.6642 9.48268L26.8129 13.5208L27.2568 13.6143L27.0346 14.6684L25.0681 14.2538Z",fill:"#223829"},null,-1),o("path",{d:"M21.9959 13.755L22.7004 7.51385L23.9144 7.65089L23.333 12.8016L24.6155 12.9464L24.4924 14.0368L21.9959 13.755Z",fill:"#223829"},null,-1),o("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.76968 9.75852C9.7795 9.33501 10.0587 8.43293 11.0967 8.21273C11.4896 8.16165 12.3586 8.28064 12.6916 9.16517L13.3833 12.5717C13.4001 12.8411 13.4374 13.534 13.1612 13.778L13.4627 14.1883L12.4407 14.3958L12.2881 14.227C12.0562 14.3448 11.6086 14.4766 11.1991 14.3771C10.7553 14.2694 10.5628 13.7844 10.4467 13.3427C10.2034 12.4173 9.88389 10.9975 9.76968 9.75852ZM12.2101 12.6282C12.223 12.5003 11.9505 11.2616 11.7473 10.4868C11.6538 10.1303 11.3149 9.65354 11.1019 9.95424C11.0714 9.99724 11.0441 10.0534 11.0214 10.1254C10.9979 10.356 11.0453 11.25 11.4448 12.8015C11.4789 12.9341 11.6085 13.0328 11.8558 12.9826C12.1813 12.9165 12.1977 12.7526 12.2099 12.6309L12.2101 12.6282Z",fill:"#223829"},null,-1),o("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18.3181 7.56132L17.7253 13.6391L18.9892 13.6541L19.0664 12.2152L20.0459 12.2268L20.2103 13.6685L21.459 13.6833L20.2822 7.58453L19.5614 7.40908C19.3974 7.36915 19.2265 7.36678 19.0614 7.40212L18.3181 7.56132ZM19.204 11.1352L19.769 11.1456C19.832 11.1467 19.8808 11.0888 19.8687 11.0273L19.4843 9.07589C19.4626 8.96598 19.3018 8.97766 19.2914 9.08991L19.1108 11.0309C19.1057 11.0866 19.1482 11.1342 19.204 11.1352Z",fill:"#223829"},null,-1),o("path",{d:"M14.8244 7.66792L13.5503 7.79126L14.1939 12.9684C14.4472 13.8769 15.2533 13.9365 15.7466 13.8887C17.0518 13.7624 17.0907 12.7573 17.084 12.6886L16.8011 7.47657L15.5813 7.59465L15.9684 12.3578C15.9106 12.7416 15.3095 12.6795 15.2848 12.424L14.8244 7.66792Z",fill:"#223829"},null,-1),o("defs",null,[o("clipPath",{id:"clip0_5027_1388"},[o("rect",{width:"21.8571",height:"21.8571",fill:"white",transform:"translate(9.1853 13.4287)"})]),o("clipPath",{id:"clip1_5027_1388"},[o("rect",{width:"21.8571",height:"21.8571",fill:"white",transform:"translate(9.1853 13.4287)"})])],-1)]))):(s(),u("svg",Wo,e[1]||(e[1]=[o("path",{d:"M9.0001 19L5.6251 20.125C5.50843 20.1583 5.4001 20.1833 5.3001 20.2C5.2001 20.2167 5.1001 20.225 5.0001 20.225C4.46676 20.225 4.0001 20.0375 3.6001 19.6625C3.2001 19.2875 3.0001 18.8083 3.0001 18.225V12.775L0.400098 8.55C0.300098 8.38333 0.225098 8.2125 0.175098 8.0375C0.125098 7.8625 0.100098 7.68333 0.100098 7.5C0.100098 7.31667 0.125098 7.1375 0.175098 6.9625C0.225098 6.7875 0.300098 6.61667 0.400098 6.45L3.8001 0.95C3.98343 0.65 4.2251 0.416667 4.5251 0.25C4.8251 0.0833333 5.1501 0 5.5001 0H12.5001C12.8501 0 13.1751 0.0833333 13.4751 0.25C13.7751 0.416667 14.0168 0.65 14.2001 0.95L17.6001 6.45C17.7001 6.61667 17.7751 6.7875 17.8251 6.9625C17.8751 7.1375 17.9001 7.31667 17.9001 7.5C17.9001 7.68333 17.8751 7.8625 17.8251 8.0375C17.7751 8.2125 17.7001 8.38333 17.6001 8.55L15.0001 12.775V18.225C15.0001 18.8083 14.8001 19.2875 14.4001 19.6625C14.0001 20.0375 13.5334 20.225 13.0001 20.225C12.9001 20.225 12.8001 20.2167 12.7001 20.2C12.6001 20.1833 12.4918 20.1583 12.3751 20.125L9.0001 19ZM5.5001 13H12.5001L15.9001 7.5L12.5001 2H5.5001L2.1001 7.5L5.5001 13ZM7.9501 8.75L11.4751 5.2C11.6584 5 11.8876 4.90417 12.1626 4.9125C12.4376 4.92083 12.6751 5.01667 12.8751 5.2C13.0751 5.4 13.1793 5.6375 13.1876 5.9125C13.1959 6.1875 13.1001 6.425 12.9001 6.625L8.6501 10.875C8.4501 11.075 8.21677 11.175 7.9501 11.175C7.68343 11.175 7.4501 11.075 7.2501 10.875L5.1251 8.75C4.9251 8.55 4.8251 8.3125 4.8251 8.0375C4.8251 7.7625 4.9251 7.525 5.1251 7.325C5.3251 7.125 5.5626 7.025 5.8376 7.025C6.1126 7.025 6.3501 7.125 6.5501 7.325L7.9501 8.75Z",fill:"#757575"},null,-1)]))),r.showOneAway?(s(),u("div",Zo,b(a.oneAwayText),1)):v("",!0)],2)]),_:1},8,["borrower-name","milestones-number","is-close-next-milestone","custom-message"])])):v("",!0)]),_:1},8,["style","visible","photo-path","basket-count","category-name","onCartModalClosed"])):v("",!0)}const Yo=aa(Ho,[["render",Qo],["__scopeId","data-v-5233d12c"]]),Xo=`query PostCheckoutAchievements($loanIds: [Int!]!) {
	postCheckoutAchievements(loanIds: $loanIds) {
		overallProgress {
			id
			achievementId
			preCheckoutTier
			postCheckoutTier
			contributingLoanIds
		}
	}
}
`,Nn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"PostCheckoutAchievements"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"loanIds"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"postCheckoutAchievements"},arguments:[{kind:"Argument",name:{kind:"Name",value:"loanIds"},value:{kind:"Variable",name:{kind:"Name",value:"loanIds"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"overallProgress"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"achievementId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"preCheckoutTier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"postCheckoutTier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"contributingLoanIds"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:251,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Xo}}},ua="five_dollars_notes",Jo={data(){return{enableFiveDollarsNotes:!1}},methods:{initializeFiveDollarsNotes(){const{version:t}=en(this.apollo,this.$kvTrackEvent,"Lending",ua,"EXP-CORE-1104-Mar2023");this.enableFiveDollarsNotes=t==="b"}}},ma={name:"ContentContainer",components:{KvGrid:dt,KvPageContainer:Dt}},er={class:"tw-col-span-12 md:tw-col-start-2 md:tw-col-span-10 lg:tw-col-span-7"};function tr(t,e,a,r,n,i){const l=g("kv-grid"),m=g("kv-page-container");return s(),x(m,null,{default:_(()=>[p(l,{class:"tw-grid-cols-12"},{default:_(()=>[o("div",er,[Ve(t.$slots,"default")])],void 0,!0),_:3})],void 0),_:3})}const nr=B(ma,[["render",tr]]);ma.__docgenInfo={displayName:"ContentContainer",exportName:"default",description:"",tags:{},slots:[{name:"default"}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/ContentContainer.vue"]};const ca={name:"SidebarContainer",components:{KvGrid:dt,KvPageContainer:Dt}},ar={class:"tw-col-span-12 md:tw-col-start-2 md:tw-col-span-10 lg:tw-col-start-8 lg:tw-col-span-5"};function ir(t,e,a,r,n,i){const l=g("kv-grid"),m=g("kv-page-container");return s(),x(m,null,{default:_(()=>[p(l,{class:"tw-grid-cols-12"},{default:_(()=>[o("div",ar,[Ve(t.$slots,"default")])],void 0,!0),_:3})],void 0),_:3})}const or=B(ca,[["render",ir]]);ca.__docgenInfo={displayName:"SidebarContainer",exportName:"default",description:"",tags:{},slots:[{name:"default"}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/SidebarContainer.vue"]};const pa={name:"LoanProgress",components:{KvProgressBar:Fi,KvLoadingPlaceholder:ge},props:{loading:{type:Boolean,default:!0},moneyLeft:{type:String,default:"0.00"},progressPercent:{type:Number,default:0},timeLeft:{type:String,default:""},loanStatus:{type:String,default:"fundraising",validator:t=>na.indexOf(t)!==-1},numberOfLenders:{type:Number,default:0},pfpMinLenders:{type:Number,default:0},loanId:{type:Number,default:0},hideViewProfileLinks:{type:Boolean,default:!1}},computed:{pfpProgressPercent(){return this.pfpMinLenders===0?0:this.numberOfLenders/this.pfpMinLenders*100},progressPercentRounded(){const t=pe(this.progressPercent).format("0%");return t==="100%"&&this.progressPercent<1?"99%":t},routeId(){return this.loanId?this.loanId:this.$route.params.id}}},rr={class:"tw-flex"},sr={key:0,class:"tw-w-full"},lr={key:0,class:"tw-flex tw-justify-between"},dr={key:1},ur={class:"md:tw-flex tw-gap-2"},mr={key:0,class:"tw-text-h4 tw-text-action tw-block"},cr={key:1},pr={class:"md:tw-flex tw-gap-2"},hr={class:"tw-text-h4 tw-text-secondary tw-block","data-testid":"bp-summary-percent-funded"},fr={key:0,class:"tw-text-h4 tw-text-action tw-block"},gr={key:2},wr={class:"md:tw-flex tw-gap-2"},vr={class:"tw-text-h4 tw-text-secondary tw-block","data-testid":"bp-summary-percent-funded"},br={key:0,class:"tw-text-h4 tw-text-action tw-block"},yr={key:0},_r={key:1,class:"tw-flex tw-flex-auto"},kr={class:"tw-flex-auto","data-testid":"bp-summary-timeleft"},Lr={class:"tw-text-h3 tw-block tw-m-0"},Cr={class:"tw-flex-auto tw-text-right"},Sr={class:"tw-text-h3 tw-m-0","data-testid":"bp-summary-lenders-to-go"},xr={class:"tw-text-h4 tw-text-secondary","data-testid":"bp-summary-amount-to-go"},Ir={key:0,class:"tw-flex tw-flex-auto tw-justify-between"},Tr={key:1,class:"tw-flex tw-flex-auto"},Nr={class:"tw-flex-auto","data-testid":"bp-summary-timeleft"},Ar={class:"tw-text-h3 tw-block tw-m-0"},Dr={class:"tw-flex-auto tw-text-right"},Pr={class:"tw-text-h3 tw-m-0","data-testid":"bp-summary-amount-to-go"},Mr={class:"tw-text-h4 tw-text-secondary","data-testid":"bp-summary-percent-funded"};function Rr(t,e,a,r,n,i){const l=g("kv-progress-bar"),m=g("KvLoadingPlaceholder"),c=g("router-link"),h=de("kv-track-event");return s(),u("figure",null,[a.loanStatus==="pfp"?(s(),x(l,{key:0,class:"tw-mb-1.5 lg:tw-mb-1","aria-label":"Percent completion of private fundraising",value:i.pfpProgressPercent,"bg-variant":"tertiary"},null,8,["value"])):(s(),x(l,{key:1,class:"tw-mb-1.5 lg:tw-mb-1","aria-label":"Percent the loan has funded",value:a.progressPercent*100,"bg-variant":"tertiary"},null,8,["value"])),o("figcaption",rr,[a.loanStatus==="funded"||a.loanStatus==="raised"?(s(),u("div",sr,[a.loading?(s(),u("div",lr,[p(m,{style:{height:"2rem",width:"100px"}}),p(m,{style:{height:"2rem",width:"100px"},class:"tw-text-right"})])):(s(),u("div",dr,[e[2]||(e[2]=o("p",{class:"tw-text-h3 tw-m-0","data-testid":"bp-summary-amount-to-go"}," This loan is fully funded! ",-1)),o("div",ur,[e[1]||(e[1]=o("p",{class:"tw-text-h4 tw-text-secondary tw-block"}," 100% funded ",-1)),a.hideViewProfileLinks?v("",!0):(s(),u("p",mr,[F((s(),x(c,{to:`/lend-classic/${i.routeId}?minimal=false`},{default:_(()=>e[0]||(e[0]=[D(" View the full borrower profile ")]),void 0),_:1,__:[0]},8,["to"])),[[h,["Lending","full-borrower-profile-exit-link"]]])]))])]))])):a.loanStatus==="expired"?(s(),u("div",cr,[e[4]||(e[4]=o("p",{class:"tw-text-h3 tw-m-0","data-testid":"bp-summary-amount-to-go"}," This loan has expired ",-1)),o("div",pr,[o("p",hr,b(i.progressPercentRounded)+" funded ",1),a.hideViewProfileLinks?v("",!0):(s(),u("p",fr,[F((s(),x(c,{to:`/lend-classic/${i.routeId}?minimal=false`},{default:_(()=>e[3]||(e[3]=[D(" View the full borrower profile ")]),void 0),_:1,__:[3]},8,["to"])),[[h,["Lending","full-borrower-profile-exit-link"]]])]))])])):a.loanStatus==="inactive"?(s(),u("div",gr,[e[6]||(e[6]=o("p",{class:"tw-text-h3 tw-m-0"}," This loan is inactive ",-1)),o("div",wr,[o("p",vr,b(i.progressPercentRounded)+" funded ",1),a.hideViewProfileLinks?v("",!0):(s(),u("p",br,[F((s(),x(c,{to:`/lend-classic/${i.routeId}?minimal=false`},{default:_(()=>e[5]||(e[5]=[D(" View the full borrower profile ")]),void 0),_:1,__:[5]},8,["to"])),[[h,["Lending","full-borrower-profile-exit-link"]]])]))])])):a.loanStatus==="pfp"?(s(),u(H,{key:3},[a.loading?(s(),u("div",yr,[p(m,{style:{height:"2rem",width:"100px"}}),p(m,{style:{height:"2rem",width:"100px"},class:"tw-text-right"})])):(s(),u("div",_r,[o("p",kr,[o("span",Lr,b(a.timeLeft)+" left ",1),e[7]||(e[7]=o("span",{class:"tw-text-h4 tw-text-secondary tw-block"}," in private fundraising ",-1))]),o("div",Cr,[o("p",Sr,b(a.numberOfLenders)+"/"+b(a.pfpMinLenders)+" lenders ",1),o("p",xr,b(t.$filters.numeral(a.moneyLeft,"$0,0[.]00"))+" to go ",1)])]))],64)):(s(),u(H,{key:4},[a.loading?(s(),u("div",Ir,[p(m,{style:{height:"2rem",width:"100px"}}),p(m,{style:{height:"2rem",width:"100px"},class:"tw-text-right"})])):(s(),u("div",Tr,[o("p",Nr,[o("span",Ar,b(a.timeLeft),1),e[8]||(e[8]=o("span",{class:"tw-text-h4 tw-text-secondary tw-block"}," remaining ",-1))]),o("div",Dr,[o("p",Pr,b(t.$filters.numeral(a.moneyLeft,"$0,0[.]00"))+" to go ",1),o("p",Mr,b(i.progressPercentRounded)+" funded ",1)])]))],64))])])}const ha=B(pa,[["render",Rr]]);pa.__docgenInfo={displayName:"LoanProgress",exportName:"default",description:"",tags:{},props:[{name:"loading",type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"moneyLeft",type:{name:"string"},defaultValue:{func:!1,value:"'0.00'"}},{name:"progressPercent",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"timeLeft",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"loanStatus",type:{name:"string"},defaultValue:{func:!1,value:"'fundraising'"}},{name:"numberOfLenders",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"pfpMinLenders",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"hideViewProfileLinks",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/LoanProgress.vue"]};function Er(t,e,a){return t.mutate({mutation:Bi,variables:{loan_id:e,is_favorite:a}})}const fa={name:"LoanBookmark",components:{KvMaterialIcon:_e,KvLoadingPlaceholder:ge},inject:["apollo","cookieStore"],props:{loanId:{type:Number,default:0}},data(){return{mdiBookmarkOutline:ki,mdiBookmark:_i,isBookmarked:!1,isLoading:!0}},apollo:{query:K`query loanBookmarked($loanId: Int!) {
				lend {
					loan(id: $loanId) {
						id
						userProperties {
							favorited
						}
					}
				}
			}
		`,variables(){return{loanId:this.loanId}},result(t){var a,r,n;const e=((r=(a=t==null?void 0:t.data)==null?void 0:a.lend)==null?void 0:r.loan)||{};this.isBookmarked=((n=e==null?void 0:e.userProperties)==null?void 0:n.favorited)||!1,this.isLoading=!1}},computed:{bookmarkText(){return this.isBookmarked?"Saved":"Save for later"}},methods:{toggleBookmark(){this.isBookmarked=!this.isBookmarked,Er(this.apollo,this.loanId,this.isBookmarked).then(t=>{if(t.errors){const e=t==null?void 0:t.errors;this.isBookmarked=!this.isBookmarked,e.forEach(a=>{this.$showTipMsg(a,"error")})}else this.$kvTrackEvent("Lending","Loan Favorite Toggled",this.isBookmarked===!0?"Favorite Loan Added":"Loan Favorite Removed",this.isBookmarked),this.isBookmarked===!0&&this.$showTipMsg('This loan has been added to your "Saved loans" list, which is accessible under the "Lend" menu in the header.',"confirm")}).catch(t=>{this.isBookmarked=!this.isBookmarked,console.error(t)})}}};function Fr(t,e,a,r,n,i){const l=g("kv-loading-placeholder"),m=g("kv-material-icon");return s(),u("div",null,[n.isLoading?(s(),x(l,{key:0,style:{height:"2rem",width:"130px"}})):(s(),u("button",{key:1,class:"tw-text-action tw-inline-flex tw-cursor-pointer tw-whitespace-nowrap tw-font-medium",onClick:e[0]||(e[0]=c=>i.toggleBookmark())},[p(m,{class:"tw-text-action tw-w-3 tw-mr-0.5",icon:`${n.isBookmarked?n.mdiBookmark:n.mdiBookmarkOutline}`},null,8,["icon"]),D(" "+b(i.bookmarkText),1)]))])}const ga=B(fa,[["render",Fr]]);fa.__docgenInfo={displayName:"LoanBookmark",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/LoanBookmark.vue"]};const Or=K`
	query summaryCard($loanId: Int!) {
		lend {
			loan(id: $loanId) {
				id
				image {
					id
					hash
				}
				name
				status
				use
				# for fullLoanUse
				anonymizationLevel
				borrowerCount
				loanAmount
				fullLoanUse @client
			}
		}
		my {
			id
			userAccount {
				id
			}
		}
	}
`,Br=K`
	query summaryCard($loanId: Int!) {
		lend {
			loan(id: $loanId) {
				id
				activity {
					id
					name
				}
				distributionModel
				fundraisingPercent @client
				fundraisingTimeLeft @client
				fundraisingTimeLeftMilliseconds @client
				geocode {
					city
					state
					country {
						id
						name
					}
				}
				loanAmount
				loanFundraisingInfo {
					id
					fundedAmount
					reservedAmount
				}
				plannedExpirationDate
				unreservedAmount @client
				inPfp
				pfpMinLenders
				lenders {
					totalCount
				}
				comments {
					totalCount
				}
			}
		}
	}
`,wa={name:"SummaryCard",inject:["apollo","cookieStore"],components:{BorrowerImage:ut,BorrowerName:da,KvMaterialIcon:_e,LoanProgress:ha,SummaryTag:Ei,LoanBookmark:ga,KvLoadingPlaceholder:ge,HeartComment:Ri},data(){return{isLoading:!0,isLoggedIn:!1,activityName:"",countryName:"",fundraisingPercent:0,hash:"",mdiMapMarker:Li,name:"",status:"",timeLeft:"",unreservedAmount:"0",use:"",distributionModel:"",city:"",state:"",inPfp:!1,pfpMinLenders:0,numLenders:0,totalComments:0}},computed:{loanId(){var t,e;return Number(((e=(t=this.$route)==null?void 0:t.params)==null?void 0:e.id)??0)},formattedLocation(){return this.distributionModel==="direct"?`${this.city}, ${this.state}, ${this.countryName}`:this.countryName==="Puerto Rico"?`${this.city}, PR`:this.countryName}},async mounted(){var a,r,n,i,l,m,c,h;this.$kvTrackEvent("Borrower profile","borrower profile status",this.status);const{data:t}=await this.apollo.query({query:Br,variables:{loanId:this.loanId}}),e=(a=t==null?void 0:t.lend)==null?void 0:a.loan;this.inPfp=(e==null?void 0:e.inPfp)??!1,this.pfpMinLenders=(e==null?void 0:e.pfpMinLenders)??0,this.numLenders=((r=e==null?void 0:e.lenders)==null?void 0:r.totalCount)??0,this.activityName=((n=e==null?void 0:e.activity)==null?void 0:n.name)??"",this.countryName=((l=(i=e==null?void 0:e.geocode)==null?void 0:i.country)==null?void 0:l.name)??"",this.fundraisingPercent=(e==null?void 0:e.fundraisingPercent)??0,this.timeLeft=(e==null?void 0:e.fundraisingTimeLeft)??"",this.unreservedAmount=(e==null?void 0:e.unreservedAmount)??"0",this.distributionModel=(e==null?void 0:e.distributionModel)??"",this.city=((m=e==null?void 0:e.geocode)==null?void 0:m.city)??"",this.state=((c=e==null?void 0:e.geocode)==null?void 0:c.state)??"",this.unreservedAmount==="0"&&(this.fundraisingPercent=1),this.totalComments=((h=e==null?void 0:e.comments)==null?void 0:h.totalCount)??0,this.isLoading=!1},apollo:{query:Or,preFetch:!0,preFetchVariables({route:t}){var e;return{loanId:Number(((e=t==null?void 0:t.params)==null?void 0:e.id)??0)}},variables(){return{loanId:this.loanId}},result(t){var a,r,n,i,l,m;const e=(r=(a=t==null?void 0:t.data)==null?void 0:a.lend)==null?void 0:r.loan;this.isLoggedIn=((l=(i=(n=t==null?void 0:t.data)==null?void 0:n.my)==null?void 0:i.userAccount)==null?void 0:l.id)!==void 0||!1,this.hash=((m=e==null?void 0:e.image)==null?void 0:m.hash)??"",this.name=(e==null?void 0:e.name)??"",this.status=(e==null?void 0:e.status)??"",this.use=(e==null?void 0:e.fullLoanUse)??""}}},Vr={class:"tw-pb-0 md:tw-bg-primary md:tw-pb-2.5 tw-py-2.5 md:tw-p-3 lg:tw-p-4 md:tw-rounded-t lg:tw-rounded"},$r={class:"tw-flex"},qr={class:"tw-flex-none tw-w-8 tw-h-8 tw-mr-1.5 tw-mb-1.5 md:tw-w-9 md:tw-h-9 md:tw-mr-3 md:tw-mb-3 lg:tw-w-10 lg:tw-h-10 lg:tw-mr-4 lg:tw-mb-4"},zr={class:"tw-flex-auto"},Ur={key:0,class:"tw-flex tw-flex-wrap tw-mb-3"},jr={key:0,href:"#bp-comments-jump-link",class:"tw-inline-block tw-text-black hover:tw-text-black"},Hr={class:"tw-flex-1"},Kr={class:"tw-flex-none tw-w-full tw-mb-2 tw-text-h2","data-testid":"bp-summary-loan-use"},Gr={class:"tw-flex-auto tw-inline-flex tw-w-full"},Wr={class:"tw-flex-1","data-testid":"bp-summary-country-tag"};function Zr(t,e,a,r,n,i){const l=g("borrower-image"),m=g("borrower-name"),c=g("kv-loading-placeholder"),h=g("heart-comment"),f=g("summary-tag"),k=g("loan-progress"),w=g("kv-material-icon"),C=g("loan-bookmark"),I=de("kv-track-event");return s(),u("section",Vr,[o("div",$r,[o("div",qr,[p(l,{"data-testid":"bp-summary-image",class:"tw-w-full tw-rounded-full tw-bg-brand",alt:n.name,"aspect-ratio":1,"default-image":{width:80,faceZoom:50},hash:n.hash,images:[{width:80,faceZoom:50,viewSize:1024},{width:72,faceZoom:50,viewSize:734},{width:64,faceZoom:50}]},null,8,["alt","hash"])]),o("div",zr,[p(m,{"data-testid":"bp-summary-borrower-name",class:"tw-mb-0.5",name:n.name},null,8,["name"]),n.isLoading?(s(),u("div",Ur,[p(c,{class:"tw-mb-1",style:{height:"0.5rem"}}),p(c,{style:{height:"2.8rem",width:"30%"}}),p(c,{style:{height:"2.8rem",width:"30%","margin-left":"auto"}})])):(s(),u(H,{key:1},[n.totalComments>0?F((s(),u("a",jr,[p(f,{class:"hover:tw-bg-brand-200 tw-mr-0","background-color":"tw-bg-brand-100"},{default:_(()=>[p(h,{class:"tw-h-3 tw-w-3 tw-mr-0.5 heart-svg"}),o("span",Hr,b(n.totalComments)+" Comment"+b(n.totalComments>1?"s":""),1)],void 0),_:1})])),[[I,["borrower-profile","click","jump-link","comments-pill"]]]):v("",!0),p(k,{"data-testid":"bp-summary-progress",class:"tw-mb-2 tw-mt-1.5","money-left":n.unreservedAmount,"progress-percent":n.fundraisingPercent,"time-left":n.timeLeft,"loan-status":n.inPfp?"pfp":"fundraising","number-of-lenders":n.numLenders,"pfp-min-lenders":n.pfpMinLenders,loading:n.isLoading},null,8,["money-left","progress-percent","time-left","loan-status","number-of-lenders","pfp-min-lenders","loading"])],64))])]),o("p",Kr,b(n.use),1),o("div",Gr,[n.isLoading?(s(),x(c,{key:0,style:{height:"1.9rem",width:"50%"}})):(s(),u(H,{key:1},[n.countryName?(s(),x(f,{key:0},{default:_(()=>[p(w,{class:"tw-h-2.5 tw-w-2.5 tw-mr-0.5 tw-shrink-0",icon:n.mdiMapMarker},null,8,["icon"]),o("span",Wr,b(i.formattedLocation),1)],void 0),_:1})):v("",!0),n.activityName?(s(),x(f,{key:1,"data-testid":"bp-summary-activity-tag"},{default:_(()=>[D(b(n.activityName),1)],void 0),_:1})):v("",!0)],64)),n.isLoggedIn?(s(),x(C,{key:2,"loan-id":i.loanId,class:"tw-hidden lg:tw-inline-flex tw-ml-auto tw-items-center","data-testid":"bp-summary-bookmark"},null,8,["loan-id"])):v("",!0)]),Ve(t.$slots,"sharebutton",{},void 0,!0)])}const Qr=B(wa,[["render",Zr],["__scopeId","data-v-c516de63"]]);wa.__docgenInfo={displayName:"SummaryCard",exportName:"default",description:"",tags:{},slots:[{name:"sharebutton"}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/SummaryCard.vue"]};const va={name:"JumpLinks",components:{KvMaterialIcon:_e},mixins:[ji],data(){return{mdiAccount:Si,mdiFormatListBulleted:Ci}},methods:{scrollToSection(t){const e=document.querySelector(t),a=(e==null?void 0:e.offsetTop)??0;this.smoothScrollTo({yPosition:a,millisecondsToAnimate:750})}}},Yr={class:"tw-text-primary tw-text-center"};function Xr(t,e,a,r,n,i){const l=g("kv-material-icon"),m=de("kv-track-event");return s(),u("div",Yr,[F((s(),u("a",{class:"tw-hidden md:tw-inline tw-text-primary tw-pr-2 tw-font-medium tw-cursor-pointer","data-testid":"bp-jump-link-borrower-story",onClick:e[0]||(e[0]=c=>i.scrollToSection("#loanStory"))},[p(l,{class:"tw-w-3 tw-h-3 tw-align-middle tw-mr-0.5",icon:n.mdiAccount},null,8,["icon"]),e[2]||(e[2]=D(" Borrower story "))])),[[m,["Borrower profile","click-jump-link","Borrower story"]]]),F((s(),u("a",{class:"tw-text-primary tw-pr-2 tw-font-medium tw-cursor-pointer tw-whitespace-nowrap","data-testid":"bp-jump-link-loan-details",onClick:e[1]||(e[1]=c=>i.scrollToSection("#loanDetails"))},[p(l,{class:"tw-w-3 tw-h-3 tw-align-middle tw-mr-0.5",icon:n.mdiFormatListBulleted},null,8,["icon"]),e[3]||(e[3]=D(" Loan details "))])),[[m,["Borrower profile","click-jump-link","Loan details"]]])])}const Jr=B(va,[["render",Xr]]);va.__docgenInfo={displayName:"JumpLinks",exportName:"default",description:"",tags:{},sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/JumpLinks.vue"]};const es="data:image/svg+xml,%3csvg%20width='14'%20height='15'%20viewBox='0%200%2014%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1.6438%209.1407C6.1263%207.93962%208.2857%2011.5161%208.80508%2013.4545C8.2857%2011.5161%208.36755%207.33908%2012.85%206.13799C8.36755%207.33908%206.15044%203.54722%205.6022%201.50115C6.15044%203.54722%206.1263%207.93962%201.6438%209.1407Z'%20fill='%23FFC700'%20stroke='%23FFC700'%20stroke-width='1.375'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",ba={name:"CompleteLoanWrapper",props:{isCompleteLoanActive:{type:Boolean,default:!1}},data(){return{sparkleUrl:es}}},ts={class:"tw-w-full"},ns={class:"tw-relative tw-inline-flex tw-flex-1 tw-w-full"},as=["src"],is=["src"],os=["src"],rs=["src"];function ss(t,e,a,r,n,i){return s(),u("div",ts,[o("div",ns,[Ve(t.$slots,"button"),F(o("img",{class:"tw-absolute tw--bottom-1 tw--left-1 tw-animate-pulse",src:n.sparkleUrl},null,8,as),[[De,a.isCompleteLoanActive]]),F(o("img",{class:"tw-absolute tw--top-2 tw-right-1.5 tw-animate-pulse tw-scale-50",style:{"animation-delay":"300ms"},src:n.sparkleUrl},null,8,is),[[De,a.isCompleteLoanActive]]),F(o("img",{class:"tw-absolute tw--top-1 tw--right-1 tw-animate-pulse",src:n.sparkleUrl},null,8,os),[[De,a.isCompleteLoanActive]]),F(o("img",{class:"tw-absolute tw-top-2 tw--right-1.5 tw-animate-pulse tw-scale-75",style:{"animation-delay":"800ms"},src:n.sparkleUrl},null,8,rs),[[De,a.isCompleteLoanActive]])])])}const ls=B(ba,[["render",ss]]);ba.__docgenInfo={displayName:"CompleteLoanWrapper",exportName:"default",description:"",tags:{},props:[{name:"isCompleteLoanActive",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],slots:[{name:"button"}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/CompleteLoanWrapper.vue"]};const ds={data(){return{addedLoan:{}}},methods:{handleCartModal(t){this.addedLoan=t}}},us=`query userAtbModal {
	hasEverLoggedIn @client
	my {
		id
        userAccount {
          id
          balance
        }
		loans {
			totalCount
		}
	}
	general {
		my_kiva_all_users: uiConfigSetting(key: "my_kiva_all_users_enable") {
			key
			value
		}
	}
}
`,ms={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userAtbModal"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasEverLoggedIn"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[]}]},{kind:"Field",name:{kind:"Name",value:"my"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userAccount"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"balance"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"loans"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"general"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"my_kiva_all_users"},name:{kind:"Name",value:"uiConfigSetting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"key"},value:{kind:"StringValue",value:"my_kiva_all_users_enable",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:297,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:us}}},An=(t,e)=>{const a=[],r=[];return t.forEach(n=>{n.preCheckoutTier===n.postCheckoutTier||!!e[n.achievementId]&&e[n.achievementId]===n.postCheckoutTier?r.push(n):a.push(n)}),{contributingLoanAchievements:a,nonContributingAchievements:r}},cs=(t,e)=>{const a=[];return t.forEach(r=>{var l;const n=e.find(m=>r.achievementId===m.id),i=(l=n==null?void 0:n.tiers)==null?void 0:l.find(m=>!m.completedDate);a.push({...n,...i})}),a.sort((r,n)=>xn.indexOf(r.id)-xn.indexOf(n.id)),a},ps=(t,e,a)=>{let r=null;const n=e.find(i=>{var f,k;const l=a.find(w=>w.achievementId===i.id),m=(l==null?void 0:l.contributingLoanIds)??[],c=m.includes(t.toString()),h=i.totalProgressToAchievement+m.length;return r=((k=(f=i==null?void 0:i.tiers)==null?void 0:f.find(w=>w.target-1===h))==null?void 0:k.target)??null,c&&r});return n?{...n,target:r}:null},Dn=3,hs="https://www.kiva.org/img/",ya={__name:"KvAtbModalContainer",props:{addedLoan:{type:Object,default:()=>({})},isNextStepsExpEnabled:{type:Boolean,default:!1}},setup(t){const e=zt("$kvTrackEvent"),a=zt("apollo"),r=zt("cookieStore"),n=Wi(),{fetchAchievementData:i,badgeAchievementData:l,getLoanFindingUrl:m}=oo(),c=t,{addedLoan:h}=tn(c),{userGoal:f,goalProgress:k,loadGoalData:w,getProgressByLoan:C}=mi({apollo:a}),I=G(!1),T=G({}),P=G([]),L=G([]),O=G(!1),E=G(""),V=G(""),q=G(!1),oe=G(""),ue=G(!1),M=G({}),z=G({}),ae=G(!1),we=G(0),me=G(0),ee=J(()=>{var N;return((N=h.value)==null?void 0:N.basketSize)??0}),xe=J(()=>{var N;return!((N=T.value)!=null&&N.my)}),$e=()=>{O.value=!1,V.value="",E.value="",q.value=!1},Pt=N=>{e("basket","dismiss","basket-modal",N.type),n.push(N.path),$e()},Mt=async()=>{await a.query({query:ms}).then(({data:N})=>{T.value=N??null,ae.value=(N==null?void 0:N.hasEverLoggedIn)??!1,ue.value=lo(N,Qi)}).catch(N=>{ot(N,"Modal ATB User Data")})},pt=async()=>{await a.query({query:so,variables:{basketId:r.get("kvbskt")||null}}).then(({data:N})=>{var U,Z,te;P.value=((te=(Z=(U=N==null?void 0:N.shop)==null?void 0:U.basket)==null?void 0:Z.items)==null?void 0:te.values)??[],we.value=P.value.reduce((Ee,Fe)=>Ee+(parseFloat(Fe.price)||0),0)}).catch(N=>{ot(N,"Modal ATB Basket Data")})},Ye=J(()=>P.value.filter(N=>N.__typename==="LoanReservation")??[]),qe=J(()=>Ye.value.map(N=>N.id)),W=J(()=>{var U,Z,te;return Math.floor(((te=(Z=(U=T.value)==null?void 0:U.my)==null?void 0:Z.userAccount)==null?void 0:te.balance)??0)-we.value<25}),ht=J(()=>{var N,U,Z;return I.value&&(xe.value&&!ae.value||!xe.value&&!((Z=(U=(N=T.value)==null?void 0:N.my)==null?void 0:U.loans)!=null&&Z.totalCount))&&ee.value===1}),X=J(()=>me.value>0),ft=J(()=>{var N;return k.value>=((N=f.value)==null?void 0:N.target)}),j=()=>{L.value.forEach(N=>{const{achievementId:U}=N;M.value[U]=N.postCheckoutTier,z.value[U]=N.postCheckoutTier-N.preCheckoutTier})},Re=()=>L.value.some(N=>{const U=M.value[N.achievementId]!==N.postCheckoutTier;return U&&(M.value[N.achievementId]=N.postCheckoutTier),U}),Xe=async N=>{await a.query({query:Nn,variables:{loanIds:N}}).then(({data:U})=>{var et;const Z=((et=U.postCheckoutAchievements)==null?void 0:et.overallProgress)??[],{contributingLoanAchievements:te,nonContributingAchievements:Ee}=An(Z,M.value);L.value=[...te];const{id:Fe,basketSize:Ie}=h.value,ze=cs(Ee,l.value),ve=ps(Fe,ze,Z),Je=Re();if(ve!=null&&ve.id&&!ht.value&&!Je){const wt=m(ve.id,n.currentRoute.value);V.value=wt||n.currentRoute.value.path,E.value=ro[ve.id];const{target:Ue}=ve;oe.value=`${Ue-1} of ${Ue}`,O.value=!0,q.value=!0}else(Ie<Dn||Je)&&W.value&&(O.value=!!L.value.length,q.value=!0);j()}).catch(U=>{ot(U,"Modal ATB Post Checkout Achievements Query")})},gt=async()=>{await a.query({query:Nn,variables:{loanIds:qe.value}}).then(({data:N})=>{var te;const U=((te=N.postCheckoutAchievements)==null?void 0:te.overallProgress)??[],{contributingLoanAchievements:Z}=An(U,M.value);L.value=[...Z],j()}).catch(N=>{ot(N,"Modal ATB Basket Achievements Query ")})};return nn(h,async()=>{var N;I.value&&!xe.value?(await pt(),Xe(qe.value),c.isNextStepsExpEnabled&&(await w(Ye.value),me.value=await C(h.value))):((N=h.value)==null?void 0:N.basketSize)<Dn&&(q.value=!0)}),an(async()=>{await Mt(),I.value=Zi(a,e,ue.value,r),I.value&&!xe.value&&(i(a),await pt(),await gt())}),(N,U)=>(s(),x(Cn(Yo),{"modal-visible":q.value,"user-data":T.value,"added-loan":Cn(h),"my-kiva-experiment-enabled":I.value,"show-modal-content":O.value,"photo-path":hs,"one-loan-away-category":E.value,"one-loan-away-filtered-url":V.value,"one-away-text":oe.value,"milestones-number":L.value.length,"milestones-progress":z.value,"has-ever-logged-in":ae.value,"is-loan-goal":X.value,"is-completing-goal":ft.value,onCloseRedirect:Pt,onResetModal:$e},null,8,["modal-visible","user-data","added-loan","my-kiva-experiment-enabled","show-modal-content","one-loan-away-category","one-loan-away-filtered-url","one-away-text","milestones-number","milestones-progress","has-ever-logged-in","is-loan-goal","is-completing-goal"]))}};ya.__docgenInfo={exportName:"default",displayName:"KvAtbModalContainer",description:"",tags:{},props:[{name:"addedLoan",type:{name:"object"},defaultValue:{func:!1,value:"{}"}},{name:"isNextStepsExpEnabled",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/WwwFrame/Header/KvAtbModalContainer.vue"]};const _a={name:"LendCta",inject:["apollo","cookieStore"],mixins:[ds],props:{loanId:{type:Number,default:0},enableFiveDollarsNotes:{type:Boolean,default:!1},teamData:{type:Object,default:null}},components:{LendAmountButton:Hi,KvGrid:dt,KvIcon:Ki,KvMaterialIcon:_e,KvUiButton:Ze,KvUiSelect:Gi,JumpLinks:Jr,LoanBookmark:ga,CompleteLoanWrapper:ls,KvAtbModalContainer:ya},data(){return{isLoggedIn:!1,mdiLightningBolt:ra,defaultSelectorAmount:25,selectedOption:"25",loanAmount:"",isExpiringSoon:!1,fundedAmount:"",reservedAmount:"",unreservedAmount:"",lentPreviously:!1,promoEligible:!1,minNoteSize:"",status:"",numLenders:0,lenderCountVisibility:!1,matchingTextVisibility:!1,matchingText:"",matchRatio:0,basketItems:[],isAdding:!1,isLoading:!0,hasFreeCredit:!1,isSticky:!1,wrapperHeight:0,wrapperObserver:null,name:"",completeLoanView:!0,slotMachineInterval:null,currentSlotStat:"",matchingHighlightExpShown:!1,inPfp:!1,userBalance:void 0,loan:null,basketSize:0}},apollo:{query:K`
			query lendCta($loanId: Int!, $basketId: String) {
				lend {
					loan(id: $loanId) {
						id
						status
						name
						minNoteSize
						loanAmount
						inPfp
						matchingText
						matchRatio
						gender
						borrowerCount
						... on LoanPartner {
							themes
						}
						unreservedAmount @client
						loanFundraisingInfo {
							id
							fundedAmount
							reservedAmount
							isExpiringSoon
						}
						userProperties {
							lentTo
							promoEligible(basketId: $basketId)
						}
						lenders{
							totalCount
						}
					}
				}
				shop (basketId: $basketId) {
					id
					basket {
						id
						hasFreeCredits
						items {
							values {
								id
							}
						}
					}
					nonTrivialItemCount
				}
				my {
					id
					userAccount {
						id
						balance
					}
				}
				general {
					uiExperimentSetting(key: "matching_highlight") {
						key
						value
					}
				}
			}
		`,preFetch:!1,variables(){return{loanId:this.loanId}},result(t){var r,n,i,l,m,c,h,f,k,w,C,I,T,P,L,O,E,V,q;this.isLoading=!1;const e=(n=(r=t==null?void 0:t.data)==null?void 0:r.lend)==null?void 0:n.loan,a=(l=(i=t==null?void 0:t.data)==null?void 0:i.shop)==null?void 0:l.basket;this.loan=e,this.isLoggedIn=((h=(c=(m=t==null?void 0:t.data)==null?void 0:m.my)==null?void 0:c.userAccount)==null?void 0:h.id)!==void 0||!1,this.loanAmount=(e==null?void 0:e.loanAmount)??"0",this.status=(e==null?void 0:e.status)??"",this.minNoteSize=(e==null?void 0:e.minNoteSize)??"",this.fundedAmount=((f=e==null?void 0:e.loanFundraisingInfo)==null?void 0:f.fundedAmount)??"",this.reservedAmount=((k=e==null?void 0:e.loanFundraisingInfo)==null?void 0:k.reservedAmount)??"",this.unreservedAmount=(e==null?void 0:e.unreservedAmount)??"",this.isExpiringSoon=((w=e==null?void 0:e.loanFundraisingInfo)==null?void 0:w.isExpiringSoon)??!1,this.lentPreviously=((C=e==null?void 0:e.userProperties)==null?void 0:C.lentTo)??!1,this.promoEligible=((I=e==null?void 0:e.userProperties)==null?void 0:I.promoEligible)??!1,this.numLenders=((T=e==null?void 0:e.lenders)==null?void 0:T.totalCount)??0,this.hasFreeCredit=(a==null?void 0:a.hasFreeCredits)??!1,this.basketItems=((P=a==null?void 0:a.items)==null?void 0:P.values)??[],this.matchingText=(e==null?void 0:e.matchingText)??"",this.matchRatio=(e==null?void 0:e.matchRatio)??0,this.name=(e==null?void 0:e.name)??"",this.matchingTextVisibility=this.status==="fundraising"&&this.matchingText&&!this.isMatchAtRisk,this.inPfp=(e==null?void 0:e.inPfp)??!1,this.userBalance=(E=(O=(L=t==null?void 0:t.data)==null?void 0:L.my)==null?void 0:O.userAccount)==null?void 0:E.balance,this.status==="fundraising"&&this.numLenders>0&&(this.lenderCountVisibility=!0),this.basketSize=((q=(V=t.data)==null?void 0:V.shop)==null?void 0:q.nonTrivialItemCount)||0,this.cycleStatsSlot(),this.initializeMatchingHighlightExp()}},methods:{async addToBasket(){var e,a;if((e=this.teamData)!=null&&e.id){const r={teamId:this.teamData.id,teamName:((a=this.teamData)==null?void 0:a.name)??"",loanId:this.loanId};Vi(this.cookieStore,r)}const t=_t(this.unreservedAmount)?this.unreservedAmount:this.selectedOption;this.isAdding=!0,zi({amount:t,apollo:this.apollo,loanId:this.loanId}).then(()=>{this.isAdding=!1,this.$kvTrackEvent("Lending","Add to basket",this.ctaButtonText),this.isCompleteLoanActive&&this.$kvTrackEvent("Borrower profile","Complete loan","click-amount-left-cta",this.loanId,this.selectedOption),setTimeout(()=>{this.formatAddedLoan()},1e3)}).catch(r=>{var i,l,m;(r==null?void 0:r.message)!==Ui&&this.$kvTrackEvent("borrower-profile","add-to-basket","Failed to add loan. Please try again."),this.isAdding=!1;const n=((l=(i=r[0])==null?void 0:i.extensions)==null?void 0:l.code)==="reached_anonymous_basket_limit"&&((m=r[0])==null?void 0:m.message);this.$showTipMsg(n,"error")})},createWrapperObserver(){var t;this.wrapperObserver=Me({targets:[(t=this.$refs)==null?void 0:t.wrapper],callback:e=>{e.forEach(a=>{var r;a.target===((r=this.$refs)==null?void 0:r.wrapper)&&(a.intersectionRatio>0?this.isSticky=!1:(this.wrapperHeight=a.boundingClientRect.height,this.isSticky=!0))})}})},destroyWrapperObserver(){this.wrapperObserver&&this.wrapperObserver.disconnect()},trackLendAmountSelection(t){this.$kvTrackEvent("Lending","Modify lend amount",t)},cycleStatsSlot(){if(this.slotMachineInterval)return;const t=()=>{const e=[];this.status==="fundraising"&&this.numLenders>0&&e.push("lenderCount"),this.status==="fundraising"&&this.matchingText.length&&!this.isMatchAtRisk&&e.push("matchingText");let a=e.indexOf(this.currentSlotStat)+1;a=a>=e.length?0:a,this.currentSlotStat=e[a]??""};t(),this.slotMachineInterval=setInterval(t,5e3)},async initializeMatchingHighlightExp(){await this.apollo.query({query:Wt,variables:{id:"matching_highlight"}});const t=di(this.apollo,"matching_highlight");if(t!=null&&t.enabled&&this.matchingTextVisibility){const{version:e}=en(this.apollo,this.$kvTrackEvent,"borrower-profile","matching_highlight","EXP-ACK-538-Mar2023",`${this.matchRatio+1}x`);e&&(this.matchingHighlightExpShown=e==="b")}},formatAddedLoan(){var e,a,r;const t={id:this.loanId,name:this.name??"",gender:((e=this.loan)==null?void 0:e.gender)??"",borrowerCount:((a=this.loan)==null?void 0:a.borrowerCount)??1,themes:((r=this.loan)==null?void 0:r.themes)??[],basketSize:this.basketSize};this.handleCartModal(t)}},watch:{matchingText(t,e){t!==e&&t!==""&&this.cycleStatsSlot()},unreservedAmount(t,e){t!==e&&e===""&&(this.selectedOption=si(this.cookieStore,this.enableFiveDollarsNotes,this.$route.query.utm_campaign,t,this.userBalance))},isCompleteLoanActive(){this.isCompleteLoanActive&&this.completeLoanView&&(this.$kvTrackEvent("Borrower profile","Complete loan","view-amount-left-cta",this.loanId,this.selectedOption),this.completeLoanView=!1)}},computed:{isInBasket(){return this.basketItems.some(t=>t.__typename==="LoanReservation"&&t.id===this.loanId)},isMatchAtRisk(){const t={loanAmount:this.loanAmount,loanFundraisingInfo:{fundedAmount:this.fundedAmount,reservedAmount:this.reservedAmount},matchRatio:this.matchRatio,matchingText:this.matchingText};return ri(t)},prices(){const t=parseFloat(this.unreservedAmount<25?this.minNoteSize:25),e=oi(this.unreservedAmount,t,this.enableFiveDollarsNotes,this.inPfp,this.isLoggedIn);return this.isCompleteLoanActive&&!e.includes(Number(this.unreservedAmount).toFixed())&&e.push(Number(this.unreservedAmount).toFixed()),e},lgScreenheadline(){if(this.showSparkles)return`${this.name}'s loan is almost funded!`;switch(this.state){case"loading":return"Loading...";case"funded":return"Help more borrowers like this";case"refunded":case"expired":case"fully-reserved":return"Help fund other borrowers";default:return"Help fund this loan"}},ctaButtonText(){if(this.showSparkles)return"Lend now";switch(this.state){case"loading":return"Loading...";case"funded":return"Find another loan like this";case"refunded":case"expired":case"fully-reserved":return"Find another loan";default:return"Lend now"}},useFormSubmit(){return!!(this.hideShowLendDropdown||this.lendButtonVisibility||this.lendAgainButton||this.state==="lent-to"||this.isAdding)},state(){return this.isLoading?"loading":this.isAdding?"adding":this.isInBasket?"basketed":this.status==="funded"||this.status==="refunded"||this.status==="expired"?this.status:this.allSharesReserved?"fully-reserved":this.lentPreviously?"lent-to":"lend"},showAdding(){return this.state==="adding"},lendButtonVisibility(){return this.state==="lend"||this.state==="loading"},showNonActionableLoanButton(){return this.state==="funded"||this.state==="refunded"||this.state==="expired"||this.state==="fully-reserved"},hideShowLendDropdown(){return this.state==="lend"||this.state==="lent-to"},freeCreditWarning(){return this.hasFreeCredit===!0&&this.promoEligible===!1},allSharesReserved(){return parseFloat(this.unreservedAmount)===0},wrapperStyle(){return{paddingBottom:this.isSticky?`${this.wrapperHeight}px`:"0"}},transitionEnterClasses(){return this.isSticky?"tw-transform tw-translate-y-7 md:tw-translate-y-7 lg:tw--translate-y-7":""},isLessThan25(){return this.enableFiveDollarsNotes?!1:_t(this.unreservedAmount)},isLentTo(){return this.state==="lent-to"},isCompleteLoanActive(){return _t(this.unreservedAmount)||ii(this.unreservedAmount)},showSparkles(){return this.isCompleteLoanActive&&Number(this.unreservedAmount).toFixed()===Number(this.selectedOption).toFixed()},isLendAmountButton(){return(this.lendButtonVisibility||this.state==="lent-to")&&_t(this.unreservedAmount)}},mounted(){this.createWrapperObserver()},beforeUnmount(){this.destroyWrapperObserver()}},fs={class:"tw-text-h3 tw-pt-3 lg:tw-mb-3 tw-hidden lg:tw-inline-block"},gs={class:"tw-flex tw-flex-wrap tw-pb-1 lg:tw-pb-2 tw-relative"},ws={key:0,class:"tw-line-clamp-1 match-text tw-mb-0.5 md:tw-hidden tw-pl-3"},vs=["disabled"],bs={key:0,for:"LoanAmountDropdown",class:"tw-sr-only"},ys=["value"],_s={class:"match-text tw-z-1 tw-mr-0.5"},ks={key:5,class:"md:tw-line-clamp-1 match-text tw-mt-0.5 tw-hidden md:tw-block tw-pl-3"},Ls={key:1,class:"tw-text-h4 tw-text-secondary tw-inline-block tw-text-center tw-w-full tw-mb-3","data-testid":"bp-lend-cta-not-eligible-for-credit"},Cs={key:2,class:"tw-text-h4 tw-text-secondary tw-inline-block tw-text-center tw-w-full tw-mb-3","data-testid":"bp-lend-cta-all-shares-reserved"},Ss={class:"tw-inline-block","data-testid":"bp-lend-cta-powered-by-text",key:"numLendersStat"},xs={class:"tw-align-middle"},Is={class:"tw-inline-block","data-testid":"bp-lend-cta-matched-text",key:"loanMatchingText"};function Ts(t,e,a,r,n,i){const l=g("kv-atb-modal-container"),m=g("kv-ui-select"),c=g("kv-ui-button"),h=g("lend-amount-button"),f=g("complete-loan-wrapper"),k=g("kv-icon"),w=g("loan-bookmark"),C=g("jump-links"),I=g("kv-grid"),T=g("kv-material-icon"),P=de("kv-track-event");return s(),u("div",{ref:"wrapper",class:Q(["lg:tw-mb-1.5",{"md:tw-px-4":n.isSticky}]),style:le(i.wrapperStyle)},[p(l,{"added-loan":t.addedLoan},null,8,["added-loan"]),o("div",{class:Q(["tw-w-full","tw-flex tw-flex-col","tw-left-0 tw-bottom-0",{"md:tw-static":!n.isSticky},"lg:tw-static",{"tw-fixed tw-z-sticky":n.isSticky}])},[p(I,{class:Q(["tw-grid-cols-12",{"md:tw-rounded-b":!n.isSticky,"md:tw-border-none":!n.isSticky,"md:tw-px-3":!n.isSticky,"md:tw-px-4":n.isSticky,"tw-bg-transparent md:tw-bg-primary":!n.isSticky,"tw-bg-primary":n.isSticky,"tw-border-t tw-border-tertiary tw-px-2.5":n.isSticky},"lg:tw-rounded-t","lg:tw-px-4","lg:tw-gap-1"])},{default:_(()=>[o("div",{class:Q(["tw-pt-1","tw-col-span-12",{"md:tw-pt-0":!n.isSticky,"md:tw-col-start-2 md:tw-col-span-10":n.isSticky},"lg:tw-col-span-12","lg:tw-pt-1 lg:tw-pb-1"])},[o("p",fs,b(i.lgScreenheadline),1),o("span",gs,[n.matchingHighlightExpShown?(s(),u("span",ws,b(n.matchRatio+1)+"x matched by "+b(n.matchingText)+"!",1)):v("",!0),i.useFormSubmit?(s(),u("form",{key:1,onSubmit:e[1]||(e[1]=Be((...L)=>i.addToBasket&&i.addToBasket(...L),["prevent"])),class:"tw-w-full tw-flex"},[o("fieldset",{class:"tw-w-full tw-flex",disabled:n.isAdding,"data-testid":"bp-lend-cta-select-and-button"},[i.hideShowLendDropdown&&!i.isLessThan25?(s(),u("label",bs," Lend amount ")):v("",!0),i.hideShowLendDropdown&&!i.isLessThan25?F((s(),x(m,{key:1,id:"LoanAmountDropdown",class:"tw-mr-2.5 tw-min-w-12","data-testid":"bp-lend-cta-amount-dropdown",modelValue:n.selectedOption,"onUpdate:modelValue":[e[0]||(e[0]=L=>n.selectedOption=L),i.trackLendAmountSelection]},{default:_(()=>[(s(!0),u(H,null,Y(i.prices,L=>(s(),u("option",{key:L,value:L}," $"+b(L),9,ys))),128))],void 0,!0),_:1},8,["modelValue","onUpdate:modelValue"])),[[P,["Lending","click-Modify loan amount","open dialog"]]]):v("",!0),p(f,{"is-complete-loan-active":i.showSparkles},{button:_(()=>[i.lendButtonVisibility&&!i.isLessThan25?(s(),x(c,{key:"lendButton",class:"tw-inline-flex tw-flex-1","data-testid":"bp-lend-cta-lend-button",type:"submit"},{default:_(()=>[D(b(i.ctaButtonText),1)],void 0,!0),_:1})):v("",!0),i.isLentTo&&!i.isLessThan25?F((s(),x(c,{key:"lendAgainButton",class:"tw-inline-flex tw-flex-1","data-testid":"bp-lend-cta-lend-again-button",type:"submit"},{default:_(()=>e[2]||(e[2]=[D(" Lend again ")]),void 0,!0),_:1,__:[2]})),[[P,["Lending","Add to basket","Lend again"]]]):v("",!0),i.isLendAmountButton&&!a.enableFiveDollarsNotes?(s(),x(h,{key:2,class:"tw-w-full","loan-id":a.loanId,"show-now":!0,"amount-left":n.unreservedAmount,onAddToBasket:i.addToBasket,"complete-loan":i.isCompleteLoanActive},null,8,["loan-id","amount-left","onAddToBasket","complete-loan"])):v("",!0),n.isAdding?(s(),x(c,{key:3,class:"tw-inline-flex tw-flex-1","data-testid":"bp-lend-cta-adding-to-basket-button"},{default:_(()=>e[3]||(e[3]=[D(" Adding to basket... ")]),void 0,!0),_:1,__:[3]})):v("",!0)]),_:1},8,["is-complete-loan-active"])],8,vs)],32)):v("",!0),i.state==="basketed"?F((s(),x(c,{key:2,class:"tw-inline-flex tw-flex-1","data-testid":"bp-lend-cta-checkout-button",to:"/basket"},{default:_(()=>e[4]||(e[4]=[D(" Continue to checkout ")]),void 0,!0),_:1,__:[4]})),[[P,["Lending","click-Continue-to-checkout","Continue to checkout"]]]):v("",!0),i.showNonActionableLoanButton?F((s(),x(c,{key:3,class:"tw-inline-flex tw-flex-1","data-testid":"bp-lend-cta-non-actionable-loan-button",to:"/lend-by-category"},{default:_(()=>[D(b(i.ctaButtonText),1)],void 0,!0),_:1})),[[P,["Lending","Non actionable loan",i.ctaButtonText,n.status]]]):v("",!0),n.matchingHighlightExpShown?(s(),u("span",{key:4,class:Q(["tw-flex","tw-items-center","tw-justify-center","tw-w-4","tw-h-4",{"tw-absolute":n.isSticky},"tw-left-0","tw-top-[0.15rem]","md:tw-top-auto","tw-bottom-auto","md:tw-bottom-2"])},[o("span",_s,b(n.matchRatio+1)+"x ",1),p(k,{name:"sparkle-icon",class:"tw-absolute tw-h-full tw-w-full"})],2)):v("",!0),n.matchingHighlightExpShown?(s(),u("span",ks,b(n.matchRatio+1)+"x matched by "+b(n.matchingText)+"!",1)):v("",!0)]),n.isSticky?v("",!0):Ve(t.$slots,"sharebutton",{key:0},void 0,!0),i.freeCreditWarning?(s(),u("p",Ls," Not eligible for lending credit ")):v("",!0),i.allSharesReserved?(s(),u("p",Cs," All shares reserved ")):v("",!0),o("hr",{class:Q(["lg:tw-block tw-border-tertiary tw-w-full tw-my-2",[{"tw-hidden":n.isSticky,"tw-block":!n.isSticky}]])},null,2),o("div",{class:Q(["lg:tw-block tw-flex lg:tw-justify-center tw-w-full",[{"tw-justify-between":n.isLoggedIn,"tw-justify-end":!n.isLoggedIn,"tw-hidden":n.isSticky}]])},[n.isLoggedIn?(s(),x(w,{key:0,"data-testid":"bp-lend-cta-loan-bookmark","loan-id":a.loanId,class:"tw-inline-block lg:tw-hidden"},null,8,["loan-id"])):v("",!0),p(C,{class:"tw-block lg:tw-mb-1.5 md:tw-mb-3","data-testid":"bp-lend-cta-jump-links"})],2)],2)],void 0),_:3},8,["class"]),p(Zt,{"enter-active-class":"tw-transition-transform tw-duration-700 tw-delay-300","enter-from-class":i.transitionEnterClasses,"enter-to-class":"tw-transform tw-translate-y-0 md:tw-translate-y-0 lg:tw-translate-y-0"},{default:_(()=>[F(p(I,{key:"grid",class:Q(["tw-grid-cols-12","tw-order-first","tw-w-full",{"tw-bottom-14":i.freeCreditWarning||i.allSharesReserved,"tw-bottom-8":!i.freeCreditWarning&&!i.allSharesReserved},{"md:tw-relative":!n.isSticky,"md:tw-bottom-0":!n.isSticky,"md:tw-order-none":!n.isSticky,"lg:tw-px-3":!n.isSticky,"md:tw-px-4":n.isSticky,"tw-px-2.5 tw-absolute":n.isSticky},"lg:tw-px-0",{"tw-hidden":n.matchingHighlightExpShown,"md:tw-grid":n.matchingHighlightExpShown}])},{default:_(()=>[o("div",{key:"wrapper",class:Q(["tw-h-5","tw-overflow-hidden","tw-col-span-12","tw-mb-1 tw-p-1","tw-rounded","tw-bg-primary","tw-text-h4","tw-flex tw-justify-center","tw-mt-1",{"tw-relative":n.isSticky,"md:tw-mb-0":!n.isSticky,"md:tw-col-start-5 md:tw-col-span-6":n.isSticky,"md:tw-hidden":n.isSticky},"lg:tw-mb-0","lg:tw-col-span-12"])},[p(Zt,{mode:"out-in",key:"transition","enter-active-class":"tw-transition-all tw-duration-1000","enter-from-class":"tw-transform tw--translate-y-2 tw-opacity-0","enter-to-class":"tw-transform tw-translate-y-0 tw-opacity-full","leave-active-class":"tw-transition-all tw-duration-1000","leave-from-class":"tw-transform tw-translate-y-0 tw-opacity-full","leave-to-class":"tw-transform tw-translate-y-2 tw-opacity-0"},{default:_(()=>[n.currentSlotStat==="lenderCount"?(s(),u("span",Ss,[p(T,{class:"tw-w-2.5 tw-h-2.5 tw-pointer-events-none tw-inline-block tw-align-middle",icon:n.mdiLightningBolt},null,8,["icon"]),o("span",xs,"powered by "+b(n.numLenders)+" lenders",1)])):n.currentSlotStat==="matchingText"?(s(),u("span",Is,[e[5]||(e[5]=o("span",{class:"tw-text-h3 tw-inline-block tw-pr-1 tw-align-middle"},"🎉",-1)),D(b(n.matchRatio+1)+"X MATCHED LOAN ",1)])):v("",!0)],void 0,!0),_:1})],2)],void 0,!0),_:1},8,["class"]),[[De,n.lenderCountVisibility||n.matchingTextVisibility]])],void 0),_:1},8,["enter-from-class"])],2)],6)}const Ns=B(_a,[["render",Ts],["__scopeId","data-v-09be5207"]]);_a.__docgenInfo={displayName:"LendCta",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"enableFiveDollarsNotes",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"teamData",type:{name:"object"},defaultValue:{func:!1,value:"null"}}],slots:[{name:"sharebutton"}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/LendCta.vue"]};const As=K`query previousLoanQuery($id: Int!) {
	lend {
		loan(id: $id) {
			id
			description
		}
	}
}`,ka={name:"PreviousLoanDescription",components:{KvTextLink:ct,KvMaterialIcon:_e,KvExpandable:uo},data(){return{mdiChevronDown:xi,previousLoanDetailsOpen:!1,previousLoanDescription:""}},inject:["apollo"],props:{loanId:{type:Number,default:0},previousLoanId:{type:Number,default:0},borrowerOrGroupName:{type:String,default:""}},computed:{formattedPreviousLoanDescription(){return rt(this.previousLoanDescription)}},methods:{fetchPreviousLoanDescription(){this.apollo.query({query:As,variables:{id:this.previousLoanId}}).then(({data:t})=>{var e,a;this.previousLoanDescription=(a=(e=t.lend)==null?void 0:e.loan)==null?void 0:a.description})},togglePreviousLoanDetails(){this.previousLoanDetailsOpen=!this.previousLoanDetailsOpen},performClick(){this.togglePreviousLoanDetails(),this.previousLoanDescription===""&&this.fetchPreviousLoanDescription()}}},Ds={"data-testid":"bp-story-previous-loan"},Ps=["data-testid","innerHTML"];function Ms(t,e,a,r,n,i){const l=g("kv-material-icon"),m=g("kv-text-link"),c=g("router-link"),h=g("kv-expandable"),f=de("kv-track-event");return s(),u("section",Ds,[F((s(),x(m,{onClick:Be(i.performClick,["prevent"])},{default:_(()=>[e[0]||(e[0]=D(" Show previous loan details ")),p(l,{icon:n.mdiChevronDown,class:Q(["tw-w-3 tw-h-3 tw-align-middle tw-mb-0.5 tw-transition-transform tw-ease-in-out tw-duration-500",{"tw-rotate-180":n.previousLoanDetailsOpen}])},null,8,["icon","class"])],void 0),_:1,__:[0]},8,["onClick"])),[[f,["Borrower profile","click-Loan details","Show previous loan details",a.loanId]]]),F(p(h,{easing:"ease-in-out"},{default:_(()=>[o("div",null,[e[1]||(e[1]=o("h2",{"data-testid":"bp-story-previous-loan-header"}," Previous loan details ",-1)),(s(!0),u(H,null,Y(i.formattedPreviousLoanDescription,(k,w)=>(s(),u("p",{"data-testid":`bp-story-previous-loan-text-${w}`,key:w,innerHTML:k},null,8,Ps))),128)),a.previousLoanId&&a.borrowerOrGroupName!==""?F((s(),x(c,{key:0,to:`/lend/${a.previousLoanId}`,"data-testid":"bp-story-previous-loan-link"},{default:_(()=>[D(b(a.borrowerOrGroupName)+"'s previous loan ",1)],void 0,!0),_:1},8,["to"])),[[f,["Borrower profile","Loan details","Borrower's previous loan",a.previousLoanId]]]):v("",!0)])],void 0),_:1},512),[[De,n.previousLoanDetailsOpen]])])}const Rs=B(ka,[["render",Ms]]);ka.__docgenInfo={displayName:"PreviousLoanDescription",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"previousLoanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"borrowerOrGroupName",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/PreviousLoanDescription.vue"]};const La={name:"LoanDescription",components:{KvLightbox:mt,previousLoanDescription:Rs},props:{partnerName:{type:String,default:""},borrowerOrGroupName:{type:String,default:""},anonymizationLevel:{type:String,default:""},storyDescription:{type:String,default:""},descriptionInOriginalLanguage:{type:String,default:""},originalLanguage:{type:Object,default:()=>{}},borrowerCount:{type:Number,default:0},borrowers:{type:Array,default:()=>[]},reviewer:{type:Object,default:()=>{}},previousLoanId:{type:Number,default:0},loanId:{type:Number,default:0}},data(){return{isLightboxVisible:!1}},computed:{borrowersList(){return this.borrowerCount<=1?"":`In this group: ${this.borrowers.map(({firstName:e})=>e).join(", ")}`},storyDescriptionParagraphs(){return rt(this.storyDescription)},descriptionInOriginalLanguageParagraphs(){return rt(this.descriptionInOriginalLanguage)},isAnonymizationLevelFull(){return this.anonymizationLevel==="full"},storyTranslation(){var t;return this.isPartnerLoan&&parseInt(((t=this.originalLanguage)==null?void 0:t.id)??0,10)!==1},language(){var t;return((t=this.originalLanguage)==null?void 0:t.name)??""},isPartnerLoan(){return this.partnerName!==""},reviewerName(){var t;return((t=this.reviewer)==null?void 0:t.bylineName)??""},lightboxTitle(){return this.isAnonymizationLevelFull?"Story":`${this.borrowerOrGroupName}'s story`},showReviewersName(){var t;return(t=this.reviewer)==null?void 0:t.showName}},methods:{openLightbox(){this.isLightboxVisible=!0},closeLightbox(){this.isLightboxVisible=!1}}},Es={class:"tw-prose","data-testid":"bp-story-header"},Fs={key:0},Os={key:1},Bs={class:"tw-prose"},Vs={key:0},$s=["data-testid","innerHTML"],qs={key:1},zs={"data-testid":"bp-story-borrower-list"},Us={key:3},js={"data-testid":"bp-story-translate-info"},Hs={key:0},Ks={key:0},Gs={"data-testid":"bp-story-translate-volunteer-link",href:"/work-with-us/reviewers",title:"Learn more about volunteering at Kiva"},Ws={key:0},Zs={key:1,"data-testid":"bp-story-translate-reviewer"},Qs=["innerHTML"];function Ys(t,e,a,r,n,i){const l=g("previous-loan-description"),m=g("kv-lightbox"),c=de("kv-track-event");return s(),u("section",null,[o("div",Es,[i.isAnonymizationLevelFull?(s(),u("h2",Fs," Story ")):v("",!0),i.isAnonymizationLevelFull?v("",!0):(s(),u("h2",Os,b(a.borrowerOrGroupName)+"'s story ",1))]),o("div",Bs,[a.storyDescription?(s(),u("section",Vs,[(s(!0),u(H,null,Y(i.storyDescriptionParagraphs,(h,f)=>(s(),u("p",{"data-testid":`bp-story-description-${f}`,key:`storyDescription-${f}`,innerHTML:h},null,8,$s))),128))])):v("",!0),i.borrowersList?(s(),u("section",qs,[o("p",zs,b(i.borrowersList),1)])):v("",!0),a.previousLoanId?(s(),x(l,{key:2,"loan-id":a.loanId,"previous-loan-id":a.previousLoanId,"borrower-or-group-name":a.borrowerOrGroupName},null,8,["loan-id","previous-loan-id","borrower-or-group-name"])):v("",!0),i.storyTranslation?(s(),u("section",Us,[o("p",null,[o("em",js,[D(" Translated from "+b(i.language)+" ",1),i.reviewerName?(s(),u("span",Hs,[e[2]||(e[2]=D(" by ")),i.showReviewersName?v("",!0):(s(),u("span",Ks,"a")),F((s(),u("a",Gs,[e[1]||(e[1]=D(" Kiva volunteer")),i.showReviewersName?v("",!0):(s(),u("span",Ws,"."))])),[[c,["Borrower profile","click-Kiva review volunteer","Kiva volunteer",a.loanId]]]),i.showReviewersName?(s(),u("span",Zs,b(i.reviewerName)+". ",1)):v("",!0)])):v("",!0),a.descriptionInOriginalLanguage!==""?F((s(),u("a",{key:1,"data-testid":"bp-story-translate-view-original-language-link",onClick:e[0]||(e[0]=(...h)=>i.openLightbox&&i.openLightbox(...h))},e[3]||(e[3]=[D(" View original language description. ")]))),[[c,["Borrower profile","click-Original language lightbox","View original language description",a.loanId]]]):v("",!0)])])])):v("",!0)]),p(m,{"data-testid":"bp-lightbox-story-translate-original-language",visible:n.isLightboxVisible,title:i.lightboxTitle,onLightboxClosed:i.closeLightbox},{default:_(()=>[(s(!0),u(H,null,Y(i.descriptionInOriginalLanguageParagraphs,(h,f)=>(s(),u("p",{key:`originalLanguageParagraph-${f}`,innerHTML:h,class:"tw-prose"},null,8,Qs))),128))],void 0),_:1},8,["visible","title","onLightboxClosed"])])}const Xs=B(La,[["render",Ys]]);La.__docgenInfo={displayName:"LoanDescription",exportName:"default",description:"",tags:{},props:[{name:"partnerName",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"borrowerOrGroupName",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"anonymizationLevel",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"storyDescription",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"descriptionInOriginalLanguage",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"originalLanguage",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}},{name:"borrowerCount",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"borrowers",type:{name:"array"},defaultValue:{func:!1,value:"[]"}},{name:"reviewer",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}},{name:"previousLoanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/LoanDescription.vue"]};const Ca={name:"LoanStory",inject:["apollo","cookieStore"],components:{BorrowerImage:ut,LoanDescription:Xs},props:{loanId:{type:Number,default:0}},data(){return{anonymizationLevel:"",borrowerCount:0,borrowers:[],name:"",hash:"",description:"",descriptionInOriginalLanguage:"",originalLanguage:{},partnerName:"",reviewer:{},previousLoanId:0,youtubeId:""}},apollo:{preFetch:!0,query:K`query loanStory($loanId: Int!) {
			lend {
				loan(id: $loanId) {
					id
					anonymizationLevel
					borrowerCount
					borrowers {
						id
						firstName
					}
					description
					previousLoanId
					descriptionInOriginalLanguage
					image {
						id
						hash
					}
					video {
						youtubeId
					}
					name
					originalLanguage {
						id
						name
					}
					... on LoanPartner {
						partnerName
						reviewer {
							id
							bylineName
							showName
						}
					}
				}
			}
		}`,preFetchVariables({route:t}){var e;return{loanId:Number(((e=t==null?void 0:t.params)==null?void 0:e.id)??0)}},variables(){return{loanId:this.loanId}},result(t){var a,r,n,i;const e=(r=(a=t==null?void 0:t.data)==null?void 0:a.lend)==null?void 0:r.loan;this.anonymizationLevel=(e==null?void 0:e.anonymizationLevel)??"",this.borrowerCount=(e==null?void 0:e.borrowerCount)??0,this.borrowers=(e==null?void 0:e.borrowers)??[],this.description=(e==null?void 0:e.description)??"",this.descriptionInOriginalLanguage=(e==null?void 0:e.descriptionInOriginalLanguage)??"",this.hash=((n=e==null?void 0:e.image)==null?void 0:n.hash)??"",this.name=(e==null?void 0:e.name)??"",this.originalLanguage=(e==null?void 0:e.originalLanguage)??{},this.partnerName=(e==null?void 0:e.partnerName)??"",this.reviewer=(e==null?void 0:e.reviewer)??{},this.previousLoanId=(e==null?void 0:e.previousLoanId)??0,this.youtubeId=((i=e==null?void 0:e.video)==null?void 0:i.youtubeId)??""}}},Js=["src"];function el(t,e,a,r,n,i){const l=g("borrower-image"),m=g("loan-description");return s(),u("article",null,[n.youtubeId?(s(),u("iframe",{key:0,class:"tw-aspect-video tw-mx-auto tw-rounded tw-w-full tw--mb-1.5 md:tw--mb-1",width:"560",height:"315",src:`https://www.youtube.com/embed/${n.youtubeId}?rel=0`,title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; web-share",allowfullscreen:""},null,8,Js)):(s(),x(l,{key:1,class:"tw-w-full tw-bg-black tw-rounded tw--mb-1.5 md:tw--mb-1","data-testid":"bp-story-borrower-image",alt:n.name,"aspect-ratio":16/25,"default-image":{width:612},hash:n.hash,images:[{width:612,viewSize:1024},{width:580,viewSize:768},{width:416,viewSize:480},{width:374,viewSize:414},{width:335,viewSize:375},{width:280}]},null,8,["alt","hash"])),p(m,{class:"tw-pt-4","loan-id":a.loanId,"anonymization-level":n.anonymizationLevel,"borrower-count":n.borrowerCount,"borrower-or-group-name":n.name,borrowers:n.borrowers,"description-in-original-language":n.descriptionInOriginalLanguage,"original-language":n.originalLanguage,"partner-name":n.partnerName,reviewer:n.reviewer,"story-description":n.description,"previous-loan-id":n.previousLoanId},null,8,["loan-id","anonymization-level","borrower-count","borrower-or-group-name","borrowers","description-in-original-language","original-language","partner-name","reviewer","story-description","previous-loan-id"]),n.youtubeId?(s(),x(l,{key:2,class:"tw-w-full tw-bg-black tw-rounded tw--mb-1.5 md:tw--mb-1","data-testid":"bp-story-borrower-image",alt:n.name,"aspect-ratio":16/25,"default-image":{width:612},hash:n.hash,images:[{width:612,viewSize:1024},{width:580,viewSize:768},{width:416,viewSize:480},{width:374,viewSize:414},{width:335,viewSize:375},{width:280}]},null,8,["alt","hash"])):v("",!0)])}const tl=B(Ca,[["render",el]]);Ca.__docgenInfo={displayName:"LoanStory",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/LoanStory.vue"]};const nl=`
query getPersonalizedLoans($limit: Int!, $filters: [FundraisingLoanSearchFilterInput!], $origin: String) {
	fundraisingLoans(limit: $limit, sortBy: personalized, filters: $filters, origin: $origin) {
		values {
			id
		}
	}
}
`,al={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getPersonalizedLoans"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filters"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FundraisingLoanSearchFilterInput"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"origin"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fundraisingLoans"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}},{kind:"Argument",name:{kind:"Name",value:"sortBy"},value:{kind:"EnumValue",value:"personalized"}},{kind:"Argument",name:{kind:"Name",value:"filters"},value:{kind:"Variable",name:{kind:"Name",value:"filters"}}},{kind:"Argument",name:{kind:"Name",value:"origin"},value:{kind:"Variable",name:{kind:"Name",value:"origin"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"values"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:265,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:nl}}},il=`#import '../../fragments/loanCardFields.graphql'

query mlLoansYouMightLikeData(
	$loanId: Int!,
	$offset: Int = 0,
	$limit: Int = 8,
	$imgDefaultSize: String = "w480h360",
	$imgRetinaSize: String = "w480h360"
) {
	ml {
		relatedLoansByTopics(limit: $limit, loanId: $loanId, offset: $offset, topics: [story]) {
			values {
				id
				...loanCardFields
				image {
					id
					default: url(customSize: $imgDefaultSize)
					retina: url(customSize: $imgRetinaSize)
					hash
				}
			}
		}
	}
}
`,Nt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mlLoansYouMightLikeData"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"loanId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"0"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"8"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"imgDefaultSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},defaultValue:{kind:"StringValue",value:"w480h360",block:!1},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"imgRetinaSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},defaultValue:{kind:"StringValue",value:"w480h360",block:!1},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ml"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relatedLoansByTopics"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}},{kind:"Argument",name:{kind:"Name",value:"loanId"},value:{kind:"Variable",name:{kind:"Name",value:"loanId"}}},{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"topics"},value:{kind:"ListValue",values:[{kind:"EnumValue",value:"story"}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"values"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"loanCardFields"},directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"default"},name:{kind:"Name",value:"url"},arguments:[{kind:"Argument",name:{kind:"Name",value:"customSize"},value:{kind:"Variable",name:{kind:"Name",value:"imgDefaultSize"}}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"retina"},name:{kind:"Name",value:"url"},arguments:[{kind:"Argument",name:{kind:"Name",value:"customSize"},value:{kind:"Variable",name:{kind:"Name",value:"imgRetinaSize"}}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"hash"},arguments:[],directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:532,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:il}}},ol=t=>{const e={};return t.filter(function(a){if(a.kind!=="FragmentDefinition")return!0;const r=a.name.value;return e[r]?!1:(e[r]=!0,!0)})};Nt.definitions=ol(Nt.definitions.concat(po.definitions));const rl=(t,e)=>{const a=(f,k)=>{if(f.kind==="FragmentSpread")k.add(f.name.value);else if(f.kind==="VariableDefinition"){const w=f.type;w.kind==="NamedType"&&k.add(w.name.value)}return f&&"selectionSet"in f&&f.selectionSet&&f.selectionSet.selections.forEach(w=>{a(w,k)}),f&&"variableDefinitions"in f&&f.variableDefinitions&&f.variableDefinitions.forEach(w=>{a(w,k)}),f&&"definitions"in f&&f.definitions&&f.definitions.forEach(w=>{a(w,k)}),k},r=f=>{const k={};return f.definitions.forEach(function(w){"name"in w&&w.name&&(k[w.name.value]=a(w,new Set))}),k},n=(f,k)=>{for(let w=0;w<f.definitions.length;w++){const C=f.definitions[w];if(C&&"name"in C&&C.name&&C.name.value==k)return C}},i=r(t),l=Object.assign({},t,{definitions:[n(t,e)]}),m=i[e]||new Set,c=new Set;let h=new Set;for(m.forEach(f=>{h.add(f)});h.size>0;){const f=h;h=new Set,f.forEach(k=>{c.has(k)||(c.add(k),(i[k]||new Set).forEach(C=>{h.add(C)}))})}return c.forEach(f=>{const k=n(t,f);k&&l.definitions.push(k)}),l};rl(Nt,"mlLoansYouMightLikeData");const Sa={name:"FundedBorrowerProfile",head(){var t,e;return{title:`${this.loan.name} from ${(e=(t=this.loan.geocode)==null?void 0:t.country)==null?void 0:e.name}'s loan has been funded!`,meta:[{vmid:"description",name:"description",content:`A loan helped ${this.loan.use}`}].concat([{property:"og:title",vmid:"og:title",content:this.shareTitle},{property:"og:description",vmid:"og:description",content:this.shareDescription},{name:"twitter:description",vmid:"twitter:description",content:this.shareDescription}])}},components:{KvLoadingSpinner:mo,HeroBackground:ia,BorrowerName:da,LoanProgress:ha,BorrowerImage:ut,KvGrid:dt,KvPageContainer:Dt,KivaClassicLoanCarousel:co,LoanCardController:$i},inject:["apollo","cookieStore"],props:{loan:{type:Object,default:()=>{}},hash:{type:String,default:""},itemsInBasket:{type:Array,default:()=>[]},inviterName:{type:String,default:""}},data(){return{viewportObserver:null,isLoading:!0,categories:[],rows:null,isVisitor:!0,loanRowsCount:4}},computed:{shareTitle(){var t,e,a;return((t=this.loan)==null?void 0:t.anonymizationLevel)!=="full"?`A loan of $${(e=this.loan)==null?void 0:e.loanAmount} made a difference for ${this.loan.name}`:`A loan of $${(a=this.loan)==null?void 0:a.loanAmount} made a difference`},shareDescription(){return"Kiva is a loan, not a donation. With Kiva you can lend as little as $25 and make a big change in someone's life."},loanStatus(){var t,e;return((t=this.loan)==null?void 0:t.status)==="fundraising"?"funded":((e=this.loan)==null?void 0:e.status)??"funded"},progressPercent(){var t,e,a;return this.loanStatus==="funded"?1:(((e=(t=this.loan)==null?void 0:t.loanFundraisingInfo)==null?void 0:e.fundedAmount)??0)/(((a=this.loan)==null?void 0:a.loanAmount)??0)}},mounted(){var t,e,a,r,n,i;this.createViewportObserver(),this.rows=[{identifier:"sector",rowIndex:1,heading:"Support these ",subHeading:"",onlyLoan:!1,limit:3,filter:{sector:{eq:(e=(t=this.loan)==null?void 0:t.sector)==null?void 0:e.name}},loanIds:[]},{identifier:"recommended",rowIndex:2,heading:"Recommended Borrower",subHeading:"We selected this loan for you because it's similar to ",onlyLoan:!0,limit:1,filter:null,loan:null},{identifier:"gender",rowIndex:3,heading:"Support these ",subHeading:"",onlyLoan:!1,limit:3,filter:{gender:{eq:(a=this.loan)==null?void 0:a.gender}},loanIds:[]},{identifier:"country",rowIndex:4,heading:"Support these borrowers in ",subHeading:"",onlyLoan:!1,limit:3,filter:{countryIsoCode:{eq:(i=(n=(r=this.loan)==null?void 0:r.geocode)==null?void 0:n.country)==null?void 0:i.isoCode}},loanIds:[]}]},methods:{refIsVisible(){var r,n;const{top:t,bottom:e}=((n=(r=this.$refs)==null?void 0:r.preBottom)==null?void 0:n.getBoundingClientRect())??{},a=window.innerHeight||document.documentElement.clientHeight;return(t>0||e>0)&&t<a},trackDisplayedLoans(t,e,a){var n;const r=((n=a==null?void 0:a.filter(i=>!!(i!=null&&i.id)))==null?void 0:n.map((i,l)=>({position:l+1,loanId:i.id})))??[];if(r.length){const i={schema:"https://raw.githubusercontent.com/kiva/snowplow/master/conf/snowplow_lend_by_category_loan_display_event_v3_schema_1_0_0.json#",data:{sectionIdentifier:t,sectionPosition:e,loansDisplayed:r}};this.$kvTrackSelfDescribingEvent(i)}},fetchLoanData(){const t=this.rows.shift();if(t)if(this.isLoading=!0,t.onlyLoan)try{return this.apollo.query({query:Nt,variables:{loanId:parseInt(this.loan.id,10),limit:t.limit}}).then(({data:e})=>{var r,n,i;const a=(((i=(n=(r=e==null?void 0:e.ml)==null?void 0:r.relatedLoansByTopics)==null?void 0:n[0])==null?void 0:i.values)??[])[0];this.categories=[...this.categories,{heading:t.heading,loan:a,loanIds:[],subHeading:t.subHeading}],this.trackDisplayedLoans(t.identifier,t.rowIndex,[a]),this.isLoading=!1,this.refIsVisible()&&this.fetchLoanData()})}catch(e){Qt(e,"FundedBorrowerProfile mlLoansYouMightLikeData"),this.isLoading=!1}else try{const e={limit:t.limit,filters:[t.filter],origin:ho};this.apollo.query({query:al,variables:e}).then(({data:a})=>{var m,c,h,f,k,w,C,I,T,P,L,O,E,V,q,oe;const r=((m=a==null?void 0:a.fundraisingLoans)==null?void 0:m.values)??[];if(!r.length)return this.isLoading=!1,this.fetchLoanData();const n=r.map(ue=>ue.id);let i="",l="";(c=t==null?void 0:t.filter)!=null&&c.gender&&(i=(h=this.loan)!=null&&h.gender.includes("female")?"women":"men",l=(f=this.loan)==null?void 0:f.gender),(k=t==null?void 0:t.filter)!=null&&k.countryIsoCode&&(i=(I=(C=(w=this.loan)==null?void 0:w.geocode)==null?void 0:C.country)==null?void 0:I.name,l=(L=(P=(T=this.loan)==null?void 0:T.geocode)==null?void 0:P.country)==null?void 0:L.isoCode),(O=t==null?void 0:t.filter)!=null&&O.sector&&(i=`${(V=(E=this.loan)==null?void 0:E.sector)==null?void 0:V.name} loans`,l=String((oe=(q=this.loan)==null?void 0:q.sector)==null?void 0:oe.id)),this.categories=[...this.categories,{heading:t.heading+i,subHeading:t.subHeading,loanIds:n,loan:null,expLabel:l}],this.trackDisplayedLoans(t.identifier,t.rowIndex,r),this.isLoading=!1,this.refIsVisible()&&this.fetchLoanData()})}catch(e){Qt(e,"FundedBorrowerProfile personalizedLoansQuery"),this.isLoading=!1}},createViewportObserver(){this.viewportObserver=Me({targets:[this.$refs.preBottom],callback:t=>{t.forEach(e=>{e.isIntersecting&&this.fetchLoanData()})}}),this.viewportObserver||Array.from({length:this.loanRowsCount}).map(()=>this.fetchLoanData())},destroyViewportObserver(){this.viewportObserver&&this.viewportObserver.disconnect()}},beforeUnmount(){this.destroyViewportObserver()}},sl={class:"tw-relative tw-bg-secondary"},ll={class:"tw-relative"},dl={class:"tw-absolute tw-top-0 tw-h-full tw-w-full tw-overflow-hidden"},ul={class:"md:tw-col-span-8 md:tw-col-start-3 tw-my-8"},ml={class:"tw-pb-0 md:tw-bg-primary md:tw-pb-2.5 tw-py-2.5 md:tw-p-3 lg:tw-p-4 md:tw-rounded"},cl={class:"tw-flex"},pl={class:"tw-flex-none tw-w-8 tw-h-8 tw-mr-1.5 tw-mb-1.5 md:tw-w-9 md:tw-h-9 md:tw-mr-3 md:tw-mb-3 lg:tw-w-10 lg:tw-h-10 lg:tw-mr-4 lg:tw-mb-4"},hl={class:"tw-flex-auto"},fl={class:"tw-mx-2 tw-overflow-auto lg:tw-mx-auto loans-container"},gl={class:"tw-text-h2"},wl={key:0,class:"tw-text-subhead"},vl={key:1},bl={key:2,class:"featured-loan-card-row tw-pt-4"},yl={ref:"preBottom"},_l={key:0,id:"loading-overlay"},kl={class:"spinner-wrapper"};function Ll(t,e,a,r,n,i){const l=g("hero-background"),m=g("borrower-image"),c=g("borrower-name"),h=g("loan-progress"),f=g("kv-grid"),k=g("kv-page-container"),w=g("kiva-classic-loan-carousel"),C=g("loan-card-controller"),I=g("kv-loading-spinner");return s(),u("div",null,[o("article",sl,[o("div",ll,[o("div",dl,[p(l)]),p(k,null,{default:_(()=>[p(f,{class:"md:tw-grid-cols-12 tw-grid tw-relative"},{default:_(()=>[o("div",ul,[o("section",ml,[o("div",cl,[o("div",pl,[p(m,{"data-testid":"bp-summary-image",class:"tw-w-full tw-rounded-full tw-bg-brand",alt:a.loan.name,"aspect-ratio":1,hash:a.hash,"default-image":{width:80,faceZoom:50},images:[{width:80,faceZoom:50,viewSize:1024},{width:72,faceZoom:50,viewSize:734},{width:64,faceZoom:50}]},null,8,["alt","hash"])]),o("div",hl,[p(c,{"data-testid":"bp-summary-borrower-name",name:a.loan.name},null,8,["name"]),p(h,{"data-testid":"bp-summary-progress",class:"tw-mb-2","progress-percent":i.progressPercent,loading:n.isLoading,"loan-status":i.loanStatus},null,8,["progress-percent","loading","loan-status"])])])])])],void 0,!0),_:1})],void 0),_:1})])]),o("article",fl,[e[0]||(e[0]=o("p",{class:"tw-text-center tw-text-h1 tw-my-6"}," Similar borrowers that need your support ",-1)),(s(!0),u(H,null,Y(n.categories,(T,P)=>(s(),u("div",{key:P,class:"tw-my-6"},[o("p",gl,b(T.heading),1),T.subHeading?(s(),u("p",wl,b(T.subHeading)+" "+b(a.loan.name)+"'s loan. ",1)):v("",!0),T.loan?(s(),u("div",bl,[T.loan?(s(),x(C,{"category-set-id":"featured-hero-loan","enable-tracking":!0,key:T.loan.id,loan:T.loan,"loan-card-type":"FeaturedHeroLoan",position:1,"row-number":P+1,"is-visitor":n.isVisitor},null,8,["loan","row-number","is-visitor"])):v("",!0)])):(s(),u("div",vl,[T.loan?v("",!0):(s(),x(w,{key:0,"is-visible":!0,"loan-ids":T.loanIds,"exp-label":T.expLabel,"lend-now-button":!0},null,8,["loan-ids","exp-label"]))]))]))),128))]),o("div",yl,[n.isLoading?(s(),u("div",_l,[o("div",kl,[p(I)])])):v("",!0)],512)])}const xa=B(Sa,[["render",Ll]]);Sa.__docgenInfo={displayName:"FundedBorrowerProfile",exportName:"default",description:"",tags:{},props:[{name:"loan",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}},{name:"hash",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"itemsInBasket",type:{name:"array"},defaultValue:{func:!1,value:"[]"}},{name:"inviterName",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/FundedBorrowerProfile.vue"]};const Ia={name:"DescriptionListItem",emits:["show-definition"],props:{term:{type:String,default:""},details:{type:[String,Number],default:""}}},Cl={class:"tw-flex tw-items-center tw-mb-2.5"},Sl={class:"tw-flex-1 tw-mb-0"},xl={"data-testid":"bp-details-value"};function Il(t,e,a,r,n,i){return s(),u("div",Cl,[o("dt",Sl,[o("button",{onClick:e[0]||(e[0]=l=>t.$emit("show-definition")),class:"tw-underline tw-font-book","data-testid":"bp-details-lightbox-btn"},b(a.term),1)]),o("dd",xl,b(a.details),1)])}const ln=B(Ia,[["render",Il]]);Ia.__docgenInfo={displayName:"DescriptionListItem",exportName:"default",description:"",tags:{},props:[{name:"term",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"details",type:{name:"string|number"},defaultValue:{func:!1,value:"''"}}],events:[{name:"show-definition"}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/DescriptionListItem.vue"]};const Ta={name:"FieldPartnerDetails",components:{DescriptionListItem:ln,KvMaterialIcon:_e,KvTextLink:ct},data(){return{mdiArrowRight:sa,mdiStar:Ni,mdiStarOutline:Ti,mdiStarHalfFull:Ii}},emits:["show-definition"],props:{partnerId:{type:Number,default:0},partnerName:{type:String,default:""},avgBorrowerCost:{type:Number,default:0},avgBorrowerCostType:{type:String,default:""},avgProfitability:{type:Number,default:0},arrearsRate:{type:Number,default:0},loansAtRiskRate:{type:Number,default:0},defaultRate:{type:Number,default:0},riskRating:{type:Number,default:0},currencyExchangeLossRate:{type:Number,default:0}},computed:{avgBorrowerCostFormatted(){return this.avgBorrowerCost!==0?`${pe(this.avgBorrowerCost/100).format("0%")} ${this.avgBorrowerCostType}`:"N/A"},avgProfitabilityFormatted(){return pe(this.avgProfitability/100).format("0[.]0%")},delinquencyRateFormatted(){return pe(this.arrearsRate/100).format("0[.]00%")},loansAtRiskRateFormatted(){return pe(this.loansAtRiskRate/100).format("0[.]00%")},defaultRateFormatted(){return pe(this.defaultRate/100).format("0[.]00%")},currencyExchangeLossRateFormatted(){return pe(this.currencyExchangeLossRate/100).format("0[.]00%")}},methods:{getStarIcon(t){return this.riskRating>=t?this.mdiStar:this.riskRating===t-.5?this.mdiStarHalfFull:this.mdiStarOutline}}},Tl={class:"tw-mb-2"},Nl={class:"tw-flex tw-mb-1.5","data-testid":"bp-field-partner-details-partner-risk-rate"},Al={class:"tw-flex-1 tw-mb-0"},Dl={class:"tw-flex","data-testid":"bp-details-value"};function Pl(t,e,a,r,n,i){const l=g("description-list-item"),m=g("kv-material-icon"),c=g("kv-text-link"),h=de("kv-track-event");return s(),u("section",null,[o("h2",Tl,b(a.partnerName),1),o("dl",null,[p(l,{"data-testid":"bp-field-partner-details-avg-cost",term:"Average cost to borrower",details:i.avgBorrowerCostFormatted,onShowDefinition:e[0]||(e[0]=f=>t.$emit("show-definition",{cid:"bp-def-average-cost-to-borrower",sfid:"50150000000T2J1",panelName:"Field-Partner",linkText:"Average cost to borrower"}))},null,8,["details"]),p(l,{"data-testid":"bp-field-partner-details-profitability",term:"Profitability (return on assets)",details:i.avgProfitabilityFormatted,onShowDefinition:e[1]||(e[1]=f=>t.$emit("show-definition",{cid:"bp-def-probablility-roa",sfid:"50150000000S17h",panelName:"Field-Partner",linkText:"Profitability (return on assets)"}))},null,8,["details"]),p(l,{"data-testid":"bp-field-partner-details-delinquency-rate",term:"Delinquency rate",details:i.delinquencyRateFormatted,onShowDefinition:e[2]||(e[2]=f=>t.$emit("show-definition",{cid:"bp-def-delinquency-rate",sfid:"50150000000SQF1",panelName:"Field-Partner",linkText:"Delinquency rate"}))},null,8,["details"]),p(l,{"data-testid":"bp-field-partner-details-loans-risk-rate",term:"Loans at risk rate",details:i.loansAtRiskRateFormatted,onShowDefinition:e[3]||(e[3]=f=>t.$emit("show-definition",{cid:"bp-def-loans-at-risk-rate",sfid:"50150000000SQI0",panelName:"Field-Partner",linkText:"Loans at risk rate"}))},null,8,["details"]),p(l,{"data-test-id":"bp-field-partner-details-default-rate",term:"Default rate",details:i.defaultRateFormatted,onShowDefinition:e[4]||(e[4]=f=>t.$emit("show-definition",{cid:"bp-def-default-rate",sfid:"50150000000S8gT",panelName:"Field-Partner",linkText:"Default rate"}))},null,8,["details"]),p(l,{"data-test-id":"bp-field-partner-details-currency-loss",term:"Currency exchange loss rate",details:i.currencyExchangeLossRateFormatted,onShowDefinition:e[5]||(e[5]=f=>t.$emit("show-definition",{cid:"bp-def-currency-exchange-loss-rate",sfid:"50150000000S186",panelName:"Field-Partner",linkText:"Currency exchange loss rate"}))},null,8,["details"]),o("div",Nl,[o("dt",Al,[o("button",{class:"tw-underline tw-font-book","data-testid":"bp-details-lightbox-btn",onClick:e[6]||(e[6]=f=>t.$emit("show-definition",{cid:"bp-def-risk-rating",sfid:"50150000000s2YH",panelName:"Field-Partner",linkText:"Field Partner risk rating"}))}," Lending Partner risk rating ")]),o("dd",null,[o("div",Dl,[(s(),u(H,null,Y(5,f=>p(m,{key:f,class:"tw-text-primary tw-w-3 tw-h-3",icon:i.getStarIcon(f)},null,8,["icon"])),64))])])])]),F((s(),x(c,{"data-testid":"bp-field-partner-details-more-about",icon:n.mdiArrowRight,href:`/partners/${a.partnerId}`,target:"_blank"},{default:_(()=>[D(" More about "+b(a.partnerName),1)],void 0),_:1},8,["icon","href"])),[[h,["Borrower profile","click-Field-Partner-tab",`More about ${a.partnerName}`]]])])}const Ml=B(Ta,[["render",Pl]]);Ta.__docgenInfo={displayName:"FieldPartnerDetails",exportName:"default",description:"",tags:{},props:[{name:"partnerId",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"partnerName",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"avgBorrowerCost",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"avgBorrowerCostType",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"avgProfitability",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"arrearsRate",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"loansAtRiskRate",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"defaultRate",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"riskRating",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"currencyExchangeLossRate",type:{name:"number"},defaultValue:{func:!1,value:"0"}}],events:[{name:"show-definition"}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/FieldPartnerDetails.vue"]};const Na={name:"LoanDetails",components:{DescriptionListItem:ln},emits:["show-definition"],props:{partnerName:{type:String,default:""},loanLenderRepaymentTerm:{type:Number,default:0},loanTermLenderRepaymentTerm:{type:Number,default:0},repaymentInterval:{type:String,default:""},flexibleFundraisingEnabled:{type:Boolean,default:!1},chargesFeesInterest:{type:Boolean,default:!1},currency:{type:String,default:""},lossLiabilityCurrencyExchange:{type:String,default:""},disbursalDate:{type:String,default:""},status:{type:String,default:""}},computed:{isPartnerLoan(){return this.partnerName!==""},loanLength(){return this.isPartnerLoan?this.loanLenderRepaymentTerm:this.loanTermLenderRepaymentTerm},repaymentSchedule(){const t={at_end:"end of term"},e=this.isPartnerLoan?t[this.repaymentInterval]||this.repaymentInterval:"Monthly";return e.toString().charAt(0).toUpperCase()+e.toString().slice(1)},fundingModel(){return this.isPartnerLoan&&this.flexibleFundraisingEnabled?"Flexible":"Fixed"},disbursedDate(){return this.disbursalDate.length?st(Pe(this.disbursalDate),"MMMM dd, yyyy"):!this.disbursalDate.length&&this.status==="expired"?"N/A, expired before fully funding":"After fully funded on Kiva"},borrowerPayingInterest(){return this.isPartnerLoan&&this.chargesFeesInterest?"Yes":"No"},currencyLossScenarioTerm(){return this.isPartnerLoan?"Partner covers currency loss?":"Currency exchange loss:"},currencyLossScenarioDetails(){return!this.isPartnerLoan||this.currency==="USD"?"N/A":this.lossLiabilityCurrencyExchange==="none"?this.currency==="USD"?"N/A":"Yes":this.lossLiabilityCurrencyExchange==="shared"?"Partially":this.lossLiabilityCurrencyExchange==="partner"?"Yes":this.lossLiabilityCurrencyExchange==="lender"?"No":""}}};function Rl(t,e,a,r,n,i){const l=g("description-list-item");return s(),u("dl",null,[p(l,{"data-testid":"bp-loan-detail-loan-length",term:"Loan length",details:`${i.loanLength} months`,onShowDefinition:e[0]||(e[0]=m=>t.$emit("show-definition",{cid:"bp-def-loan-length",sfid:"50150000000Ry3z",panelName:"Loan-Details",linkText:"Loan length"}))},null,8,["details"]),p(l,{"data-testid":"bp-loan-detail-repayment-schedule",term:"Repayment schedule",details:i.repaymentSchedule,onShowDefinition:e[1]||(e[1]=m=>t.$emit("show-definition",{cid:"bp-def-repayment-schedule",sfid:"50150000000Ry44",panelName:"Loan-Details",linkText:"Repayment schedule"}))},null,8,["details"]),p(l,{"data-testid":"bp-loan-detail-disbursed-date",term:"Disbursed date",details:i.disbursedDate,onShowDefinition:e[2]||(e[2]=m=>t.$emit("show-definition",{cid:"bp-def-disbursed-date",sfid:"50150000000RyAs",panelName:"Loan-Details",linkText:"Disbursed date"}))},null,8,["details"]),p(l,{"data-testid":"bp-loan-detail-funding-model",term:"Funding model",details:i.fundingModel,onShowDefinition:e[3]||(e[3]=m=>t.$emit("show-definition",{cid:"bp-def-funding-model",sfid:"5011T000001GNKy",panelName:"Loan-Details",linkText:"Funding model"}))},null,8,["details"]),p(l,{"data-testid":"bp-loan-detail-currency-loss",term:i.currencyLossScenarioTerm,details:i.currencyLossScenarioDetails,onShowDefinition:e[4]||(e[4]=m=>t.$emit("show-definition",{cid:"bp-def-partner-covers-currency-loss",sfid:"50150000000J5kV",panelName:"Loan-Details",linkText:i.currencyLossScenarioTerm}))},null,8,["term","details"]),p(l,{"data-testid":"bp-loan-detail-paying-interest",term:"Is borrower paying interest?",details:i.borrowerPayingInterest,onShowDefinition:e[5]||(e[5]=m=>t.$emit("show-definition",{cid:"bp-def-do-borrowers-pay-interest",sfid:"50150000000IIav",panelName:"Loan-Details",linkText:"Is borrower paying interest?"}))},null,8,["details"])])}const El=B(Na,[["render",Rl]]);Na.__docgenInfo={displayName:"LoanDetails",exportName:"default",description:"",tags:{},props:[{name:"partnerName",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"loanLenderRepaymentTerm",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"loanTermLenderRepaymentTerm",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"repaymentInterval",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"flexibleFundraisingEnabled",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"chargesFeesInterest",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"currency",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"lossLiabilityCurrencyExchange",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"disbursalDate",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"status",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],events:[{name:"show-definition"}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/LoanDetails.vue"]};const Aa={name:"TrusteeDetails",components:{DescriptionListItem:ln,KvTextLink:ct},emits:["show-definition"],props:{borrowerName:{type:String,default:""},endorsement:{type:String,default:""},trusteeName:{type:String,default:""},numLoansEndorsedPublic:{type:Number,default:0},totalLoansValue:{type:String,default:"0.00"},numDefaultedLoans:{type:Number,default:0},repaymentRate:{type:Number,default:0},trusteeId:{type:Number,default:0}},data(){return{mdiArrowRight:sa}},computed:{endorsementTitle(){return`Why are you endorsing ${this.borrowerName}?`},noTrusteeState(){return this.trusteeName==="No Trustee Endorsement"},totalLoansValueFormatted(){return pe(this.totalLoansValue).format("$0,0[.]00")},repaymentRateFormatted(){return pe(this.repaymentRate/100).format("0%")},numLoansEndorsedPublicFormatted(){return pe(this.numLoansEndorsedPublic).format("0,0")},numDefaultedLoansFormatted(){return pe(this.numDefaultedLoans).format("0,0")}}},Fl={class:"tw-mb-2","data-testid":"bp-details-trustee-name"},Ol={key:0,class:"tw-prose tw-my-3","data-testid":"bp-details-trustee-endorsement"},Bl={"data-testid":"bp-details-trustee-endorsement-text"};function Vl(t,e,a,r,n,i){const l=g("description-list-item"),m=g("kv-text-link"),c=de("kv-track-event");return s(),u("section",null,[e[4]||(e[4]=o("p",{class:"tw-mb-1.5","data-testid":"bp-details-trustee-description"}," Trustees are organizations that refer potential U.S.-based borrowers to Kiva and publicly vouch for them on Kiva.org. ",-1)),o("h2",Fl,b(a.trusteeName),1),o("dl",null,[p(l,{"data-testid":"bp-details-trustee-kiva-borrowers",term:"Kiva borrowers",details:i.numLoansEndorsedPublicFormatted,onShowDefinition:e[0]||(e[0]=h=>t.$emit("show-definition",{cid:"bp-def-trustee-kiva-borrowers",sfid:"50150000000s2cE",panelName:"Trustee",linkText:"Kiva borrowers"}))},null,8,["details"]),p(l,{"data-testid":"bp-details-trustee-total-loans",term:"Total loans",details:i.totalLoansValueFormatted,onShowDefinition:e[1]||(e[1]=h=>t.$emit("show-definition",{cid:"bp-def-trustee-total-loans",sfid:"50150000000s2cO",panelName:"Trustee",linkText:"Total loans"}))},null,8,["details"]),p(l,{"data-testid":"bp-details-trustee-loans-defaulted",term:"Loans defaulted",details:i.numDefaultedLoansFormatted,onShowDefinition:e[2]||(e[2]=h=>t.$emit("show-definition",{cid:"bp-def-trustee-loans-defaulted",sfid:"50150000000s2cn",panelName:"Trustee",linkText:"Loans defaulted"}))},null,8,["details"]),p(l,{"data-testid":"bp-details-trustee-repayment-rate",term:"Repayment rate",details:i.repaymentRateFormatted,onShowDefinition:e[3]||(e[3]=h=>t.$emit("show-definition",{cid:"bp-def-trustee-repayment-rate",sfid:"50150000000s2cx",panelName:"Trustee",linkText:"Repayment rate"}))},null,8,["details"])]),F((s(),x(m,{"data-testid":"bp-details-trustee-more-about-link",icon:n.mdiArrowRight,href:`/trustees/${a.trusteeId}`,target:"_blank"},{default:_(()=>[D(b(i.noTrusteeState?"More about loans without endorsements":"More about this trustee"),1)],void 0),_:1},8,["icon","href"])),[[c,["Borrower profile","click-Trustee-tab",i.noTrusteeState?"More about loans without endorsements":"More about this trustee"]]]),a.endorsement?(s(),u("div",Ol,[o("h3",null,b(i.endorsementTitle),1),o("blockquote",null,[o("p",Bl,b(a.endorsement),1)])])):v("",!0)])}const $l=B(Aa,[["render",Vl]]);Aa.__docgenInfo={displayName:"TrusteeDetails",exportName:"default",description:"",tags:{},props:[{name:"borrowerName",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"endorsement",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"trusteeName",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"numLoansEndorsedPublic",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"totalLoansValue",type:{name:"string"},defaultValue:{func:!1,value:"'0.00'"}},{name:"numDefaultedLoans",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"repaymentRate",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"trusteeId",type:{name:"number"},defaultValue:{func:!1,value:"0"}}],events:[{name:"show-definition"}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/TrusteeDetails.vue"]};const ql=K`query repaymentScheduleQuery($loanId: Int!) {
	lend {
		loan(id: $loanId) {
			id
			repaymentInterval
			lenderRepaymentTerm
			paidAmount
			loanAmount
			terms {
				currency
				currencyFullName
				lossLiabilityNonpayment
				lossLiabilityCurrencyExchange
				loanAmount
				disbursalDate
				disbursalAmount
				flexibleFundraisingEnabled
				lenderRepaymentTerm
				expectedPayments {
					amount
					localAmount
					dueToKivaDate
					effectiveDate
				}
			}
			... on LoanPartner {
				partner {
					id
					name
				}
			}
		}
	}
}`,Da={name:"RepaymentSchedule",components:{KvLightbox:mt,KvMaterialIcon:_e},inject:["apollo"],props:{loanId:{type:Number,default:0},status:{type:String,default:""}},data(){return{mdiCheckboxMarkedCircle:Di,mdiMinusCircle:Ai,isLightboxVisible:!1,firstRepaymentDate:"",repaymentSchedule:[],repaidAmount:0,loanAmount:0,lenderRepaymentTerm:0,partnerName:"",disbursalDate:""}},methods:{openLightbox(){this.isLightboxVisible=!0},closeLightbox(){this.isLightboxVisible=!1},calculateRepaymentSchedule(){this.apollo.query({query:ql,variables:{loanId:this.loanId}}).then(({data:t})=>{var e,a,r,n,i,l,m,c,h,f,k,w,C,I,T,P,L;this.partnerName=((r=(a=(e=t==null?void 0:t.lend)==null?void 0:e.loan)==null?void 0:a.partner)==null?void 0:r.name)||"",this.repaymentSchedule=((l=(i=(n=t==null?void 0:t.lend)==null?void 0:n.loan)==null?void 0:i.terms)==null?void 0:l.expectedPayments)||[],this.repaidAmount=((c=(m=t==null?void 0:t.lend)==null?void 0:m.loan)==null?void 0:c.paidAmount)||0,this.loanAmount=((f=(h=t==null?void 0:t.lend)==null?void 0:h.loan)==null?void 0:f.loanAmount)||0,this.lenderRepaymentTerm=((C=(w=(k=t==null?void 0:t.lend)==null?void 0:k.loan)==null?void 0:w.terms)==null?void 0:C.lenderRepaymentTerm)||0,this.firstRepaymentDate=((I=this.repaymentSchedule[0])==null?void 0:I.dueToKivaDate)||"",this.disbursalDate=((L=(P=(T=t==null?void 0:t.lend)==null?void 0:T.loan)==null?void 0:P.terms)==null?void 0:L.disbursalDate)||""})}},computed:{isPartnerLoan(){return!!this.partnerName},formattedFirstRepaymentDate(){return this.firstRepaymentDate!==""?st(Pe(this.firstRepaymentDate),"MMM dd, yyyy"):!1},statusLanguageCheck(){return this.status==="payingBack"?"began":"begin"},delinquentPayment(){return this.parsedRepaymentSchedule.find(({delinquent:e})=>e===!0)!==void 0},repaymentStatusCheck(){return this.status==="payingBack"&&this.delinquentPayment?"delinquent":"on track"},parsedRepaymentSchedule(){const t=[],e=[];let a=!1,r=!1;if(this.repaymentSchedule.length!==0){const n=this.repaymentSchedule.reduce((i,l)=>(i[l.dueToKivaDate]||(i[l.dueToKivaDate]=[]),i[l.dueToKivaDate].push(l),i),{});Object.entries(n).forEach(([i,l])=>{const c=l.reduce((I,T)=>(I.push(T.amount),I),[]).reduce((I,T)=>I+parseFloat(T),0);e.push(c);const h=e.reduce((I,T)=>I+parseFloat(T),0);a=this.repaidAmount>h;const f=new Date,k=Pe(i);r=!a&&Tn(k,f);const w=st(Pe(i),"MMM yyyy"),C=pe(c).format("$0,0.00");t.push({formattedRepaymentDate:w,totalMonthlyPayment:c,formattedMonthlyPayment:C,repaid:a,delinquent:r})})}return t},loanAmountFormatted(){return pe(this.loanAmount).format("$0,0.00")},calculateMonthlyPayment(){return pe(this.loanAmount/this.lenderRepaymentTerm).format("$0,0.00")},loanDisbursed(){return this.disbursalDate!==""&&Tn(Pe(this.disbursalDate),new Date)}},mounted(){this.calculateRepaymentSchedule()}},zl={key:0},Ul={class:"tw-inline-block tw-pb-3"},jl={class:"tw-font-medium"},Hl={key:0},Kl={class:"tw-inline-block tw-font-medium"},Gl={class:"md:tw-hidden tw-w-full"},Wl={class:"tw-inline-block tw-w-full tw-bg-secondary tw-rounded tw-text-center tw-mb-2 tw-pb-1.5"},Zl={class:"tw-text-h4 tw-py-1.5"},Ql={class:"tw-mb-1.5"},Yl={key:0},Xl={key:1,class:"tw-bg-primary tw-mx-auto tw-py-1 tw-rounded",style:{width:"11.5rem"}},Jl={key:2,class:"tw-bg-primary tw-mx-auto tw-py-1 tw-rounded",style:{width:"7.5rem"}},ed={class:"tw-table-auto tw-hidden md:tw-table"},td={class:"table-data-spacing"},nd={class:"table-data-spacing"},ad={key:0,class:"table-data-spacing"},id={key:1,class:"table-data-spacing"},od={key:2,class:"table-data-spacing"},rd={key:1},sd={key:1,class:"tw-prose"};function ld(t,e,a,r,n,i){const l=g("kv-material-icon"),m=g("kv-lightbox"),c=de("kv-track-event");return s(),u("div",null,[F((s(),u("button",{class:"tw-text-h4 tw-text-link tw-mt-3","data-testid":"bp-loan-detail-full-repayment-schedule-lightbox-btn",onClick:e[0]||(e[0]=(...h)=>i.openLightbox&&i.openLightbox(...h))},e[1]||(e[1]=[D(" Detailed repayment schedule > ")]))),[[c,["Borrower Profile","click-repayment schedule","Detailed repayment schedule"]]]),p(m,{visible:n.isLightboxVisible,title:"Loan repayment schedule",onLightboxClosed:i.closeLightbox},{default:_(()=>[i.isPartnerLoan||!i.isPartnerLoan&&i.loanDisbursed?(s(),u("div",zl,[o("p",Ul,[D(" Repayments "+b(i.statusLanguageCheck)+" in ",1),o("span",jl,b(i.formattedFirstRepaymentDate),1)]),a.status==="payingBack"?(s(),u("span",Hl,[e[2]||(e[2]=o("p",{class:"tw-inline-block"}," and are ",-1)),o("p",Kl,b(i.repaymentStatusCheck)+". ",1)])):v("",!0),o("table",Gl,[o("tbody",null,[(s(!0),u(H,null,Y(i.parsedRepaymentSchedule,(h,f)=>(s(),u("tr",{key:f,class:"tw-mb-1"},[o("td",Wl,[o("p",Zl,b(h.formattedRepaymentDate),1),e[5]||(e[5]=o("hr",{class:"tw-mb-1.5 tw-mx-1.5"},null,-1)),o("p",Ql," Expected: "+b(h.formattedMonthlyPayment),1),!h.repaid&&!h.delinquent?(s(),u("p",Yl," Available "+b(h.formattedRepaymentDate),1)):v("",!0),h.repaid&&!h.delinquent?(s(),u("p",Xl,[p(l,{icon:n.mdiCheckboxMarkedCircle,class:"tw-w-3 tw-h-3 tw-text-brand-700 tw-align-middle"},null,8,["icon"]),e[3]||(e[3]=D(" Repayment received "))])):v("",!0),!h.repaid&&h.delinquent?(s(),u("p",Jl,[p(l,{class:"tw-w-3 tw-h-3 tw-text-danger tw-align-middle",icon:n.mdiMinusCircle},null,8,["icon"]),e[4]||(e[4]=D(" Delinquent "))])):v("",!0)])]))),128))])]),o("table",ed,[e[8]||(e[8]=o("thead",{class:"tw-bg-secondary tw-text-left"},[o("tr",null,[o("th",null,[o("span",{class:"tw-sr-only"},"Date")]),o("th",{class:"table-heading-spacing"}," Expected "),o("th",{class:"table-heading-spacing"}," Status ")])],-1)),o("tbody",null,[(s(!0),u(H,null,Y(i.parsedRepaymentSchedule,(h,f)=>(s(),u("tr",{key:f,class:"tw-mb-1"},[o("td",td,b(h.formattedRepaymentDate),1),o("td",nd,b(h.formattedMonthlyPayment),1),!h.repaid&&!h.delinquent?(s(),u("td",ad," Available "+b(h.formattedRepaymentDate),1)):v("",!0),h.repaid&&!h.delinquent?(s(),u("td",id,[p(l,{icon:n.mdiCheckboxMarkedCircle,class:"tw-w-3 tw-h-3 tw-text-brand-700 tw-align-middle"},null,8,["icon"]),e[6]||(e[6]=D(" Repayment received "))])):v("",!0),!h.repaid&&h.delinquent?(s(),u("td",od,[p(l,{class:"tw-w-3 tw-h-3 tw-text-danger tw-align-middle",icon:n.mdiMinusCircle},null,8,["icon"]),e[7]||(e[7]=D(" Delinquent "))])):v("",!0)]))),128))])]),!i.isPartnerLoan&&i.loanDisbursed?(s(),u("p",rd," Disbursement and repayments will be made via PayPal, a web-based payment system. Repayments made on delinquent loans will be applied toward the oldest payment due until the loan becomes current. ")):v("",!0)])):v("",!0),!i.isPartnerLoan&&!i.loanDisbursed?(s(),u("div",sd,[o("p",null," This loan is for "+b(i.loanAmountFormatted)+". ",1),o("p",null,[D(" Repayments on this loan will be made in monthly installments of "+b(i.calculateMonthlyPayment)+" USD over a period of "+b(n.lenderRepaymentTerm)+" months. After the funds are disbursed, the borrower(s) will have the standard 1 month before the first payment is due, and may have an additional grace period per the terms outlined in their loan agreement. The detailed repayment schedule will be published here at the time that the funds for this loan are disbursed.",1),e[9]||(e[9]=o("br",null,null,-1))]),e[10]||(e[10]=o("p",null," Disbursement and repayments will be made via PayPal, a web-based payment system. Repayments made on delinquent loans will be applied toward the oldest payment due until the loan becomes current. ",-1))])):v("",!0)],void 0),_:1},8,["visible","onLightboxClosed"])])}const dd=B(Da,[["render",ld],["__scopeId","data-v-4c774953"]]);Da.__docgenInfo={displayName:"RepaymentSchedule",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"status",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/RepaymentSchedule.vue"]};const Pa={name:"DetailsTabs",inject:["apollo"],components:{FieldPartnerDetails:Ml,KvLightbox:mt,KvLoadingPlaceholder:ge,KvTab:wo,KvTabPanel:vo,KvTabs:go,LoanDetails:El,TrusteeDetails:$l,RepaymentSchedule:dd},props:{loanId:{type:Number,default:0},name:{type:String,required:!0},useSalesForce:{type:Boolean,default:!1}},data(){return{contentfulDefinitions:null,isLightboxVisible:!1,lightboxContent:null,lightboxTitle:"",loan:{name:"",currency:"",flexibleFundraisingEnabled:!1,loanLenderRepaymentTerm:0,loanTermLenderRepaymentTerm:0,lossLiabilityCurrencyExchange:"",repaymentInterval:"",anonymizationLevel:"",lentTo:!1},loading:!0,observer:null,partner:{arrearsRate:0,avgBorrowerCost:0,avgBorrowerCostType:"",avgProfitability:0,chargesFeesInterest:!1,defaultRate:0,id:0,loansAtRiskRate:0,name:"",riskRating:0},trustee:{id:0,name:"",numDefaultedLoans:0,numLoansEndorsedPublic:0,repaymentRate:0,totalLoansValue:"0",endorsement:""}}},computed:{isPartnerLoan(){var t;return!!((t=this.partner)!=null&&t.name)},hasTrustee(){var t;return!this.isPartnerLoan&&((t=this.trustee)==null?void 0:t.name)},loanTabId(){return`tab-panel-${this.name}-loan-details`},noTrusteeState(){var t;return((t=this.trustee)==null?void 0:t.name)==="No Trustee Endorsement"},partnerTabId(){return`tab-panel-${this.name}-field-partner`},trusteeTabId(){return`tab-panel-${this.name}-trustee`},isSupporter(){var t;return((t=this.loan)==null?void 0:t.lentTo)||!1},displayRepaymentSchedule(){return this.loan.anonymizationLevel!=="full"?this.loan.status==="fundraising"?!0:this.isSupporter:!1}},methods:{closeLightbox(){this.isLightboxVisible=!1,setTimeout(()=>{this.lightboxTitle="",this.lightboxContent=null},500)},loadContentfulDefinitions(t){this.apollo.query({query:K`query contentfulDefinitions {
					contentful {
						entries(contentKey: "borrower-profile-definitions", contentType: "contentGroup")
					}
				}`}).then(e=>{var r,n,i,l;const a=((i=(n=(r=e.data)==null?void 0:r.contentful)==null?void 0:n.entries)==null?void 0:i.items)??null;if(a){const m=fo(a);this.contentfulDefinitions=((l=m.borrowerProfileDefinitions)==null?void 0:l.contents)??null,this.showContentfulEntry(t)}})},loadData(){this.apollo.query({query:K`query loanDetails($loanId: Int!) {
					lend {
						loan(id: $loanId) {
							id
							name
							status
							lenderRepaymentTerm
							repaymentInterval
							disbursalDate
							anonymizationLevel
							userProperties {
								lentTo
							}
							terms {
								currency
								flexibleFundraisingEnabled
								lenderRepaymentTerm
								lossLiabilityCurrencyExchange
							}
							... on LoanDirect {
								trustee {
									id
									organizationName
									stats {
										id
										numDefaultedLoans
										numLoansEndorsedPublic
										repaymentRate
										totalLoansValue
									}
								}
								endorsement
							}
							... on LoanPartner {
								partner {
									arrearsRate
									avgBorrowerCost
									avgBorrowerCostType
									avgProfitability
									chargesFeesInterest
									defaultRate
									id
									loansAtRiskRate
									name
									riskRating
									currencyExchangeLossRate
								}
							}
						}
					}
				}`,variables:{loanId:this.loanId}}).then(t=>{var n,i,l,m,c,h,f,k,w,C,I;const e=(i=(n=t==null?void 0:t.data)==null?void 0:n.lend)==null?void 0:i.loan,a=e==null?void 0:e.partner,r=e==null?void 0:e.trustee;this.loan.currency=((l=e==null?void 0:e.terms)==null?void 0:l.currency)??"",this.loan.flexibleFundraisingEnabled=((m=e==null?void 0:e.terms)==null?void 0:m.flexibleFundraisingEnabled)??!1,this.loan.loanLenderRepaymentTerm=(e==null?void 0:e.lenderRepaymentTerm)??0,this.loan.loanTermLenderRepaymentTerm=((c=e==null?void 0:e.terms)==null?void 0:c.lenderRepaymentTerm)??0,this.loan.lossLiabilityCurrencyExchange=((h=e==null?void 0:e.terms)==null?void 0:h.lossLiabilityCurrencyExchange)??"",this.loan.repaymentInterval=(e==null?void 0:e.repaymentInterval)??"",this.loan.disbursalDate=(e==null?void 0:e.disbursalDate)??"",this.loan.status=(e==null?void 0:e.status)??"",this.loan.name=(e==null?void 0:e.name)??"",this.loan.anonymizationLevel=(e==null?void 0:e.anonymizationLevel)??"none",this.loan.lentTo=((f=e==null?void 0:e.userProperties)==null?void 0:f.lendTo)??!1,this.partner.arrearsRate=(a==null?void 0:a.arrearsRate)??0,this.partner.avgBorrowerCost=(a==null?void 0:a.avgBorrowerCost)??0,this.partner.avgBorrowerCostType=(a==null?void 0:a.avgBorrowerCostType)??"",this.partner.avgProfitability=(a==null?void 0:a.avgProfitability)??0,this.partner.chargesFeesInterest=(a==null?void 0:a.chargesFeesInterest)??!1,this.partner.defaultRate=(a==null?void 0:a.defaultRate)??0,this.partner.id=(a==null?void 0:a.id)??0,this.partner.loansAtRiskRate=(a==null?void 0:a.loansAtRiskRate)??0,this.partner.name=(a==null?void 0:a.name)??"",this.partner.riskRating=(a==null?void 0:a.riskRating)??0,this.partner.currencyExchangeLossRate=(a==null?void 0:a.currencyExchangeLossRate)??0,this.trustee.endorsement=(e==null?void 0:e.endorsement)??"",this.trustee.id=(r==null?void 0:r.id)??0,this.trustee.name=(r==null?void 0:r.organizationName)??"",this.trustee.numDefaultedLoans=((k=r==null?void 0:r.stats)==null?void 0:k.numDefaultedLoans)??0,this.trustee.numLoansEndorsedPublic=((w=r==null?void 0:r.stats)==null?void 0:w.numLoansEndorsedPublic)??0,this.trustee.repaymentRate=((C=r==null?void 0:r.stats)==null?void 0:C.repaymentRate)??0,this.trustee.totalLoansValue=((I=r==null?void 0:r.stats)==null?void 0:I.totalLoansValue)??"0",this.loading=!1})},showContentfulEntry(t){if(!this.contentfulDefinitions)return this.loadContentfulDefinitions(t),!1;const e=this.contentfulDefinitions.find(a=>a.key===t);e&&(this.lightboxTitle=e.name,this.lightboxContent=bo.documentToHtmlString(e.richText),this.isLightboxVisible=!0)},showDefinition(t){this.$kvTrackEvent("Borrower Profile",`click-${t.panelName}-tab-definition-link`,t.linkText),this.useSalesForce?this.showSalesforceSolution(t.sfid):this.showContentfulEntry(t.cid)},showSalesforceSolution(t){this.apollo.query({query:K`query salesforceSolution($id: String!) {
					general {
						salesforceSolution(id: $id) {
							name
							note
						}
					}
				}`,variables:{id:t}}).then(e=>{var i,l;const a=((l=(i=e==null?void 0:e.data)==null?void 0:i.general)==null?void 0:l.salesforceSolution)??null,r=(a==null?void 0:a.name)??"",n=(a==null?void 0:a.note)??null;a&&(this.lightboxTitle=r,this.lightboxContent=n,this.isLightboxVisible=!0)})}},mounted(){this.loadData()}},ud={class:"tw-py-4 md:tw-py-6 lg:tw-py-8"},md={key:0},cd={class:"tw-flex tw-mb-4.5 md:tw-mb-5 tw-h-2.5 md:tw-h-3 lg:tw-h-4"},pd=["innerHTML"];function hd(t,e,a,r,n,i){const l=g("kv-loading-placeholder"),m=g("kv-tab"),c=g("loan-details"),h=g("repayment-schedule"),f=g("kv-tab-panel"),k=g("field-partner-details"),w=g("trustee-details"),C=g("kv-tabs"),I=g("kv-lightbox"),T=de("kv-track-event");return s(),u("section",ud,[n.loading?(s(),u("div",md,[o("div",cd,[p(l,{class:"tw-mr-2.5 md:tw-mr-5 lg:tw-mr-6",style:{width:"22%"}}),p(l,{style:{width:"22%"}})]),(s(),u(H,null,Y(5,P=>o("div",{key:P,class:"tw-flex tw-justify-between tw-h-2 tw-mb-4"},[p(l,{style:le({width:20+Math.random()*20+"%"})},null,8,["style"]),p(l,{style:le({width:5+Math.random()*5+"%"})},null,8,["style"])])),64))])):(s(),x(C,{key:1},{tabNav:_(()=>[F((s(),x(m,{"for-panel":i.loanTabId,"data-testid":"bp-detail-loan-details-tab"},{default:_(()=>e[0]||(e[0]=[D(" Loan details ")]),void 0,!0),_:1,__:[0]},8,["for-panel"])),[[T,["Borrower Profile","click-Loan-Details-tab","Loan Details"]]]),i.isPartnerLoan?F((s(),x(m,{key:0,"for-panel":i.partnerTabId,"data-testid":"bp-detail-field-partner-tab"},{default:_(()=>e[1]||(e[1]=[D(" Lending Partner ")]),void 0,!0),_:1,__:[1]},8,["for-panel"])),[[T,["Borrower Profile","click-Field-Partner-tab","Field Partner"]]]):v("",!0),i.hasTrustee?F((s(),x(m,{key:1,"for-panel":i.trusteeTabId,"data-testid":"bp-detail-trustee-tab"},{default:_(()=>[D(b(i.noTrusteeState?"No Trustee":"Trustee"),1)],void 0,!0),_:1},8,["for-panel"])),[[T,["Borrower Profile","click-Trustee-tab",i.noTrusteeState?"No Trustee":"Trustee"]]]):v("",!0)]),tabPanels:_(()=>[p(f,{id:i.loanTabId,"data-testid":"bp-detail-loan-detail-panel"},{default:_(()=>[p(c,{status:n.loan.status,"charges-fees-interest":n.partner.chargesFeesInterest,currency:n.loan.currency,"flexible-fundraising-enabled":n.loan.flexibleFundraisingEnabled,"loan-lender-repayment-term":n.loan.loanLenderRepaymentTerm,"loan-term-lender-repayment-term":n.loan.loanTermLenderRepaymentTerm,"loss-liability-currency-exchange":n.loan.lossLiabilityCurrencyExchange,"partner-name":n.partner.name,"repayment-interval":n.loan.repaymentInterval,"disbursal-date":n.loan.disbursalDate,onShowDefinition:i.showDefinition},null,8,["status","charges-fees-interest","currency","flexible-fundraising-enabled","loan-lender-repayment-term","loan-term-lender-repayment-term","loss-liability-currency-exchange","partner-name","repayment-interval","disbursal-date","onShowDefinition"]),i.displayRepaymentSchedule?(s(),x(h,{key:0,"loan-id":a.loanId,status:n.loan.status},null,8,["loan-id","status"])):v("",!0)],void 0,!0),_:1},8,["id"]),i.isPartnerLoan?(s(),x(f,{key:0,id:i.partnerTabId,"data-testid":"bp-detail-field-partner-panel"},{default:_(()=>[p(k,{"arrears-rate":n.partner.arrearsRate,"avg-borrower-cost":n.partner.avgBorrowerCost,"avg-borrower-cost-type":n.partner.avgBorrowerCostType,"avg-profitability":n.partner.avgProfitability,"default-rate":n.partner.defaultRate,"loans-at-risk-rate":n.partner.loansAtRiskRate,"partner-id":n.partner.id,"partner-name":n.partner.name,"risk-rating":n.partner.riskRating,"currency-exchange-loss-rate":n.partner.currencyExchangeLossRate,onShowDefinition:i.showDefinition},null,8,["arrears-rate","avg-borrower-cost","avg-borrower-cost-type","avg-profitability","default-rate","loans-at-risk-rate","partner-id","partner-name","risk-rating","currency-exchange-loss-rate","onShowDefinition"])],void 0,!0),_:1},8,["id"])):v("",!0),i.hasTrustee?(s(),x(f,{key:1,id:i.trusteeTabId,"data-testid":"bp-detail-trustee-panel"},{default:_(()=>[p(w,{"borrower-name":n.loan.name,endorsement:n.trustee.endorsement,"num-defaulted-loans":n.trustee.numDefaultedLoans,"num-loans-endorsed-public":n.trustee.numLoansEndorsedPublic,"repayment-rate":n.trustee.repaymentRate,"trustee-id":n.trustee.id,"trustee-name":n.trustee.name,"total-loans-value":n.trustee.totalLoansValue,onShowDefinition:i.showDefinition},null,8,["borrower-name","endorsement","num-defaulted-loans","num-loans-endorsed-public","repayment-rate","trustee-id","trustee-name","total-loans-value","onShowDefinition"])],void 0,!0),_:1},8,["id"])):v("",!0)]),_:1})),p(I,{visible:n.isLightboxVisible,title:n.lightboxTitle,onLightboxClosed:i.closeLightbox},{default:_(()=>[o("div",{innerHTML:n.lightboxContent,class:"tw-prose"},null,8,pd)],void 0),_:1},8,["visible","title","onLightboxClosed"])])}const fd=B(Pa,[["render",hd]]);Pa.__docgenInfo={displayName:"DetailsTabs",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"name",type:{name:"string"},required:!0},{name:"useSalesForce",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/DetailsTabs.vue"]};const Ma={name:"CountryInfo",inject:["apollo","cookieStore"],components:{KvLoadingPlaceholder:ge,KvUiButton:Ze},props:{loanId:{type:Number,default:0}},data(){return{avgAnnualIncome:"",countryIsoCode:"",countryName:"",loading:!0,loansInRegionLink:"",numLoansFundraising:0,regionName:""}},computed:{showFindMoreLoansInCountryButton(){return this.numLoansFundraising>=1},showFindMoreLoansInRegionButton(){return this.numLoansFundraising===0},avgAnnualIncomeFormatted(){return pe(this.avgAnnualIncome).format("$0,0[.]00")}},methods:{createObserver(){this.observer=Me({targets:[this.$el],callback:t=>{t.forEach(e=>{e.target===this.$el&&e.intersectionRatio>0&&this.loadData()})}}),this.observer||this.loadData()},destroyObserver(){this.observer&&this.observer.disconnect()},loadData(){this.apollo.query({query:K`query borrowerCountryInfo($loanId: Int!) {
					lend {
						loan(id: $loanId) {
							id
							geocode {
								latitude
								longitude
								country {
									id
									numLoansFundraising
									ppp
									isoCode
									name
									region
								}
							}
						}
						countryFacets {
							country {
								id
								isoCode
								region
							}
						}
					}
				}`,variables:{loanId:this.loanId}}).then(t=>{var n,i,l,m,c,h,f,k,w,C;const e=(l=(i=(n=t==null?void 0:t.data)==null?void 0:n.lend)==null?void 0:i.loan)==null?void 0:l.geocode;this.numLoansFundraising=((m=e==null?void 0:e.country)==null?void 0:m.numLoansFundraising)??0,this.avgAnnualIncome=((c=e==null?void 0:e.country)==null?void 0:c.ppp)??"",this.countryIsoCode=((h=e==null?void 0:e.country)==null?void 0:h.isoCode)??"",this.countryName=((f=e==null?void 0:e.country)==null?void 0:f.name)??"",this.regionName=((k=e==null?void 0:e.country)==null?void 0:k.region)??"";const a=[],r=((C=(w=t==null?void 0:t.data)==null?void 0:w.lend)==null?void 0:C.countryFacets)??[];if(r.length){for(let I=0;I<r.length;I+=1)r[I].country.region===this.regionName&&a.push(r[I].country.isoCode);this.loansInRegionLink=`/lend?country=${a.join(",").toLowerCase()}&sortBy=newest`}this.loading=!1})}},mounted(){this.createObserver()},beforeUnmount(){this.destroyObserver()}},gd={key:0,class:""},wd={class:"tw-flex lg:tw-mb-3"},vd={key:1},bd={class:"tw-text-h2 tw-mb-4","data-testid":"bp-country-header"},yd={class:"tw-flex tw-mb-4"},_d={class:"tw-flex-auto","data-testid":"bp-country-aai"},kd={class:"tw-block tw-text-h2","data-testid":"bp-country-aai-value"},Ld={class:"tw-flex-auto","data-testid":"bp-country-loans-fundraising"},Cd={class:"tw-block tw-text-h2","data-testid":"bp-country-loans-fundraising-value"};function Sd(t,e,a,r,n,i){const l=g("kv-loading-placeholder"),m=g("kv-ui-button");return s(),u("section",null,[n.loading?(s(),u("div",gd,[p(l,{class:"tw-mb-2",style:le({width:30+Math.random()*15+"%",height:"1.6rem"})},null,8,["style"]),o("div",wd,[(s(),u(H,null,Y(2,c=>o("div",{key:c,class:"tw-flex-auto"},[p(l,{class:"tw-block tw-mb-2",style:le({width:10+Math.random()*15+"%",height:"1.6rem"})},null,8,["style"]),p(l,{class:"tw-block tw-mb-2",style:le({width:40+Math.random()*15+"%",height:"1.0rem"})},null,8,["style"])])),64))])])):(s(),u("div",vd,[o("h2",bd,b(n.countryName)+" at a glance ",1),o("div",yd,[o("p",_d,[o("span",kd,b(i.avgAnnualIncomeFormatted),1),e[0]||(e[0]=o("span",{class:"tw-block tw-text-h4 tw-text-secondary"}," Average annual income (USD) ",-1))]),o("p",Ld,[o("span",Cd,b(n.numLoansFundraising),1),e[1]||(e[1]=o("span",{class:"tw-block tw-text-h4 tw-text-secondary"}," Loans currently fundraising ",-1))])]),i.showFindMoreLoansInCountryButton?(s(),x(m,{key:0,class:"tw-inline-flex tw-flex-1","data-testid":"bp-country-find-loans-country",href:`/lend/filter?country=${n.countryIsoCode}`,target:"_blank"},{default:_(()=>[D(" Find more borrowers in "+b(n.countryName),1)],void 0),_:1},8,["href"])):v("",!0),i.showFindMoreLoansInRegionButton?(s(),x(m,{key:1,class:"tw-inline-flex tw-flex-1","data-testid":"bp-country-find-loans-region",href:n.loansInRegionLink,target:"_blank"},{default:_(()=>[D(" Find more borrowers in "+b(n.regionName),1)],void 0),_:1},8,["href"])):v("",!0)]))])}const xd=B(Ma,[["render",Sd]]);Ma.__docgenInfo={displayName:"CountryInfo",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/CountryInfo.vue"]};const Ra={name:"BorrowerCountry",inject:["apollo","cookieStore"],components:{CountryInfo:xd,KvLoadingPlaceholder:ge,KvMap:ko},props:{loanId:{type:Number,default:0}},data(){return{mapZoomLevel:5,mapInitialZoom:4,mapAutoZoomDelay:500,mapAspectRatio:1.3,mapLat:null,mapLong:null,loading:!0}},watch:{loanId(t,e){t!==e&&t&&this.loadCoordinates()}},mounted(){this.loadCoordinates()},methods:{loadCoordinates(){if(this.loanId)return this.apollo.query({query:K`query borrowerCountryCoords($loanId: Int!) {
					lend {
						loan(id: $loanId) {
							id
							geocode {
								latitude
								longitude
								country {
									id
									geocode {
										latitude
										longitude
									}
								}
							}
						}
					}
				}`,variables:{loanId:this.loanId}}).then(({data:t})=>{var a,r,n,i,l,m;const e=(r=(a=t==null?void 0:t.lend)==null?void 0:a.loan)==null?void 0:r.geocode;this.mapLat=(e==null?void 0:e.latitude)??null,this.mapLong=(e==null?void 0:e.longitude)??null,(!this.mapLat||!this.mapLong)&&(this.mapLat=((i=(n=e==null?void 0:e.country)==null?void 0:n.geocode)==null?void 0:i.latitude)??null,this.mapLong=((m=(l=e==null?void 0:e.country)==null?void 0:l.geocode)==null?void 0:m.longitude)??null),this.loading=!1}).catch(t=>{Qt(t,"borrowerProfileSideSheetQuery")})}}},Id={key:0},Td={key:1};function Nd(t,e,a,r,n,i){const l=g("KvLoadingPlaceholder"),m=g("kv-map"),c=g("country-info");return n.loading?(s(),u("article",Id,[p(l,{class:"tw-w-full tw-h-full tw-mt-2",style:{"aspect-ratio":"8 / 5"}})])):(s(),u("article",Td,[p(m,{"data-testid":"bp-country-map",class:"tw-rounded tw-overflow-hidden tw-mb-6","auto-zoom-delay":n.mapAutoZoomDelay,"aspect-ratio":n.mapAspectRatio,lat:n.mapLat,long:n.mapLong,"zoom-level":n.mapZoomLevel,"initial-zoom":n.mapInitialZoom},null,8,["auto-zoom-delay","aspect-ratio","lat","long","zoom-level","initial-zoom"]),p(c,{"loan-id":a.loanId},null,8,["loan-id"])]))}const Ad=B(Ra,[["render",Nd]]);Ra.__docgenInfo={displayName:"BorrowerCountry",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/BorrowerCountry.vue"]};const Ea="data:image/svg+xml,%3csvg%20class=''%20width='25'%20height='37'%20viewBox='0%200%2025%2037'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M8.22861%200.875H0.857178V36.3125H8.22861V0.875Z'%20fill='white'%20/%3e%3cpath%20d='M10.1143%2023.2751C21.9428%2023.2751%2024.6857%2013.2126%2024.6857%2011.4626H23.6571C11.8286%2011.4626%209.08569%2021.5251%209.08569%2023.2751H10.1143Z'%20fill='white'%20/%3e%3cpath%20d='M9.08569%2024.2376C9.08569%2026.0751%2011.1428%2036.3126%2023.8285%2036.3126H24.8571C24.8571%2034.4751%2022.8%2024.2376%2010.1143%2024.2376H9.08569Z'%20fill='white'%20/%3e%3c/svg%3e",Fa={name:"SupporterDetails",components:{BorrowerImage:ut,KvTooltip:Lo},props:{name:{type:String,default:""},hash:{type:String,default:""},itemData:{type:Object,default:()=>{}},publicId:{type:String,default:""},whereabouts:{type:String,default:""},displayType:{type:String,default:""},hasAnonymousSupporters:{type:Boolean,default:!1}},data(){return{kivaKUrl:Ea,anonymousSupporterCard:!1,isMobile:!1,userCardStyleOptions:[{color:"tw-text-action",bg:"tw-bg-brand-50"},{color:"tw-text-black",bg:"tw-bg-brand-100"},{color:"tw-text-white",bg:"tw-bg-action"},{color:"tw-text-brand-50",bg:"tw-bg-action"},{color:"tw-text-brand-50",bg:"tw-bg-black"},{color:"tw-text-primary-inverse",bg:"tw-bg-action"},{color:"tw-text-white",bg:"tw-bg-black"}]}},computed:{borrowerImageAspect(){return this.isMobile?3/4:1},configureTracking(){return this.displayType==="lenders"?["Borrower profile","click-lender-image",this.name]:["Borrower profile","click-team-image",this.name]},lenderNameFirstLetter(){var t,e;return((e=(t=this.name)==null?void 0:t.substring(0,1))==null?void 0:e.toUpperCase())??""},linkPath(){return this.publicId?this.displayType==="lenders"?`/lender/${this.publicId}`:`/team/${this.publicId}`:""},randomizedUserClass(){if(this.hash)return"tw-bg-black";const t=this.userCardStyleOptions[Math.floor(Math.random()*this.userCardStyleOptions.length)];return`${t.color} ${t.bg} hover:${t.color}`},teamId(){var t;return((t=this.itemData)==null?void 0:t.id)??null},teamTooltipData(){var r,n,i;const t=((r=this.itemData)==null?void 0:r.category)??"",e=((n=this.itemData)==null?void 0:n.lenderCount)??0,a=((i=this.itemData)==null?void 0:i.lenderCountForLoan)??0;return t&&e&&a?{category:t,lendersForTeamMessage:`${a} of ${e} members`}:null},toolTipId(){const t=this.publicId||"",e=`team_${this.teamId}_${wi().vnode.key}`;return this.displayType==="teams"?e:t}},methods:{determineIfMobile(){this.isMobile=document.documentElement.clientWidth<735}},beforeUnmount(){window.removeEventListener("resize",lt(()=>{this.determineIfMobile()},200))},mounted(){window.addEventListener("resize",lt(()=>{this.determineIfMobile()},200)),this.hasAnonymousSupporters&&(this.anonymousSupporterCard=!0),this.determineIfMobile()}},Dd={class:"tw-block md:tw-inline-block md:tw-flex-none md:tw-mr-2 tw-max-w-[160px] md:tw-w-[84px] xl:tw-w-12 tw-mb-1 md:tw-mb-0",style:{"line-height":"0"}},Pd={class:"tw-pt-1"},Md={key:2,class:"tw-w-full tw-rounded tw-bg-brand tw-flex tw-items-center tw-justify-center tw-h-[120px] md:tw-h-[84px] xl:tw-h-12"},Rd=["src"],Ed={key:1,class:"tw-text-h4"};function Fd(t,e,a,r,n,i){const l=g("borrower-image"),m=g("kv-tooltip"),c=g("router-link"),h=de("kv-track-event");return F((s(),x(c,{class:Q(["tw-flex tw-flex-col md:tw-flex-row md:tw-items-center tw-no-underline hover:tw-no-underline tw-mb-1",{"hover:tw-cursor-default":n.anonymousSupporterCard}]),to:i.linkPath,id:i.toolTipId},{default:_(()=>[o("div",Dd,[!n.anonymousSupporterCard&&a.hash?(s(),x(l,{key:0,class:"tw-w-full tw-rounded tw-bg-black",alt:a.name,"aspect-ratio":i.borrowerImageAspect,"default-image":{width:n.isMobile?160:96},hash:a.hash,images:[{width:160,viewSize:320},{width:84,viewSize:734},{width:96,viewSize:1024}]},null,8,["alt","aspect-ratio","default-image","hash"])):!n.anonymousSupporterCard&&!a.hash?(s(),u("div",{key:1,class:Q(["tw-w-full tw-rounded tw-flex tw-items-center tw-justify-center tw-h-[120px] md:tw-h-[84px] xl:tw-h-12 tw-text-h1",i.randomizedUserClass])},[o("span",Pd,b(i.lenderNameFirstLetter),1)],2)):(s(),u("div",Md,[o("img",{src:n.kivaKUrl},null,8,Rd)]))]),o("div",{class:Q(["tw-text-primary",{"hover:tw-underline hover:tw-text-action":!n.anonymousSupporterCard}])},[a.name?(s(),u("span",{key:0,class:Q(`${a.displayType==="teams"?"tw-text-h4":""}`)},b(a.name),3)):v("",!0),e[0]||(e[0]=o("br",null,null,-1)),a.whereabouts?(s(),u("span",Ed,b(a.whereabouts),1)):v("",!0)],2),i.teamTooltipData&&!n.isMobile?(s(),x(m,{key:0,class:"tooltip",controller:i.toolTipId,"data-testid":`tooltip-id-${i.toolTipId}`,theme:"dark"},{default:_(()=>[D(b(i.teamTooltipData.category),1),e[1]||(e[1]=o("br",null,null,-1)),D(" "+b(i.teamTooltipData.lendersForTeamMessage),1)],void 0,!0),_:1,__:[1]},8,["controller","data-testid"])):v("",!0)],void 0),_:1},8,["class","to","id"])),[[h,i.configureTracking]])}const Od=B(Fa,[["render",Fd]]);Fa.__docgenInfo={displayName:"SupporterDetails",exportName:"default",description:"",tags:{},props:[{name:"name",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"hash",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"itemData",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}},{name:"publicId",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"whereabouts",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"displayType",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"hasAnonymousSupporters",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/SupporterDetails.vue"]};const Bd=K`query teamsQuery($loanId: Int!, $limit: Int, $offset: Int, $sortBy: TeamSearchSortByEnum) {
	lend {
		loan(id: $loanId) {
			id
			teams(limit: $limit, offset: $offset, sortBy: $sortBy ) {
				totalCount
				values {
					category
					id
					image {
						id
						hash
					}
					lenderCount
					lenderCountForLoan(id: $loanId)
					name
					teamPublicId
				}
			}
		}
	}
}`,Vd=K`query lendersQuery($loanId: Int!, $limit: Int, $offset: Int) {
	lend {
		loan(id: $loanId) {
			id
			userProperties {
				lentTo
			}
			lenders(limit: $limit, offset: $offset) {
				totalCount
				values {
					id
					name
					publicId
					lenderPage {
						whereabouts
					}
					image {
						id
						hash
					}
				}
			}
		}
	}
}`,$d=K`query userQuery {
	my {
		id
		lender {
			id
			publicId
			image {
				id
				hash
			}
			name
			lenderPage {
				whereabouts
			}
		}
	}
}`,Oa={name:"LendersAndTeams",components:{KvButton:Ze,KvLightbox:mt,KvLoadingPlaceholder:ge,KvMaterialIcon:_e,KvTextLink:ct,SupporterDetails:Od},inject:["apollo","cookieStore"],emits:["hide-section"],props:{displayType:{type:String,default:"lenders",validator:t=>["lenders","teams"].indexOf(t)!==-1},loanId:{type:Number,default:0}},data(){return{fetchingLightboxItems:!1,initialItemLimit:6,isLightboxVisible:!1,items:[],loading:!0,mdiLightningBolt:ra,observer:null,itemQueryLimit:20,sortBy:"memberCount",totalItemCount:0,supporterOfLoan:!1,userId:"",userImageHash:"",userName:"",userWhereabouts:"",publicId:"",teamPublicId:"",lenderPageUrl:""}},computed:{itemQueryOffset(){var t;return((t=this.items)==null?void 0:t.length)??0},countAwareName(){const t=this.displayType,e=t.slice(0,-1);return this.totalItemCount>1||this.totalItemCount===0?t:e},filteredItemList(){return this.items.filter(t=>t.name!=="Anonymous"&&t.id!==this.userId)},hasAnonymousSupporters(){return!!this.items.filter(e=>e.name==="Anonymous").length},poweredByText(){return`powered by ${this.totalItemCount} ${this.countAwareName}`},sectionTitle(){return`Contributing ${this.displayType==="teams"?"lending ":""}${this.countAwareName}`},seeAllLinkText(){return`See all ${this.totalItemCount} ${this.displayType==="teams"?"lending ":""}${this.countAwareName}`},truncatedItemList(){let t=0;return this.hasAnonymousSupporters&&this.supporterOfLoan?t=2:(this.supporterOfLoan||this.hasAnonymousSupporters)&&(t=1),this.filteredItemList.slice(0,this.initialItemLimit-t)}},methods:{createObserver(){this.observer=Me({targets:[this.$el],callback:t=>{t.forEach(e=>{if(e.target===this.$el&&e.intersectionRatio>0){if(this.items.length)return!1;this.fetchItems()}})}}),this.observer||this.fetchItems()},destroyObserver(){this.observer&&this.observer.disconnect()},fetchItems(t=!1){if(this.loanId===0)return!1;const e={loanId:this.loanId,limit:this.itemQueryLimit,offset:this.itemQueryOffset,sortBy:this.sortBy},a={loanId:this.loanId,limit:this.itemQueryLimit,offset:this.itemQueryOffset};this.apollo.query({query:this.displayType==="teams"?Bd:Vd,variables:this.displayType==="teams"?e:a}).then(({data:r})=>{var i,l,m,c,h,f,k,w,C;this.totalItemCount=((m=(l=(i=r==null?void 0:r.lend)==null?void 0:i.loan)==null?void 0:l[this.displayType])==null?void 0:m.totalCount)??0,this.totalItemCount||this.$emit("hide-section");const n=((f=(h=(c=r==null?void 0:r.lend)==null?void 0:c.loan)==null?void 0:h[this.displayType])==null?void 0:f.values)??0;this.lentTo=((C=(w=(k=r==null?void 0:r.lend)==null?void 0:k.loan)==null?void 0:w.userProperties)==null?void 0:C.lentTo)??!1,this.lentTo&&(this.supporterOfLoan=!0),this.items=[...this.items,...n],this.loading=!1,t&&(this.fetchingLightboxItems=!1)})},loadMore(){this.fetchingLightboxItems=!0,this.fetchItems(!0)},openLightbox(){this.isLightboxVisible=!0,this.items.length<=this.initialItemLimit&&this.loadMore()},gatherCurrentUserData(){this.apollo.query({query:$d}).then(({data:t})=>{var a,r,n;const e=(a=t==null?void 0:t.my)==null?void 0:a.lender;this.userId=(e==null?void 0:e.id)??"",this.userImageHash=(e==null?void 0:e.image.hash)??"",this.userName=(e==null?void 0:e.name)??"",this.userWhereabouts=((r=e==null?void 0:e.lenderPage)==null?void 0:r.whereabouts)??"",this.lenderPageUrl=((n=e==null?void 0:e.lenderPage)==null?void 0:n.url)??""})}},mounted(){this.createObserver(),this.gatherCurrentUserData()},beforeUnmount(){this.destroyObserver()}},qd=["data-testid"],zd={class:"tw-mb-3"},Ud=["data-testid"],jd={key:0,class:"tw-grid tw-grid-cols-2 tw-gap-2"},Hd={style:{display:"block",height:"auto",width:"50%"}},Kd=["data-testid"],Gd={class:"tw-text-h2"},Wd={class:"tw-mb-3"},Zd=["data-testid"],Qd=["data-testid"];function Yd(t,e,a,r,n,i){const l=g("kv-material-icon"),m=g("kv-loading-placeholder"),c=g("supporter-details"),h=g("kv-text-link"),f=g("kv-button"),k=g("kv-lightbox");return s(),u("section",null,[o("div",null,[o("h2",{class:"tw-text-h2","data-testid":`bp-${a.displayType}-header`},b(i.sectionTitle),9,qd),o("div",zd,[p(l,{class:"tw-w-2.5 tw-h-2.5 tw-pointer-events-none tw-inline-block tw-align-middle",icon:n.mdiLightningBolt},null,8,["icon"]),n.loading?(s(),x(m,{key:0,style:le({width:20+Math.random()*15+"%",height:"14px"}),class:"tw-ml-1 tw-inline-block tw-align-middle"},null,8,["style"])):(s(),u("span",{key:1,class:"tw-text-h4","data-testid":`bp-powered-by-${a.displayType}-message`},b(i.poweredByText),9,Ud))]),n.loading?(s(),u("div",jd,[(s(),u(H,null,Y(5,w=>o("div",{key:w,class:"tw-flex tw-flex-col md:tw-flex-row md:tw-items-center tw-mb-3"},[p(m,{class:"tw-rounded md:tw-hidden tw-mb-1.5",style:{width:"135px",height:"101px"}}),p(m,{class:"tw-rounded md:tw-block tw-hidden tw-mr-2",style:{width:"96px",height:"96px"}}),o("div",Hd,[p(m,{class:"tw-mb-1 tw-flex-shrink-0 tw-w-full",style:{height:"14px"}}),p(m,{style:le({width:40+Math.random()*15+"%",height:"14px"})},null,8,["style"])])])),64))])):v("",!0),n.loading?v("",!0):(s(),u("div",{key:1,class:"section-items tw-grid tw-grid-cols-2 tw-gap-2 tw-mb-3","data-testid":`bp-${a.displayType}-grid`},[n.supporterOfLoan?(s(),x(c,{key:0,"data-testid":`bp-${a.displayType}-support-details-supporter`,"display-type":"lenders",hash:n.userImageHash,name:n.userName,whereabouts:n.userWhereabouts,"supporter-page-url":n.lenderPageUrl},null,8,["data-testid","hash","name","whereabouts","supporter-page-url"])):v("",!0),(s(!0),u(H,null,Y(i.truncatedItemList,(w,C)=>(s(),x(c,{key:C,"data-testid":`bp-${a.displayType}-support-details-${C}`,name:w.name,hash:w.image&&w.image.hash?w.image.hash:"","item-data":w,"display-type":a.displayType,"public-id":`${a.displayType==="lenders"?w.publicId:w.teamPublicId}`,whereabouts:`${a.displayType==="lenders"?w.lenderPage.whereabouts:""}`},null,8,["data-testid","name","hash","item-data","display-type","public-id","whereabouts"]))),128)),i.hasAnonymousSupporters&&a.displayType==="lenders"?(s(),x(c,{key:1,"data-testid":`bp-${a.displayType}-support-details-anonymous`,name:"+ Anonymous lenders","display-type":"lenders","has-anonymous-supporters":i.hasAnonymousSupporters},null,8,["data-testid","has-anonymous-supporters"])):v("",!0)],8,Kd)),n.totalItemCount>n.initialItemLimit?(s(),x(h,{key:2,"data-testid":`bp-${a.displayType}-see-all-link`,onClick:i.openLightbox},{default:_(()=>[D(b(i.seeAllLinkText),1)],void 0),_:1},8,["data-testid","onClick"])):v("",!0)]),p(k,{"data-testid":`bp-${a.displayType}-lightbox`,visible:n.isLightboxVisible,title:i.sectionTitle,onLightboxClosed:e[0]||(e[0]=w=>n.isLightboxVisible=!1)},{header:_(()=>[o("h2",Gd,b(i.sectionTitle),1),o("div",Wd,[p(l,{class:"tw-w-2.5 tw-h-2.5 tw-pointer-events-none tw-inline-block tw-align-middle",icon:n.mdiLightningBolt},null,8,["icon"]),o("span",{"data-testid":`bp-${a.displayType}-lightbox-powered-by-message`},b(i.poweredByText),9,Zd)])]),default:_(()=>[o("div",{class:"tw-mb-3 tw-grid tw-grid-cols-2 md:tw-grid-cols-3 tw-gap-2","data-testid":`bp-lightbox-${a.displayType}-grid`},[n.supporterOfLoan?(s(),x(c,{key:0,"data-testid":`bp-lightbox-${a.displayType}-support-details-supporter`,"display-type":"lenders",hash:n.userImageHash,name:n.userName,whereabouts:n.userWhereabouts,"supporter-page-url":n.lenderPageUrl},null,8,["data-testid","hash","name","whereabouts","supporter-page-url"])):v("",!0),(s(!0),u(H,null,Y(i.filteredItemList,(w,C)=>(s(),x(c,{key:`lb_item_${C}`,"data-testid":`bp-lightbox-${a.displayType}-support-details-${C}`,name:w.name,hash:w.image&&w.image.hash?w.image.hash:"","item-data":w,"display-type":a.displayType,"public-id":`${a.displayType==="lenders"?w.publicId:w.teamPublicId}`,whereabouts:`${a.displayType==="lenders"?w.lenderPage.whereabouts:""}`},null,8,["data-testid","name","hash","item-data","display-type","public-id","whereabouts"]))),128)),i.hasAnonymousSupporters&&a.displayType==="lenders"?(s(),x(c,{key:1,"data-testid":`bp-lightbox-${a.displayType}-support-details-anonymous`,name:"+ Anonymous lenders","display-type":"lenders","has-anonymous-supporters":i.hasAnonymousSupporters},null,8,["data-testid","has-anonymous-supporters"])):v("",!0)],8,Qd),n.items.length<n.totalItemCount?(s(),x(f,{key:0,"data-testid":`bp-lightbox-${a.displayType}-load-more-button`,class:"tw-w-full",onClick:Be(i.loadMore,["prevent"]),state:n.fetchingLightboxItems?"loading":"",variant:"ghost"},{default:_(()=>e[1]||(e[1]=[D(" Load more ")]),void 0,!0),_:1,__:[1]},8,["data-testid","onClick","state"])):v("",!0)],void 0),_:1},8,["data-testid","visible","title"])])}const Xd=B(Oa,[["render",Yd]]);Oa.__docgenInfo={displayName:"LendersAndTeams",exportName:"default",description:"",tags:{},props:[{name:"displayType",type:{name:"string"},defaultValue:{func:!1,value:"'lenders'"}},{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}}],events:[{name:"hide-section"}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/LendersAndTeams.vue"]};const Pn=We(()=>Qe(()=>import("./entry-twitter-logo-CKBJE5jZoB.js"),__vite__mapDeps([0,1]),import.meta.url)),Mn=We(()=>Qe(()=>import("./entry-yelp-logo-B3xvN1uhUN.js"),__vite__mapDeps([2,1]),import.meta.url)),Rn=We(()=>Qe(()=>import("./entry-etsy-logo-XXt8qaIMUO.js"),__vite__mapDeps([3,1]),import.meta.url)),En=We(()=>Qe(()=>import("./entry-facebook-logo-CxXOeoqLhG.js"),__vite__mapDeps([4,1]),import.meta.url)),Fn=We(()=>Qe(()=>import("./entry-instagram-logo-CTb2FALcXo.js"),__vite__mapDeps([5,1]),import.meta.url)),On=We(()=>Qe(()=>import("./entry-linkedin-logo-9_C1iJf6OB.js"),__vite__mapDeps([6,1]),import.meta.url)),Ba={name:"BorrowerBusinessDetails",components:{KvTextLink:ct,TwitterLogo:Pn,YelpLogo:Mn,EtsyLogo:Rn,FacebookLogo:En,InstagramLogo:Fn,LinkedinLogo:On},props:{loanId:{type:Number,default:0},borrowerBusinessName:{type:String,default:""},sector:{type:String,default:""},socialLinks:{type:Object,default:()=>{}},yearsInBusiness:{type:String,default:""}},data(){return{mdiArrowTopRight:la}},methods:{getLogo(t){switch(t){case"twitter":return Pn;case"etsy":return Rn;case"facebook":return En;case"instagram":return Fn;case"linkedin":return On;case"yelp":return Mn;default:return null}},getLogoWidth(t){switch(t){case"twitter":return 28;case"etsy":return 32;case"facebook":return 28;case"instagram":return 28;case"linkedin":return 30;case"yelp":return 30;default:return 0}},getLogoHeight(t){switch(t){case"twitter":return 23;case"etsy":return 15;case"facebook":return 28;case"instagram":return 28;case"linkedin":return 28;case"yelp":return 22;default:return 0}},verifyUrl(t){if(t)try{let e=t;return t.startsWith("http")||(e=`https://${t}`),e=new URL(e),e.href}catch{if(typeof window<"u")return Co(a=>{a.setTag("borrower_profile","social_link"),So(`Invalid url ${t} for ${this.loanId}`)}),""}}},computed:{processedWebsite(){var e;const t=((e=this.socialLinks)==null?void 0:e.website)??"";return t?this.verifyUrl(t):""},filteredSocialLinks(){const t=Object.keys(this.socialLinks),e=["etsy","facebook","instagram","linkedin","twitter","yelp"];return t.filter(n=>!!(e.includes(n)&&this.socialLinks[n])).map(n=>({type:n,url:this.socialLinks[n]}))??[]},yearsInBusinessFormatted(){return{startup:"New Business",six_month:"<6 months",one_year:"6 months - 1 year",three_year:"1 year - 3 years",five_year:"3 years - 5 years",more:"More than 5 years"}[this.yearsInBusiness]}}},Jd={class:"tw-rounded tw-border-tertiary tw-bg-primary tw-p-2.5 md:tw-p-3.5 lg:tw-p-4","data-test-id":"bp-direct-business-info"},eu={class:"tw-mt-0 tw-mb-1","data-testid":"bp-direct-business-name"},tu={key:1,class:"tw-mb-0","data-testid":"bp-direct-business-industry"},nu={class:"tw-mb-0","data-testid":"bp-direct-business-years"},au=["data-testid","href"];function iu(t,e,a,r,n,i){const l=g("kv-text-link"),m=de("kv-track-event");return s(),u("section",Jd,[o("h2",eu," About "+b(a.borrowerBusinessName),1),i.processedWebsite?(s(),x(l,{key:0,icon:n.mdiArrowTopRight,class:"tw-mb-2","data-testid":"bp-direct-business-website",target:"_blank",href:i.processedWebsite},{default:_(()=>e[0]||(e[0]=[D(" View Website ")]),void 0),_:1,__:[0]},8,["icon","href"])):v("",!0),a.sector?(s(),u("h3",tu,b(a.sector),1)):v("",!0),e[1]||(e[1]=o("p",{class:"tw-text-h4 tw-text-secondary tw-mb-2"}," Industry ",-1)),o("h3",nu,b(i.yearsInBusinessFormatted),1),e[2]||(e[2]=o("p",{class:"tw-text-h4 tw-text-secondary"}," Years in operation ",-1)),(s(!0),u(H,null,Y(i.filteredSocialLinks,(c,h)=>F((s(),u("a",{key:h,target:"_blank",class:"tw-rounded tw-bg-secondary tw-inline-flex tw-items-center tw-justify-center tw-mt-2 tw-mr-2 tw-h-6 tw-w-6","data-testid":`bp-direct-business-social-links-${h}`,href:i.verifyUrl(c.url)},[(s(),x(vi(i.getLogo(c.type)),{alt:`${c.type}-logo`,width:i.getLogoWidth(c.type),height:i.getLogoHeight(c.type)},null,8,["alt","width","height"]))],8,au)),[[m,["Borrower Profile","EXP-GROW-655-Aug2021","click-social-",c.type]]])),128))])}const ou=B(Ba,[["render",iu]]);Ba.__docgenInfo={displayName:"BorrowerBusinessDetails",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"borrowerBusinessName",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"sector",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"socialLinks",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}},{name:"yearsInBusiness",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/BorrowerBusinessDetails.vue"]};const Va={name:"MoreAboutLoan",inject:["apollo","cookieStore"],components:{BorrowerBusinessDetails:ou,KvLoadingPlaceholder:ge},props:{loanId:{type:Number,default:0}},data(){return{businessName:"",businessDescription:"",dualStatementNote:"",loading:!0,loanAlertText:"",moreInfoAboutLoan:"",name:"",partnerName:"",purpose:"",sector:"",socialLinks:{etsy:"",facebook:"",instagram:"",linkedin:"",twitter:"",website:"",yelp:""},yearsInBusiness:""}},computed:{borrowerBusinessName(){return this.businessName?this.businessName:this.name},partnerNameNA(){return this.partnerName.indexOf("N/A")>-1||this.partnerName.indexOf("N/a")>-1||this.partnerName.indexOf("n/a")>-1},businessDescriptionParagraphs(){return rt(this.businessDescription)},purposeParagraphs(){return rt(this.purpose)}},methods:{createObserver(){this.observer=Me({targets:[this.$el],callback:t=>{t.forEach(e=>{e.target===this.$el&&e.intersectionRatio>0&&this.loadData()})}}),this.observer||this.loadData()},destroyObserver(){this.observer&&this.observer.disconnect()},loadData(){this.apollo.query({query:K`query moreAboutLoan($loanId: Int!) {
					lend {
						loan(id: $loanId) {
							id
							name
							sector {
								id
								name
							}
							... on LoanDirect {
								businessName
								businessDescription
								purpose
								yearsInBusiness
								socialLinks {
									etsy
									facebook
									instagram
									linkedin
									twitter
									website
									yelp
								}
							}
							... on LoanPartner {
								dualStatementNote
								moreInfoAboutLoan
								partnerName
								partner {
									id
									loanAlertText
								}
							}
						}
					}
				}`,variables:{loanId:this.loanId}}).then(t=>{var a,r,n,i;const e=(r=(a=t==null?void 0:t.data)==null?void 0:a.lend)==null?void 0:r.loan;this.businessName=(e==null?void 0:e.businessName)??"",this.businessDescription=(e==null?void 0:e.businessDescription)??"",this.dualStatementNote=(e==null?void 0:e.dualStatementNote)??"",this.name=(e==null?void 0:e.name)??"",this.loanAlertText=((n=e==null?void 0:e.partner)==null?void 0:n.loanAlertText)??"",this.moreInfoAboutLoan=(e==null?void 0:e.moreInfoAboutLoan)??"",this.partnerName=(e==null?void 0:e.partnerName)??"",this.purpose=(e==null?void 0:e.purpose)??"",this.sector=((i=e==null?void 0:e.sector)==null?void 0:i.name)??"",this.socialLinks=(e==null?void 0:e.socialLinks)??{},this.yearsInBusiness=(e==null?void 0:e.yearsInBusiness)??"",this.loading=!1})}},mounted(){this.createObserver()},beforeUnmount(){this.destroyObserver()}},ru={ref:"body"},su={class:"tw-prose tw-break-words"},lu={key:0},du={key:0,"data-testid":"bp-more_about-facilitated"},uu=["innerHTML"],mu={key:1,"data-testid":"bp-more-about-alert-text"},cu=["innerHTML"],pu={key:2,"data-testid":"bp-more-about-dual-statement"},hu=["innerHTML"],fu={key:0},gu={class:"tw-prose tw-my-2"},wu={"data-testid":"bp-more-about-direct-description"},vu=["innerHTML"],bu={class:"tw-prose","data-testid":"bp-direct-loan-purpose"},yu={"data-testid":"bp-more-about-purpose"},_u=["innerHTML"],ku={key:1};function Lu(t,e,a,r,n,i){const l=g("borrower-business-details"),m=g("kv-loading-placeholder");return s(),u("section",null,[e[5]||(e[5]=o("h2",{"data-testid":"bp-more-about-header"}," More about this loan ",-1)),o("div",ru,[o("div",su,[n.partnerName&&!n.loading?(s(),u("div",lu,[i.partnerNameNA?v("",!0):(s(),u("p",du," This loan is facilitated by our Lending Partner, "+b(n.partnerName)+". Lending Partners are local organizations working in communities to vet borrowers, provide services, and administer loans on the ground. ",1)),o("div",{innerHTML:n.moreInfoAboutLoan,"data-testid":"bp-more-about-info"},null,8,uu),n.loanAlertText?(s(),u("div",mu,[o("h3",null," About "+b(n.partnerName)+": ",1),o("p",{key:"storyDescription",innerHTML:n.loanAlertText},null,8,cu)])):v("",!0),n.dualStatementNote?(s(),u("div",pu,[e[0]||(e[0]=o("h3",null," Important Note About This Loan ",-1)),o("div",{innerHTML:n.dualStatementNote},null,8,hu)])):v("",!0)])):v("",!0)]),!n.partnerName&&!n.loading?(s(),u("div",fu,[o("div",gu,[e[1]||(e[1]=o("h3",null," Business description ",-1)),o("div",wu,[(s(!0),u(H,null,Y(i.businessDescriptionParagraphs,(c,h)=>(s(),u("p",{key:`businessDescription-${h}`,innerHTML:c},null,8,vu))),128))])]),p(l,{class:"tw-mb-2","borrower-business-name":i.borrowerBusinessName,sector:n.sector,"social-links":n.socialLinks,"years-in-business":n.yearsInBusiness,"loan-id":a.loanId},null,8,["borrower-business-name","sector","social-links","years-in-business","loan-id"]),o("div",bu,[e[2]||(e[2]=o("h3",null," What is the purpose of this loan? ",-1)),o("div",yu,[(s(!0),u(H,null,Y(i.purposeParagraphs,(c,h)=>(s(),u("p",{key:`purpose-${h}`,innerHTML:c},null,8,_u))),128))])])])):v("",!0),n.loading?(s(),u("div",ku,[p(m,{class:"tw-mb-2",style:le({width:60+Math.random()*15+"%",height:"1.6rem"})},null,8,["style"]),(s(),u(H,null,Y(5,c=>o("div",{key:`${c}pl1`},[p(m,{class:"tw-w-full tw-mb-1",style:le({width:80+Math.random()*15+"%",height:"1rem"})},null,8,["style"])])),64)),e[3]||(e[3]=o("br",null,null,-1)),p(m,{class:"tw-mb-2",style:le({width:60+Math.random()*15+"%",height:"1.6rem"})},null,8,["style"]),(s(),u(H,null,Y(5,c=>o("div",{key:`${c}pl2`},[p(m,{class:"tw-w-full tw-mb-1",style:le({width:80+Math.random()*15+"%",height:"1rem"})},null,8,["style"])])),64)),e[4]||(e[4]=o("br",null,null,-1))])):v("",!0)],512)])}const Cu=B(Va,[["render",Lu]]);Va.__docgenInfo={displayName:"MoreAboutLoan",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/MoreAboutLoan.vue"]};const $a={name:"WhySpecial",inject:["apollo","cookieStore"],components:{KvLoadingPlaceholder:ge},props:{loanId:{type:Number,default:0}},data(){return{loading:!0,whySpecial:""}},computed:{fullWhySpecial(){return li(this.whySpecial)}},apollo:{query:K`query whySpecial($loanId: Int!) {
			lend {
				loan(id: $loanId) {
					id
					whySpecial
				}
			}
		}`,variables(){return{loanId:this.loanId}},result(t){var e,a,r;this.whySpecial=((r=(a=(e=t==null?void 0:t.data)==null?void 0:e.lend)==null?void 0:a.loan)==null?void 0:r.whySpecial)??""}},methods:{createObserver(){this.observer=Me({targets:[this.$el],callback:t=>{t.forEach(e=>{e.target===this.$el&&e.intersectionRatio>0&&this.loadData()})}}),this.observer||this.loadData()},destroyObserver(){this.observer&&this.observer.disconnect()},loadData(){this.apollo.query({query:K`query whySpecial($loanId: Int!) {
					lend {
						loan(id: $loanId) {
							id
							whySpecial
						}
					}
				}`,variables:{loanId:this.loanId}}).then(t=>{var e,a,r;this.whySpecial=((r=(a=(e=t==null?void 0:t.data)==null?void 0:e.lend)==null?void 0:a.loan)==null?void 0:r.whySpecial)??"",this.loading=!1})}},mounted(){this.createObserver()},beforeUnmount(){this.destroyObserver()}},Su={key:0,class:"tw-w-full"},xu={key:1,class:"tw-text-h2 tw-my-1"};function Iu(t,e,a,r,n,i){const l=g("kv-loading-placeholder");return s(),u("article",null,[n.loading?(s(),u("div",Su,[p(l,{class:"tw-w-full tw-mb-2 lg:tw-mb-3",style:{height:"1.6rem"}}),p(l,{class:"tw-mb-2",style:le({width:60+Math.random()*15+"%",height:"1.6rem"})},null,8,["style"])])):v("",!0),e[0]||(e[0]=o("h2",{class:"tw-sr-only"}," Why this loan is special ",-1)),n.loading?v("",!0):(s(),u("p",xu,b(i.fullWhySpecial),1))])}const Tu=B($a,[["render",Iu]]);$a.__docgenInfo={displayName:"WhySpecial",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/WhySpecial.vue"]};const qa={name:"CommentsAndWhySpecial",inject:["apollo","cookieStore"],components:{BorrowerImage:ut,KvButton:Ze,KvCarousel:No,KvLightbox:mt,KvLoadingPlaceholder:ge,KvMaterialIcon:_e,KvRadio:Ao,WhySpecial:Tu},mixins:[xo],props:{loanId:{type:Number,default:0},isLoggedIn:{type:Boolean,default:!1}},data(){return{kivaKUrl:Ea,mdiDotsHorizontalCircle:Pi,loading:!0,comments:[],commentMenuShown:!1,isReportLightboxVisible:!1,isCommentLightboxVisible:!1,selectedReason:"",selectedCommentId:"",selectedCommentBody:"",userCardStyleOptions:[{color:"tw-text-action",bg:"tw-bg-brand-50"},{color:"tw-text-black",bg:"tw-bg-brand-100"},{color:"tw-text-action",bg:"tw-bg-secondary"},{color:"tw-text-white",bg:"tw-bg-action"},{color:"tw-text-brand-50",bg:"tw-bg-action"},{color:"tw-text-brand-50",bg:"tw-bg-black"},{color:"tw-text-primary-inverse",bg:"tw-bg-action"},{color:"tw-text-white",bg:"tw-bg-black"}],isMobile:!1}},computed:{buttonState(){return this.loading?"loading":this.selectedReason?"":"disabled"},enhancedComments(){return this.comments.map(t=>{var n,i,l,m,c,h,f;const e=(n=t.authorImageUrl)==null?void 0:n.split("/").pop(),a=(l=(i=t.authorLendingAction)==null?void 0:i.teams)==null?void 0:l[0],r=(h=(c=(m=t.authorLendingAction)==null?void 0:m.lender)==null?void 0:c.teams)==null?void 0:h.values.find(k=>{var w,C;return k.name===((C=(w=t.authorLendingAction)==null?void 0:w.teams)==null?void 0:C[0])});return{...t,isAnonymous:t.authorName==="Anonymous"||t.authorName===null,lenderNameFirstLetter:(f=t.authorName)==null?void 0:f.substring(0,1).toUpperCase(),lenderTeam:a,lenderTeamPublicId:(r==null?void 0:r.teamPublicId)??null,hash:e==null?void 0:e.split(".")[0]}})}},watch:{loanId(t,e){t!==e&&t&&this.loadData()}},mounted(){this.createObserver(),window.addEventListener("resize",this.throttledResize),this.determineIfMobile()},beforeUnmount(){this.destroyObserver(),window.removeEventListener("resize",this.throttledResize)},methods:{createObserver(){this.observer=Me({targets:[this.$el],callback:t=>{t.forEach(e=>{e.target===this.$el&&e.intersectionRatio>0&&this.loadData()})}}),this.observer||this.loadData()},destroyObserver(){this.observer&&this.observer.disconnect()},loadData(){this.loanId&&this.apollo.query({query:K`query loanComments($loanId: Int!) {
					lend {
						loan(id: $loanId) {
							id
							comments {
								values {
									id
									authorName
									authorImageUrl
									authorLendingAction {
										teams
										lender {
											id
											teams(limit: 100) { #arbitrary limit for lenders that have a lot of teams
												values {
													id
													name
													teamPublicId
												}
											}
										}
									}
									body
								}
							}
						}
					}
				}`,variables:{loanId:this.loanId},fetchPolicy:"network-only"}).then(t=>{var e,a,r,n;this.comments=((n=(r=(a=(e=t==null?void 0:t.data)==null?void 0:e.lend)==null?void 0:a.loan)==null?void 0:r.comments)==null?void 0:n.values)??[],this.loading=!1})},openCommentMenu(){this.commentMenuShown=!0},hideCommentsMenu(){this.commentMenuShown=!1},openReportModal(t){this.selectedCommentId=t,this.isReportLightboxVisible=!0},reportComment(){this.loading=!0,this.apollo.mutate({mutation:K`mutation flagLoanComment($id: Int!, $description: String, $commentId: Int!) {
					loan(id: $id) {
						flagComment(description: $description, commentId: $commentId)
					}
				}`,variables:{id:this.loanId,commentId:this.selectedCommentId,description:this.selectedReason}}).then(({data:t,errors:e})=>{if(t.loan.flagComment)this.$showTipMsg("Thank you for reporting this comment!");else if(e[0].message)this.$showTipMsg(e[0].message);else throw new Error("There was a problem reporting this comment")}).catch(t=>{ot(t,"error"),this.$showTipMsg("There was a problem reporting this comment","error")}).finally(()=>{this.isReportLightboxVisible=!1,this.loading=!1})},randomizedUserClass(){const t=this.userCardStyleOptions[Math.floor(Math.random()*this.userCardStyleOptions.length)];return`${t.color} ${t.bg}`},determineIfMobile(){this.isMobile=document.documentElement.clientWidth<735},isDefaultProfilePic(t){return Io(t)},throttledResize(){return lt(this.determineIfMobile,200)},isTruncatedComment(t){return((t==null?void 0:t.length)??0)>255},shortComment(t){return this.isTruncatedComment(t)?`${t==null?void 0:t.substring(0,255)}... `:t},showFullComment(t){this.isCommentLightboxVisible=!0,this.selectedCommentBody=t}}},Nu={key:0,class:"tw-w-full tw-my-5 md:tw-my-6 lg:tw-my-8 tw-py-2 md:tw-py-3 lg:tw-py-5"},Au={key:1,class:"tw-bg-white tw-rounded tw-p-1.5 tw-absolute tw-right-1 tw-top-0",style:{"box-shadow":"0 4px 12px rgb(0 0 0 / 8%)",width:"15rem"}},Du={class:"tw-text-base"},Pu=["onClick"],Mu={class:"tw-break-words"},Ru={key:0,class:"tw-mt-1"},Eu=["onClick"],Fu={class:"tw-self-end tw-flex tw-align-center tw-mt-1.5"},Ou={class:"tw-self-center"},Bu={key:2,class:"tw-rounded-full tw-bg-brand tw-w-full tw-h-full tw-flex tw-align-center tw-justify-center"},Vu=["src"],$u={class:"tw-m-auto"},qu={key:0},zu={class:"tw-flex tw-flex-col tw-gap-2 tw-mt-1 tw-mb-2"},Uu={class:"tw-break-words"};function ju(t,e,a,r,n,i){const l=g("kv-loading-placeholder"),m=g("kv-material-icon"),c=g("borrower-image"),h=g("router-link"),f=g("why-special"),k=g("kv-carousel"),w=g("kv-radio"),C=g("kv-button"),I=g("kv-lightbox"),T=de("click-outside"),P=de("kv-track-event");return s(),u("article",null,[n.loading?(s(),u("div",Nu,[p(l,{class:"tw-w-full tw-mb-2 lg:tw-mb-3",style:{height:"1.6rem"}}),p(l,{class:"tw-mb-2",style:le({width:60+Math.random()*15+"%",height:"1.6rem"})},null,8,["style"])])):v("",!0),e[15]||(e[15]=o("h2",{class:"tw-sr-only"}," Loan Comments ",-1)),n.loading?v("",!0):(s(),u("div",{class:"tw-py-2 md:tw-py-3 lg:tw-py-5",key:`comments-${a.loanId}`},[p(k,{"multiple-slides-visible":!1,"embla-options":{loop:!1,draggable:!1}},bi({_:2},[Y(i.enhancedComments,(L,O)=>({name:`slide${O}`,fn:_(()=>[o("div",null,[a.isLoggedIn?(s(),u("button",{key:0,onClick:e[0]||(e[0]=Be((...E)=>i.openCommentMenu&&i.openCommentMenu(...E),["stop"])),class:"tw-ml-auto tw-mr-0 tw-block",style:le({visibility:n.commentMenuShown?"hidden":"visible"})},[p(m,{class:"tw-w-3 tw-h-3 tw-text-secondary",icon:n.mdiDotsHorizontalCircle},null,8,["icon"])],4)):v("",!0),n.commentMenuShown?F((s(),u("div",Au,[e[7]||(e[7]=o("h4",{class:"tw-text-h4 tw-text-secondary tw-mb-1"}," More options ",-1)),o("ul",null,[o("li",Du,[o("button",{onClick:E=>i.openReportModal(L.id)}," Report this comment ",8,Pu)])])])),[[T,i.hideCommentsMenu]]):v("",!0),o("div",null,[o("h2",null,[o("em",Mu,'"'+b(i.shortComment(L.body))+'"',1)])]),o("div",{class:Q(["tw-flex",i.isTruncatedComment(L.body)?"tw-justify-between":"tw-justify-end"])},[i.isTruncatedComment(L.body)?(s(),u("p",Ru,[F((s(),u("button",{class:"tw-text-link",onClick:E=>i.showFullComment(L.body)},e[8]||(e[8]=[D(" Read More ")]),8,Eu)),[[P,["borrower-profile","click","comment-read-more"]]])])):v("",!0),o("div",Fu,[o("div",{class:Q(["tw-mr-1",{"tw-w-4 tw-h-4":n.isMobile,"tw-w-6 tw-h-6":!n.isMobile}])},[!L.isAnonymous&&!i.isDefaultProfilePic(L.hash)?(s(),x(c,{key:0,class:"tw-rounded-full tw-bg-black tw-w-full tw-h-full",alt:L.authorName,"default-image":{width:n.isMobile?32:48},hash:L.hash},null,8,["alt","default-image","hash"])):!L.isAnonymous&&i.isDefaultProfilePic(L.hash)?(s(),u("div",{key:1,class:Q(["tw-rounded-full tw-text-h2 tw-w-full tw-h-full tw-flex tw-align-center tw-justify-center",i.randomizedUserClass()])},[o("span",Ou,b(L.lenderNameFirstLetter),1)],2)):(s(),u("div",Bu,[o("img",{src:n.kivaKUrl},null,8,Vu)]))],2),o("div",$u,[o("h3",null,b(L.authorName),1),L.lenderTeam&&L.lenderTeamPublicId?(s(),u("h4",qu,[F((s(),x(h,{to:`/team/${L.lenderTeamPublicId}`,class:"tw-text-primary"},{default:_(()=>[D(b(L.lenderTeam),1)],void 0,!0),_:2},1032,["to"])),[[P,["borrower-profile","click","comment-team-name",L.lenderTeamPublicId]]])])):v("",!0)])])],2)])])})),n.loading?void 0:{name:"why-special",fn:_(()=>[p(f,{"data-testid":"bp-why-special","loan-id":a.loanId},null,8,["loan-id"])]),key:"0"}]),1024)])),p(I,{visible:n.isReportLightboxVisible,title:"Report comment",onLightboxClosed:e[5]||(e[5]=L=>n.isReportLightboxVisible=!1)},{header:_(()=>e[9]||(e[9]=[o("h2",null," Report Comment ",-1),o("h3",{class:"tw-mt-2"}," Why are you reporting this comment? ",-1)])),controls:_(()=>[p(C,{variant:"secondary",onClick:e[4]||(e[4]=L=>n.isReportLightboxVisible=!1)},{default:_(()=>e[13]||(e[13]=[D(" Cancel ")]),void 0,!0),_:1,__:[13]}),p(C,{variant:"primary",state:i.buttonState,onClick:i.reportComment},{default:_(()=>e[14]||(e[14]=[D(" Submit report ")]),void 0,!0),_:1,__:[14]},8,["state","onClick"])]),default:_(()=>[o("fieldset",zu,[p(w,{value:"I find it offensive",name:"reportReason",modelValue:n.selectedReason,"onUpdate:modelValue":e[1]||(e[1]=L=>n.selectedReason=L)},{default:_(()=>e[10]||(e[10]=[D(" I find it offensive ")]),void 0,!0),_:1,__:[10]},8,["modelValue"]),p(w,{value:"It's spam or misleading",name:"reportReason",modelValue:n.selectedReason,"onUpdate:modelValue":e[2]||(e[2]=L=>n.selectedReason=L)},{default:_(()=>e[11]||(e[11]=[D(" It's spam or misleading ")]),void 0,!0),_:1,__:[11]},8,["modelValue"]),p(w,{value:"It is harmful, violent, or could cause harm",name:"reportReason",modelValue:n.selectedReason,"onUpdate:modelValue":e[3]||(e[3]=L=>n.selectedReason=L)},{default:_(()=>e[12]||(e[12]=[D(" It is harmful, violent, or could cause harm ")]),void 0,!0),_:1,__:[12]},8,["modelValue"])])],void 0),_:1},8,["visible"]),p(I,{visible:n.isCommentLightboxVisible,title:"",onLightboxClosed:e[6]||(e[6]=L=>n.isCommentLightboxVisible=!1)},{default:_(()=>[o("h2",null,[o("em",Uu,'"'+b(n.selectedCommentBody)+'"',1)])],void 0),_:1},8,["visible"])])}const Hu=B(qa,[["render",ju]]);qa.__docgenInfo={displayName:"CommentsAndWhySpecial",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"isLoggedIn",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/CommentsAndWhySpecial.vue"]};const za={name:"TopBannerPfp",components:{KvMaterialIcon:_e,KvGrid:dt,KvPageContainer:Dt},props:{lendersNeeded:{type:Number,default:0},daysLeft:{type:Number,default:0},borrowerName:{type:String,default:"This borrower"}},data(){return{mdiInformationOutline:Mi}},computed:{daysLeftLanguage(){switch(this.daysLeft){case this.daysLeft<1:return"less than 1 day";case this.daysLeft===1:return`${this.daysLeft} day`;default:return`${this.daysLeft} days`}}}},Ku={class:"tw-col-span-12"},Gu={class:"tw-bg-brand-200 md:tw-bg-primary tw-p-2.5 md:tw-p-3 lg:tw-p-4 tw-rounded-b"},Wu={class:"tw-flex tw-items-center"},Zu={class:"tw-flex-none tw-mr-1.5 tw-h-2.5"},Qu={class:"tw-flex-auto"};function Yu(t,e,a,r,n,i){const l=g("kv-material-icon"),m=g("kv-grid"),c=g("kv-page-container");return s(),x(c,{class:"tw-px-0"},{default:_(()=>[p(m,{class:"tw-grid-cols-12"},{default:_(()=>[o("div",Ku,[o("section",Gu,[o("div",Wu,[o("div",Zu,[p(l,{class:"tw-text-secondary tw-h-2.5 tw-w-2.5 tw-shrink-0",icon:n.mdiInformationOutline},null,8,["icon"])]),e[0]||(e[0]=o("div",null,[o("h3",null," This loan is in the private funding stage. ")],-1))]),o("div",Qu,b(a.borrowerName)+" has "+b(i.daysLeftLanguage)+" to earn the support of "+b(a.lendersNeeded)+" lenders through their network. If successful, we'll share this loan with everyone on Kiva. ",1)])])],void 0,!0),_:1})],void 0),_:1})}const Xu=B(za,[["render",Yu]]);za.__docgenInfo={displayName:"TopBannerPfp",exportName:"default",description:"",tags:{},props:[{name:"lendersNeeded",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"daysLeft",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"borrowerName",type:{name:"string"},defaultValue:{func:!1,value:"'This borrower'"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/TopBannerPfp.vue"]};const Ju=`query updatesQuery($loanId: Int!, $limit: Int, $offset: Int) {
    lend {
        loan(id: $loanId) {
            id
            name
            updates(limit: $limit, offset: $offset) {
                totalCount
                values {
                    id
                    body
                    subject
                    date
                    image {
                        id
                        url(customSize: "h200w700")
                    }
                }
            }
        }
    }
}`,em={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"updatesQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"loanId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lend"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"loan"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"loanId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updates"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}},{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"values"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[{kind:"Argument",name:{kind:"Name",value:"customSize"},value:{kind:"StringValue",value:"h200w700",block:!1}}],directives:[]}]}}]}}]}}]}}]}}]}}],loc:{start:0,end:557,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Ju}}};/*! @license DOMPurify 2.4.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.0/LICENSE */function Ae(t){"@babel/helpers - typeof";return Ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(t)}function Yt(t,e){return Yt=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},Yt(t,e)}function tm(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function It(t,e,a){return tm()?It=Reflect.construct:It=function(n,i,l){var m=[null];m.push.apply(m,i);var c=Function.bind.apply(n,m),h=new c;return l&&Yt(h,l.prototype),h},It.apply(null,arguments)}function be(t){return nm(t)||am(t)||im(t)||om()}function nm(t){if(Array.isArray(t))return Xt(t)}function am(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function im(t,e){if(t){if(typeof t=="string")return Xt(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Xt(t,e)}}function Xt(t,e){(e==null||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function om(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var rm=Object.hasOwnProperty,Bn=Object.setPrototypeOf,sm=Object.isFrozen,lm=Object.getPrototypeOf,dm=Object.getOwnPropertyDescriptor,he=Object.freeze,ke=Object.seal,um=Object.create,Ua=typeof Reflect<"u"&&Reflect,At=Ua.apply,Jt=Ua.construct;At||(At=function(e,a,r){return e.apply(a,r)});he||(he=function(e){return e});ke||(ke=function(e){return e});Jt||(Jt=function(e,a){return It(e,be(a))});var mm=ye(Array.prototype.forEach),Vn=ye(Array.prototype.pop),at=ye(Array.prototype.push),Tt=ye(String.prototype.toLowerCase),cm=ye(String.prototype.match),Ne=ye(String.prototype.replace),pm=ye(String.prototype.indexOf),hm=ye(String.prototype.trim),ce=ye(RegExp.prototype.test),Ut=fm(TypeError);function ye(t){return function(e){for(var a=arguments.length,r=new Array(a>1?a-1:0),n=1;n<a;n++)r[n-1]=arguments[n];return At(t,e,r)}}function fm(t){return function(){for(var e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return Jt(t,a)}}function R(t,e,a){a=a||Tt,Bn&&Bn(t,null);for(var r=e.length;r--;){var n=e[r];if(typeof n=="string"){var i=a(n);i!==n&&(sm(e)||(e[r]=i),n=i)}t[n]=!0}return t}function Oe(t){var e=um(null),a;for(a in t)At(rm,t,[a])&&(e[a]=t[a]);return e}function kt(t,e){for(;t!==null;){var a=dm(t,e);if(a){if(a.get)return ye(a.get);if(typeof a.value=="function")return ye(a.value)}t=lm(t)}function r(n){return console.warn("fallback value for",n),null}return r}var $n=he(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),jt=he(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ht=he(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),gm=he(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Kt=he(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),wm=he(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),qn=he(["#text"]),zn=he(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Gt=he(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Un=he(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Lt=he(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),vm=ke(/\{\{[\w\W]*|[\w\W]*\}\}/gm),bm=ke(/<%[\w\W]*|[\w\W]*%>/gm),ym=ke(/^data-[\-\w.\u00B7-\uFFFF]/),_m=ke(/^aria-[\-\w]+$/),km=ke(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Lm=ke(/^(?:\w+script|data):/i),Cm=ke(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Sm=ke(/^html$/i),xm=function(){return typeof window>"u"?null:window},Im=function(e,a){if(Ae(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,n="data-tt-policy-suffix";a.currentScript&&a.currentScript.hasAttribute(n)&&(r=a.currentScript.getAttribute(n));var i="dompurify"+(r?"#"+r:"");try{return e.createPolicy(i,{createHTML:function(m){return m},createScriptURL:function(m){return m}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function ja(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xm(),e=function(d){return ja(d)};if(e.version="2.4.0",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var a=t.document,r=t.document,n=t.DocumentFragment,i=t.HTMLTemplateElement,l=t.Node,m=t.Element,c=t.NodeFilter,h=t.NamedNodeMap,f=h===void 0?t.NamedNodeMap||t.MozNamedAttrMap:h,k=t.HTMLFormElement,w=t.DOMParser,C=t.trustedTypes,I=m.prototype,T=kt(I,"cloneNode"),P=kt(I,"nextSibling"),L=kt(I,"childNodes"),O=kt(I,"parentNode");if(typeof i=="function"){var E=r.createElement("template");E.content&&E.content.ownerDocument&&(r=E.content.ownerDocument)}var V=Im(C,a),q=V?V.createHTML(""):"",oe=r,ue=oe.implementation,M=oe.createNodeIterator,z=oe.createDocumentFragment,ae=oe.getElementsByTagName,we=a.importNode,me={};try{me=Oe(r).documentMode?r.documentMode:{}}catch{}var ee={};e.isSupported=typeof O=="function"&&ue&&typeof ue.createHTMLDocument<"u"&&me!==9;var xe=vm,$e=bm,Pt=ym,Mt=_m,pt=Lm,Ye=Cm,qe=km,W=null,ht=R({},[].concat(be($n),be(jt),be(Ht),be(Kt),be(qn))),X=null,ft=R({},[].concat(be(zn),be(Gt),be(Un),be(Lt))),j=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Re=null,Xe=null,gt=!0,N=!0,U=!1,Z=!1,te=!1,Ee=!1,Fe=!1,Ie=!1,ze=!1,ve=!1,Je=!0,et=!1,wt="user-content-",Ue=!0,tt=!1,je={},He=null,un=R({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),mn=null,cn=R({},["audio","video","img","source","image","track"]),Rt=null,pn=R({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Et="http://www.w3.org/1998/Math/MathML",Ft="http://www.w3.org/2000/svg",Te="http://www.w3.org/1999/xhtml",vt=Te,Ot=!1,Ke,Ya=["application/xhtml+xml","text/html"],Xa="text/html",ne,Ge=null,Ja=r.createElement("form"),hn=function(d){return d instanceof RegExp||d instanceof Function},Bt=function(d){Ge&&Ge===d||((!d||Ae(d)!=="object")&&(d={}),d=Oe(d),Ke=Ya.indexOf(d.PARSER_MEDIA_TYPE)===-1?Ke=Xa:Ke=d.PARSER_MEDIA_TYPE,ne=Ke==="application/xhtml+xml"?function(y){return y}:Tt,W="ALLOWED_TAGS"in d?R({},d.ALLOWED_TAGS,ne):ht,X="ALLOWED_ATTR"in d?R({},d.ALLOWED_ATTR,ne):ft,Rt="ADD_URI_SAFE_ATTR"in d?R(Oe(pn),d.ADD_URI_SAFE_ATTR,ne):pn,mn="ADD_DATA_URI_TAGS"in d?R(Oe(cn),d.ADD_DATA_URI_TAGS,ne):cn,He="FORBID_CONTENTS"in d?R({},d.FORBID_CONTENTS,ne):un,Re="FORBID_TAGS"in d?R({},d.FORBID_TAGS,ne):{},Xe="FORBID_ATTR"in d?R({},d.FORBID_ATTR,ne):{},je="USE_PROFILES"in d?d.USE_PROFILES:!1,gt=d.ALLOW_ARIA_ATTR!==!1,N=d.ALLOW_DATA_ATTR!==!1,U=d.ALLOW_UNKNOWN_PROTOCOLS||!1,Z=d.SAFE_FOR_TEMPLATES||!1,te=d.WHOLE_DOCUMENT||!1,Ie=d.RETURN_DOM||!1,ze=d.RETURN_DOM_FRAGMENT||!1,ve=d.RETURN_TRUSTED_TYPE||!1,Fe=d.FORCE_BODY||!1,Je=d.SANITIZE_DOM!==!1,et=d.SANITIZE_NAMED_PROPS||!1,Ue=d.KEEP_CONTENT!==!1,tt=d.IN_PLACE||!1,qe=d.ALLOWED_URI_REGEXP||qe,vt=d.NAMESPACE||Te,d.CUSTOM_ELEMENT_HANDLING&&hn(d.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(j.tagNameCheck=d.CUSTOM_ELEMENT_HANDLING.tagNameCheck),d.CUSTOM_ELEMENT_HANDLING&&hn(d.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(j.attributeNameCheck=d.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),d.CUSTOM_ELEMENT_HANDLING&&typeof d.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(j.allowCustomizedBuiltInElements=d.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Z&&(N=!1),ze&&(Ie=!0),je&&(W=R({},be(qn)),X=[],je.html===!0&&(R(W,$n),R(X,zn)),je.svg===!0&&(R(W,jt),R(X,Gt),R(X,Lt)),je.svgFilters===!0&&(R(W,Ht),R(X,Gt),R(X,Lt)),je.mathMl===!0&&(R(W,Kt),R(X,Un),R(X,Lt))),d.ADD_TAGS&&(W===ht&&(W=Oe(W)),R(W,d.ADD_TAGS,ne)),d.ADD_ATTR&&(X===ft&&(X=Oe(X)),R(X,d.ADD_ATTR,ne)),d.ADD_URI_SAFE_ATTR&&R(Rt,d.ADD_URI_SAFE_ATTR,ne),d.FORBID_CONTENTS&&(He===un&&(He=Oe(He)),R(He,d.FORBID_CONTENTS,ne)),Ue&&(W["#text"]=!0),te&&R(W,["html","head","body"]),W.table&&(R(W,["tbody"]),delete Re.tbody),he&&he(d),Ge=d)},fn=R({},["mi","mo","mn","ms","mtext"]),gn=R({},["foreignobject","desc","title","annotation-xml"]),ei=R({},["title","style","font","a","script"]),bt=R({},jt);R(bt,Ht),R(bt,gm);var Vt=R({},Kt);R(Vt,wm);var ti=function(d){var y=O(d);(!y||!y.tagName)&&(y={namespaceURI:Te,tagName:"template"});var S=Tt(d.tagName),$=Tt(y.tagName);return d.namespaceURI===Ft?y.namespaceURI===Te?S==="svg":y.namespaceURI===Et?S==="svg"&&($==="annotation-xml"||fn[$]):!!bt[S]:d.namespaceURI===Et?y.namespaceURI===Te?S==="math":y.namespaceURI===Ft?S==="math"&&gn[$]:!!Vt[S]:d.namespaceURI===Te?y.namespaceURI===Ft&&!gn[$]||y.namespaceURI===Et&&!fn[$]?!1:!Vt[S]&&(ei[S]||!bt[S]):!1},Le=function(d){at(e.removed,{element:d});try{d.parentNode.removeChild(d)}catch{try{d.outerHTML=q}catch{d.remove()}}},$t=function(d,y){try{at(e.removed,{attribute:y.getAttributeNode(d),from:y})}catch{at(e.removed,{attribute:null,from:y})}if(y.removeAttribute(d),d==="is"&&!X[d])if(Ie||ze)try{Le(y)}catch{}else try{y.setAttribute(d,"")}catch{}},wn=function(d){var y,S;if(Fe)d="<remove></remove>"+d;else{var $=cm(d,/^[\r\n\t ]+/);S=$&&$[0]}Ke==="application/xhtml+xml"&&(d='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+d+"</body></html>");var fe=V?V.createHTML(d):d;if(vt===Te)try{y=new w().parseFromString(fe,Ke)}catch{}if(!y||!y.documentElement){y=ue.createDocument(vt,"template",null);try{y.documentElement.innerHTML=Ot?"":fe}catch{}}var re=y.body||y.documentElement;return d&&S&&re.insertBefore(r.createTextNode(S),re.childNodes[0]||null),vt===Te?ae.call(y,te?"html":"body")[0]:te?y.documentElement:re},vn=function(d){return M.call(d.ownerDocument||d,d,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},ni=function(d){return d instanceof k&&(typeof d.nodeName!="string"||typeof d.textContent!="string"||typeof d.removeChild!="function"||!(d.attributes instanceof f)||typeof d.removeAttribute!="function"||typeof d.setAttribute!="function"||typeof d.namespaceURI!="string"||typeof d.insertBefore!="function")},nt=function(d){return Ae(l)==="object"?d instanceof l:d&&Ae(d)==="object"&&typeof d.nodeType=="number"&&typeof d.nodeName=="string"},Ce=function(d,y,S){ee[d]&&mm(ee[d],function($){$.call(e,y,S,Ge)})},bn=function(d){var y;if(Ce("beforeSanitizeElements",d,null),ni(d)||ce(/[\u0080-\uFFFF]/,d.nodeName))return Le(d),!0;var S=ne(d.nodeName);if(Ce("uponSanitizeElement",d,{tagName:S,allowedTags:W}),d.hasChildNodes()&&!nt(d.firstElementChild)&&(!nt(d.content)||!nt(d.content.firstElementChild))&&ce(/<[/\w]/g,d.innerHTML)&&ce(/<[/\w]/g,d.textContent)||S==="select"&&ce(/<template/i,d.innerHTML))return Le(d),!0;if(!W[S]||Re[S]){if(!Re[S]&&_n(S)&&(j.tagNameCheck instanceof RegExp&&ce(j.tagNameCheck,S)||j.tagNameCheck instanceof Function&&j.tagNameCheck(S)))return!1;if(Ue&&!He[S]){var $=O(d)||d.parentNode,fe=L(d)||d.childNodes;if(fe&&$)for(var re=fe.length,ie=re-1;ie>=0;--ie)$.insertBefore(T(fe[ie],!0),P(d))}return Le(d),!0}return d instanceof m&&!ti(d)||(S==="noscript"||S==="noembed")&&ce(/<\/no(script|embed)/i,d.innerHTML)?(Le(d),!0):(Z&&d.nodeType===3&&(y=d.textContent,y=Ne(y,xe," "),y=Ne(y,$e," "),d.textContent!==y&&(at(e.removed,{element:d.cloneNode()}),d.textContent=y)),Ce("afterSanitizeElements",d,null),!1)},yn=function(d,y,S){if(Je&&(y==="id"||y==="name")&&(S in r||S in Ja))return!1;if(!(N&&!Xe[y]&&ce(Pt,y))){if(!(gt&&ce(Mt,y))){if(!X[y]||Xe[y]){if(!(_n(d)&&(j.tagNameCheck instanceof RegExp&&ce(j.tagNameCheck,d)||j.tagNameCheck instanceof Function&&j.tagNameCheck(d))&&(j.attributeNameCheck instanceof RegExp&&ce(j.attributeNameCheck,y)||j.attributeNameCheck instanceof Function&&j.attributeNameCheck(y))||y==="is"&&j.allowCustomizedBuiltInElements&&(j.tagNameCheck instanceof RegExp&&ce(j.tagNameCheck,S)||j.tagNameCheck instanceof Function&&j.tagNameCheck(S))))return!1}else if(!Rt[y]){if(!ce(qe,Ne(S,Ye,""))){if(!((y==="src"||y==="xlink:href"||y==="href")&&d!=="script"&&pm(S,"data:")===0&&mn[d])){if(!(U&&!ce(pt,Ne(S,Ye,"")))){if(S)return!1}}}}}}return!0},_n=function(d){return d.indexOf("-")>0},kn=function(d){var y,S,$,fe;Ce("beforeSanitizeAttributes",d,null);var re=d.attributes;if(re){var ie={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:X};for(fe=re.length;fe--;){y=re[fe];var yt=y,se=yt.name,qt=yt.namespaceURI;if(S=se==="value"?y.value:hm(y.value),$=ne(se),ie.attrName=$,ie.attrValue=S,ie.keepAttr=!0,ie.forceKeepAttr=void 0,Ce("uponSanitizeAttribute",d,ie),S=ie.attrValue,!ie.forceKeepAttr&&($t(se,d),!!ie.keepAttr)){if(ce(/\/>/i,S)){$t(se,d);continue}Z&&(S=Ne(S,xe," "),S=Ne(S,$e," "));var Ln=ne(d.nodeName);if(yn(Ln,$,S)){if(et&&($==="id"||$==="name")&&($t(se,d),S=wt+S),V&&Ae(C)==="object"&&typeof C.getAttributeType=="function"&&!qt)switch(C.getAttributeType(Ln,$)){case"TrustedHTML":S=V.createHTML(S);break;case"TrustedScriptURL":S=V.createScriptURL(S);break}try{qt?d.setAttributeNS(qt,se,S):d.setAttribute(se,S),Vn(e.removed)}catch{}}}}Ce("afterSanitizeAttributes",d,null)}},ai=function A(d){var y,S=vn(d);for(Ce("beforeSanitizeShadowDOM",d,null);y=S.nextNode();)Ce("uponSanitizeShadowNode",y,null),!bn(y)&&(y.content instanceof n&&A(y.content),kn(y));Ce("afterSanitizeShadowDOM",d,null)};return e.sanitize=function(A){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y,S,$,fe,re;if(Ot=!A,Ot&&(A="<!-->"),typeof A!="string"&&!nt(A)){if(typeof A.toString!="function")throw Ut("toString is not a function");if(A=A.toString(),typeof A!="string")throw Ut("dirty is not a string, aborting")}if(!e.isSupported){if(Ae(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof A=="string")return t.toStaticHTML(A);if(nt(A))return t.toStaticHTML(A.outerHTML)}return A}if(Ee||Bt(d),e.removed=[],typeof A=="string"&&(tt=!1),tt){if(A.nodeName){var ie=ne(A.nodeName);if(!W[ie]||Re[ie])throw Ut("root node is forbidden and cannot be sanitized in-place")}}else if(A instanceof l)y=wn("<!---->"),S=y.ownerDocument.importNode(A,!0),S.nodeType===1&&S.nodeName==="BODY"||S.nodeName==="HTML"?y=S:y.appendChild(S);else{if(!Ie&&!Z&&!te&&A.indexOf("<")===-1)return V&&ve?V.createHTML(A):A;if(y=wn(A),!y)return Ie?null:ve?q:""}y&&Fe&&Le(y.firstChild);for(var yt=vn(tt?A:y);$=yt.nextNode();)$.nodeType===3&&$===fe||bn($)||($.content instanceof n&&ai($.content),kn($),fe=$);if(fe=null,tt)return A;if(Ie){if(ze)for(re=z.call(y.ownerDocument);y.firstChild;)re.appendChild(y.firstChild);else re=y;return X.shadowroot&&(re=we.call(a,re,!0)),re}var se=te?y.outerHTML:y.innerHTML;return te&&W["!doctype"]&&y.ownerDocument&&y.ownerDocument.doctype&&y.ownerDocument.doctype.name&&ce(Sm,y.ownerDocument.doctype.name)&&(se="<!DOCTYPE "+y.ownerDocument.doctype.name+`>
`+se),Z&&(se=Ne(se,xe," "),se=Ne(se,$e," ")),V&&ve?V.createHTML(se):se},e.setConfig=function(A){Bt(A),Ee=!0},e.clearConfig=function(){Ge=null,Ee=!1},e.isValidAttribute=function(A,d,y){Ge||Bt({});var S=ne(A),$=ne(d);return yn(S,$,y)},e.addHook=function(A,d){typeof d=="function"&&(ee[A]=ee[A]||[],at(ee[A],d))},e.removeHook=function(A){if(ee[A])return Vn(ee[A])},e.removeHooks=function(A){ee[A]&&(ee[A]=[])},e.removeAllHooks=function(){ee={}},e}var jn=ja();const Ha={name:"UpdateDetails",components:{KvSocialShareButton:Po},props:{body:{type:String,default:""},date:{type:String,default:""},subject:{type:String,default:""},index:{type:Number,default:1},imageUrl:{type:String,default:""}},data(){return{readMoreClicked:!1}},computed:{formattedJournalDate(){return st(Pe(this.date),"MMMM dd, yyyy")},truncateBody(){var e;return(((e=this.htmlSafeBody)==null?void 0:e.length)??0)>205},shortBody(){var t;return`${(t=this.htmlSafeBody)==null?void 0:t.substring(0,205)}... `},htmlSafeBody(){return jn.sanitize(this.body,{ALLOWED_TAGS:["b","i","em","strong","a","p","br","h1","h2","h3","h4"]})},shareMessage(){let t="";return this.subject&&(t+=`${this.subject} - `),t+=this.shortBody,jn.sanitize(t,{ALLOWED_TAGS:[]})}}},Tm={class:"tw-rounded tw-bg-primary tw-p-3 tw-mb-3"},Nm=["src"],Am={class:"tw-prose tw-pb-2"},Dm=["innerHTML"],Pm={key:0},Mm=["innerHTML"],Rm=["innerHTML"],Em={class:"tw-flex tw-justify-between tw-align-center tw-flex-wrap"},Fm={class:"tw-flex tw-items-center"},Om={class:"tw-flex tw-items-center tw-mt-2 md:tw-mt-0"},Bm={class:"tw-text-secondary"},Vm={class:"tw-text-secondary"};function $m(t,e,a,r,n,i){const l=g("kv-social-share-button"),m=de("kv-track-event");return s(),u("div",Tm,[a.imageUrl?(s(),u("img",{key:0,class:"tw-rounded tw-mb-2",src:a.imageUrl,alt:"photo of borrower"},null,8,Nm)):v("",!0),o("div",Am,[o("p",{innerHTML:a.subject},null,8,Dm),i.truncateBody&&!n.readMoreClicked?(s(),u("p",Pm,[o("span",{innerHTML:i.shortBody},null,8,Mm),F((s(),u("button",{class:"tw-text-link",onClick:e[0]||(e[0]=c=>n.readMoreClicked=!0)},e[1]||(e[1]=[D(" read more ")]))),[[De,i.truncateBody&&!n.readMoreClicked],[m,["borrower-profile","click","update-read-more"]]])])):(s(),u("p",{key:1,innerHTML:i.htmlSafeBody},null,8,Rm))]),o("div",null,[o("div",Em,[o("div",Fm,[p(l,{"modal-title":"Share this loan update","share-message":i.shareMessage,"share-url":t.$route.path+"#updates",variant:"link","utm-campaign":"social_share_update"},{default:_(()=>e[2]||(e[2]=[D(" Share this update ")]),void 0),_:1,__:[2]},8,["share-message","share-url"])]),o("div",Om,[o("span",Bm,"Update #"+b(a.index),1),e[3]||(e[3]=o("span",{class:"tw-text-secondary tw-px-1.5"},"•",-1)),o("span",Vm,b(i.formattedJournalDate),1)])])])])}const qm=B(Ha,[["render",$m]]);Ha.__docgenInfo={displayName:"UpdateDetails",exportName:"default",description:"",tags:{},props:[{name:"body",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"date",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"subject",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"index",type:{name:"number"},defaultValue:{func:!1,value:"1"}},{name:"imageUrl",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/UpdateDetails.vue"]};const Ka={name:"JournalUpdates",components:{KvButton:Ze,KvLoadingPlaceholder:ge,UpdateDetails:qm},inject:["apollo","cookieStore"],emits:["hide-section"],props:{loanId:{type:Number,default:0}},data(){return{observer:null,loading:!0,loanName:"",journals:[],itemQueryOffset:0,itemQueryLimit:3,totalItemCount:0}},computed:{sectionTitle(){return`Updates from ${this.loanName}`},firstLoading(){return this.loading&&this.journals.length===0},buttonState(){return this.loading?"loading":""}},methods:{createObserver(){this.observer=Me({targets:[this.$el],callback:t=>{t.forEach(e=>{if(e.target===this.$el&&e.intersectionRatio>0){if(this.journals.length)return!1;this.fetchItems()}})}}),this.observer||this.fetchItems()},destroyObserver(){this.observer&&this.observer.disconnect()},fetchItems(){if(this.loanId===0)return!1;this.loading=!0;const t={loanId:this.loanId,limit:this.itemQueryLimit,offset:this.itemQueryOffset};this.apollo.query({query:em,variables:t}).then(({data:e})=>{var a,r,n,i,l,m,c,h;this.loanName=((r=(a=e==null?void 0:e.lend)==null?void 0:a.loan)==null?void 0:r.name)??"",this.totalItemCount=((l=(i=(n=e==null?void 0:e.lend)==null?void 0:n.loan)==null?void 0:i.updates)==null?void 0:l.totalCount)??0,this.totalItemCount||this.$emit("hide-section"),this.journals=this.journals.concat(((h=(c=(m=e==null?void 0:e.lend)==null?void 0:m.loan)==null?void 0:c.updates)==null?void 0:h.values)??[]),this.loading=!1})},loadMore(){this.itemQueryOffset+=this.itemQueryLimit,this.fetchItems()}},mounted(){this.createObserver()},beforeUnmount(){this.destroyObserver()}},zm={id:"updates"},Um={class:"tw-text-h2 tw-mb-3","data-testid":"bp-updates-header"},jm={"data-testid":"bp-updates-section"},Hm={key:0,class:"tw-rounded tw-bg-primary tw-p-3 tw-mb-3"},Km={class:"tw-flex tw-justify-between tw-align-baseline"},Gm={key:1,class:"tw-mb-3 tw-text-center"};function Wm(t,e,a,r,n,i){const l=g("kv-loading-placeholder"),m=g("update-details"),c=g("kv-button");return s(),u("section",zm,[o("h2",Um,[D(b(i.sectionTitle)+" ",1),i.firstLoading?(s(),x(l,{key:0,class:"tw-inline-block tw-align-middle tw-mb-0.5",style:{width:"27%",height:"28px"}})):v("",!0)]),o("div",jm,[(s(!0),u(H,null,Y(n.journals,(h,f)=>(s(),x(m,{key:h.id,body:h.body,date:h.date,subject:h.subject,index:n.totalItemCount-f,"image-url":h.image?h.image.url:null},null,8,["body","date","subject","index","image-url"]))),128))]),n.loading?(s(),u("div",Hm,[p(l,{class:"tw-rounded tw-mb-2 tw-w-full",style:{height:"121px"}}),p(l,{class:"tw-mb-2",style:{height:"14px",width:"96%"}}),p(l,{class:"tw-mb-2",style:{height:"14px",width:"41%"}}),o("div",Km,[p(l,{class:"tw-mb-2",style:{height:"28px",width:"33%"}}),p(l,{class:"tw-mb-2",style:{height:"14px",width:"24%"}})])])):v("",!0),n.journals.length<n.totalItemCount?(s(),u("div",Gm,[p(c,{class:"tw-mb-3",onClick:i.loadMore,variant:"secondary",disabled:n.loading,state:i.buttonState,"aria-label":"See older updates"},{default:_(()=>e[0]||(e[0]=[D(" See older updates ")]),void 0),_:1,__:[0]},8,["onClick","disabled","state"])])):v("",!0)])}const Zm=B(Ka,[["render",Wm]]);Ka.__docgenInfo={displayName:"JournalUpdates",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},defaultValue:{func:!1,value:"0"}}],events:[{name:"hide-section"}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/JournalUpdates.vue"]};const Qm=""+new URL("associate-HRuRASJ4.png",import.meta.url).href,Ym=Object.freeze(Object.defineProperty({__proto__:null,default:Qm},Symbol.toStringTag,{value:"Module"})),Xm=""+new URL("photo_1-DY3A0CF3.jpg",import.meta.url).href,Jm=Object.freeze(Object.defineProperty({__proto__:null,default:Xm},Symbol.toStringTag,{value:"Module"})),ec=""+new URL("photo_2-CVi8BNbX.jpg",import.meta.url).href,tc=Object.freeze(Object.defineProperty({__proto__:null,default:ec},Symbol.toStringTag,{value:"Module"})),nc=""+new URL("associate-DSk3ujqU.png",import.meta.url).href,ac=Object.freeze(Object.defineProperty({__proto__:null,default:nc},Symbol.toStringTag,{value:"Module"})),ic=""+new URL("photo_1-Cz7VIiwB.jpg",import.meta.url).href,oc=Object.freeze(Object.defineProperty({__proto__:null,default:ic},Symbol.toStringTag,{value:"Module"})),rc=""+new URL("photo_2-Bn9aaxut.jpg",import.meta.url).href,sc=Object.freeze(Object.defineProperty({__proto__:null,default:rc},Symbol.toStringTag,{value:"Module"})),lc=""+new URL("associate-i-2YvouF.png",import.meta.url).href,dc=Object.freeze(Object.defineProperty({__proto__:null,default:lc},Symbol.toStringTag,{value:"Module"})),uc=""+new URL("photo_1-BTMIt-hv.jpg",import.meta.url).href,mc=Object.freeze(Object.defineProperty({__proto__:null,default:uc},Symbol.toStringTag,{value:"Module"})),cc=""+new URL("photo_2-C79WvJ2d.jpg",import.meta.url).href,pc=Object.freeze(Object.defineProperty({__proto__:null,default:cc},Symbol.toStringTag,{value:"Module"})),hc=""+new URL("associate-Y5cMHtLe.png",import.meta.url).href,fc=Object.freeze(Object.defineProperty({__proto__:null,default:hc},Symbol.toStringTag,{value:"Module"})),gc=""+new URL("photo_1-DdK5elWS.jpg",import.meta.url).href,wc=Object.freeze(Object.defineProperty({__proto__:null,default:gc},Symbol.toStringTag,{value:"Module"})),vc=""+new URL("photo_2-Sys5Ia0v.jpg",import.meta.url).href,bc=Object.freeze(Object.defineProperty({__proto__:null,default:vc},Symbol.toStringTag,{value:"Module"})),yc=Object.assign({"/src/assets/images/borrower-profile/education-placement/africa/associate.png":Ym,"/src/assets/images/borrower-profile/education-placement/africa/photo_1.jpg":Jm,"/src/assets/images/borrower-profile/education-placement/africa/photo_2.jpg":tc,"/src/assets/images/borrower-profile/education-placement/central-south-america/associate.png":ac,"/src/assets/images/borrower-profile/education-placement/central-south-america/photo_1.jpg":oc,"/src/assets/images/borrower-profile/education-placement/central-south-america/photo_2.jpg":sc,"/src/assets/images/borrower-profile/education-placement/europe-asia/associate.png":dc,"/src/assets/images/borrower-profile/education-placement/europe-asia/photo_1.jpg":mc,"/src/assets/images/borrower-profile/education-placement/europe-asia/photo_2.jpg":pc,"/src/assets/images/borrower-profile/education-placement/north-america/associate.png":fc,"/src/assets/images/borrower-profile/education-placement/north-america/photo_1.jpg":wc,"/src/assets/images/borrower-profile/education-placement/north-america/photo_2.jpg":bc}),_c=Mo(yc,"/src/assets/images/borrower-profile/education-placement/"),Ga={name:"BorrowerEducationPlacement",data(){return{leafHeartUrl:qi}},props:{loanRegion:{type:String,default:""}},methods:{getImage(t){return _c(t)},splitName(t){return t.split(",")[0]}},computed:{associateNameAndTitle(){const t=this.loanRegion.toLowerCase();return t==="africa"?"Manon, Investment Manager for Africa":t==="north america"?"Eli, Director of Kiva U.S.":["europe","asia"].includes(t)?"Kendra, Investment Director for Europe & Asia":"Patrick, Investment Manager for Latin America"},regionFolder(){const t=this.loanRegion.toLowerCase().replace(" ","-");return["europe","asia"].includes(t)?"europe-asia":["central-america","south-america"].includes(t)?"central-south-america":t},associateQuote(){const t=this.loanRegion.toLowerCase();return t==="africa"?"“Being able to visit to the communities we serve is invaluable. It not only allows us to witness Kiva's real-world impact in people's lives, but it also deepens our relationships with our partners and helps us to better understand the realities that borrowers face so that we can better serve them.“":t==="north america"?"“Kiva’s impact in the U.S. is built on the strong relationships we cultivate with community partners who champion borrowers and their businesses. The work we do on the Kiva US team to empower and support these partners forms the very foundation of our mission, enabling us to expand our reach and transform lives within these communities.”":["europe","asia"].includes(t)?"“Part of my team's focus is evaluating and monitoring the client protection practices that our Lending Partners have in place to ensure that borrowers’ rights are prioritized. We make sure borrowers only receive loans that they have the capacity to repay and are not subject to predatory lending practices, so that the only experience they have with their loan is a positive one.”":"“As Investment Managers, we work on finding innovative solutions that can scale our impact to more communities. For example, working with nontraditional partners to expand our reach to Venezuelan refugees, or creating a collaboration between smallholder farmers in Peru and a European foundation leveraging blockchain tools to help them access international markets.”"}}},kc={class:"tw-flex tw-items-center tw-gap-2 tw-mb-2"},Lc={class:"tw-h-10 tw-w-10"},Cc=["src"],Sc={class:"tw-text-h3"},xc={class:"tw-mb-4 tw-text-subhead"},Ic={id:"education-photos",class:"tw-mb-2"},Tc={class:"tw-flex tw-items-center tw-w-full tw-overflow-auto tw-gap-2.5"},Nc=["src","alt"],Ac=["src","alt"],Dc={class:"tw-flex tw-flex-col md:tw-flex-row tw-justify-center tw-gap-2 tw-bg-brand-100 tw-rounded tw-p-2 tw-mb-2"},Pc=["src"];function Mc(t,e,a,r,n,i){return s(),u("section",null,[e[0]||(e[0]=o("h2",{class:"tw-mb-2"}," How the Kiva team expands financial access ",-1)),e[1]||(e[1]=o("p",{class:"tw-mb-4"}," Kiva's global Investments team of 30+ employees oversees all lending partner relationships to ensure fair and trustworthy lending. ",-1)),o("div",kc,[o("div",Lc,[o("img",{src:i.getImage(`${i.regionFolder}/associate.png`),alt:"Manon, Investment Manager for Africa"},null,8,Cc)]),o("div",null,[o("p",Sc,b(i.associateNameAndTitle),1)])]),o("p",xc,b(i.associateQuote),1),o("div",Ic,[o("div",Tc,[o("img",{src:i.getImage(`${i.regionFolder}/photo_1.jpg`),alt:`Borrower photo from ${a.loanRegion}`},null,8,Nc),o("img",{src:i.getImage(`${i.regionFolder}/photo_2.jpg`),alt:`Borrower photo from ${a.loanRegion}`},null,8,Ac)])]),o("div",Dc,[o("img",{class:"tw-w-7 tw-h-7",src:n.leafHeartUrl,alt:"donation line item image"},null,8,Pc),o("p",null,"None of this work would be possible without donations from lenders like you. Thank you for continuing to support "+b(i.splitName(i.associateNameAndTitle))+" and the Kiva team! ",1)])])}const Rc=B(Ga,[["render",Mc],["__scopeId","data-v-7abae392"]]);Ga.__docgenInfo={displayName:"BorrowerEducationPlacement",exportName:"default",description:"",tags:{},props:[{name:"loanRegion",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/BorrowerEducationPlacement.vue"]};const Ec=`query LenderPublicProfile ($publicId: String!) {
	community {
		lender(publicId: $publicId) {
			id
			name
			loanCount
			memberSince
			image {
				id
				url(customSize: "w200h200")
				width
				height
			}
			seoImage: image {
				id
				url(customSize: "w90h360")
				width
				height
			}
			lenderPage {
				whereabouts
				occupation
				loanBecause
				otherInfo
				url
			}
		}
	}
}
`,Fc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"LenderPublicProfile"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"publicId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"community"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lender"},arguments:[{kind:"Argument",name:{kind:"Name",value:"publicId"},value:{kind:"Variable",name:{kind:"Name",value:"publicId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"loanCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"memberSince"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[{kind:"Argument",name:{kind:"Name",value:"customSize"},value:{kind:"StringValue",value:"w200h200",block:!1}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"seoImage"},name:{kind:"Name",value:"image"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[{kind:"Argument",name:{kind:"Name",value:"customSize"},value:{kind:"StringValue",value:"w90h360",block:!1}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"lenderPage"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"whereabouts"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"occupation"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"loanBecause"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"otherInfo"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:434,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Ec}}},Wa={name:"ChallengeTeamInvite",components:{KvUserAvatar:Ro,KvToast:Eo},props:{shareLender:{type:Object,default:()=>({})},teamName:{type:String,required:!0},teamId:{type:String,default:""}},data(){return{mdiArrowTopRight:la,mdiClose:oa}},computed:{shareLenderName(){var t;return((t=this.shareLender)==null?void 0:t.name)??""},shareLenderImage(){var t,e;return((e=(t=this.shareLender)==null?void 0:t.image)==null?void 0:e.url)??""},headerCallout(){return this.shareLenderName?`Support ${this.shareLenderName} and help `:"Help "},teamLink(){return`/lend/filter?team=${this.teamId??""}`}},methods:{closeCallback(){this.$kvTrackEvent("borrower-profile","click","close-invite-link")}},mounted(){this.$refs.toastRef.show("","",!0)}},Oc={class:"tw-w-full"},Bc={class:"tw-w-full tw-flex tw-gap-1 tw-items-center tw-justify-between"},Vc={class:"tw-text-lg data-hj-suppress"},$c=["href"];function qc(t,e,a,r,n,i){const l=g("kv-user-avatar"),m=g("kv-toast"),c=de("kv-track-event");return s(),x(m,{ref:"toastRef",class:"tw-fixed tw-top-9 md:tw-top-11 tw-left-0 tw-right-0 tw-z-banner toast-container tw-rounded-t-none md:tw-rounded-t",onClose:i.closeCallback},{toastContent:_(()=>[o("div",Oc,[o("div",Bc,[p(l,{"lender-name":i.shareLenderName,"lender-image-url":i.shareLenderImage,"is-small":"",class:"challenge-avatar md:tw-w-4 md:tw-h-4 tw-flex tw-items-center"},null,8,["lender-name","lender-image-url"]),o("p",Vc,[D(b(i.headerCallout)+" ",1),F((s(),u("a",{href:i.teamLink},[D(b(a.teamName),1)],8,$c)),[[c,["borrower-profile","click","invite-link",a.teamName]]]),e[0]||(e[0]=D(" hit their goal "))])])])]),_:1},8,["onClose"])}const zc=B(Wa,[["render",qc],["__scopeId","data-v-930ab945"]]);Wa.__docgenInfo={displayName:"ChallengeTeamInvite",exportName:"default",description:"",tags:{},props:[{name:"shareLender",type:{name:"object"},defaultValue:{func:!1,value:"{}"}},{name:"teamName",type:{name:"string"},required:!0},{name:"teamId",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/ChallengeTeamInvite.vue"]};const it=t=>{var e,a,r;return((e=t==null?void 0:t.query)==null?void 0:e.utm_content)??((a=t==null?void 0:t.query)==null?void 0:a.name)??((r=t==null?void 0:t.query)==null?void 0:r.lender)??""},Hn="education_placement_bp",Uc="filters_challenge_header",Kn=K`
	query borrowerProfileMeta(
		$loanId: Int!,
		$publicId: String!,
		$getInviter: Boolean!,
		$basketId: String,
		$imgDefaultSize: String = "w480h360",
		$imgRetinaSize: String = "w960h720"
	) {
		lend {
			loan(id: $loanId) {
				id
				borrowerCount
				name
				... on LoanDirect {
					businessName
				}
				geocode {
					city
					country {
						id
						name
						isoCode
						region
					}
				}
				image {
					id
					default: url(customSize: $imgDefaultSize)
					retina: url(customSize: $imgRetinaSize)
					hash
				}
				plannedExpirationDate
				lenders {
					totalCount
				}
				anonymizationLevel
				loanAmount
				status
				use
				fullLoanUse @client
				fundraisingPercent @client
				loanFundraisingInfo {
					id
					fundedAmount
					reservedAmount
				}
				inPfp
				pfpMinLenders
				gender
				sector {
					id
					name
				}
				userProperties {
					lentTo
				}
			}
		}
		community @include(if: $getInviter) {
			lender(publicId: $publicId) {
				id
				name
			}
		}
		shop(basketId: $basketId) {
			id
			basket {
				id
				items {
					values {
						id
					}
				}
			}
		}
	}
`,jc=K`
	query borrowerProfileMeta(
		$loanId: Int!,
	) {
		lend {
			loan(id: $loanId) {
				id
				...on LoanPartner {
					partnerName
					partner {
						id
						countries {
							id
							name
						}
					}
				}
			}
		}
		my {
			id
			userAccount {
				id
				inviterName
				public
			}
		}
	}
`,Za={name:"BorrowerProfile",inject:["apollo","cookieStore"],components:{BorrowerCountry:Ad,ContentContainer:nr,DetailsTabs:fd,HeroBackground:ia,KvLoadingPlaceholder:ge,FundedBorrowerProfile:xa,LendCta:Ns,LendersAndTeams:Xd,LoanStory:tl,JournalUpdates:Zm,MoreAboutLoan:Cu,SidebarContainer:or,ShareButton:Do,CommentsAndWhySpecial:Hu,SummaryCard:Qr,TopBannerPfp:Xu,WwwPage:pi,BorrowerEducationPlacement:Rc,ChallengeTeamInvite:zc},head(){var r,n;const t=this.anonymizationLevel==="full"?void 0:this.pageTitle,e=this.anonymizationLevel==="full"?void 0:this.pageDescription,a=(n=(r=this.$route.query)==null?void 0:r.utm_campaign)==null?void 0:n.includes("scle");return{title:t,meta:[{property:"og:title",vmid:"og:title",content:this.shareTitle},{property:"og:description",vmid:"og:description",content:this.shareDescription},{property:"og:type",vmid:"og:type",content:"kivadotorg:loan"},{property:"og:image",vmid:"og:image",content:this.imageShareUrl},{vmid:"description",name:"description",content:e}].concat(this.$appConfig.enableFB?[{vmid:"facebook_label",name:"facebook_label",content:this.facebookPageLabel}]:[]).concat([{name:"twitter:title",vmid:"twitter:title",content:this.shareTitle},{name:"twitter:image",vmid:"twitter:image",content:this.imageShareUrl},{name:"twitter:label1",vmid:"twitter:label1",content:"Supporters"},{name:"twitter:data1",vmid:"twitter:data1",content:this.numLenders},{name:"twitter:label2",vmid:"twitter:label2",content:"End Date"},{name:"twitter:data2",vmid:"twitter:data2",content:this.endDate},{name:"twitter:description",vmid:"twitter:description",content:this.shareDescription}]).concat(a?[{vmid:"robots",name:"robots",content:"noindex"}]:[]),link:a?[{vmid:"canonical",rel:"canonical",href:`https://${this.$appConfig.host}${this.$route.fullPath}`}]:[]}},data(){return{businessName:null,countryName:"",showLenders:!0,showTeams:!0,showUpdates:!0,hasThreeDaysOrLessLeft:!1,endDate:"",numLenders:0,name:"",hash:"",anonymizationLevel:"none",loanAmount:"0",status:"",fullLoanUse:"",loanFundraisingInfo:{},inviterName:"",inviterIsGuestOrAnonymous:!1,inPfp:!1,itemsInBasket:[],pfpMinLenders:0,diffInDays:0,lender:{},loan:{},partnerName:"",partnerCountry:"",isoCode:"",isMobile:!1,isLoading:!0,regionBelongsToExp:!1,showEducationPlacementExp:!1,loanRegion:"",expRegionList:["North America","Central America","South America","Africa","Asia","Europe"],enableChallengeHeader:!1,teamData:{},shareLender:void 0,hideChallengeCallout:!1}},mixins:[Jo,ci],apollo:{query:Kn,preFetch(t,e,{route:a,cookieStore:r}){var i;const n=it(a);return e.query({query:Kn,variables:{loanId:Number(((i=a==null?void 0:a.params)==null?void 0:i.id)??0),publicId:n,getInviter:!!n,basketId:r.get("kvbskt")}}).then(({data:l})=>{var w,C,I,T,P;const m=r.get("kvlendborrowerbeta");if(m==="a"||m==="c"){const{query:L={}}=a;return Promise.reject({path:`/lend-classic/${(w=a==null?void 0:a.params)==null?void 0:w.id}`,query:L})}const c=(C=l==null?void 0:l.lend)==null?void 0:C.loan,h=na.indexOf(c==null?void 0:c.status)!==-1;let f=c===null||c==="undefined"||!h;if((((I=c==null?void 0:c.userProperties)==null?void 0:I.lentTo)??!1)&&!f){const L=(c==null?void 0:c.loanAmount)??"0",O=((T=c==null?void 0:c.loanFundraisingInfo)==null?void 0:T.fundedAmount)??"0",E=Number(L)-Number(O),V=(c==null?void 0:c.status)!=="fundraising";f=!E||V}if(f){const{query:L={}}=a;return L.minimal=!1,Promise.reject({path:`/lend-classic/${Number(((P=a==null?void 0:a.params)==null?void 0:P.id)??0)}`,query:L})}return Promise.all([e.query({query:Wt,variables:{id:ua}}),e.query({query:Wt,variables:{id:Hn}})])})},preFetchVariables({route:t,cookieStore:e}){var r;const a=it(t);return{loanId:Number(((r=t==null?void 0:t.params)==null?void 0:r.id)??0),publicId:a,getInviter:!!a,basketId:e.get("kvbskt")}},variables(){var e,a;const t=it(this.$route);return{loanId:Number(((a=(e=this.$route)==null?void 0:e.params)==null?void 0:a.id)??0),publicId:t,getInviter:!!t,basketId:this.cookieStore.get("kvbskt")}},result(t){var a,r,n,i,l,m,c,h,f,k,w,C,I,T,P,L,O;const e=(r=(a=t==null?void 0:t.data)==null?void 0:a.lend)==null?void 0:r.loan;this.loan=e,this.inPfp=(e==null?void 0:e.inPfp)??!1,this.pfpMinLenders=(e==null?void 0:e.pfpMinLenders)??0,this.businessName=(e==null?void 0:e.businessName)??"",this.name=(e==null?void 0:e.name)??"",this.countryName=((i=(n=e==null?void 0:e.geocode)==null?void 0:n.country)==null?void 0:i.name)??"",this.hash=((l=e==null?void 0:e.image)==null?void 0:l.hash)??"",this.numLenders=((m=e==null?void 0:e.lenders)==null?void 0:m.totalCount)??0,this.endDate=e!=null&&e.plannedExpirationDate?st(Pe(e==null?void 0:e.plannedExpirationDate),"M/d"):"",this.anonymizationLevel=(e==null?void 0:e.anonymizationLevel)??"none",this.loanAmount=(e==null?void 0:e.loanAmount)??"0",this.status=(e==null?void 0:e.status)??"",this.fullLoanUse=(e==null?void 0:e.fullLoanUse)??"",this.loanFundraisingInfo=(e==null?void 0:e.loanFundraisingInfo)??{},this.inviterName=this.inviterIsGuestOrAnonymous?"":((f=(h=(c=t==null?void 0:t.data)==null?void 0:c.community)==null?void 0:h.lender)==null?void 0:f.name)??"",this.itemsInBasket=((I=(C=(w=(k=t==null?void 0:t.data)==null?void 0:k.shop)==null?void 0:w.basket)==null?void 0:C.items)==null?void 0:I.values)??[],this.diffInDays=yo(Pe(e==null?void 0:e.plannedExpirationDate),new Date),this.hasThreeDaysOrLessLeft=this.diffInDays<=3,this.isoCode=((P=(T=e==null?void 0:e.geocode)==null?void 0:T.country)==null?void 0:P.isoCode)??"",this.loanRegion=((O=(L=e==null?void 0:e.geocode)==null?void 0:L.country)==null?void 0:O.region)??"",this.regionBelongsToExp=this.expRegionList.includes(this.loanRegion)}},async mounted(){var n,i,l,m,c,h,f,k,w,C,I,T,P;const t=this.cookieStore.get("kvlendborrowerbeta");t==="b"&&this.$kvTrackEvent("Borrower Profile","EXP-GROW-655-Aug2021",t);const{data:e}=await this.apollo.query({query:jc,variables:{loanId:this.loanId}}),a=(n=e==null?void 0:e.lend)==null?void 0:n.loan;this.partnerName=(a==null?void 0:a.partnerName)??"",this.partnerCountry=((l=(i=a==null?void 0:a.partner)==null?void 0:i.countries[0])==null?void 0:l.name)??"",this.lender=((m=e==null?void 0:e.my)==null?void 0:m.userAccount)??{},this.regionBelongsToExp&&en(this.apollo,this.$kvTrackEvent,"borrower-profile",Hn,"EXP-MARS-514-DEC2023 ").version==="b"&&(this.showEducationPlacementExp=!0);const r=this.apollo.readFragment({id:`Experiment:${Uc}`,fragment:Yi})||{};if(this.enableChallengeHeader=(r==null?void 0:r.version)==="b",this.enableChallengeHeader){const L=((h=(c=this.$route)==null?void 0:c.query)==null?void 0:h.team)??"";let O=null;if(L){const E=await this.apollo.query({query:Sn,variables:{team_public_id:L}});O=((w=(k=(f=E==null?void 0:E.data)==null?void 0:f.community)==null?void 0:k.team)==null?void 0:w.id)??null}if(O){const E=await this.apollo.query({query:Sn,variables:{team_id:O}});this.teamData=((I=(C=E==null?void 0:E.data)==null?void 0:C.community)==null?void 0:I.team)||{};const V=it(this.$route),q=await this.apollo.query({query:Fc,variables:{publicId:V}});this.shareLender=((P=(T=q==null?void 0:q.data)==null?void 0:T.community)==null?void 0:P.lender)??{}}}this.determineIfMobile(),window.addEventListener("resize",lt(()=>{this.determineIfMobile()},200)),this.isLoading=!1},methods:{determineIfMobile(){this.isMobile=document.documentElement.clientWidth<735}},beforeUnmount(){window.removeEventListener("resize",lt(()=>{this.determineIfMobile()},200))},computed:{shareCampaign(){return this.inPfp?"social_share_bp_pfp":"social_share_bp"},loanId(){return Number(this.$route.params.id||0)},imageShareUrl(){return this.hash?To({height:630,width:1200,base:this.$appConfig.photoPath,hash:this.hash}):""},facebookPageLabel(){return`Kiva - ${this.facebookPageTitle}`},facebookPageTitle(){let t=this.name;return this.businessName&&(t=`${t}, ${this.businessName}`),`${t} - ${this.countryName}`},amountLeft(){return this.loanAmount-this.loanFundraisingInfo.fundedAmount},pageTitle(){return`Lend to ${this.name} in ${this.countryName}`},pageDescription(){return this.fullLoanUse},shareTitle(){return this.anonymizationLevel==="full"?"Can you help support this loan?":this.inviterName===""||this.$route.query.share==="true"?`Can you help support ${this.name}?`:`Can you help ${this.inviterName} support ${this.name}?`},shareDescription(){return"Kiva is a loan, not a donation. With Kiva you can lend as little as $25 and make a big change in someone's life."},showFundraising(){return this.amountLeft&&this.status==="fundraising"},loanType(){var t;return((t=this.loan)==null?void 0:t.__typename)==="LoanDirect"?"direct-loan":"partner-loan"},shareBtnVariant(){return this.isMobile?"secondary":"caution"},showChallengeCallout(){return this.enableChallengeHeader&&Object.keys(this.teamData).length&&!this.hideChallengeCallout}},created(){const t=it(this.$route);this.inviterIsGuestOrAnonymous=t==="anonymous"||t==="guest",this.initializeFiveDollarsNotes(),this.loanType==="direct-loan"&&ui("us_borrower_profile")}},Hc={key:1,class:"tw-relative tw-bg-secondary"},Kc={class:"tw-relative"},Gc={class:"tw-absolute tw-top-0 tw-h-full tw-w-full tw-overflow-hidden"},Wc={class:"tw-bg-primary tw-mb-5 md:tw-mb-6 lg:tw-mb-8",id:"bp-comments-jump-link"},Zc={class:"tw-bg-primary"},Qc={key:2};function Yc(t,e,a,r,n,i){const l=g("challenge-team-invite"),m=g("hero-background"),c=g("top-banner-pfp"),h=g("summary-card"),f=g("content-container"),k=g("kv-loading-placeholder"),w=g("share-button"),C=g("lend-cta"),I=g("sidebar-container"),T=g("loan-story"),P=g("journal-updates"),L=g("comments-and-why-special"),O=g("borrower-education-placement"),E=g("more-about-loan"),V=g("borrower-country"),q=g("lenders-and-teams"),oe=g("details-tabs"),ue=g("FundedBorrowerProfile"),M=g("www-page");return s(),x(M,{id:"borrower-profile","data-testid":i.loanType},{default:_(()=>[i.showChallengeCallout?(s(),x(l,{key:0,class:"tw-absolute tw-mx-auto tw-w-full tw-z-5","share-lender":n.shareLender,"team-name":n.teamData.name,"team-id":n.teamData.teamPublicId,onClose:e[0]||(e[0]=z=>n.hideChallengeCallout=!0)},null,8,["share-lender","team-name","team-id"])):v("",!0),i.showFundraising?(s(),u("article",Hc,[o("div",Kc,[o("div",Gc,[p(m)]),n.inPfp?(s(),x(c,{key:0,class:"tw-relative","lenders-needed":n.pfpMinLenders,"borrower-name":n.name,"days-left":n.diffInDays},null,8,["lenders-needed","borrower-name","days-left"])):v("",!0),p(f,{class:Q([[n.inPfp?"lg:tw-pt-3":"lg:tw-pt-8"],"md:tw-pt-6"])},{default:_(()=>[p(h,{"data-testid":"bp-summary",class:"tw-relative lg:tw--mb-1.5"})],void 0,!0),_:1},8,["class"])]),o("div",{class:Q([n.inPfp?"lg:tw-pt-16":"lg:tw-pt-8","lg:tw-absolute tw-pointer-events-none lg:tw-w-full lg:tw-h-full lg:tw-top-0 tw-z-docked"])},[p(I,{class:"lg:tw-sticky lg:tw-mt-10 lg:tw-pb-8 lg:tw-top-12"},{default:_(()=>[p(C,{class:"tw-pointer-events-auto","loan-id":i.loanId,"enable-five-dollars-notes":t.enableFiveDollarsNotes,"team-data":n.teamData},{sharebutton:_(()=>[n.isLoading?(s(),x(k,{key:0,style:{height:"2rem",width:"100%"}})):(s(),x(w,{key:1,class:"tw-block lg:tw-mb-1.5",loan:n.loan,variant:i.shareBtnVariant,lender:n.lender,campaign:i.shareCampaign,"in-pfp":n.inPfp,"pfp-min-lenders":n.pfpMinLenders,"num-lenders":n.numLenders},null,8,["loan","variant","lender","campaign","in-pfp","pfp-min-lenders","num-lenders"]))]),_:1},8,["loan-id","enable-five-dollars-notes","team-data"])],void 0,!0),_:1})],2),p(f,{class:"tw-mt-4 md:tw-mt-6 lg:tw-mt-8"},{default:_(()=>[p(T,{id:"loanStory","data-testid":"bp-loan-story",class:"tw-mb-5 md:tw-mb-6 lg:tw-mb-8 tw-z-1","loan-id":i.loanId},null,8,["loan-id"])],void 0,!0),_:1}),p(f,null,{default:_(()=>[n.showUpdates?(s(),x(P,{key:0,"data-testid":"bp-updates",class:"tw-mb-5 md:tw-mb-6 lg:tw-mb-8","loan-id":i.loanId,onHideSection:e[1]||(e[1]=z=>n.showUpdates=!1)},null,8,["loan-id"])):v("",!0)],void 0,!0),_:1}),o("div",Wc,[p(f,null,{default:_(()=>[p(L,{"data-testid":"bp-comments","loan-id":i.loanId,"is-logged-in":!!n.lender.id},null,8,["loan-id","is-logged-in"])],void 0,!0),_:1})]),n.showEducationPlacementExp?(s(),x(f,{key:0},{default:_(()=>[p(O,{"data-testid":"bp-education","loan-region":n.loanRegion},null,8,["loan-region"])],void 0,!0),_:1})):v("",!0),p(f,null,{default:_(()=>[p(E,{"data-testid":"bp-more-about",class:"tw-mb-5 md:tw-mb-6 lg:tw-mb-8","loan-id":i.loanId},null,8,["loan-id"]),p(V,{"data-testid":"bp-country",class:"tw-mb-5 md:tw-mb-6 lg:tw-mb-8","loan-id":i.loanId},null,8,["loan-id"]),n.showLenders?(s(),x(q,{"data-testid":"bp-lenders",key:"lenders",class:"tw-mb-5 md:tw-mb-6 lg:tw-mb-8","loan-id":i.loanId,"display-type":"lenders",onHideSection:e[2]||(e[2]=z=>n.showLenders=!1)},null,8,["loan-id"])):v("",!0),n.showTeams?(s(),x(q,{"data-testid":"bp-teams",key:"teams",class:"tw-mb-5 md:tw-mb-6 lg:tw-mb-8","loan-id":i.loanId,"display-type":"teams",onHideSection:e[3]||(e[3]=z=>n.showTeams=!1)},null,8,["loan-id"])):v("",!0)],void 0,!0),_:1}),o("div",Zc,[p(f,null,{default:_(()=>[p(oe,{id:"loanDetails","loan-id":i.loanId,name:"bp-details"},null,8,["loan-id"])],void 0,!0),_:1})])])):(s(),u("article",Qc,[p(ue,{loan:n.loan,hash:n.hash,"items-in-basket":n.itemsInBasket,"inviter-name":n.inviterName},null,8,["loan","hash","items-in-basket","inviter-name"])]))],void 0),_:1},8,["data-testid"])}const dn=B(Za,[["render",Yc]]);Za.__docgenInfo={displayName:"BorrowerProfile",exportName:"default",description:"",tags:{},sourceFiles:["/home/runner/work/ui/ui/src/pages/BorrowerProfile/BorrowerProfile.vue"]};const Se=Fo(3),Qa={data:{lend:{loan:Se[0]},fundraisingLoans:{values:[{id:2413188},{id:2411288},{id:2406410},{id:2406459},{id:2406956},{id:2408858}]},ml:{relatedLoansByTopics:[{values:[Se[0],Se[0],Se[0],Se[0],Se[0]]}]}}},Xc={data:{lend:{loan:{...Se[1],inPfp:!0,pfpMinLenders:700}}}},pf={title:"Page/Borrower Profile",component:dn,parameters:{layout:"fullscreen"}},Ct=()=>({components:{BorrowerProfile:dn},parameters:{layout:"fullscreen"},mixins:[on({queryResult:Qa}),rn(),sn],template:"<borrower-profile />"}),St=(t,{argTypes:e})=>({props:Object.keys(e),components:{FundedBorrowerProfile:xa},parameters:{layout:"fullscreen"},mixins:[on({queryResult:Qa}),rn(),sn],setup(){return{loan:Se[0],hash:Se[0].image.hash}},template:'<funded-borrower-profile :loan="loan" :hash="hash" />'}),xt=()=>({components:{BorrowerProfile:dn},parameters:{layout:"fullscreen"},mixins:[on({queryResult:Xc}),rn(),sn],template:"<borrower-profile />"});var Gn,Wn,Zn;Ct.parameters={...Ct.parameters,docs:{...(Gn=Ct.parameters)==null?void 0:Gn.docs,source:{originalSource:`() => ({
  components: {
    BorrowerProfile
  },
  parameters: {
    layout: 'fullscreen'
  },
  mixins: [apolloStoryMixin({
    queryResult
  }), cookieStoreStoryMixin(), kvAuth0StoryMixin],
  template: \`<borrower-profile />\`
})`,...(Zn=(Wn=Ct.parameters)==null?void 0:Wn.docs)==null?void 0:Zn.source}}};var Qn,Yn,Xn;St.parameters={...St.parameters,docs:{...(Qn=St.parameters)==null?void 0:Qn.docs,source:{originalSource:`(_, {
  argTypes
}) => ({
  props: Object.keys(argTypes),
  components: {
    FundedBorrowerProfile
  },
  parameters: {
    layout: 'fullscreen'
  },
  mixins: [apolloStoryMixin({
    queryResult
  }), cookieStoreStoryMixin(), kvAuth0StoryMixin],
  setup() {
    return {
      loan: mockLoans[0],
      hash: mockLoans[0].image.hash
    };
  },
  template: \`<funded-borrower-profile :loan="loan" :hash="hash" />\`
})`,...(Xn=(Yn=St.parameters)==null?void 0:Yn.docs)==null?void 0:Xn.source}}};var Jn,ea,ta;xt.parameters={...xt.parameters,docs:{...(Jn=xt.parameters)==null?void 0:Jn.docs,source:{originalSource:`() => ({
  components: {
    BorrowerProfile
  },
  parameters: {
    layout: 'fullscreen'
  },
  mixins: [apolloStoryMixin({
    queryResult: queryResultPfp
  }), cookieStoreStoryMixin(), kvAuth0StoryMixin],
  template: \`<borrower-profile />\`
})`,...(ta=(ea=xt.parameters)==null?void 0:ea.docs)==null?void 0:ta.source}}};const hf=["Default","Funded","PrivateFundraisingPeriod"];export{Ct as Default,St as Funded,xt as PrivateFundraisingPeriod,hf as __namedExportsOrder,pf as default};
