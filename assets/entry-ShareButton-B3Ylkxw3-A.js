import{g as d}from"./entry-numeral-DJCTM12wUX.js";import{f as c}from"./entry-mdi-BJHOrBfjV3.js";import{K as f}from"./entry-KvSocialShareButton-7rHfWlFtkv.js";import{f as p,b as g,r as i,o as y,e as s,F as b,a as v,N as w}from"./entry-vue.esm-bundler-Bf_Yeyugwo.js";import{w as P}from"./entry-KvMaterialIcon-DcajXwg-0j.js";import"./entry-KvWwwHeader-CVdIzOPj6Q.js";import{_ as L}from"./entry-_plugin-vue_export-helper-DlAUqK2UKH.js";const l={name:"ShareButton",components:{KvSocialShareButton:f,KvMaterialIcon:P},data(){return{modifiedShareMessage:"",mdiPencilOutline:c,borrowedLoanId:null}},inject:["apollo","cookieStore"],emits:["lightbox-closed"],props:{lender:{type:Object,default:()=>{}},loan:{type:Object,required:!0},campaign:{type:String,required:!0},inPfp:{type:Boolean,default:!1},pfpMinLenders:{type:Number,default:1},numLenders:{type:Number,default:0},variant:{type:String,default:"caution"},openLightbox:{type:Boolean,default:!1},isPortfolio:{type:Boolean,default:!1}},created(){var t,r;const e=this.apollo.readQuery({query:d`
				query mostRecentBorrowedLoan {
					my {
						id
						mostRecentBorrowedLoan {
							id
						}
					}
				}
			`});this.borrowedLoanId=((r=(t=e==null?void 0:e.my)==null?void 0:t.mostRecentBorrowedLoan)==null?void 0:r.id)??null,this.modifiedShareMessage=this.shareMessage},computed:{progressPfpPercent(){const e=this.numLenders/this.pfpMinLenders;return Math.round(e*100)},progressPercent(){var t;const e=((t=this.loan)==null?void 0:t.fundraisingPercent)??0;return Math.round(e*100)},amountRemaining(){var e,t,r;return`$${(((e=this.loan)==null?void 0:e.loanAmount)??0)-(((r=(t=this.loan)==null?void 0:t.loanFundraisingInfo)==null?void 0:r.fundedAmount)??0)}`},isBorrower(){var e;return((e=this.loan)==null?void 0:e.id)===this.borrowedLoanId||this.$route.query.share==="true"},modalTitle(){return this.isPortfolio?`Share ${this.name}'s story`:this.isBorrower?this.inPfp?this.progressPfpPercent>=50?"You’re almost there":"Set a goal for today":this.progressPercent>=50?"You’re almost there":"Set a goal for today":this.inPfp?this.progressPfpPercent>=50?"Push this loan into public fundraising!":`Get ${this.name}'s loan back on track`:this.progressPercent>=50?"Push this loan over the finish line!":`Get ${this.name}'s loan back on track`},name(){return this.loan.name&&this.loan.anonymization!=="full"?this.loan.name:"this lender"},shareMessage(){if(this.isPortfolio)return`I’m proud to have lent to ${this.name}. Learn more about their story.`;const e=this.pfpMinLenders-this.numLenders,t=e===1?"lender":"lenders",r=this.numLenders+3<=this.pfpMinLenders?this.numLenders+3:this.pfpMinLenders;if(this.isBorrower)return this.inPfp?this.progressPfpPercent>=50?`Join me in reaching my goal on Kiva with only ${e} ${t} left to go! Your support can help me grow my business and achieve my dreams.`:`Help me reach ${r} lenders on my 0% interest Kiva loan today! Your support can make a big difference in my business.`:this.progressPercent>=50?`My fundraiser on Kiva is over halfway there — only ${this.amountRemaining} to go!`:`I'm crowdfunding a loan on Kiva — Help me hit ${this.progressPercent+10}% today!`;const o=this.$filters.changeCase(this.name,"titleCase");return this.inPfp?this.progressPfpPercent>=50?`Help ${o} reach their goal – only ${e} ${t} to go!`:`Join me in supporting ${o} on Kiva! Let's help them reach their dream by getting 3 more lenders today.`:this.progressPercent>=50?`${o}'s loan is over halfway there on Kiva – only ${this.amountRemaining} to go!`:`${o} is crowdfunding a loan on Kiva — Let's get them to ${this.progressPercent+10}% today!`},utmContent(){var e,t;return(e=this.lender)!=null&&e.public&&((t=this.lender)!=null&&t.inviterName)?this.lender.inviterName:"anonymous"},utmCampaign(){return this.$route.query.emlid?`${this.campaign}_eml${this.$route.query.emlid}`:this.campaign},shareLink(){var e;return this.loan.id&&((e=this.lender)!=null&&e.inviterName)?`/invitedby/${this.lender.inviterName}/for/${this.loan.id}`:`${this.$route.path}`},forceLightbox(){return this.$route.query.share==="true"||this.openLightbox}},methods:{closeLightbox(){this.$emit("lightbox-closed")}}},x={class:"tw-relative"};function _(e,t,r,o,a,n){const u=i("kv-material-icon"),m=i("kv-social-share-button");return y(),p(m,{"modal-title":n.modalTitle,"share-message":a.modifiedShareMessage,"share-url":n.shareLink,variant:r.variant,"utm-campaign":n.utmCampaign,"utm-content":n.utmContent,"open-lightbox":n.forceLightbox,"loan-id":r.loan.id,"tracking-category":r.isPortfolio?"portfolio":"borrower-profile",onLightboxClosed:n.closeLightbox},{"modal-content":g(()=>[s("div",x,[b(s("textarea",{class:"tw-w-full tw-border tw-border-tertiary tw-rounded-xs tw-h-12 tw-p-2",style:{height:"10rem"},"onUpdate:modelValue":t[0]||(t[0]=h=>a.modifiedShareMessage=h)},"				",512),[[w,a.modifiedShareMessage]]),v(u,{class:"tw-w-2.5 tw-h-2.5 tw-absolute tw-bottom-2 tw-right-2",icon:a.mdiPencilOutline},null,8,["icon"])])]),_:1},8,["modal-title","share-message","share-url","variant","utm-campaign","utm-content","open-lightbox","loan-id","tracking-category","onLightboxClosed"])}const C=L(l,[["render",_]]);l.__docgenInfo={displayName:"ShareButton",exportName:"default",description:"",tags:{},props:[{name:"lender",type:{name:"object"},defaultValue:{func:!0,value:"() => {}"}},{name:"loan",type:{name:"object"},required:!0},{name:"campaign",type:{name:"string"},required:!0},{name:"inPfp",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"pfpMinLenders",type:{name:"number"},defaultValue:{func:!1,value:"1"}},{name:"numLenders",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"variant",type:{name:"string"},defaultValue:{func:!1,value:"'caution'"}},{name:"openLightbox",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"isPortfolio",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],events:[{name:"lightbox-closed"}],sourceFiles:["/home/runner/work/ui/ui/src/components/BorrowerProfile/ShareButton.vue"]};export{C as S};
