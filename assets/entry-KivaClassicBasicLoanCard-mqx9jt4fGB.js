import{n as F,g as z}from"./entry-numeral-DJCTM12wUX.js";import{r as j,k as H,F as P}from"./entry-mdi-BJHOrBfjV3.js";import{r as X,a as q,b as E}from"./entry-loanUtils-5D9a5yj3H7.js";import{c as O}from"./entry-observerUtils-DveHpw6JZJ.js";import{p as W,t as G}from"./entry-time-left-mixin-BgOgttSZrl.js";import{B as J}from"./entry-BorrowerImage-WXGsRE2huI.js";import{S as Y,B as Z}from"./entry-SummaryTag-BL5nRGkmuD.js";import{K as $}from"./entry-KvLoadingParagraph-B1vku9KEXS.js";import{c as m,e as p,a as f,K as g,r as d,o as s,f as r,d as o,F as w,P as ee,b as c,x as y,J as h,H as L,g as te}from"./entry-vue.esm-bundler-Bf_Yeyugwo.js";import"./entry-KvWwwHeader-CVdIzOPj6Q.js";import{q as ne}from"./entry-KvProgressBar-CQtXD0YVwH.js";import{_ as N}from"./entry-_plugin-vue_export-helper-DlAUqK2UKH.js";import{s as ae,h as ie,a as se}from"./entry-injectionCheck-B-GzsW2qm5.js";import{A as oe}from"./entry-ActionButton-DBlbdMcglY.js";import{L as re}from"./entry-LoanTag-ByD8VlFF-R.js";import{w as le}from"./entry-KvMaterialIcon-DcajXwg-0j.js";import{_ as de}from"./entry-KvLoadingPlaceholder-DUZzoT9CoU.js";import{U as ue}from"./entry-KvButton-DF0Vhz1EWA.js";import{K as me}from"./entry-KvTextLink-CFK6VYUYhK.js";import{w as ce,a as he}from"./entry-exports-CudK1O5XNw.js";const x={name:"LoanProgressGroup",components:{KvProgressBar:ne},props:{moneyLeft:{type:String,default:"0.00"},progressPercent:{type:Number,default:0},timeLeft:{type:String,default:""}},computed:{numeralLeft(){return F(this.moneyLeft)},fundingText(){const e=this.numeralLeft.format("$0,0[.]00"),t=`${this.timeLeft!==""?`. ${this.timeLeft}`:""}`,a=t.includes("!")?"":"!";return this.numeralLeft.value()?`${e} to go${t}${a}`:"Funded!"}}},fe={class:"tw-mb-0.5"};function ge(e,t,a,u,i,n){const l=d("kv-progress-bar");return s(),m("figure",null,[p("h4",fe,g(n.fundingText),1),f(l,{class:"tw-mb-1.5 lg:tw-mb-1","aria-label":"Percent the loan has funded",value:a.progressPercent*100},null,8,["value"])])}const ke=N(x,[["render",ge]]);x.__docgenInfo={displayName:"LoanProgressGroup",exportName:"default",description:"",tags:{},props:[{name:"moneyLeft",type:{name:"string"},defaultValue:{func:!1,value:"'0.00'"}},{name:"progressPercent",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"timeLeft",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/LoanCards/LoanProgressGroup.vue"]};const ve="data:image/png;base64,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",B={name:"LoanMatchingText",props:{matcherName:{type:String,default:""},matchRatio:{type:Number,default:0},status:{type:String,default:""},fundedAmount:{type:String,default:""},reservedAmount:{type:String,default:""},loanAmount:{type:String,default:""}},data(){return{partyEmoji:ve}},computed:{amountLeft(){return this.loanAmount-this.fundedAmount-this.reservedAmount},isFunded(){return this.status==="funded"},isExpired(){return this.status==="expired"},isBasketedByAnotherUser(){return this.amountLeft<=0&&!this.isFunded},constructedMatchingText(){return this.isFunded||this.isBasketedByAnotherUser||this.isExpired?"":`${this.matchRatio+1}x matching by ${this.matcherName}`}}},we={class:"tw-flex tw-items-center"},ye={class:"tw-text-h4 tw-mr-1 tw-text-center tw-h-3 tw-w-3 tw-rounded-full tw-bg-brand-100",style:{border:"1px solid #2AA967"}},pe=["src"],be={class:"tw-inline-block"};function Ae(e,t,a,u,i,n){return s(),m("span",we,[p("span",ye,[p("img",{src:i.partyEmoji,alt:"matching icon",class:"tw-m-auto",style:{padding:"4px 0 2px 0",height:"1.2rem"}},null,8,pe)]),p("h4",be,g(n.constructedMatchingText),1)])}const Le=N(B,[["render",Ae]]);B.__docgenInfo={displayName:"LoanMatchingText",exportName:"default",description:"",tags:{},props:[{name:"matcherName",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"matchRatio",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"status",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"fundedAmount",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"reservedAmount",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"loanAmount",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/LoanCards/LoanMatchingText.vue"]};const Ne=`fragment loanCardFields on LoanBasic {
	id
	distributionModel
	status
	name
	borrowerCount
	geocode {
		# city added for DetailedLoanCard Query Cache
		city
		# state is used for US loans on LoanChannelCategoryPage
		state
		country {
			id
			isoCode
			name
			region
		}
	}
	use
	activity {
		id
		name
	}
	sector {
		id
		name
	}
	tags
	whySpecial
	lenderRepaymentTerm
	loanAmount
	minNoteSize
	loanFundraisingInfo {
		id
		fundedAmount
		reservedAmount
		isExpiringSoon
	}
	plannedExpirationDate
	matchingText
	matchRatio
	isMatchable
	userProperties {
		favorited
		lentTo
	}

	image {
		id
		hash
	}

	# for fullLoanUse, along with use, borrowerCount, status, name, loanAmount
	anonymizationLevel
	fullLoanUse @client

	# lenders added for DetailedLoanCard Query Cache
	lenders(limit: 0) {
		totalCount
	}
	... on LoanPartner {
		partnerName
		themes
	}
	...on LoanDirect {
		trusteeName
	}
}
`,I={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"loanCardFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LoanBasic"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"distributionModel"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"borrowerCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"geocode"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"city"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"country"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isoCode"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"region"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"use"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sector"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"tags"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"whySpecial"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lenderRepaymentTerm"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"loanAmount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"minNoteSize"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"loanFundraisingInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fundedAmount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reservedAmount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isExpiringSoon"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"plannedExpirationDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"matchingText"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"matchRatio"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isMatchable"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userProperties"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"favorited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lentTo"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hash"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"anonymizationLevel"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullLoanUse"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[]}]},{kind:"Field",name:{kind:"Name",value:"lenders"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"0"}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LoanPartner"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"partnerName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"themes"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LoanDirect"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"trusteeName"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:938,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:Ne}}},Se=z`
	${I}
	query kcBasicLoanCard($basketId: String, $loanId: Int!) {
	shop (basketId: $basketId) {
		id
		basket {
			id
			# for isInBasket
			items {
				values {
					id
				}
			}
		}
	}
	lend {
		loan(id: $loanId) {
			id
			...loanCardFields

			# for loan-progress component
			unreservedAmount @client
			fundraisingPercent @client
			fundraisingTimeLeft @client
		}
	}
}`,C={name:"KivaClassicBasicLoanCard",emits:["show-loan-details","add-to-basket","custom-checkout-button-action"],props:{loanId:{type:Number,required:!0},expLabel:{type:String,default:""},lendNowButton:{type:Boolean,default:!1},checkoutRoute:{type:String,default:"/basket"},customCheckoutButtonText:{type:String,default:"Checkout now"},customLoanDetails:{type:Boolean,default:!1},showActionButton:{type:Boolean,default:!1},useFullWidth:{type:Boolean,default:!1},showTags:{type:Boolean,default:!1},enableFiveDollarsNotes:{type:Boolean,default:!1},useEmittedAddToBasket:{type:Boolean,default:!1}},inject:["apollo","cookieStore"],mixins:[W,G],components:{BorrowerImage:J,BorrowerName:Z,KvLoadingPlaceholder:de,KvLoadingParagraph:$,LoanProgressGroup:ke,LoanMatchingText:Le,KvMaterialIcon:le,SummaryTag:Y,KvUiButton:ue,KvTextLink:me,ActionButton:oe,LoanTag:re},data(){return{mdiCheckCircleOutline:P,loan:null,basketItems:null,isLoading:!0,queryObserver:null,mdiChevronRight:H,mdiMapMarker:j,viewportObserver:null,isAdding:!1,watchedQuery:{}}},computed:{cardWidth(){return this.useFullWidth?"100%":"374px"},amountLeft(){var u;const e=((u=this.loan)==null?void 0:u.loanFundraisingInfo)??{fundedAmount:0,reservedAmount:0},{fundedAmount:t,reservedAmount:a}=e;return F(this.loanAmount).subtract(t).subtract(a).value()},isFunded(){var e;return((e=this.loan)==null?void 0:e.status)==="funded"},isSelectedByAnother(){return this.amountLeft<=0&&!this.isFunded},borrowerName(){var e;return((e=this.loan)==null?void 0:e.name)||""},countryISO(){var e,t,a;return((a=(t=(e=this.loan)==null?void 0:e.geocode)==null?void 0:t.country)==null?void 0:a.isoCode)||""},countryName(){var e,t,a;return((a=(t=(e=this.loan)==null?void 0:e.geocode)==null?void 0:t.country)==null?void 0:a.name)||""},city(){var e,t;return((t=(e=this.loan)==null?void 0:e.geocode)==null?void 0:t.city)||""},state(){var e,t;return((t=(e=this.loan)==null?void 0:e.geocode)==null?void 0:t.state)||""},distributionModel(){var e;return((e=this.loan)==null?void 0:e.distributionModel)||""},imageHash(){var e,t;return((t=(e=this.loan)==null?void 0:e.image)==null?void 0:t.hash)??""},isInBasket(){return Array.isArray(this.basketItems)?this.basketItems.filter(a=>a.__typename==="LoanReservation").map(a=>a.id).indexOf(this.loanId)>-1:!1},isLentTo(){var e,t;return(t=(e=this.loan)==null?void 0:e.userProperties)==null?void 0:t.lentTo},isMatchAtRisk(){return E(this.loan)},sectorName(){var e,t;return(((t=(e=this.loan)==null?void 0:e.sector)==null?void 0:t.name)||"").toLowerCase()},whySpecial(){var t;const e=((t=this.loan)==null?void 0:t.whySpecial)||"";return e.toString().charAt(0).toLowerCase()+e.toString().slice(1)},fundraisingPercent(){var e;return((e=this.loan)==null?void 0:e.fundraisingPercent)??0},unreservedAmount(){var e;return((e=this.loan)==null?void 0:e.unreservedAmount)??"0"},timeLeft(){var e;return((e=this.loan)==null?void 0:e.fundraisingTimeLeft)??""},formattedLocation(){return this.distributionModel==="direct"?`${this.city}, ${this.state}, ${this.countryName}`:this.countryName==="Puerto Rico"?`${this.city}, PR`:this.countryName},allSharesReserved(){var e;return parseFloat((e=this.loan)==null?void 0:e.unreservedAmount)===0},isLessThan25(){return this.unreservedAmount<25&&this.unreservedAmount>0},lendAmount(){return this.isLessThan25?this.unreservedAmount:25},ctaButtonText(){return`Lend $${this.lendAmount} now`},showLendNowButton(){return this.lendNowButton},loanUse(){var t;const e=((t=this.loan)==null?void 0:t.fullLoanUse)??"";return e.length>75?`${e.slice(0,75)}...`:e},loanStatus(){var e;return((e=this.loan)==null?void 0:e.status)??""},loanAmount(){var e;return((e=this.loan)==null?void 0:e.loanAmount)??"0"},loanBorrowerCount(){var e;return((e=this.loan)==null?void 0:e.borrowerCount)??0},loanMatchingText(){var e;return((e=this.loan)==null?void 0:e.matchingText)??""},loanMatchRatio(){var e;return((e=this.loan)==null?void 0:e.matchRatio)??""},loanFundedAmount(){var e,t;return((t=(e=this.loan)==null?void 0:e.loanFundraisingInfo)==null?void 0:t.fundedAmount)??0},loanReservedAmount(){var e,t;return((t=(e=this.loan)==null?void 0:e.loanFundraisingInfo)==null?void 0:t.reservedAmount)??0}},methods:{showLoanDetails(e){this.customLoanDetails&&(e.preventDefault(),this.$emit("show-loan-details"))},createViewportObserver(){this.viewportObserver=O({targets:[this.$el],callback:e=>{e.forEach(t=>{t.target===this.$el&&t.intersectionRatio>0&&this.loadData()})}}),this.viewportObserver||this.loadData()},destroyViewportObserver(){this.viewportObserver&&this.viewportObserver.disconnect()},loadData(){this.queryObserver||(this.watchedQuery=q({apollo:this.apollo,cookieStore:this.cookieStore,loanId:this.loanId,loanQuery:Se,callback:e=>this.processQueryResult(e)}),this.queryObserver=this.watchedQuery.queryObserver)},processQueryResult(e){var t,a,u,i,n,l;if(e.error){console.error(e.error),this.$showTipMsg("There was a problem loading your loan recommendations","error");try{ce(k=>{k.setTag("wizard_stage","results"),k.setTag("loan_id",this.loanId),he(e.error)})}catch{}}this.loan=((a=(t=e.data)==null?void 0:t.lend)==null?void 0:a.loan)||null,this.loan&&(this.isLoading=!1),this.basketItems=((l=(n=(i=(u=e.data)==null?void 0:u.shop)==null?void 0:i.basket)==null?void 0:n.items)==null?void 0:l.values)||null},addToBasket(e){if(this.useEmittedAddToBasket)return this.$emit("add-to-basket",e),!0;this.isAdding=!0,ae({amount:this.lendAmount,apollo:this.apollo,loanId:this.loanId}).then(()=>{this.isAdding=!1,this.$emit("add-to-basket",{loanId:this.loanId,success:!0})}).catch(t=>{var u,i,n,l;if(this.isAdding=!1,this.$emit("add-to-basket",{loanId:this.loanId,success:!1}),ie((i=(u=t==null?void 0:t[0])==null?void 0:u.extensions)==null?void 0:i.code))return this.$showTipMsg("There was a problem adding the loan to your basket, refreshing the page to try again.","error"),se({cookieStore:this.cookieStore,loan:{id:this.loanId,price:this.lendAmount}});const a=((l=(n=t[0])==null?void 0:n.extensions)==null?void 0:l.code)==="reached_anonymous_basket_limit"?t[0].message:"There was a problem adding the loan to your basket";this.$showTipMsg(a,"error")})}},mounted(){this.loan?this.loadData():this.createViewportObserver()},beforeUnmount(){var e;this.destroyViewportObserver(),(e=this.watchedQuery.subscription)==null||e.unsubscribe()},created(){const e=X({apollo:this.apollo,loanId:this.loanId,fragment:I});e&&(this.loan=e,this.isLoading=!1)},watch:{loanId(e){this.queryObserver&&this.queryObserver.setVariables({basketId:this.cookieStore.get("kvbskt"),loanId:e})}}},Fe=["id"],xe={key:1},Be={key:8,class:"tw-mb-2.5 tw-flex-grow"},Ie={class:"tw-inline-flex tw-items-center tw-gap-1"},Ce={key:0,class:"tw-rounded tw-bg-secondary tw-text-center tw-w-full tw-py-1 tw-px-1.5 tw-mb-2 tw-mt-2"};function _e(e,t,a,u,i,n){const l=d("kv-loading-placeholder"),k=d("loan-tag"),_=d("borrower-image"),A=d("kv-material-icon"),T=d("summary-tag"),M=d("router-link"),R=d("borrower-name"),K=d("loan-progress-group"),V=d("kv-loading-paragraph"),U=d("kv-text-link"),D=d("loan-matching-text"),b=d("kv-ui-button"),Q=d("action-button"),v=ee("kv-track-event");return s(),m("div",{class:"tw-flex tw-flex-col",style:y({minWidth:"230px",height:"100%",maxWidth:n.cardWidth}),id:`${a.loanId}-loan-card`},[i.isLoading?(s(),r(l,{key:0,class:"tw-mb-1 tw-rounded",style:{width:"100%",height:"15.75rem"}})):o("",!0),i.isLoading?o("",!0):(s(),m("div",{key:1,class:"tw-relative",onClick:t[0]||(t[0]=(...S)=>n.showLoanDetails&&n.showLoanDetails(...S))},[w((s(),r(M,{is:n.allSharesReserved?"span":"router-link",to:a.customLoanDetails?"":`/lend/${a.loanId}`},{default:c(()=>[a.showTags?(s(),r(k,{key:0,loan:i.loan,"amount-left":n.amountLeft},null,8,["loan","amount-left"])):o("",!0),f(_,{class:"tw-relative tw-w-full tw-bg-black tw-rounded",alt:"photo of "+n.borrowerName,"aspect-ratio":3/4,"default-image":{width:336},hash:n.imageHash,images:[{width:336,viewSize:1024},{width:336,viewSize:768},{width:416,viewSize:480},{width:374,viewSize:414},{width:335,viewSize:375},{width:280}]},null,8,["alt","hash"]),n.countryName?(s(),m("div",xe,[f(T,{class:"tw-absolute tw-bottom-2 tw-left-1 tw-text-primary",city:n.city,state:n.state,"country-name":n.countryName},{default:c(()=>[f(A,{class:"tw-h-2.5 tw-w-2.5 tw-mr-0.5",icon:i.mdiMapMarker},null,8,["icon"]),h(" "+g(n.formattedLocation),1)],void 0,!0),_:1},8,["city","state","country-name"])])):o("",!0)],void 0),_:1},8,["is","to"])),[[v,["Lending","click-Read more","Photo",a.loanId]]])])),i.isLoading?(s(),r(l,{key:2,class:"tw-mb-0.5",style:y({width:75+Math.random()*15+"%",height:"1.875rem"})},null,8,["style"])):o("",!0),i.isLoading?o("",!0):(s(),r(R,{key:3,class:"tw-mb-1 tw-text-h3","max-length":50,name:n.borrowerName,style:y({minHeight:a.showActionButton?0:"3rem"})},null,8,["name","style"])),i.isLoading?(s(),r(l,{key:4,class:"tw-mb-0.5",style:y({width:40+Math.random()*15+"%",height:"1.3rem"})},null,8,["style"])):o("",!0),i.isLoading?(s(),r(l,{key:5,class:"tw-mb-1.5 tw-rounded",style:{width:"100%",height:"0.5rem"}})):o("",!0),i.isLoading?o("",!0):(s(),r(K,{key:6,class:"tw-mb-2.5","money-left":n.unreservedAmount,"progress-percent":n.fundraisingPercent,"time-left":e.timeLeftMessage,"all-shares-reserved":n.allSharesReserved},null,8,["money-left","progress-percent","time-left","all-shares-reserved"])),i.isLoading?(s(),r(V,{key:7,class:"tw-mb-1.5 tw-flex-grow",style:{width:"100%",height:"5.5rem"}})):o("",!0),i.isLoading?o("",!0):(s(),m("p",Be,[h(g(n.loanUse)+" ",1),w((s(),r(U,{onClick:n.showLoanDetails},{default:c(()=>t[2]||(t[2]=[h(" Learn more ")]),void 0),_:1,__:[2]},8,["onClick"])),[[v,["Lending","click-Read more","Learn more",a.loanId]]])])),i.isLoading?(s(),r(l,{key:9,class:"tw-mb-1",style:y({width:75+Math.random()*15+"%",height:"1.3rem"})},null,8,["style"])):o("",!0),!i.isLoading&&n.loanMatchingText!==""&&!n.isMatchAtRisk?(s(),r(D,{key:10,class:"tw-mb-1.5","matcher-name":n.loanMatchingText,"match-ratio":n.loanMatchRatio,status:n.loanStatus,"funded-amount":n.loanFundedAmount,"reserved-amount":n.loanReservedAmount,"loan-amount":n.loanAmount},null,8,["matcher-name","match-ratio","status","funded-amount","reserved-amount","loan-amount"])):o("",!0),i.isLoading?(s(),r(l,{key:11,class:"tw-rounded tw-self-start",style:{width:"9rem",height:"3rem"}})):o("",!0),i.isLoading?o("",!0):(s(),m(L,{key:12},[n.isInBasket?w((s(),r(b,{key:0,class:"tw-mb-2 tw-text-secondary",variant:"secondary",to:a.checkoutRoute,onClick:t[1]||(t[1]=S=>e.$emit("custom-checkout-button-action",a.loanId))},{default:c(()=>[te(e.$slots,"default",{},()=>[p("div",Ie,[h(g(a.customCheckoutButtonText)+" ",1),f(A,{class:"tw-w-2.5 tw-h-2.5",icon:i.mdiCheckCircleOutline},null,8,["icon"])])])],void 0),_:3},8,["to"])),[[v,["Lending","click-Read more","checkout-now-button-click",a.loanId,a.loanId]]]):o("",!0),n.isInBasket?o("",!0):(s(),m(L,{key:1},[n.allSharesReserved?(s(),m("div",Ce," Another lender has selected this loan. Please choose a different borrower to support. ")):o("",!0),n.allSharesReserved?o("",!0):(s(),m(L,{key:1},[!n.showLendNowButton&&!a.showActionButton?w((s(),r(b,{key:0,class:"tw-mb-2 tw-self-start",state:`${n.allSharesReserved?"disabled":""}`,to:a.customLoanDetails?"":`/lend/${a.loanId}`,onClick:n.showLoanDetails},{default:c(()=>[t[3]||(t[3]=h(" View loan ")),f(A,{class:"tw-w-3 tw-h-3 tw-align-middle",icon:i.mdiChevronRight},null,8,["icon"])],void 0),_:1,__:[3]},8,["state","to","onClick"])),[[v,["Lending","click-Read-more","View loan",a.loanId]]]):o("",!0),n.showLendNowButton&&!i.isAdding?w((s(),r(b,{key:"lendButton",class:"tw-inline-flex tw-flex-1","data-testid":"bp-lend-cta-lend-button",type:"submit",onClick:n.addToBasket},{default:c(()=>[h(g(n.ctaButtonText),1)],void 0),_:1},8,["onClick"])),[[v,["Lending","lend-button-loan-upsell",a.expLabel]]]):o("",!0),n.showLendNowButton&&i.isAdding?(s(),r(b,{key:2,class:"tw-inline-flex tw-flex-1","data-testid":"bp-lend-cta-adding-to-basket-button"},{default:c(()=>t[4]||(t[4]=[h(" Adding to basket... ")]),void 0),_:1,__:[4]})):o("",!0),a.showActionButton&&!n.showLendNowButton?(s(),r(Q,{key:3,"loan-id":a.loanId,loan:i.loan,"items-in-basket":i.basketItems,"is-lent-to":n.isLentTo,"is-funded":n.isFunded,"is-selected-by-another":n.isSelectedByAnother,"is-amount-lend-button":n.isLessThan25&&!a.enableFiveDollarsNotes,"amount-left":n.amountLeft,"show-now":!a.enableFiveDollarsNotes,"enable-five-dollars-notes":a.enableFiveDollarsNotes,onAddToBasket:n.addToBasket},null,8,["loan-id","loan","items-in-basket","is-lent-to","is-funded","is-selected-by-another","is-amount-lend-button","amount-left","show-now","enable-five-dollars-notes","onAddToBasket"])):o("",!0)],64))],64))],64))],12,Fe)}const Ze=N(C,[["render",_e]]);C.__docgenInfo={displayName:"KivaClassicBasicLoanCard",exportName:"default",description:"",tags:{},props:[{name:"loanId",type:{name:"number"},required:!0},{name:"expLabel",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"lendNowButton",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"checkoutRoute",type:{name:"string"},defaultValue:{func:!1,value:"'/basket'"}},{name:"customCheckoutButtonText",type:{name:"string"},defaultValue:{func:!1,value:"'Checkout now'"}},{name:"customLoanDetails",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"showActionButton",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"useFullWidth",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"showTags",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"enableFiveDollarsNotes",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"useEmittedAddToBasket",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],events:[{name:"custom-checkout-button-action"},{name:"show-loan-details"},{name:"add-to-basket",type:{names:["undefined"]}}],slots:[{name:"default"}],sourceFiles:["/home/runner/work/ui/ui/src/components/LoanCards/KivaClassicBasicLoanCard.vue"]};export{Ze as K,I as _};
