import{a as R}from"./entry-apollo-story-mixin-CB9BNmK9U5.js";import{c as O}from"./entry-cookie-store-story-mixin-Bv_t57ys9l.js";import{k as U}from"./entry-kv-auth0-story-mixin-DxLGBTBTDx.js";import{f as r,b as n,r as p,o,g as ae,c as g,e as i,d as v,F as m,P as q,J as c,a as _,K as w,n as H,G as le,H as ce,I as ue}from"./entry-vue.esm-bundler-Bf_Yeyugwo.js";import"./entry-KvWwwHeader-CVdIzOPj6Q.js";import{g as b}from"./entry-numeral-DJCTM12wUX.js";import{x as j}from"./entry-KvPageContainer-B9-1kg27t_.js";import{_ as h}from"./entry-_plugin-vue_export-helper-DlAUqK2UKH.js";import{W as Q}from"./entry-WwwPage-D-sW1TnUWL.js";import{d as de}from"./entry-mdi-BJHOrBfjV3.js";import{i as me,o as pe,a as fe}from"./entry-touchEvents-DzV-rvy7P4.js";import{K as ve}from"./entry-syncDate-BmkM6LdPy7.js";import{K as ye}from"./entry-KvExpandable-DeDyumYo7d.js";import{w as _e}from"./entry-KvMaterialIcon-DcajXwg-0j.js";import{K as ge}from"./entry-KvAlert-BkleVpfpH3.js";import{K as I}from"./entry-KvSettingsCard-DETGV9-s7u.js";import{U as F}from"./entry-KvButton-DF0Vhz1EWA.js";import{_ as G}from"./entry-KvLoadingPlaceholder-DUZzoT9CoU.js";import{a as L}from"./entry-exports-CudK1O5XNw.js";import{K as ke}from"./entry-KvLightbox-Bd591zHfoG.js";import{g as he}from"./entry-_commonjsHelpers-Cpj98o6Yn6.js";import{g as we}from"./entry-orderBy-CUrcrXTfYx.js";import{r as be}from"./entry-_baseUniq-DhZtlzFzUZ.js";import"./entry-logReadQueryError-Codcl0QZ_g.js";import"./entry-logFormatter-DhjghUk5Me.js";import"./entry-TheBasketBar-CAfv021hcH.js";import"./entry-KvButton-CZu-utW0a_.js";import"./entry-getCacheKey-BX3EO2qX-W.js";import"./entry-basketCount-CZ-kE9ye_Z.js";import"./entry-TheFooter-B50H37oieJ.js";import"./entry-KvAccordionItem-BUdedcIFQ1.js";import"./entry-settingsUtils-CXPrtFAPl-.js";import"./entry-get-BUjo_hX5jl.js";import"./entry-get-D3xDH2SX94.js";import"./entry-isSymbol-5pnFTpIKM9.js";import"./entry-index-COmIkRYU2t.js";import"./entry-urlUtils-D59-4GikCB.js";import"./entry-promoCredit-A8tDfJh8uJ.js";import"./entry-rich-text-html-renderer.es5-kBaKhcHuza.js";import"./entry-KvGrid-A3hpmYTsti.js";import"./entry-updateDonation-CfhElOgRHH.js";import"./entry-AppealBannerCircular-D3bqh_0eaU.js";import"./entry-smooth-scroll-mixin-Coaqv0J44m.js";import"./entry-KvProgressCircle-Dl0vzA6hWT.js";import"./entry-KvContentfulImg-ClwkYYkTk_.js";import"./entry-GenericPromoBanner-xsZONbxoWL.js";import"./entry-KvIcon-DpMQFaEAGT.js";import"./iframe-CWeBLAo0.js";import"./entry-KvProgressBar-CQtXD0YVwH.js";import"./entry-DonationBanner-BukgKHfxUA.js";import"./entry-kiva-logo-fyRkKmi0FM.js";import"./entry-CampaignLogoGroup-D5aVYDQ4uA.js";import"./entry-throttle-DL1zg7kAk0.js";import"./entry-toNumber-MeiYJWOH0A.js";import"./entry-imageUtils-_95xo2d0ng.js";import"./entry-myKivaUtils-USlSQzpKdw.js";import"./entry-myKivaForAllUsers-DI6rZrUMxZ.js";import"./entry-KvUserAvatar-CcUKtQr-4i.js";import"./entry-throttle-DR-Bh3IiJx.js";import"./entry-KvThemeProvider-CJZWo36001.js";import"./entry-toInteger-XI_MWEAzOD.js";import"./entry-keys-B9dmm4b_qU.js";import"./entry-PromoCreditBanner-CCrPa6t4Rf.js";import"./entry-lock-scroll-Bww220JhDP.js";import"./entry-KvTextInput-DOWiWB5Pob.js";import"./entry-attrs-C2OODjD6EW.js";import"./entry-KvLoadingSpinner-D0IZcQeh_0.js";import"./entry-vue-focus-lock-DKAacIANk5.js";import"./entry-_baseIndexOf-qfoVQuLp0t.js";import"./entry-_baseFindIndex-Ca62E79BN9.js";const z={name:"KvDefaultWrapper",components:{KvPageContainer:j}};function Se(t,e,l,f,a,d){const s=p("kv-page-container");return o(),r(s,{class:"tw-pt-4 tw-pb-8 md:tw-pt-6 md:tw-pb-12 lg:tw-pt-8 lg:tw-pb-16"},{default:n(()=>[ae(t.$slots,"default")],void 0),_:3})}const Y=h(z,[["render",Se]]);z.__docgenInfo={displayName:"KvDefaultWrapper",exportName:"default",description:"",tags:{},slots:[{name:"default"}],sourceFiles:["/home/runner/work/ui/ui/src/components/Kv/KvDefaultWrapper.vue"]};const J={name:"ThePortfolioTertiaryMenu",inject:["apollo","cookieStore"],data(){return{userBalance:0,publicId:""}},computed:{donateCreditUrl(){return{path:"/donate/supportusprocess",query:{donationAmount:this.userBalance}}},publicLenderUrl(){return{path:`/lender/${this.publicId}`}}},apollo:{query:b`query portfolioTertiaryMenu {
			my {
				id
				userAccount {
					id
					publicId
					balance
				}
			}
		}`,preFetch:!0,result({data:t}){var e,l,f,a;this.userBalance=((l=(e=t==null?void 0:t.my)==null?void 0:e.userAccount)==null?void 0:l.balance)??0,this.publicId=((a=(f=t==null?void 0:t.my)==null?void 0:f.userAccount)==null?void 0:a.publicId)??""}}},Me={class:"tw-font-medium","data-testid":"portfolio-tertiary-menu"},xe={key:0};function Te(t,e,l,f,a,d){const s=p("router-link"),u=q("kv-track-event");return o(),g("ul",Me,[i("li",null,[m((o(),r(s,{to:"/portfolio",class:"portfolio-tertitary-menu-link","exact-active-class":"portfolio-tertitary-menu-active-link"},{default:n(()=>e[0]||(e[0]=[c(" My impact ")]),void 0),_:1,__:[0]})),[[u,["TertiaryNav","click-MyKiva-My-impact"]]])]),i("li",null,[m((o(),r(s,{to:"/portfolio/lending-stats",class:"portfolio-tertitary-menu-link","exact-active-class":"portfolio-tertitary-menu-active-link"},{default:n(()=>e[1]||(e[1]=[c(" Lending stats ")]),void 0),_:1,__:[1]})),[[u,["TertiaryNav","click-MyKiva-Lending-stats"]]])]),i("li",null,[m((o(),r(s,{to:"/portfolio/loans",class:"portfolio-tertitary-menu-link","exact-active-class":"portfolio-tertitary-menu-active-link"},{default:n(()=>e[2]||(e[2]=[c(" My loans ")]),void 0),_:1,__:[2]})),[[u,["TertiaryNav","click-MyKiva-My-loans"]]])]),i("li",null,[m((o(),r(s,{to:"/portfolio/estimated-repayments",class:"portfolio-tertitary-menu-link","exact-active-class":"portfolio-tertitary-menu-active-link","data-testid":"portfolio-estimated-payments"},{default:n(()=>e[3]||(e[3]=[c(" Estimated repayments ")]),void 0),_:1,__:[3]})),[[u,["TertiaryNav","click-MyKiva-Estimated-repayments"]]])]),i("li",null,[m((o(),r(s,{to:"/portfolio/credit/deposit",class:"portfolio-tertitary-menu-link","exact-active-class":"portfolio-tertitary-menu-active-link","data-testid":"portfolio-add-credit"},{default:n(()=>e[4]||(e[4]=[c(" Add credit ")]),void 0),_:1,__:[4]})),[[u,["TertiaryNav","click-MyKiva-Add-credit"]]])]),i("li",null,[m((o(),r(s,{to:"/withdraw",class:"portfolio-tertitary-menu-link","exact-active-class":"portfolio-tertitary-menu-active-link"},{default:n(()=>e[5]||(e[5]=[c(" Withdraw ")]),void 0),_:1,__:[5]})),[[u,["TertiaryNav","click-MyKiva-Withdraw"]]])]),i("li",null,[m((o(),r(s,{to:d.donateCreditUrl,class:"portfolio-tertitary-menu-link","exact-active-class":"portfolio-tertitary-menu-active-link"},{default:n(()=>e[6]||(e[6]=[c(" Donate credit ")]),void 0),_:1,__:[6]},8,["to"])),[[u,["TertiaryNav","click-MyKiva-Donate-credit"]]])]),a.publicId?(o(),g("li",xe,[m((o(),r(s,{to:d.publicLenderUrl,class:"portfolio-tertitary-menu-link","exact-active-class":"portfolio-tertitary-menu-active-link"},{default:n(()=>e[7]||(e[7]=[c(" Public lender profile ")]),void 0),_:1,__:[7]},8,["to"])),[[u,["TertiaryNav","click-MyKiva-Public-lender-profile"]]])])):v("",!0),i("li",null,[m((o(),r(s,{to:"/portfolio/transactions",class:"portfolio-tertitary-menu-link","exact-active-class":"portfolio-tertitary-menu-active-link","data-testid":"portfolio-transactions"},{default:n(()=>e[8]||(e[8]=[c(" Transaction history ")]),void 0),_:1,__:[8]})),[[u,["TertiaryNav","click-MyKiva-Transaction-history"]]])]),i("li",null,[m((o(),r(s,{to:"/portfolio/donations",class:"portfolio-tertitary-menu-link","exact-active-class":"portfolio-tertitary-menu-active-link"},{default:n(()=>e[9]||(e[9]=[c(" My donations ")]),void 0),_:1,__:[9]})),[[u,["TertiaryNav","click-MyKiva-My-donations"]]])]),i("li",null,[m((o(),r(s,{to:"/portfolio/kiva-cards",class:"portfolio-tertitary-menu-link","exact-active-class":"portfolio-tertitary-menu-active-link"},{default:n(()=>e[10]||(e[10]=[c(" Purchased Kiva Cards ")]),void 0),_:1,__:[10]})),[[u,["TertiaryNav","click-MyKiva-Purchases-Kiva-Cards"]]])]),i("li",null,[m((o(),r(s,{to:"/portfolio/invites",class:"portfolio-tertitary-menu-link","exact-active-class":"portfolio-tertitary-menu-active-link","data-testid":"portfolio-invite-friends"},{default:n(()=>e[11]||(e[11]=[c(" Invite friends ")]),void 0),_:1,__:[11]})),[[u,["TertiaryNav","click-MyKiva-Invite-friends"]]])]),i("li",null,[m((o(),r(s,{to:"/portfolio/credit/bonus-history",class:"portfolio-tertitary-menu-link","exact-active-class":"portfolio-tertitary-menu-active-link","data-testid":"portfolio-bonus-history"},{default:n(()=>e[12]||(e[12]=[c(" Free credit history ")]),void 0),_:1,__:[12]})),[[u,["TertiaryNav","click-MyKiva-Free-credit-history"]]])])])}const Ne=h(J,[["render",Te],["__scopeId","data-v-555e32c3"]]);J.__docgenInfo={displayName:"ThePortfolioTertiaryMenu",exportName:"default",description:"",tags:{},sourceFiles:["/home/runner/work/ui/ui/src/components/WwwFrame/Menus/ThePortfolioTertiaryMenu.vue"]};const X={name:"TheSettingsTertiaryMenu",inject:["apollo","cookieStore"],data(){return{isMfaActive:!1}},apollo:{query:b`query mfaFeatureFlagQuery {
			general {
				mfaEnabled: featureSetting(key: "mfa.enabled") {
					key
					value
				}
			}
		}`,preFetch:!0,result({data:t}){var e,l;this.isMfaActive=((l=(e=t==null?void 0:t.general)==null?void 0:e.mfaEnabled)==null?void 0:l.value)==="true"}}},Le={key:0};function Ke(t,e,l,f,a,d){const s=p("router-link"),u=q("kv-track-event");return o(),g("ul",null,[i("li",null,[m((o(),r(s,{to:"/settings/account",class:"settings-tertitary-menu-link","exact-active-class":"settings-tertitary-menu-active-link"},{default:n(()=>e[0]||(e[0]=[c(" Account ")]),void 0),_:1,__:[0]})),[[u,["TertiaryNav","click-MyKiva-Settings-account"]]])]),a.isMfaActive?(o(),g("li",Le,[m((o(),r(s,{to:"/settings/security",class:"settings-tertitary-menu-link","exact-active-class":"settings-tertitary-menu-active-link"},{default:n(()=>e[1]||(e[1]=[c(" Security and login ")]),void 0),_:1,__:[1]})),[[u,["TertiaryNav","click-MyKiva-Settings-security"]]])])):v("",!0),i("li",null,[m((o(),r(s,{to:"/settings/credit",class:"settings-tertitary-menu-link","exact-active-class":"settings-tertitary-menu-active-link"},{default:n(()=>e[2]||(e[2]=[c(" Credit ")]),void 0),_:1,__:[2]})),[[u,["TertiaryNav","click-MyKiva-Settings-credit"]]])]),i("li",null,[m((o(),r(s,{to:"/settings/payments",class:"settings-tertitary-menu-link","exact-active-class":"settings-tertitary-menu-active-link"},{default:n(()=>e[3]||(e[3]=[c(" Payments ")]),void 0),_:1,__:[3]})),[[u,["TertiaryNav","click-MyKiva-Settings-payments"]]])]),i("li",null,[m((o(),r(s,{to:"/settings/email",class:"settings-tertitary-menu-link","exact-active-class":"settings-tertitary-menu-active-link"},{default:n(()=>e[4]||(e[4]=[c(" Email ")]),void 0),_:1,__:[4]})),[[u,["TertiaryNav","click-MyKiva-Settings-email"]]])]),i("li",null,[m((o(),r(s,{to:"/settings/data",class:"settings-tertitary-menu-link","exact-active-class":"settings-tertitary-menu-active-link"},{default:n(()=>e[5]||(e[5]=[c(" Data ")]),void 0),_:1,__:[5]})),[[u,["TertiaryNav","click-Settings-data"]]])]),i("li",null,[m((o(),r(s,{to:"/lend/saved-search",class:"settings-tertitary-menu-link","exact-active-class":"settings-tertitary-menu-active-link"},{default:n(()=>e[6]||(e[6]=[c(" Saved searches ")]),void 0),_:1,__:[6]})),[[u,["TertiaryNav","click-MyKiva-Settings-saved-searches"]]])])])}const Ae=h(X,[["render",Ke],["__scopeId","data-v-41320cc1"]]);X.__docgenInfo={displayName:"TheSettingsTertiaryMenu",exportName:"default",description:"",tags:{},sourceFiles:["/home/runner/work/ui/ui/src/components/WwwFrame/Menus/TheSettingsTertiaryMenu.vue"]};const Pe="kvborrowerapplicant",Z={name:"TheMyKivaSecondaryMenu",components:{KvDropdown:ve,KvExpandable:ye,KvMaterialIcon:_e,KvPageContainer:j,ThePortfolioTertiaryMenu:Ne,TheSettingsTertiaryMenu:Ae},inject:["apollo","cookieStore"],data(){return{open:!1,isBorrower:!1,isTrustee:!1,usingTouch:!1,mdiChevronDown:de}},apollo:{query:b`query myKivaSecondaryMenu {
			my {
				id
				isBorrower
				trustee {
					id
				}
			}
			usingTouch @client
		}`,preFetch:!0,result({data:t}){var e,l,f;this.isBorrower=((e=t==null?void 0:t.my)==null?void 0:e.isBorrower)??!1,this.isTrustee=!!((f=(l=t==null?void 0:t.my)==null?void 0:l.trustee)!=null&&f.id),this.usingTouch=(t==null?void 0:t.usingTouch)??!1}},computed:{myKivaCategory(){return this.$route.path.split("/")[1]},isBorrowerApplicant(){var t;return!this.isBorrower&&((t=this.cookieStore.get(Pe))==null?void 0:t.toLowerCase())==="true"}},methods:{toggle(){this.open?this.collapse():this.expand()},expand(){this.open=!0,this.usingTouch&&fe(this.touchHandler)},collapse(){this.open=!1,this.usingTouch&&pe(this.touchHandler)},touchHandler(t){me(t,this.$el)||this.collapse()}}},qe={class:"tw-bg-action-highlight tw-font-medium"},Ie={class:"tw-inline-block"},Fe={class:"tw-inline-block"},Ce={class:"tw-inline-block"},Ee={class:"tw-inline-block"},Ve={key:0,class:"tw-inline-block"},Be={key:1,class:"tw-inline-block"},De={key:2,class:"tw-inline-block"},$e={class:"md:tw-hidden"},We=["aria-expanded"],Re={class:"tw-capitalize"},Oe=["aria-hidden"],Ue={class:"tw-bg-secondary"},He={key:0},je={key:1},Qe={key:2};function Ge(t,e,l,f,a,d){const s=p("router-link"),u=p("the-settings-tertiary-menu"),k=p("kv-dropdown"),S=p("kv-page-container"),M=p("kv-material-icon"),x=p("the-portfolio-tertiary-menu"),K=p("kv-expandable"),y=q("kv-track-event");return o(),g("div",qe,[_(S,{class:"tw-hidden md:tw-block"},{default:n(()=>[i("ul",null,[i("li",Ie,[m((o(),r(s,{to:"/portfolio","active-class":"tw-underline",class:"desktop-link"},{default:n(()=>e[1]||(e[1]=[c(" My impact ")]),void 0,!0),_:1,__:[1]})),[[y,["SecondaryNav","click-MyKiva-My-impact"]]])]),i("li",Fe,[m((o(),r(s,{to:"/teams/my-teams","active-class":"tw-underline",class:"desktop-link"},{default:n(()=>e[2]||(e[2]=[c(" My teams ")]),void 0,!0),_:1,__:[2]})),[[y,["SecondaryNav","click-MyKiva-My-teams"]]])]),i("li",Ce,[m((o(),r(s,{to:"/account/messages","active-class":"tw-underline",class:"desktop-link"},{default:n(()=>e[3]||(e[3]=[c(" Messages ")]),void 0,!0),_:1,__:[3]})),[[y,["SecondaryNav","click-MyKiva-Messages"]]])]),i("li",Ee,[m((o(),r(s,{id:"settings-link",to:"/settings","active-class":"tw-underline",class:"desktop-link"},{default:n(()=>e[4]||(e[4]=[c(" Settings ")]),void 0,!0),_:1,__:[4]})),[[y,["SecondaryNav","click-MyKiva-Settings"]]]),_(k,{controller:"settings-link"},{default:n(()=>[_(u)],void 0,!0),_:1})]),d.isBorrowerApplicant?(o(),g("li",Ve,[m((o(),r(s,{to:"/my/borrower/application","active-class":"tw-underline",class:"desktop-link"},{default:n(()=>e[5]||(e[5]=[c(" Borrower application ")]),void 0,!0),_:1,__:[5]})),[[y,["SecondaryNav","click-MyKiva-Borrower-application"]]])])):v("",!0),a.isBorrower?(o(),g("li",Be,[m((o(),r(s,{to:"/my/borrower","active-class":"tw-underline",class:"desktop-link"},{default:n(()=>e[6]||(e[6]=[c(" Borrower Dashboard ")]),void 0,!0),_:1,__:[6]})),[[y,["SecondaryNav","click-MyKiva-Borrower-dashboard"]]])])):v("",!0),a.isTrustee?(o(),g("li",De,[m((o(),r(s,{to:"/my/trustee","active-class":"tw-underline",class:"desktop-link"},{default:n(()=>e[7]||(e[7]=[c(" Trustee Dashboard ")]),void 0,!0),_:1,__:[7]})),[[y,["SecondaryNav","click-MyKiva-Trustee-dashboard"]]])])):v("",!0)])],void 0),_:1}),i("div",$e,[i("button",{onClick:e[0]||(e[0]=(...A)=>d.toggle&&d.toggle(...A)),"aria-controls":"tertiary-combo-nav","aria-expanded":a.open?"true":"false",class:"tw-bg-action-highlight tw-w-full tw-h-8 tw-px-2 tw-text-primary-inverse hover:tw-underline tw-flex tw-items-center tw-justify-between"},[i("span",Re,w(d.myKivaCategory),1),_(M,{class:H(["tw-h-4 tw-w-4 tw-transition tw-transform tw-duration-500 tw-ease",{"tw-rotate-180":a.open}]),icon:a.mdiChevronDown},null,8,["class","icon"])],8,We),_(K,{easing:"ease-in-out"},{default:n(()=>[m(i("div",{id:"tertiary-combo-nav",class:"kv-expandable-pane sec-ter-combo-nav","aria-hidden":a.open?"false":"true"},[d.myKivaCategory==="portfolio"?(o(),r(x,{key:0,class:"tw-bg-tertiary tw-py-1 tw-pl-4"})):d.myKivaCategory==="settings"?(o(),r(u,{key:1,class:"tw-bg-tertiary tw-py-1 tw-pl-2"})):v("",!0),i("ul",Ue,[i("li",null,[m((o(),r(s,{to:"/portfolio",class:"mobile-link"},{default:n(()=>e[8]||(e[8]=[c(" Portfolio ")]),void 0,!0),_:1,__:[8]})),[[y,["SecondaryNav","click-MyKiva-Portfolio"]]])]),i("li",null,[m((o(),r(s,{to:"/teams/my-teams",class:"mobile-link"},{default:n(()=>e[9]||(e[9]=[c(" My teams ")]),void 0,!0),_:1,__:[9]})),[[y,["SecondaryNav","click-MyKiva-My-teams"]]])]),i("li",null,[m((o(),r(s,{to:"/account/messages",class:"mobile-link"},{default:n(()=>e[10]||(e[10]=[c(" Messages ")]),void 0,!0),_:1,__:[10]})),[[y,["SecondaryNav","click-MyKiva-Messages"]]])]),i("li",null,[m((o(),r(s,{to:"/settings",class:"mobile-link"},{default:n(()=>e[11]||(e[11]=[c(" Settings ")]),void 0,!0),_:1,__:[11]})),[[y,["SecondaryNav","click-MyKiva-Settings"]]])]),d.isBorrowerApplicant?(o(),g("li",He,[m((o(),r(s,{to:"/my/borrower/application",class:"mobile-link"},{default:n(()=>e[12]||(e[12]=[c(" Borrower application ")]),void 0,!0),_:1,__:[12]})),[[y,["SecondaryNav","click-MyKiva-Borrower-application"]]])])):v("",!0),a.isBorrower?(o(),g("li",je,[m((o(),r(s,{to:"/my/borrower",class:"mobile-link"},{default:n(()=>e[13]||(e[13]=[c(" Borrower Dashboard ")]),void 0,!0),_:1,__:[13]})),[[y,["SecondaryNav","click-MyKiva-Borrower-dashboard"]]])])):v("",!0),a.isTrustee?(o(),g("li",Qe,[m((o(),r(s,{to:"/my/trustee",class:"mobile-link"},{default:n(()=>e[14]||(e[14]=[c(" Trustee Dashboard ")]),void 0,!0),_:1,__:[14]})),[[y,["SecondaryNav","click-MyKiva-Trustee-dashboard"]]])])):v("",!0)])],8,Oe),[[le,a.open]])],void 0),_:1})])])}const ee=h(Z,[["render",Ge],["__scopeId","data-v-1efd464c"]]);Z.__docgenInfo={displayName:"TheMyKivaSecondaryMenu",exportName:"default",description:"",tags:{},sourceFiles:["/home/runner/work/ui/ui/src/components/WwwFrame/Menus/TheMyKivaSecondaryMenu.vue"]};const ze=b`query getUserEmail {
	my {
		id
		userAccount {
			id
			email
		}
	}
}`,Ye=b`mutation passwordReset {
	my {
		sendChangePasswordEmail
	}
}`,te={name:"Password",components:{KvAlert:ge,KvButton:F,KvSettingsCard:I},inject:["apollo"],data(){return{userEmail:null,isPasswordRequestPending:!1,isPasswordRequestSuccess:!1,isPasswordRequestFailure:!1}},mounted(){this.loadUserEmail()},methods:{loadUserEmail(){this.apollo.query({query:ze}).then(({data:t})=>{var e,l;this.userEmail=(l=(e=t==null?void 0:t.my)==null?void 0:e.userAccount)==null?void 0:l.email}).catch(t=>{console.error(t)})},async onClickRequestPassword(){this.isPasswordRequestPending=!0,this.isPasswordRequestSuccess=!1,this.isPasswordRequestFailure=!1;try{await this.apollo.mutate({mutation:Ye}),this.isPasswordRequestSuccess=!0}catch(t){console.error(t),this.isPasswordRequestFailure=!0}this.isPasswordRequestPending=!1}}},Je={class:"data-hj-suppress"};function Xe(t,e,l,f,a,d){const s=p("kv-alert"),u=p("kv-button"),k=p("kv-settings-card");return o(),r(k,{title:"Password"},{content:n(()=>[e[3]||(e[3]=i("p",{class:"tw-mb-4"}," Clicking this button will send you a verification email. As a final step in this process, you'll need to click the link in that email to successfully update your account password. ",-1)),a.isPasswordRequestSuccess?(o(),r(s,{key:0,class:"alert",role:"alert",variant:"success","can-close":!0},{default:n(()=>[i("b",null,[e[0]||(e[0]=c(" Email has been sent to ")),i("span",Je,w(a.userEmail?a.userEmail:"the address on file"),1)])],void 0,!0),_:1})):v("",!0),a.isPasswordRequestFailure?(o(),r(s,{key:1,class:"alert",role:"alert",variant:"danger","can-close":!0},{default:n(()=>e[1]||(e[1]=[c(" There was a problem sending the password reset email ")]),void 0,!0),_:1,__:[1]})):v("",!0),_(u,{onClick:d.onClickRequestPassword,state:a.isPasswordRequestPending?"disabled":""},{default:n(()=>e[2]||(e[2]=[c(" Send change password email ")]),void 0,!0),_:1,__:[2]},8,["onClick","state"])]),_:1})}const Ze=h(te,[["render",Xe],["__scopeId","data-v-edff3b66"]]);te.__docgenInfo={displayName:"Password",exportName:"default",description:"",tags:{},sourceFiles:["/home/runner/work/ui/ui/src/components/Settings/Password.vue"]};const et=b`query mfaQuery {
	my {
		id
		enrolledInMFA
	}
}`,ie={name:"TwoStepVerification",components:{KvSettingsCard:I,KvButton:F,KvLoadingPlaceholder:G},data(){return{isMFAActive:!1,isLoading:!0}},computed:{MFAStatus(){return this.isMFAActive?"on":"off"}},inject:["apollo","kvAuth0"],mounted(){this.isLoading=!0,this.apollo.query({query:et}).then(t=>{if(t.errors)throw t.errors;this.isMFAActive=t.data.my.enrolledInMFA||!1,this.isLoading=!1}).catch(t=>{var e,l;console.error(t),this.$showTipMsg("There was an error when getting your 2-step verification status. Please refresh the page and try again.","error");try{L(((l=(e=t==null?void 0:t[0])==null?void 0:e.extensions)==null?void 0:l.exception)||t)}catch{}})}},tt={class:"two-step-card-wrapper"},it={class:"tw-mb-2"};function ot(t,e,l,f,a,d){const s=p("kv-loading-placeholder"),u=p("kv-button"),k=p("kv-settings-card");return o(),g("div",tt,[_(k,{title:"2-Step verification",class:"two-step-card-wrapper__two-step-card"},{content:n(()=>[i("h3",it,[e[0]||(e[0]=c(" Status: ")),a.isLoading?(o(),r(s,{key:0,class:"tw-inline-block tw-w-4",style:{top:"0.125rem",height:"1.2rem"}})):v("",!0),a.isLoading?v("",!0):(o(),g("span",{key:1,class:H(["tw-capitalize",{"tw-text-danger":d.MFAStatus==="off","tw-text-brand":d.MFAStatus==="on"}])},w(d.MFAStatus),3))]),e[2]||(e[2]=i("p",{class:"tw-mb-4"},[c(" Protect your Kiva account with an extra layer of security by requiring access to your phone. Once configured, you'll be required to enter "),i("span",{class:"tw-font-medium"}," both your password and an authenication code from your mobile phone "),c(" in order to access your account. ")],-1)),_(u,{to:"/settings/security/mfa"},{default:n(()=>e[1]||(e[1]=[c(" Manage 2-step verification ")]),void 0,!0),_:1,__:[1]})]),_:1})])}const nt=h(ie,[["render",ot]]);ie.__docgenInfo={displayName:"TwoStepVerification",exportName:"default",description:"",tags:{},sourceFiles:["/home/runner/work/ui/ui/src/components/Settings/TwoStepVerification.vue"]};const oe={name:"TwoStepFaq",components:{KvLightbox:ke},data(){return{whatIsLbVisible:!1,howItWorksLbVisible:!1,howItProtectsLbVisible:!1}},methods:{triggerWhatIsLightbox(){this.whatIsLbVisible=!this.whatIsLbVisible},triggerHowItWorksLightbox(){this.howItWorksLbVisible=!this.howItWorksLbVisible},triggerHowItProtectsLightbox(){this.howItProtectsLbVisible=!this.howItProtectsLbVisible},lightboxClosed(){this.whatIsLbVisible=!1,this.howItWorksLBVisible=!1,this.howItProtectsLBVisible=!1}}},st={class:"tw-bg-primary tw-p-4"};function rt(t,e,l,f,a,d){const s=p("kv-lightbox");return o(),g("div",st,[e[6]||(e[6]=i("h2",{class:"tw-text-h3 tw-mb-2"}," Level up your security with 2-step verfication ",-1)),e[7]||(e[7]=i("p",{class:"tw-mb-4"}," 2-step verification protects your Kiva account by requiring an additional code when you log in on a device we don't recognize. ",-1)),e[8]||(e[8]=i("h3",{class:"tw-mb-2"}," FAQ ",-1)),i("ul",null,[i("li",null,[i("button",{class:"tw-text-link tw-font-medium tw-text-left",onClick:e[0]||(e[0]=(...u)=>d.triggerWhatIsLightbox&&d.triggerWhatIsLightbox(...u))}," What is 2-step Verification? ")]),i("li",null,[i("button",{class:"tw-text-link tw-font-medium tw-text-left",onClick:e[1]||(e[1]=(...u)=>d.triggerHowItWorksLightbox&&d.triggerHowItWorksLightbox(...u))}," How does it work? ")]),i("li",null,[i("button",{class:"tw-text-link tw-font-medium tw-text-left",onClick:e[2]||(e[2]=(...u)=>d.triggerHowItProtectsLightbox&&d.triggerHowItProtectsLightbox(...u))}," How does it protect you? ")])]),_(s,{visible:a.whatIsLbVisible,onLightboxClosed:d.lightboxClosed,title:"What is 2-step verification?"},{default:n(()=>e[3]||(e[3]=[i("p",null," 2-step verification is the most secure way to access your Kiva account. By linking a second device to your account, you'll be required to enter a code in addition to your password when you login. ",-1)]),void 0),_:1,__:[3]},8,["visible","onLightboxClosed"]),_(s,{visible:a.howItWorksLbVisible,onLightboxClosed:d.lightboxClosed,title:"How does it work?"},{default:n(()=>e[4]||(e[4]=[i("p",null," Once you set up 2-step verification, you'll be asked to provide a code from your mobile device in addition to your password in order to log into your account. This code will be sent to you via text, voice call, or a mobile app. ",-1)]),void 0),_:1,__:[4]},8,["visible","onLightboxClosed"]),_(s,{visible:a.howItProtectsLbVisible,onLightboxClosed:d.lightboxClosed,title:"How it protects you"},{default:n(()=>e[5]||(e[5]=[i("p",null," 2-step verification ensures that even if someone gains access to your password, they won't be able to login without access to your mobile device. ",-1)]),void 0),_:1,__:[5]},8,["visible","onLightboxClosed"])])}const at=h(oe,[["render",rt]]);oe.__docgenInfo={displayName:"TwoStepFaq",exportName:"default",description:"",tags:{},sourceFiles:["/home/runner/work/ui/ui/src/components/Settings/TwoStepFaq.vue"]};const ne={name:"SecuritySettings",components:{KvDefaultWrapper:Y,WwwPage:Q,TheMyKivaSecondaryMenu:ee,Password:Ze,TwoStepVerification:nt,TwoStepFaq:at},head:{title:"Security and login"}},lt={class:"row"},ct={class:"columns small-12 large-8 security-login-page__component-container"},ut={class:"columns small-12 large-4 security-login-page__component-container"};function dt(t,e,l,f,a,d){const s=p("the-my-kiva-secondary-menu"),u=p("password"),k=p("two-step-verification"),S=p("two-step-faq"),M=p("kv-default-wrapper"),x=p("www-page");return o(),r(x,{class:"security-login-page","gray-background":!0},{secondary:n(()=>[_(s)]),default:n(()=>[_(M,null,{default:n(()=>[e[0]||(e[0]=i("div",{class:"row column"},[i("h1",{class:"tw-mb-4"}," Security and login ")],-1)),i("div",lt,[i("div",ct,[_(u),_(k)]),i("div",ut,[_(S)])])],void 0,!0),_:1,__:[0]})],void 0),_:1})}const se=h(ne,[["render",dt]]);ne.__docgenInfo={displayName:"SecuritySettings",exportName:"default",description:"",tags:{},sourceFiles:["/home/runner/work/ui/ui/src/pages/Settings/SecuritySettings.vue"]};var P,C;function mt(){if(C)return P;C=1;var t=we(),e=be();function l(f,a){return f&&f.length?e(f,t(a,2)):[]}return P=l,P}var pt=mt();const ft=he(pt),vt=`query mfaQuery($mfa_token: String!) {
	my {
		id
		lastLoginTimestamp @client
		authenticatorEnrollments(mfa_token: $mfa_token) {
			id
			active
			authenticator_type
			oob_channel
			name
		}
	}
}
`,yt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mfaQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mfa_token"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"my"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lastLoginTimestamp"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[]}]},{kind:"Field",name:{kind:"Name",value:"authenticatorEnrollments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mfa_token"},value:{kind:"Variable",name:{kind:"Name",value:"mfa_token"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"authenticator_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"oob_channel"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:238,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:vt}}},_t=`mutation removeMfa {
  my {
		deleteAllAuthenticatorEnrollments
	}
}
`,gt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeMfa"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"my"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteAllAuthenticatorEnrollments"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:107,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:_t}}},kt=`mutation removeOneMfaMethod($mfa_token: String!, $id: ID!) {
  my {
		deleteAuthenticatorEnrollment( mfa_token: $mfa_token, id: $id)
	}
}
`,ht={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeOneMfaMethod"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mfa_token"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"my"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteAuthenticatorEnrollment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mfa_token"},value:{kind:"Variable",name:{kind:"Name",value:"mfa_token"}}},{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[]}]}}]}}],loc:{start:0,end:176,source:{name:"GraphQL request",locationOffset:{line:1,column:1},body:kt}}},re={name:"TwoStepVerificationPage",data(){return{isAuthenticatorLightboxVisible:!1,isPhoneLightboxVisible:!1,lastLoginTime:0,mfaMethods:[],isLoading:!0,pageError:""}},components:{KvButton:F,KvDefaultWrapper:Y,KvSettingsCard:I,TheMyKivaSecondaryMenu:ee,WwwPage:Q,KvLoadingPlaceholder:G},head:{title:"2-step verification"},mounted(){this.$route.query.mfa==="off"?window.confirm("Are you sure you want to turn off 2-step verification?")?this.turnOffMfa().then(()=>{this.$router.push("/settings/security")}):this.$router.push("/settings/security/mfa"):this.gatherMfaEnrollments()},inject:["apollo","kvAuth0"],computed:{cardTitle(){return this.isMfaActive?"Add a backup method":"How would you like your verification code?"},cardSubhead(){return this.isMfaActive?"Set up additional backup steps so you can log in even if your other options aren't available":"You'll be asked for a verification code when accessing your Kiva account."},isMfaActive(){return this.mfaMethods.length>0}},watch:{$route(t,e){t.fullPath!==e.fullPath&&t.path==="/settings/security/mfa"&&this.gatherMfaEnrollments()}},methods:{gatherMfaEnrollments(){this.isLoading=!0,this.kvAuth0.checkSession({skipIfUserExists:!0}).then(()=>this.kvAuth0.getMfaManagementToken()).then(t=>this.apollo.query({query:yt,variables:{mfa_token:t},fetchPolicy:"network-only"})).then(t=>{if(t.errors)throw t.errors;this.pageError="";const e=t.data.my.authenticatorEnrollments;this.lastLoginTime=t.data.my.lastLoginTimestamp;const l=e.filter(f=>f.authenticator_type==="recovery-code");if(l.length&&l.every(f=>!f.active))return this.turnOffMfa().then(()=>this.gatherMfaEnrollments());this.formatMfaMethods(e),this.isLoading=!1}).catch(t=>{var e,l;this.isLoading=!1,console.error(t),this.pageError="There was an error fetching your 2-step verification status. Please refresh the page and try again.";try{L(((l=(e=t==null?void 0:t[0])==null?void 0:e.extensions)==null?void 0:l.exception)||t)}catch{}})},checkLastLoginTime(){const t=(Math.floor(Date.now())-this.lastLoginTime)/60/1e3,e=`${this.$route.path}?mfa=off`,l=encodeURIComponent(e);t>=5?window.location=`/ui-login?force=true&doneUrl=${l}`:window.location=e},turnOffMfa(){return this.apollo.mutate({mutation:gt}).then(t=>{if(t.errors)throw t.errors}).catch(t=>{var e,l;this.isLoading=!1,console.error(t),this.pageError="There was an error when turning off your 2-step verification. Please refresh the page and try again.";try{L(((l=(e=t==null?void 0:t[0])==null?void 0:e.extensions)==null?void 0:l.exception)||t)}catch{}})},removeMfaMethod(t){this.kvAuth0.checkSession({skipIfUserExists:!0}).then(()=>this.kvAuth0.getMfaManagementToken()).then(e=>this.apollo.mutate({mutation:ht,variables:{mfa_token:e,id:t.id}})).then(e=>{if(e.errors)throw e.errors;this.gatherMfaEnrollments()}).catch(e=>{var l,f;console.error(e),this.$showTipMsg("There was an error when deleting the method. Please refresh the page and try again.","error");try{L(((f=(l=e==null?void 0:e[0])==null?void 0:l.extensions)==null?void 0:f.exception)||e)}catch{}})},formatMfaMethods(t){const e=t.filter(l=>l.active);this.mfaMethods=ft(e,l=>l.id.split("|")[1])},readableAuthName(t){return t==="oob"?"Text/voice message":t==="recovery-code"?"Recovery code":"Authenticator app"}}},wt={class:"row"},bt={class:"column small-12 large-8 two-step-verification__settings-card-area"},St={key:0,class:"two-step-verification__error tw-text-danger"},Mt={class:"tw-mb-1"},xt={class:"two-step-verification__method--number data-hj-suppress"},Tt=["onClick"],Nt={class:"two-step-verification__sub-section tw-mb-4"},Lt={class:"tw-mb-2"},Kt={class:"two-step-verification__sub-section"};function At(t,e,l,f,a,d){const s=p("the-my-kiva-secondary-menu"),u=p("kv-loading-placeholder"),k=p("kv-settings-card"),S=p("kv-button"),M=p("router-view"),x=p("kv-default-wrapper"),K=p("www-page");return o(),r(K,{class:"two-step-verification","gray-background":!0},{secondary:n(()=>[_(s)]),default:n(()=>[_(x,null,{default:n(()=>[e[8]||(e[8]=i("div",{class:"row column"},[i("h1",{class:"tw-mb-4"}," 2-step verification ")],-1)),i("div",wt,[i("div",bt,[a.pageError?(o(),g("p",St,w(a.pageError),1)):v("",!0),a.isLoading?(o(),r(u,{key:1,class:"two-step-verification--loading"})):v("",!0),!a.isLoading&&d.isMfaActive&&!a.pageError?(o(),r(k,{key:2,title:"2-step verification is turned on"},{content:n(()=>[i("div",null,[e[1]||(e[1]=i("p",{class:"tw-mb-2"}," We'll ask you for your password and verification code from your mobile phone in order to log into your Kiva account. ",-1)),i("button",{class:"tw-text-link tw-font-medium",onClick:e[0]||(e[0]=(...y)=>d.checkLastLoginTime&&d.checkLastLoginTime(...y))}," Turn off 2-step verification ")])]),_:1})):v("",!0),a.isLoading?(o(),r(u,{key:3,class:"two-step-verification--loading"})):v("",!0),!a.isLoading&&d.isMfaActive&&!a.pageError?(o(),r(k,{key:4,title:"Your security method(s)"},{content:n(()=>[i("ul",null,[(o(!0),g(ce,null,ue(a.mfaMethods,(y,A)=>(o(),g("li",{class:"two-step-verification__method",key:A},[i("h3",Mt,w(d.readableAuthName(y.authenticator_type)),1),i("p",xt,w(y.name),1),y.authenticator_type!=="recovery-code"?(o(),g("button",{key:0,class:"tw-text-link tw-font-medium",onClick:qt=>d.removeMfaMethod(y)}," Remove ",8,Tt)):v("",!0)]))),128))])]),_:1})):v("",!0),a.isLoading?(o(),r(u,{key:5,class:"two-step-verification--loading"})):v("",!0),!a.isLoading&&!a.pageError?(o(),r(k,{key:6,title:`${d.cardTitle}`},{content:n(()=>[i("div",Nt,[i("p",Lt,w(d.cardSubhead),1),v("",!0)]),i("div",Kt,[e[6]||(e[6]=i("h3",{class:"tw-mb-2"}," Authentication app ",-1)),e[7]||(e[7]=i("p",{class:"tw-mb-2"}," Receive code from an authenticator app on your device, like Google Authenticator, Duo, or Authy. ",-1)),_(S,{to:`/settings/security/mfa/app?first=${!d.isMfaActive}`},{default:n(()=>e[5]||(e[5]=[c(" Use authenticator app ")]),void 0,!0),_:1,__:[5]},8,["to"])]),_(M)]),_:1},8,["title"])):v("",!0)])])],void 0,!0),_:1,__:[8]})],void 0),_:1})}const Pt=h(re,[["render",At],["__scopeId","data-v-79f46931"]]);re.__docgenInfo={displayName:"TwoStepVerificationPage",exportName:"default",description:"",tags:{},sourceFiles:["/home/runner/work/ui/ui/src/pages/Settings/TwoStepVerificationPage.vue"]};const zi={title:"Page/Security Settings",component:se},T=()=>({mixins:[R(),O(),U],components:{SecuritySettingsPage:se},template:`
        <security-settings-page />
    `}),N=()=>({mixins:[R(),O(),U],components:{TwoStepVerificationPage:Pt},template:`
        <two-step-verification-page />
    `});var E,V,B;T.parameters={...T.parameters,docs:{...(E=T.parameters)==null?void 0:E.docs,source:{originalSource:`() => ({
  mixins: [apolloStoryMixin(), cookieStoreStoryMixin(), kvAuth0StoryMixin],
  components: {
    SecuritySettingsPage
  },
  template: \`
        <security-settings-page />
    \`
})`,...(B=(V=T.parameters)==null?void 0:V.docs)==null?void 0:B.source}}};var D,$,W;N.parameters={...N.parameters,docs:{...(D=N.parameters)==null?void 0:D.docs,source:{originalSource:`() => ({
  mixins: [apolloStoryMixin(), cookieStoreStoryMixin(), kvAuth0StoryMixin],
  components: {
    TwoStepVerificationPage
  },
  template: \`
        <two-step-verification-page />
    \`
})`,...(W=($=N.parameters)==null?void 0:$.docs)==null?void 0:W.source}}};const Yi=["SecurityAndLogin","TwoStepVerification"];export{T as SecurityAndLogin,N as TwoStepVerification,Yi as __namedExportsOrder,zi as default};
