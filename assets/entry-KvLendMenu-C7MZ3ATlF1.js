import{P as B,c as l,o as n,H as x,I as N,F as m,J as p,K as _,e as s,r as g,d as I,a as w,b as L,f as M,h as $,j as A,n as H,x as J,z as Q,A as V}from"./entry-vue.esm-bundler-Bf_Yeyugwo.js";import{p as q,l as j}from"./entry-mdi-BJHOrBfjV3.js";import{z as W}from"./entry-KvAccordionItem-Bt-JNbOfTg.js";import{_ as P}from"./entry-KvLoadingPlaceholder-DUZzoT9CoU.js";import{s as K}from"./entry-KvWwwHeader-CVdIzOPj6Q.js";import{H as X,_ as Z}from"./entry-KvTabs-Dt0rMR23wJ.js";import{I as Y}from"./entry-KvTabPanel-Dqe0lxZDeq.js";import{w as z}from"./entry-KvMaterialIcon-DcajXwg-0j.js";import{g as ee}from"./entry-KvGrid-A3hpmYTsti.js";import{x as te}from"./entry-KvPageContainer-B9-1kg27t_.js";import{g as U}from"./entry-numeral-DJCTM12wUX.js";import"./entry-KvExpandable-DLPQ2-gM4K.js";import"./entry-_commonjsHelpers-Cpj98o6Yn6.js";const ne={name:"CountryList",props:{countries:{type:Array,default:()=>[]}}},ae={class:"tw-whitespace-nowrap tw-font-medium"},le=["href"],se={key:1,class:"tw-block tw-py-1 tw-text-tertiary"};function oe(r,e,t,a,v,b){const d=B("kv-track-event");return n(),l("ul",ae,[(n(!0),l(x,null,N(t.countries,c=>(n(),l("li",{key:c.isoCode,class:"country-list-item"},[c.count>0?m((n(),l("a",{key:0,href:`/lend/filter?country=${c.isoCode}`,class:"tw-text-primary hover:tw-text-action tw-block tw-w-full tw-py-1"},[p(_(c.name)+" ("+_(c.count)+") ",1)],8,le)),[[d,["TopNav","click-Lend-Country",c.name]]]):(n(),l("span",se,_(c.name)+" (0) ",1))]))),128))])}const E=K(ne,[["render",oe],["__scopeId","data-v-b291d337"]]),re={props:{searches:{type:Array,default:()=>[]}}},ie={class:"tw-font-book"},ce=["href"];function de(r,e,t,a,v,b){return n(),l("ul",ie,[(n(!0),l(x,null,N(t.searches,d=>(n(),l("li",{key:d.id},[s("a",{class:"tw-text-primary hover:tw-text-action tw-block tw-w-full tw-py-1",href:d.url},_(d.name),9,ce)]))),128)),e[0]||(e[0]=s("li",null,[s("a",{class:"tw-text-primary hover:tw-text-action tw-block tw-w-full tw-py-1",href:"/lend/saved-search"}," Manage saved searches ")],-1))])}const D=K(re,[["render",de]]);function ue(r){return r.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase()}const me={components:{KvAccordionItem:W,KvTab:Z,KvTabPanel:Y,KvTabs:X,KvLendMenuCountryList:E,KvLendMenuSearchList:D,KvLoadingPlaceholder:P,KvMaterialIcon:z},props:{categories:{type:Array,default:()=>[]},favorites:{type:Number,default:0},userId:{type:Number,default:null},regions:{type:Array,default:()=>[]},searches:{type:Array,default:()=>[]},isRegionsLoading:{type:Boolean,default:!0},isChannelsLoading:{type:Boolean,default:!0},showMGUpsellLink:{type:Boolean,default:!1},countriesNotLentToUrl:{type:String,default:"/lend/countries-not-lent"}},setup(r){const e=$(null),t=$([]),a=$(null),v=A(()=>r.searches.length>0);return{mdiArrowRight:q,hasSearches:v,navLendCategories:e,regionAccordions:t,searchesLink:a,onClose:()=>{var b,d,c,k,u,C,y;(c=(d=(b=e.value)==null?void 0:b.tabContext)==null?void 0:d.setTab)==null||c.call(d,0),(u=(k=t.value)==null?void 0:k.forEach)==null||u.call(k,o=>{var f;(f=o==null?void 0:o.collapse)==null||f.call(o)}),(y=(C=a.value)==null?void 0:C.collapse)==null||y.call(C)},paramCase:ue}}},pe={class:"tw-pb-2"},we={key:0,href:"/monthlygood"},ve={class:"tw-inline-flex tw-items-center tw-py-2 tw-mb-2 tw-gap-0.5 tw-border-b tw-border-tertiary tw-font-medium"},he={class:"tw-font-medium"},ye=["href"],fe={class:"tw-border-t tw-border-tertiary"},ge={href:"/lend-by-category/recommended-by-lenders",class:"lend-link tw-text-brand"},ke={href:"/lend",class:"lend-link"},Le={href:"/categories",class:"lend-link"},be={class:"tw-flex"},Ce={class:"tw-text-h4"},xe={class:"tw-font-medium"},Se=["href"],$e={key:1,class:"tw-block tw-py-1 tw-text-tertiary"},Ne={key:0},Te={key:1},_e=["href"];function Ae(r,e,t,a,v,b){const d=g("kv-material-icon"),c=g("kv-tab"),k=g("kv-loading-placeholder"),u=g("kv-tab-panel"),C=g("kv-accordion-item"),y=g("kv-lend-menu-country-list"),o=g("kv-lend-menu-search-list"),f=g("kv-tabs"),h=B("kv-track-event");return n(),l("div",pe,[t.showMGUpsellLink?m((n(),l("a",we,[s("span",ve,[e[0]||(e[0]=p(" Lend monthly ")),w(d,{icon:a.mdiArrowRight,class:"tw-w-3 tw-h-3"},null,8,["icon"])])])),[[h,["TopNav","click-Lend-Menu-Monthly-Good","Lend-monthly"]]]):I("",!0),w(f,{ref:"navLendCategories"},{tabNav:L(()=>[m((n(),M(c,{"for-panel":"nav-lend-categories"},{default:L(()=>e[1]||(e[1]=[p(" Categories ")])),_:1})),[[h,["TopNav","click-Lend-Tab-Categories"]]]),m((n(),M(c,{"for-panel":"nav-lend-regions"},{default:L(()=>e[2]||(e[2]=[p(" Regions ")])),_:1})),[[h,["TopNav","click-Lend-Tab-Regions"]]]),t.userId?m((n(),M(c,{key:0,"for-panel":"nav-my-kiva"},{default:L(()=>e[3]||(e[3]=[p(" My Kiva ")])),_:1})),[[h,["TopNav","click-Lend-Tab-My-Kiva"]]]):I("",!0)]),tabPanels:L(()=>[w(u,{id:"nav-lend-categories"},{default:L(()=>[s("ul",he,[t.isChannelsLoading?(n(),l(x,{key:0},N(14,i=>s("li",{key:i,style:{width:"11rem"},class:"tw-py-1 tw-flex"},[w(k,{class:"tw-inline-block tw-align-middle",style:{height:"1rem"}}),e[4]||(e[4]=s("span",{class:"tw-inline-block"}," ",-1))])),64)):(n(!0),l(x,{key:1},N(t.categories,(i,S)=>(n(),l("li",{key:S},[m((n(),l("a",{href:i.url,class:"lend-link"},[p(_(i.name),1)],8,ye)),[[h,["TopNav","click-Lend-Category",i.name,S+1]]])]))),128)),s("li",fe,[m((n(),l("a",ge,e[5]||(e[5]=[p(" Recommended by lenders ")]))),[[h,["TopNav","click-Lend-Recommended-by-lenders"]]])]),s("li",null,[m((n(),l("a",ke,e[6]||(e[6]=[p(" All loans ")]))),[[h,["TopNav","click-Lend-All_Loans"]]])]),s("li",null,[m((n(),l("a",Le,e[7]||(e[7]=[p(" All categories ")]))),[[h,["TopNav","click-Lend-All_Categories"]]])])])]),_:1}),w(u,{id:"nav-lend-regions"},{default:L(()=>[t.isRegionsLoading?(n(),l(x,{key:0},N(8,i=>w(C,{id:`placeholder-${i}-panel`,key:i,disabled:!0},{header:L(()=>[s("div",be,[w(k,{class:"tw-inline-block tw-align-middle",style:{height:"1rem"}}),e[8]||(e[8]=s("span",{class:"tw-inline-block tw-text-h4"}," ",-1))])]),_:2},1032,["id"])),64)):(n(!0),l(x,{key:1},N(t.regions,i=>m((n(),M(C,{id:`lend-menu-${a.paramCase(i.name)}-panel`,key:i.name,ref_for:!0,ref:"regionAccordions"},{header:L(()=>[s("h3",Ce,_(i.name),1)]),default:L(()=>[w(y,{countries:i.countries},null,8,["countries"])]),_:2},1032,["id"])),[[h,["TopNav","click-Lend-Region",i.name]]])),128))]),_:1}),t.userId?(n(),M(u,{key:0,id:"nav-my-kiva"},{default:L(()=>[s("ul",xe,[s("li",null,[t.favorites>0?m((n(),l("a",{key:0,href:`/lend?lenderFavorite=${t.userId}`,class:"lend-link"},e[9]||(e[9]=[p(" Saved loans ")]),8,Se)),[[h,["TopNav","click-Lend-Favorites"]]]):(n(),l("span",$e,"Saved loans"))]),a.hasSearches?(n(),l("li",Ne,[w(C,{id:"lend-menu-saved-searches-panel",ref:"searchesLink"},{header:L(()=>e[10]||(e[10]=[s("p",{class:"tw-font-medium"}," Saved searches ",-1)])),default:L(()=>[w(o,{searches:t.searches},null,8,["searches"])]),_:1},512)])):(n(),l("li",Te,e[11]||(e[11]=[s("span",{class:"tw-block tw-py-1 tw-text-tertiary"},"Saved searches",-1)]))),s("li",null,[m((n(),l("a",{href:t.countriesNotLentToUrl,class:"lend-link"},e[12]||(e[12]=[p(" Countries I haven't lent to ")]),8,_e)),[[h,["TopNav","click-Lend-Countries_Not_Lent"]]])])])]),_:1})):I("",!0)]),_:1},512)])}const Me=K(me,[["render",Ae],["__scopeId","data-v-de8f418f"]]),Ie={components:{KvGrid:ee,KvLendMenuCountryList:E,KvLendMenuSearchList:D,KvLoadingPlaceholder:P,KvMaterialIcon:z},props:{categories:{type:Array,default:()=>[]},favorites:{type:Number,default:0},isRegionsLoading:{type:Boolean,default:!0},isChannelsLoading:{type:Boolean,default:!0},userId:{type:Number,default:null},regions:{type:Array,default:()=>[]},searches:{type:Array,default:()=>[]},showMGUpsellLink:{type:Boolean,default:!1},countriesNotLentToUrl:{type:String,default:"/lend/countries-not-lent"}},setup(r){const e=$(null),t=$(""),a=A(()=>t.value!==""),v=u=>t.value===u,b=u=>{t.value=u},d=A(()=>{var u;const C={width:"150%"};if(a.value){const y=((u=e.value)==null?void 0:u.clientWidth)??0;C.transform=`translateX(${y*-1}px)`}return C}),c=A(()=>r.regions.filter(u=>v(u.name))),k=A(()=>r.searches.length>0);return{mdiArrowRight:q,mdiChevronLeft:j,categoriesSection:e,openedSection:t,sectionOpen:a,isOpenSection:v,openSection:b,onClose:()=>{t.value=""},openRegions:c,computedStyle:d,hasSearches:k,savedSearchesTitle:"Saved searches"}}},Re={class:"lend-mega-menu tw-overflow-hidden tw-pb-3 lg:tw-pt-3"},Ke={key:0,href:"/monthlygood"},Oe={class:"tw-inline-flex tw-items-center tw-py-1 tw-mb-2 tw-gap-0.5 tw-font-medium tw-text-action"},Ue={ref:"categoriesSection",class:"tw-col-span-7"},Be={class:"tw-flex tw-gap-4 tw-whitespace-nowrap"},Fe={class:"tw-columns-2 tw-gap-4 tw-font-medium"},Ge=["href"],qe={class:"tw-font-medium"},Pe={class:"link-item"},ze={href:"/lend-by-category/recommended-by-lenders",class:"mega-menu-link"},Ee={class:"link-item"},De={href:"/categories",class:"mega-menu-link"},He={class:"link-item"},Je={class:"mega-menu-link",href:"/lend"},Qe={key:0},Ve={class:"tw-font-medium"},je=["href"],We={key:1,class:"tw-text-secondary tw-py-1 tw-inline-block tw-no-underline hover:tw-underline"},Xe=["aria-pressed"],Ze={key:1,class:"tw-text-secondary tw-py-1 tw-inline-block"},Ye=["href"],et={class:"tw-col-span-2"},tt={class:"tw-col-span-8 tw-flex tw-flex-col"},nt={class:"tw-flex tw-whitespace-nowrap tw-h-full"},at={class:"tw-font-medium"},lt=["aria-pressed","onClick"];function st(r,e,t,a,v,b){const d=g("kv-material-icon"),c=g("kv-loading-placeholder"),k=g("kv-lend-menu-search-list"),u=g("kv-lend-menu-country-list"),C=g("kv-grid"),y=B("kv-track-event");return n(),l("div",Re,[s("div",{style:J(a.computedStyle),class:"tw-transition tw-duration-1000 tw-ease-in-out"},[t.showMGUpsellLink?m((n(),l("a",Ke,[s("span",Oe,[e[2]||(e[2]=p(" Lend monthly ")),w(d,{icon:a.mdiArrowRight,class:"tw-w-3 tw-h-3"},null,8,["icon"])])])),[[y,["TopNav","click-Lend-Menu-Monthly-Good","Lend-monthly"]]]):I("",!0),w(C,{style:{"grid-template-columns":"repeat(18, minmax(0, 1fr))"}},{default:L(()=>[s("div",Ue,[e[11]||(e[11]=s("h2",{class:"menu-heading tw-mb-2"}," Categories ",-1)),s("div",Be,[s("ul",Fe,[t.isChannelsLoading?(n(),l(x,{key:0},N(14,o=>s("li",{key:o,class:"link-item"},[w(c,{class:"tw-inline-block tw-align-middle",style:{height:"1.25rem"}}),e[3]||(e[3]=s("span",{class:"tw-py-1 tw-inline-block"}," ",-1))])),64)):(n(!0),l(x,{key:1},N(t.categories,(o,f)=>(n(),l("li",{key:f,class:"link-item"},[m((n(),l("a",{href:o.url,class:"tw-text-primary tw-text-left hover:tw-text-action tw-no-underline tw-my-1 tw-inline-block"},[p(_(o.name),1)],8,Ge)),[[y,["TopNav","click-Lend-Category",o.name,f+1]]])]))),128))]),s("div",null,[s("ul",qe,[s("li",Pe,[m((n(),l("a",ze,e[4]||(e[4]=[p(" Recommended by lenders ")]))),[[y,["TopNav","click-Lend-Recommended-by-lenders"]]])]),s("li",Ee,[m((n(),l("a",De,e[5]||(e[5]=[p(" All categories ")]))),[[y,["TopNav","click-Lend-All_Categories"]]])]),s("li",He,[m((n(),l("a",Je,e[6]||(e[6]=[p(" All loans ")]))),[[y,["TopNav","click-Lend-All_Loans"]]])])]),t.userId?(n(),l("div",Qe,[e[9]||(e[9]=s("span",{class:"tw-inline-block tw-py-1"}," ",-1)),e[10]||(e[10]=s("h2",{class:"menu-heading tw-my-1"}," My Kiva ",-1)),s("ul",Ve,[s("li",null,[t.favorites>0?m((n(),l("a",{key:0,href:`/lend?lenderFavorite=${t.userId}`,class:"tw-text-primary tw-text-left hover:tw-text-action tw-py-1 tw-inline-block tw-no-underline hover:tw-underline"},e[7]||(e[7]=[p(" Saved loans ")]),8,je)),[[y,["TopNav","click-Lend-Favorites"]]]):(n(),l("span",We," Saved loans "))]),s("li",null,[a.hasSearches?(n(),l("button",{key:0,"aria-pressed":a.isOpenSection(a.savedSearchesTitle)?"true":"false",class:"tw-text-primary tw-text-left tw-py-1 tw-inline-block hover:tw-text-action hover:tw-underline",onClick:e[0]||(e[0]=o=>a.openSection(a.savedSearchesTitle))},_(a.savedSearchesTitle),9,Xe)):(n(),l("span",Ze," Saved searches "))]),s("li",null,[m((n(),l("a",{href:t.countriesNotLentToUrl,class:"tw-text-primary tw-text-left hover:tw-text-action tw-py-1 tw-inline-block tw-no-underline hover:tw-underline"},e[8]||(e[8]=[p(" Countries I haven't lent to ")]),8,Ye)),[[y,["TopNav","click-Lend-Countries_Not_Lent"]]])])])])):I("",!0)])])],512),s("div",et,[a.sectionOpen?(n(),l("button",{key:0,class:"tw-flex",onClick:e[1]||(e[1]=o=>a.openedSection="")},[w(d,{class:"tw-flex-shrink-0 tw-w-3 tw-h-3",icon:a.mdiChevronLeft},null,8,["icon"]),e[12]||(e[12]=s("span",{class:"tw-text-base"}," Back ",-1))])):I("",!0)]),s("div",tt,[a.isOpenSection(a.savedSearchesTitle)?(n(),l(x,{key:0},[e[13]||(e[13]=s("h2",{class:"menu-heading tw-mb-2"}," Saved Searches ",-1)),w(k,{class:"search-list tw-h-full",searches:t.searches},null,8,["searches"])],64)):(n(),l(x,{key:1},[e[15]||(e[15]=s("h2",{class:"menu-heading tw-mb-2"}," Regions ",-1)),s("div",nt,[s("ul",at,[t.isRegionsLoading?(n(),l(x,{key:0},N(8,o=>s("li",{key:o,class:"link-item"},[w(c,{class:"tw-inline-block tw-align-middle",style:{height:"1.25rem"}}),e[14]||(e[14]=s("span",{class:"tw-py-1 tw-inline-block"}," ",-1))])),64)):(n(!0),l(x,{key:1},N(t.regions,o=>(n(),l("li",{key:o.name,class:"link-item tw-mr-4"},[m((n(),l("button",{"aria-pressed":a.isOpenSection(o.name)?"true":"false",class:H(["tw-text-primary tw-text-left tw-py-1 hover:tw-text-action hover:tw-underline",{"tw-text-action":a.isOpenSection(o.name)}]),onClick:f=>a.openSection(o.name)},[p(_(o.name),1)],10,lt)),[[y,["TopNav","click-Lend-Region",o.name]]])]))),128))]),(n(!0),l(x,null,N(a.openRegions,o=>(n(),l("div",{key:o.name,class:"tw-h-full"},[w(u,{countries:o.countries,class:"region-list tw-h-full"},null,8,["countries"])]))),128))])],64))])]),_:1})],4)])}const ot=K(Ie,[["render",st],["__scopeId","data-v-0c9de865"]]);function rt(r,e){if(!Array.isArray(r))throw new TypeError("list must be an array");return(t,a)=>{const v=t[e],b=a[e];return r.indexOf(v)<r.indexOf(b)?-1:1}}const it=(r,e)=>r.reduce((t,a)=>{const v=a[e];return t[v]||(t[v]=[]),t[v].push(a),t},{}),G=r=>(e,t)=>e[r]>t[r]?1:t[r]>e[r]?-1:0,ct={components:{KvLendListMenu:Me,KvLendMegaMenu:ot,KvPageContainer:te},props:{userId:{type:Number,default:null},showMGUpsellLink:{type:Boolean,default:!1},countriesNotLentToUrl:{type:String,default:"/lend/countries-not-lent"}},emits:["load-lend-menu-data"],setup(r,{emit:e}){const{userId:t}=Q(r),a=$([]),v=$([]),b=$(0),d=$([]),c=["North America","Central America","South America","Africa","Eastern Europe","Middle East","Asia","Oceania"],k=$(!0),u=$(!0),C=async f=>{var h,i,S,O;if(f.watchQuery({query:U`query countryFacets {
					lend {
						countryFacets {
							count
							country {
								name
								region
								isoCode
							}
						}
					}

				}`}).subscribe({next:({data:T})=>{var R;v.value=((R=T==null?void 0:T.lend)==null?void 0:R.countryFacets)??[],k.value=!1}}),f.watchQuery({query:U`
					query lendMenuData {
						lend {
							loanChannels(popular: true, applyMinLoanCount: true, limit: 50) {
								values {
									id
									name
									url
								}
							}
						}
					}
				`}).subscribe({next:({data:T})=>{var R,F;a.value=((F=(R=T==null?void 0:T.lend)==null?void 0:R.loanChannels)==null?void 0:F.values)??[],u.value=!1}}),t.value){const{data:T}=await f.query({query:U`
						query lendMenuPrivateData($userId: Int!) {
							lend {
								loans(limit: 1, filters: {
									lenderFavorite: $userId
								}) {
									totalCount
								}
							}
							my {
								savedSearches {
									values {
										id
										name
										url
									}
								}
							}
						}
					`,variables:{userId:t.value},fetchPolicy:"network-only"});b.value=((i=(h=T==null?void 0:T.lend)==null?void 0:h.loans)==null?void 0:i.totalCount)??0,d.value=((O=(S=T==null?void 0:T.my)==null?void 0:S.savedSearches)==null?void 0:O.values)??[]}},y=A(()=>{const f=v.value.map(S=>({name:S.country.name,region:S.country.region,isoCode:S.country.isoCode.toLowerCase(),count:S.count||0})),h=it(f,"region"),i=[];for(const[S,O]of Object.entries(h))i.push({name:S,countries:O.sort(G("name"))});return i.sort(rt(c,"name"))}),o=A(()=>{var f;return((f=a.value)==null?void 0:f.map(h=>{const i=JSON.parse(JSON.stringify(h));return i.url=i.url.replace("lend","lend-by-category"),i})).sort(G("name"))});return V(()=>{e("load-lend-menu-data")}),{onLoad:C,regions:y,computedCategories:o,isChannelsLoading:u,isRegionsLoading:k,savedSearches:d,favoritesCount:b}}};function dt(r,e,t,a,v,b){const d=g("kv-lend-list-menu"),c=g("kv-lend-mega-menu"),k=g("kv-page-container");return n(),M(k,{class:"tw-pt-2 lg:tw-pt-0"},{default:L(()=>[w(d,{class:"lg:tw-hidden",categories:a.computedCategories,regions:a.regions,"user-id":t.userId,favorites:a.favoritesCount,searches:a.savedSearches,"is-regions-loading":a.isRegionsLoading,"is-channels-loading":a.isChannelsLoading,"show-m-g-upsell-link":t.showMGUpsellLink,"countries-not-lent-to-url":t.countriesNotLentToUrl},null,8,["categories","regions","user-id","favorites","searches","is-regions-loading","is-channels-loading","show-m-g-upsell-link","countries-not-lent-to-url"]),w(c,{class:"tw-hidden lg:tw-block",categories:a.computedCategories,regions:a.regions,"user-id":t.userId,favorites:a.favoritesCount,searches:a.savedSearches,"is-regions-loading":a.isRegionsLoading,"is-channels-loading":a.isChannelsLoading,"show-m-g-upsell-link":t.showMGUpsellLink,"countries-not-lent-to-url":t.countriesNotLentToUrl},null,8,["categories","regions","user-id","favorites","searches","is-regions-loading","is-channels-loading","show-m-g-upsell-link","countries-not-lent-to-url"])]),_:1})}const xt=K(ct,[["render",dt]]);export{xt as default};
