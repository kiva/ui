import{g as r,c as m,o as c,m as $,q as s,L as f,A as D,b as le,j as w,k as ne,w as se,z as O,u as g,J as L,I as U,a as b,C as F,M as B}from"./entry-vue.esm-bundler-C0PPCo9W96.js";import{d as re,f as _}from"./entry-useBadgeData-Bo50EdUMyn.js";import{G as ce,H as ie}from"./entry-GoalProgressRing-CwBp38KzOS.js";import{a as ue}from"./entry-mdi-B1ONwcTkQ2.js";import{x as ge}from"./entry-KvMaterialIcon-C3KLX5OV-L.js";import{_ as de}from"./entry-KvLoadingPlaceholder-B_9_tltQhY.js";import"./entry-KvWwwHeader-C1bm1YMh4q.js";import{g as R}from"./entry-KvButton-BA7nBLyz1b.js";import"./entry-numeral-xVHG5DEP0A.js";import{u as me,S as I,L as j,G as fe}from"./entry-useGoalData-CY18ya0ook.js";import{_ as pe}from"./entry-_plugin-vue_export-helper-DlAUqK2UKH.js";const we={key:0,class:"tw-bg-marigold-2 tw-rounded-lg tw-text-small tw-drop-shadow-md tw-hidden lg:tw-block tw-absolute tw--top-1.5 tw-px-1.5 tw-left-1/2 tw--translate-x-1/2 tw-whitespace-nowrap"},ye={class:"tw-flex lg:tw-flex-col tw-gap-1 lg:tw-gap-0 tw-items-baseline lg:tw-items-center tw-text-eco-green-3"},he={class:"tw-flex tw-flex-col tw-gap-1"},ve={key:0,class:"tw-bg-marigold-2 tw-rounded-lg tw-text-small tw-drop-shadow-md lg:tw-hidden tw-px-1.5"},xe={class:"tw-text-primary tw-font-medium tw-text-h5 tw-text-center"},H={__name:"LoanNumberSelector",props:{selected:{type:Boolean,default:!1},highlightedText:{type:String,default:""},loansNumber:{type:Number,default:2},optionText:{type:String,default:""}},setup(l){const T=l,d=r(()=>Math.abs(T.loansNumber).toString().length>=3);return(C,y)=>(c(),m("div",{class:D(["tw-flex tw-justify-between tw-items-center tw-w-full tw-border-2 tw-border-gray-200 tw-rounded tw-p-2.5 tw-py-1 tw-cursor-pointer tw-relative tw-gap-2",{"tw-border-eco-green-3 tw-bg-eco-green-1":l.selected}])},[l.highlightedText?(c(),m("div",we,f(l.highlightedText),1)):$("",!0),s("div",ye,[s("span",{class:D(["tw-text-h1 tw-text-center",{"!tw-text-h2":d.value}]),style:{"line-height":"1"}},f(l.loansNumber),3),y[0]||(y[0]=s("span",{class:"tw-text-small tw-text-center"},"loans",-1))]),s("div",he,[l.highlightedText?(c(),m("div",ve,f(l.highlightedText),1)):$("",!0),s("div",xe,f(l.optionText),1)])],2))}};H.__docgenInfo={exportName:"default",displayName:"LoanNumberSelector",description:"",tags:{},props:[{name:"selected",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"highlightedText",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"loansNumber",type:{name:"number"},defaultValue:{func:!1,value:"2"}},{name:"optionText",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],sourceFiles:["/home/runner/work/ui/ui/src/components/MyKiva/GoalSetting/LoanNumberSelector.vue"]};const be={class:"tw-flex tw-flex-col tw-justify-center tw-gap-0 lg:tw-gap-1.5 tw-items-center"},Te=["src"],Ce=["innerHTML"],ke={class:"tw-text-base lg:tw-text-subhead tw-my-1.5 lg:tw-mb-1 lg:tw-mt-2 tw-text-center"},Se={class:"tw-w-full tw-flex tw-flex-col lg:tw-flex-row tw-gap-1 lg:tw-gap-1.5 tw-my-1"},Ne={class:"buttons tw-flex tw-flex-col tw-w-full tw-gap-1.5"},W={__name:"GoalSelector",props:{isGoalSet:{type:Boolean,default:!1},categoriesLoanCount:{type:Object,default:()=>({})},trackingCategory:{type:String,default:"post-checkout"},goToUrl:{type:String,default:"/mykiva"},tieredAchievements:{type:Array,default:()=>[]},selectedCategoryId:{type:String,default:re},selectedCategoryName:{type:String,default:"Women"},goalLoans:{type:Number,default:0},goalProgress:{type:Number,default:0},goalProgressPercentage:{type:Number,default:0}},emits:["set-goal","edit-goal","set-goal-target","close-modal"],setup(l,{emit:T}){const d=le("$kvTrackEvent"),{getCategoryLoansLastYear:C,getCategoryLoanCountByYear:y,getSupportAllLoanCountByYear:z}=me(),t=l,h=T,k=[{loansNumber:3,optionText:"Start strong",selected:!1},{loansNumber:4,highlightedText:"Recommended",optionText:"Extra mile",selected:!1},{loansNumber:5,optionText:"Trailblazing!",selected:!1}],i=w(k),S=w(!1),G=w(null),A=w(0),Y=w(1),N=r(()=>t.selectedCategoryId===_?A.value:C(t.tieredAchievements,t.selectedCategoryId)),p=r(()=>{var o;const e=(o=t.tieredAchievements)==null?void 0:o.find(a=>a.id===t.selectedCategoryId);return typeof(e==null?void 0:e.progressForCurrentYear)=="number"?e.progressForCurrentYear:G.value??0}),M=async()=>{var n;const e=(n=t.tieredAchievements)==null?void 0:n.find(u=>u.id===t.selectedCategoryId);if(typeof(e==null?void 0:e.progressForCurrentYear)=="number")return;S.value=!0;const o=new Date().getFullYear(),a=await y(t.selectedCategoryId,o,"network-only");G.value=a,S.value=!1},K=r(()=>{var e;return N.value===0||N.value>I?t.selectedCategoryId===_?"How many loans will you make this year?":`How many loans to <span class="tw-text-eco-green-3">${(e=t.selectedCategoryName)==null?void 0:e.toLowerCase()}</span> will you make this year?`:'Lenders like you help <br><span class="tw-text-eco-green-3">3 women</span> a year'}),Q=r(()=>p.value>0?`You've already made ${p.value} that will count`:""),q=new Date().getFullYear(),J=r(()=>`Set ${q} goal`),v=r(()=>{const e=i.value.find(o=>o.selected);return(e==null?void 0:e.loansNumber)??k[1].loansNumber}),x=r(()=>t.goalLoans>0?t.goalLoans:v.value),X=r(()=>!x.value||x.value===0?0:Math.min(Math.round(p.value/x.value*100),100)),V=e=>{i.value=i.value.map((o,a)=>({...o,selected:a===e}))},Z=e=>{V(e),Y.value=e;const o=["same-as-last-year","a-little-more","double"];d(t.trackingCategory,"click","set-goal-amount",o[e]),h("set-goal-target",i.value[e].loansNumber)},ee=()=>{h("edit-goal"),d(t.trackingCategory,"click","edit-goal-category")},te=()=>{d(t.trackingCategory,"click",t.goToUrl==="/mykiva"?"go-to-mykiva":"continue-towards-goal"),window.location.href=t.goToUrl},ae=()=>{var E;const e=new Date().getFullYear(),o=`goal-${t.selectedCategoryId}-${e}`,a=v.value,n=new Date().toISOString(),u=((E=t.categoriesLoanCount)==null?void 0:E[t.selectedCategoryId])||0,oe={goalName:o,category:t.selectedCategoryId,target:a,dateStarted:n,status:fe.IN_PROGRESS,loanTotalAtStart:u};h("set-goal",oe),d(t.trackingCategory,"click","set-annual-goal",t.selectedCategoryId,v.value)},P=()=>{const e=p.value,o=N.value;if(e>=I){const a=e+3,n=Math.max(Math.ceil(a*1.25),a+1),u=Math.max(a*2,n+1);i.value=[{loansNumber:a,optionText:"A few more",selected:!1},{loansNumber:n,optionText:"Grow a little",selected:!1,highlightedText:"More Impact"},{loansNumber:u,optionText:"Aim higher",selected:!1}]}else if(o>I){const a=o,n=Math.max(Math.ceil(a*1.25),a+1),u=Math.max(a*2,n+1);i.value=[{loansNumber:a,optionText:`Same as ${j}`,selected:!1},{loansNumber:n,optionText:"Grow a little",selected:!1,highlightedText:"More Impact"},{loansNumber:u,optionText:"Double my impact!",selected:!1}]}else i.value=k;V(Y.value),h("set-goal-target",v.value)};return ne(async()=>{await M(),P(),t.trackingCategory==="post-checkout"&&d("post-checkout","view","set-annual-goal")}),se(()=>t.selectedCategoryId,async e=>{await M(),P(),e===_&&(A.value=await z(j))}),(e,o)=>(c(),m("div",be,[l.isGoalSet?(c(),O(g(ce),{key:0,variant:"modal","goal-loans":x.value,"goal-progress":p.value,"goal-progress-percentage":X.value,"category-name":l.selectedCategoryName,"category-id":l.selectedCategoryId,"go-to-url":l.goToUrl,onButtonClick:te},null,8,["goal-loans","goal-progress","goal-progress-percentage","category-name","category-id","go-to-url"])):(c(),m(L,{key:1},[s("img",{src:g(ie),class:"lg:tw-mb-1 tw-w-10 lg:tw-w-12.5"},null,8,Te),s("h2",{class:"tw-px-4 lg:tw-px-7 tw-text-center",style:{"line-height":"125%"},innerHTML:K.value},null,8,Ce),s("div",ke,f(Q.value),1),s("div",Se,[S.value?(c(),m(L,{key:0},U(3,a=>b(g(de),{key:a,class:"tw-flex-1 !tw-rounded",style:{"min-height":"82px"}})),64)):(c(!0),m(L,{key:1},U(i.value,(a,n)=>(c(),O(g(H),{key:n,"loans-number":a.loansNumber,"option-text":a.optionText,selected:a.selected,"highlighted-text":a.highlightedText,onClick:u=>Z(n)},null,8,["loans-number","option-text","selected","highlighted-text","onClick"]))),128))]),s("div",Ne,[b(g(R),{class:"tw-w-full tw-mt-1.5",onClick:ae},{default:F(()=>[B(f(J.value),1)],void 0),_:1}),b(g(R),{variant:"ghost",class:"edit-goal-button tw-w-full",onClick:ee},{default:F(()=>[o[0]||(o[0]=B(" Edit goal category ")),b(g(ge),{icon:g(ue),class:"tw-ml-0.5"},null,8,["icon"])],void 0),_:1,__:[0]})])],64))]))}},De=pe(W,[["__scopeId","data-v-7752f9ac"]]);W.__docgenInfo={exportName:"default",displayName:"GoalSelector",description:"",tags:{},props:[{name:"isGoalSet",description:"Whether the goal has been set on parent component",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"categoriesLoanCount",description:"Categories loan count",type:{name:"object"},defaultValue:{func:!1,value:"{}"}},{name:"trackingCategory",description:"Tracking category for analytics",type:{name:"string"},defaultValue:{func:!1,value:"'post-checkout'"}},{name:"goToUrl",description:"URL to go to after setting goal",type:{name:"string"},defaultValue:{func:!1,value:"'/mykiva'"}},{name:"tieredAchievements",description:"Tiered achievements data (last year)",type:{name:"array"},defaultValue:{func:!1,value:"[]"}},{name:"selectedCategoryId",description:"Goal Category ID",type:{name:"string"},defaultValue:{func:!1,value:"ID_WOMENS_EQUALITY"}},{name:"selectedCategoryName",description:"Goal Category Name",type:{name:"string"},defaultValue:{func:!1,value:"'Women'"}},{name:"goalLoans",description:"Target number of loans for the goal",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"goalProgress",description:"Current progress (number of loans made toward goal)",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"goalProgressPercentage",description:"Progress percentage (0-100)",type:{name:"number"},defaultValue:{func:!1,value:"0"}}],events:[{name:"set-goal"},{name:"edit-goal"},{name:"set-goal-target"},{name:"close-modal"}],sourceFiles:["/home/runner/work/ui/ui/src/components/MyKiva/GoalSetting/GoalSelector.vue"]};export{De as G};
