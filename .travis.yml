dist: bionic
language: node_js
cache:
  npm: true
  directories:
    - ~/.cache
addons:
  apt:
    packages:
    - build-essential
    - libgconf-2-4
    - libcairo2-dev
    - libpango1.0-dev
    - libjpeg-dev
    - libgif-dev
    - librsvg2-dev
jobs:
  fast_finish: true
  include:
    - node_js: '12.14'
    - node_js: 'node'
      if: head_branch = master
    - node_js: 15
      if: branch = node-v15
  allow_failures:
    - node_js: 'node'
      if: head_branch = master
    - node_js: 15
      if: branch = node-v15
branches:
  only:
    - master
    - /^release-.*$/
    - node-v15
after_script:
  - cat test/unit/coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js
