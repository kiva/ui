name: Ui Tests

# on: [push, pull_request]
# pull_request
on:
  push:
    branches:
      - github-actions-build-test
      # - master
      # - /^release-.*$/
  # pull_request:
    # branches:
      # - master
      # - /^release-.*$/

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Use Node.js
      uses: actions/setup-node@v1
      with:
        node-version: '12.x'
    - name: Install dependencies
      run: npm ci
    - name: Run Lint
      run: npm run lint
    - name: Run Unit Tests
      run: npm run unit
    - name: Run e2e Tests
      uses: cypress-io/github-action@v2
      with:
        browser: chrome
        headless: true
        build: npm run build
        start: npm start -- --mock --config=local
        wait-on: 'http-get://localhost:8888/ui-site-map'
        command: npm run e2e:headless
